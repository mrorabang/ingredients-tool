/*! For license information please see main.95e03bc2.js.LICENSE.txt */
(()=>{var e={4:(e,t,n)=>{"use strict";var r=n(853),a=n(43),i=n(950);function s(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function l(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function c(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function u(e){if(l(e)!==e)throw Error(s(188))}function h(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(null!==(t=h(e)))return t;e=e.sibling}return null}var f=Object.assign,d=Symbol.for("react.element"),p=Symbol.for("react.transitional.element"),m=Symbol.for("react.portal"),g=Symbol.for("react.fragment"),v=Symbol.for("react.strict_mode"),y=Symbol.for("react.profiler"),b=Symbol.for("react.provider"),w=Symbol.for("react.consumer"),T=Symbol.for("react.context"),S=Symbol.for("react.forward_ref"),E=Symbol.for("react.suspense"),k=Symbol.for("react.suspense_list"),_=Symbol.for("react.memo"),x=Symbol.for("react.lazy");Symbol.for("react.scope");var C=Symbol.for("react.activity");Symbol.for("react.legacy_hidden"),Symbol.for("react.tracing_marker");var I=Symbol.for("react.memo_cache_sentinel");Symbol.for("react.view_transition");var A=Symbol.iterator;function N(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=A&&e[A]||e["@@iterator"])?e:null}var R=Symbol.for("react.client.reference");function O(e){if(null==e)return null;if("function"===typeof e)return e.$$typeof===R?null:e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case g:return"Fragment";case y:return"Profiler";case v:return"StrictMode";case E:return"Suspense";case k:return"SuspenseList";case C:return"Activity"}if("object"===typeof e)switch(e.$$typeof){case m:return"Portal";case T:return(e.displayName||"Context")+".Provider";case w:return(e._context.displayName||"Context")+".Consumer";case S:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case _:return null!==(t=e.displayName||null)?t:O(e.type)||"Memo";case x:t=e._payload,e=e._init;try{return O(e(t))}catch(n){}}return null}var P=Array.isArray,D=a.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,L=i.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,M={pending:!1,data:null,method:null,action:null},F=[],U=-1;function j(e){return{current:e}}function V(e){0>U||(e.current=F[U],F[U]=null,U--)}function z(e,t){U++,F[U]=e.current,e.current=t}var B=j(null),H=j(null),W=j(null),G=j(null);function K(e,t){switch(z(W,t),z(H,e),z(B,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?ah(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)e=ih(t=ah(t),e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}V(B),z(B,e)}function q(){V(B),V(H),V(W)}function $(e){null!==e.memoizedState&&z(G,e);var t=B.current,n=ih(t,e.type);t!==n&&(z(H,e),z(B,n))}function X(e){H.current===e&&(V(B),V(H)),G.current===e&&(V(G),$h._currentValue=M)}var Y=Object.prototype.hasOwnProperty,Q=r.unstable_scheduleCallback,J=r.unstable_cancelCallback,Z=r.unstable_shouldYield,ee=r.unstable_requestPaint,te=r.unstable_now,ne=r.unstable_getCurrentPriorityLevel,re=r.unstable_ImmediatePriority,ae=r.unstable_UserBlockingPriority,ie=r.unstable_NormalPriority,se=r.unstable_LowPriority,oe=r.unstable_IdlePriority,le=r.log,ce=r.unstable_setDisableYieldValue,ue=null,he=null;function fe(e){if("function"===typeof le&&ce(e),he&&"function"===typeof he.setStrictMode)try{he.setStrictMode(ue,e)}catch(t){}}var de=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(pe(e)/me|0)|0},pe=Math.log,me=Math.LN2;var ge=256,ve=4194304;function ye(e){var t=42&e;if(0!==t)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194048&e;case 4194304:case 8388608:case 16777216:case 33554432:return 62914560&e;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function be(e,t,n){var r=e.pendingLanes;if(0===r)return 0;var a=0,i=e.suspendedLanes,s=e.pingedLanes;e=e.warmLanes;var o=134217727&r;return 0!==o?0!==(r=o&~i)?a=ye(r):0!==(s&=o)?a=ye(s):n||0!==(n=o&~e)&&(a=ye(n)):0!==(o=r&~i)?a=ye(o):0!==s?a=ye(s):n||0!==(n=r&~e)&&(a=ye(n)),0===a?0:0!==t&&t!==a&&0===(t&i)&&((i=a&-a)>=(n=t&-t)||32===i&&0!==(4194048&n))?t:a}function we(e,t){return 0===(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)}function Te(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function Se(){var e=ge;return 0===(4194048&(ge<<=1))&&(ge=256),e}function Ee(){var e=ve;return 0===(62914560&(ve<<=1))&&(ve=4194304),e}function ke(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function _e(e,t){e.pendingLanes|=t,268435456!==t&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function xe(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var r=31-de(t);e.entangledLanes|=t,e.entanglements[r]=1073741824|e.entanglements[r]|4194090&n}function Ce(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-de(n),a=1<<r;a&t|e[r]&t&&(e[r]|=t),n&=~a}}function Ie(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Ae(e){return 2<(e&=-e)?8<e?0!==(134217727&e)?32:268435456:8:2}function Ne(){var e=L.p;return 0!==e?e:void 0===(e=window.event)?32:uf(e.type)}var Re=Math.random().toString(36).slice(2),Oe="__reactFiber$"+Re,Pe="__reactProps$"+Re,De="__reactContainer$"+Re,Le="__reactEvents$"+Re,Me="__reactListeners$"+Re,Fe="__reactHandles$"+Re,Ue="__reactResources$"+Re,je="__reactMarker$"+Re;function Ve(e){delete e[Oe],delete e[Pe],delete e[Le],delete e[Me],delete e[Fe]}function ze(e){var t=e[Oe];if(t)return t;for(var n=e.parentNode;n;){if(t=n[De]||n[Oe]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=bh(e);null!==e;){if(n=e[Oe])return n;e=bh(e)}return t}n=(e=n).parentNode}return null}function Be(e){if(e=e[Oe]||e[De]){var t=e.tag;if(5===t||6===t||13===t||26===t||27===t||3===t)return e}return null}function He(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e.stateNode;throw Error(s(33))}function We(e){var t=e[Ue];return t||(t=e[Ue]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function Ge(e){e[je]=!0}var Ke=new Set,qe={};function $e(e,t){Xe(e,t),Xe(e+"Capture",t)}function Xe(e,t){for(qe[e]=t,e=0;e<t.length;e++)Ke.add(t[e])}var Ye,Qe,Je=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ze={},et={};function tt(e,t,n){if(a=t,Y.call(et,a)||!Y.call(Ze,a)&&(Je.test(a)?et[a]=!0:(Ze[a]=!0,0)))if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":return void e.removeAttribute(t);case"boolean":var r=t.toLowerCase().slice(0,5);if("data-"!==r&&"aria-"!==r)return void e.removeAttribute(t)}e.setAttribute(t,""+n)}var a}function nt(e,t,n){if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(t)}e.setAttribute(t,""+n)}}function rt(e,t,n,r){if(null===r)e.removeAttribute(n);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(n)}e.setAttributeNS(t,n,""+r)}}function at(e){if(void 0===Ye)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Ye=t&&t[1]||"",Qe=-1<n.stack.indexOf("\n    at")?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+Ye+e+Qe}var it=!1;function st(e,t){if(!e||it)return"";it=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var r={DetermineComponentFrameRoot:function(){try{if(t){var n=function(){throw Error()};if(Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(n,[])}catch(a){var r=a}Reflect.construct(e,[],n)}else{try{n.call()}catch(i){r=i}e.call(n.prototype)}}else{try{throw Error()}catch(s){r=s}(n=e())&&"function"===typeof n.catch&&n.catch(function(){})}}catch(o){if(o&&r&&"string"===typeof o.stack)return[o.stack,r.stack]}return[null,null]}};r.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var a=Object.getOwnPropertyDescriptor(r.DetermineComponentFrameRoot,"name");a&&a.configurable&&Object.defineProperty(r.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var i=r.DetermineComponentFrameRoot(),s=i[0],o=i[1];if(s&&o){var l=s.split("\n"),c=o.split("\n");for(a=r=0;r<l.length&&!l[r].includes("DetermineComponentFrameRoot");)r++;for(;a<c.length&&!c[a].includes("DetermineComponentFrameRoot");)a++;if(r===l.length||a===c.length)for(r=l.length-1,a=c.length-1;1<=r&&0<=a&&l[r]!==c[a];)a--;for(;1<=r&&0<=a;r--,a--)if(l[r]!==c[a]){if(1!==r||1!==a)do{if(r--,0>--a||l[r]!==c[a]){var u="\n"+l[r].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}}while(1<=r&&0<=a);break}}}finally{it=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?at(n):""}function ot(e){switch(e.tag){case 26:case 27:case 5:return at(e.type);case 16:return at("Lazy");case 13:return at("Suspense");case 19:return at("SuspenseList");case 0:case 15:return st(e.type,!1);case 11:return st(e.type.render,!1);case 1:return st(e.type,!0);case 31:return at("Activity");default:return""}}function lt(e){try{var t="";do{t+=ot(e),e=e.return}while(e);return t}catch(n){return"\nError generating stack: "+n.message+"\n"+n.stack}}function ct(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function ut(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function ht(e){e._valueTracker||(e._valueTracker=function(e){var t=ut(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var a=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){r=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function ft(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=ut(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function dt(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}var pt=/[\n"\\]/g;function mt(e){return e.replace(pt,function(e){return"\\"+e.charCodeAt(0).toString(16)+" "})}function gt(e,t,n,r,a,i,s,o){e.name="",null!=s&&"function"!==typeof s&&"symbol"!==typeof s&&"boolean"!==typeof s?e.type=s:e.removeAttribute("type"),null!=t?"number"===s?(0===t&&""===e.value||e.value!=t)&&(e.value=""+ct(t)):e.value!==""+ct(t)&&(e.value=""+ct(t)):"submit"!==s&&"reset"!==s||e.removeAttribute("value"),null!=t?yt(e,s,ct(t)):null!=n?yt(e,s,ct(n)):null!=r&&e.removeAttribute("value"),null==a&&null!=i&&(e.defaultChecked=!!i),null!=a&&(e.checked=a&&"function"!==typeof a&&"symbol"!==typeof a),null!=o&&"function"!==typeof o&&"symbol"!==typeof o&&"boolean"!==typeof o?e.name=""+ct(o):e.removeAttribute("name")}function vt(e,t,n,r,a,i,s,o){if(null!=i&&"function"!==typeof i&&"symbol"!==typeof i&&"boolean"!==typeof i&&(e.type=i),null!=t||null!=n){if(!("submit"!==i&&"reset"!==i||void 0!==t&&null!==t))return;n=null!=n?""+ct(n):"",t=null!=t?""+ct(t):n,o||t===e.value||(e.value=t),e.defaultValue=t}r="function"!==typeof(r=null!=r?r:a)&&"symbol"!==typeof r&&!!r,e.checked=o?e.checked:!!r,e.defaultChecked=!!r,null!=s&&"function"!==typeof s&&"symbol"!==typeof s&&"boolean"!==typeof s&&(e.name=s)}function yt(e,t,n){"number"===t&&dt(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function bt(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+ct(n),t=null,a=0;a<e.length;a++){if(e[a].value===n)return e[a].selected=!0,void(r&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function wt(e,t,n){null==t||((t=""+ct(t))!==e.value&&(e.value=t),null!=n)?e.defaultValue=null!=n?""+ct(n):"":e.defaultValue!==t&&(e.defaultValue=t)}function Tt(e,t,n,r){if(null==t){if(null!=r){if(null!=n)throw Error(s(92));if(P(r)){if(1<r.length)throw Error(s(93));r=r[0]}n=r}null==n&&(n=""),t=n}n=ct(t),e.defaultValue=n,(r=e.textContent)===n&&""!==r&&null!==r&&(e.value=r)}function St(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var Et=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function kt(e,t,n){var r=0===t.indexOf("--");null==n||"boolean"===typeof n||""===n?r?e.setProperty(t,""):"float"===t?e.cssFloat="":e[t]="":r?e.setProperty(t,n):"number"!==typeof n||0===n||Et.has(t)?"float"===t?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function _t(e,t,n){if(null!=t&&"object"!==typeof t)throw Error(s(62));if(e=e.style,null!=n){for(var r in n)!n.hasOwnProperty(r)||null!=t&&t.hasOwnProperty(r)||(0===r.indexOf("--")?e.setProperty(r,""):"float"===r?e.cssFloat="":e[r]="");for(var a in t)r=t[a],t.hasOwnProperty(a)&&n[a]!==r&&kt(e,a,r)}else for(var i in t)t.hasOwnProperty(i)&&kt(e,i,t[i])}function xt(e){if(-1===e.indexOf("-"))return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ct=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),It=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function At(e){return It.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}var Nt=null;function Rt(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Ot=null,Pt=null;function Dt(e){var t=Be(e);if(t&&(e=t.stateNode)){var n=e[Pe]||null;e:switch(e=t.stateNode,t.type){case"input":if(gt(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+mt(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var a=r[Pe]||null;if(!a)throw Error(s(90));gt(r,a.value,a.defaultValue,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name)}}for(t=0;t<n.length;t++)(r=n[t]).form===e.form&&ft(r)}break e;case"textarea":wt(e,n.value,n.defaultValue);break e;case"select":null!=(t=n.value)&&bt(e,!!n.multiple,t,!1)}}}var Lt=!1;function Mt(e,t,n){if(Lt)return e(t,n);Lt=!0;try{return e(t)}finally{if(Lt=!1,(null!==Ot||null!==Pt)&&(zc(),Ot&&(t=Ot,e=Pt,Pt=Ot=null,Dt(t),e)))for(t=0;t<e.length;t++)Dt(e[t])}}function Ft(e,t){var n=e.stateNode;if(null===n)return null;var r=n[Pe]||null;if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(s(231,t,typeof n));return n}var Ut=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),jt=!1;if(Ut)try{var Vt={};Object.defineProperty(Vt,"passive",{get:function(){jt=!0}}),window.addEventListener("test",Vt,Vt),window.removeEventListener("test",Vt,Vt)}catch(Df){jt=!1}var zt=null,Bt=null,Ht=null;function Wt(){if(Ht)return Ht;var e,t,n=Bt,r=n.length,a="value"in zt?zt.value:zt.textContent,i=a.length;for(e=0;e<r&&n[e]===a[e];e++);var s=r-e;for(t=1;t<=s&&n[r-t]===a[i-t];t++);return Ht=a.slice(e,1<t?1-t:void 0)}function Gt(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function Kt(){return!0}function qt(){return!1}function $t(e){function t(t,n,r,a,i){for(var s in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=a,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(a):a[s]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?Kt:qt,this.isPropagationStopped=qt,this}return f(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=Kt)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=Kt)},persist:function(){},isPersistent:Kt}),t}var Xt,Yt,Qt,Jt={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Zt=$t(Jt),en=f({},Jt,{view:0,detail:0}),tn=$t(en),nn=f({},en,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:pn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Qt&&(Qt&&"mousemove"===e.type?(Xt=e.screenX-Qt.screenX,Yt=e.screenY-Qt.screenY):Yt=Xt=0,Qt=e),Xt)},movementY:function(e){return"movementY"in e?e.movementY:Yt}}),rn=$t(nn),an=$t(f({},nn,{dataTransfer:0})),sn=$t(f({},en,{relatedTarget:0})),on=$t(f({},Jt,{animationName:0,elapsedTime:0,pseudoElement:0})),ln=$t(f({},Jt,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),cn=$t(f({},Jt,{data:0})),un={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},hn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},fn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function dn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=fn[e])&&!!t[e]}function pn(){return dn}var mn=$t(f({},en,{key:function(e){if(e.key){var t=un[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=Gt(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?hn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:pn,charCode:function(e){return"keypress"===e.type?Gt(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Gt(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),gn=$t(f({},nn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),vn=$t(f({},en,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:pn})),yn=$t(f({},Jt,{propertyName:0,elapsedTime:0,pseudoElement:0})),bn=$t(f({},nn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),wn=$t(f({},Jt,{newState:0,oldState:0})),Tn=[9,13,27,32],Sn=Ut&&"CompositionEvent"in window,En=null;Ut&&"documentMode"in document&&(En=document.documentMode);var kn=Ut&&"TextEvent"in window&&!En,_n=Ut&&(!Sn||En&&8<En&&11>=En),xn=String.fromCharCode(32),Cn=!1;function In(e,t){switch(e){case"keyup":return-1!==Tn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function An(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Nn=!1;var Rn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function On(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Rn[e.type]:"textarea"===t}function Pn(e,t,n,r){Ot?Pt?Pt.push(r):Pt=[r]:Ot=r,0<(t=Wu(t,"onChange")).length&&(n=new Zt("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Dn=null,Ln=null;function Mn(e){Mu(e,0)}function Fn(e){if(ft(He(e)))return e}function Un(e,t){if("change"===e)return t}var jn=!1;if(Ut){var Vn;if(Ut){var zn="oninput"in document;if(!zn){var Bn=document.createElement("div");Bn.setAttribute("oninput","return;"),zn="function"===typeof Bn.oninput}Vn=zn}else Vn=!1;jn=Vn&&(!document.documentMode||9<document.documentMode)}function Hn(){Dn&&(Dn.detachEvent("onpropertychange",Wn),Ln=Dn=null)}function Wn(e){if("value"===e.propertyName&&Fn(Ln)){var t=[];Pn(t,Ln,e,Rt(e)),Mt(Mn,t)}}function Gn(e,t,n){"focusin"===e?(Hn(),Ln=n,(Dn=t).attachEvent("onpropertychange",Wn)):"focusout"===e&&Hn()}function Kn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Fn(Ln)}function qn(e,t){if("click"===e)return Fn(t)}function $n(e,t){if("input"===e||"change"===e)return Fn(t)}var Xn="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function Yn(e,t){if(Xn(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!Y.call(t,a)||!Xn(e[a],t[a]))return!1}return!0}function Qn(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Jn(e,t){var n,r=Qn(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Qn(r)}}function Zn(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?Zn(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function er(e){for(var t=dt((e=null!=e&&null!=e.ownerDocument&&null!=e.ownerDocument.defaultView?e.ownerDocument.defaultView:window).document);t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=dt((e=t.contentWindow).document)}return t}function tr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var nr=Ut&&"documentMode"in document&&11>=document.documentMode,rr=null,ar=null,ir=null,sr=!1;function or(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;sr||null==rr||rr!==dt(r)||("selectionStart"in(r=rr)&&tr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},ir&&Yn(ir,r)||(ir=r,0<(r=Wu(ar,"onSelect")).length&&(t=new Zt("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=rr)))}function lr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var cr={animationend:lr("Animation","AnimationEnd"),animationiteration:lr("Animation","AnimationIteration"),animationstart:lr("Animation","AnimationStart"),transitionrun:lr("Transition","TransitionRun"),transitionstart:lr("Transition","TransitionStart"),transitioncancel:lr("Transition","TransitionCancel"),transitionend:lr("Transition","TransitionEnd")},ur={},hr={};function fr(e){if(ur[e])return ur[e];if(!cr[e])return e;var t,n=cr[e];for(t in n)if(n.hasOwnProperty(t)&&t in hr)return ur[e]=n[t];return e}Ut&&(hr=document.createElement("div").style,"AnimationEvent"in window||(delete cr.animationend.animation,delete cr.animationiteration.animation,delete cr.animationstart.animation),"TransitionEvent"in window||delete cr.transitionend.transition);var dr=fr("animationend"),pr=fr("animationiteration"),mr=fr("animationstart"),gr=fr("transitionrun"),vr=fr("transitionstart"),yr=fr("transitioncancel"),br=fr("transitionend"),wr=new Map,Tr="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Sr(e,t){wr.set(e,t),$e(t,[e])}Tr.push("scrollEnd");var Er=new WeakMap;function kr(e,t){if("object"===typeof e&&null!==e){var n=Er.get(e);return void 0!==n?n:(t={value:e,source:t,stack:lt(t)},Er.set(e,t),t)}return{value:e,source:t,stack:lt(t)}}var _r=[],xr=0,Cr=0;function Ir(){for(var e=xr,t=Cr=xr=0;t<e;){var n=_r[t];_r[t++]=null;var r=_r[t];_r[t++]=null;var a=_r[t];_r[t++]=null;var i=_r[t];if(_r[t++]=null,null!==r&&null!==a){var s=r.pending;null===s?a.next=a:(a.next=s.next,s.next=a),r.pending=a}0!==i&&Or(n,a,i)}}function Ar(e,t,n,r){_r[xr++]=e,_r[xr++]=t,_r[xr++]=n,_r[xr++]=r,Cr|=r,e.lanes|=r,null!==(e=e.alternate)&&(e.lanes|=r)}function Nr(e,t,n,r){return Ar(e,t,n,r),Pr(e)}function Rr(e,t){return Ar(e,null,null,t),Pr(e)}function Or(e,t,n){e.lanes|=n;var r=e.alternate;null!==r&&(r.lanes|=n);for(var a=!1,i=e.return;null!==i;)i.childLanes|=n,null!==(r=i.alternate)&&(r.childLanes|=n),22===i.tag&&(null===(e=i.stateNode)||1&e._visibility||(a=!0)),e=i,i=i.return;return 3===e.tag?(i=e.stateNode,a&&null!==t&&(a=31-de(n),null===(r=(e=i.hiddenUpdates)[a])?e[a]=[t]:r.push(t),t.lane=536870912|n),i):null}function Pr(e){if(50<Oc)throw Oc=0,Pc=null,Error(s(185));for(var t=e.return;null!==t;)t=(e=t).return;return 3===e.tag?e.stateNode:null}var Dr={};function Lr(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Mr(e,t,n,r){return new Lr(e,t,n,r)}function Fr(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Ur(e,t){var n=e.alternate;return null===n?((n=Mr(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=65011712&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function jr(e,t){e.flags&=65011714;var n=e.alternate;return null===n?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Vr(e,t,n,r,a,i){var o=0;if(r=e,"function"===typeof e)Fr(e)&&(o=1);else if("string"===typeof e)o=function(e,t,n){if(1===n||null!=t.itemProp)return!1;switch(e){case"meta":case"title":return!0;case"style":if("string"!==typeof t.precedence||"string"!==typeof t.href||""===t.href)break;return!0;case"link":if("string"!==typeof t.rel||"string"!==typeof t.href||""===t.href||t.onLoad||t.onError)break;return"stylesheet"!==t.rel||(e=t.disabled,"string"===typeof t.precedence&&null==e);case"script":if(t.async&&"function"!==typeof t.async&&"symbol"!==typeof t.async&&!t.onLoad&&!t.onError&&t.src&&"string"===typeof t.src)return!0}return!1}(e,n,B.current)?26:"html"===e||"head"===e||"body"===e?27:5;else e:switch(e){case C:return(e=Mr(31,n,t,a)).elementType=C,e.lanes=i,e;case g:return zr(n.children,a,i,t);case v:o=8,a|=24;break;case y:return(e=Mr(12,n,t,2|a)).elementType=y,e.lanes=i,e;case E:return(e=Mr(13,n,t,a)).elementType=E,e.lanes=i,e;case k:return(e=Mr(19,n,t,a)).elementType=k,e.lanes=i,e;default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case b:case T:o=10;break e;case w:o=9;break e;case S:o=11;break e;case _:o=14;break e;case x:o=16,r=null;break e}o=29,n=Error(s(130,null===e?"null":typeof e,"")),r=null}return(t=Mr(o,n,t,a)).elementType=e,t.type=r,t.lanes=i,t}function zr(e,t,n,r){return(e=Mr(7,e,r,t)).lanes=n,e}function Br(e,t,n){return(e=Mr(6,e,null,t)).lanes=n,e}function Hr(e,t,n){return(t=Mr(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Wr=[],Gr=0,Kr=null,qr=0,$r=[],Xr=0,Yr=null,Qr=1,Jr="";function Zr(e,t){Wr[Gr++]=qr,Wr[Gr++]=Kr,Kr=e,qr=t}function ea(e,t,n){$r[Xr++]=Qr,$r[Xr++]=Jr,$r[Xr++]=Yr,Yr=e;var r=Qr;e=Jr;var a=32-de(r)-1;r&=~(1<<a),n+=1;var i=32-de(t)+a;if(30<i){var s=a-a%5;i=(r&(1<<s)-1).toString(32),r>>=s,a-=s,Qr=1<<32-de(t)+a|n<<a|r,Jr=i+e}else Qr=1<<i|n<<a|r,Jr=e}function ta(e){null!==e.return&&(Zr(e,1),ea(e,1,0))}function na(e){for(;e===Kr;)Kr=Wr[--Gr],Wr[Gr]=null,qr=Wr[--Gr],Wr[Gr]=null;for(;e===Yr;)Yr=$r[--Xr],$r[Xr]=null,Jr=$r[--Xr],$r[Xr]=null,Qr=$r[--Xr],$r[Xr]=null}var ra=null,aa=null,ia=!1,sa=null,oa=!1,la=Error(s(519));function ca(e){throw ma(kr(Error(s(418,"")),e)),la}function ua(e){var t=e.stateNode,n=e.type,r=e.memoizedProps;switch(t[Oe]=e,t[Pe]=r,n){case"dialog":Fu("cancel",t),Fu("close",t);break;case"iframe":case"object":case"embed":Fu("load",t);break;case"video":case"audio":for(n=0;n<Du.length;n++)Fu(Du[n],t);break;case"source":Fu("error",t);break;case"img":case"image":case"link":Fu("error",t),Fu("load",t);break;case"details":Fu("toggle",t);break;case"input":Fu("invalid",t),vt(t,r.value,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name,!0),ht(t);break;case"select":Fu("invalid",t);break;case"textarea":Fu("invalid",t),Tt(t,r.value,r.defaultValue,r.children),ht(t)}"string"!==typeof(n=r.children)&&"number"!==typeof n&&"bigint"!==typeof n||t.textContent===""+n||!0===r.suppressHydrationWarning||Yu(t.textContent,n)?(null!=r.popover&&(Fu("beforetoggle",t),Fu("toggle",t)),null!=r.onScroll&&Fu("scroll",t),null!=r.onScrollEnd&&Fu("scrollend",t),null!=r.onClick&&(t.onclick=Qu),t=!0):t=!1,t||ca(e)}function ha(e){for(ra=e.return;ra;)switch(ra.tag){case 5:case 13:return void(oa=!1);case 27:case 3:return void(oa=!0);default:ra=ra.return}}function fa(e){if(e!==ra)return!1;if(!ia)return ha(e),ia=!0,!1;var t,n=e.tag;if((t=3!==n&&27!==n)&&((t=5===n)&&(t=!("form"!==(t=e.type)&&"button"!==t)||sh(e.type,e.memoizedProps)),t=!t),t&&aa&&ca(e),ha(e),13===n){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,n=0;e;){if(8===e.nodeType)if("/$"===(t=e.data)){if(0===n){aa=vh(e.nextSibling);break e}n--}else"$"!==t&&"$!"!==t&&"$?"!==t||n++;e=e.nextSibling}aa=null}}else 27===n?(n=aa,dh(e.type)?(e=yh,yh=null,aa=e):aa=n):aa=ra?vh(e.stateNode.nextSibling):null;return!0}function da(){aa=ra=null,ia=!1}function pa(){var e=sa;return null!==e&&(null===bc?bc=e:bc.push.apply(bc,e),sa=null),e}function ma(e){null===sa?sa=[e]:sa.push(e)}var ga=j(null),va=null,ya=null;function ba(e,t,n){z(ga,t._currentValue),t._currentValue=n}function wa(e){e._currentValue=ga.current,V(ga)}function Ta(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Sa(e,t,n,r){var a=e.child;for(null!==a&&(a.return=e);null!==a;){var i=a.dependencies;if(null!==i){var o=a.child;i=i.firstContext;e:for(;null!==i;){var l=i;i=a;for(var c=0;c<t.length;c++)if(l.context===t[c]){i.lanes|=n,null!==(l=i.alternate)&&(l.lanes|=n),Ta(i.return,n,e),r||(o=null);break e}i=l.next}}else if(18===a.tag){if(null===(o=a.return))throw Error(s(341));o.lanes|=n,null!==(i=o.alternate)&&(i.lanes|=n),Ta(o,n,e),o=null}else o=a.child;if(null!==o)o.return=a;else for(o=a;null!==o;){if(o===e){o=null;break}if(null!==(a=o.sibling)){a.return=o.return,o=a;break}o=o.return}a=o}}function Ea(e,t,n,r){e=null;for(var a=t,i=!1;null!==a;){if(!i)if(0!==(524288&a.flags))i=!0;else if(0!==(262144&a.flags))break;if(10===a.tag){var o=a.alternate;if(null===o)throw Error(s(387));if(null!==(o=o.memoizedProps)){var l=a.type;Xn(a.pendingProps.value,o.value)||(null!==e?e.push(l):e=[l])}}else if(a===G.current){if(null===(o=a.alternate))throw Error(s(387));o.memoizedState.memoizedState!==a.memoizedState.memoizedState&&(null!==e?e.push($h):e=[$h])}a=a.return}null!==e&&Sa(t,e,n,r),t.flags|=262144}function ka(e){for(e=e.firstContext;null!==e;){if(!Xn(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function _a(e){va=e,ya=null,null!==(e=e.dependencies)&&(e.firstContext=null)}function xa(e){return Ia(va,e)}function Ca(e,t){return null===va&&_a(e),Ia(e,t)}function Ia(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},null===ya){if(null===e)throw Error(s(308));ya=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else ya=ya.next=t;return n}var Aa="undefined"!==typeof AbortController?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,n){e.push(n)}};this.abort=function(){t.aborted=!0,e.forEach(function(e){return e()})}},Na=r.unstable_scheduleCallback,Ra=r.unstable_NormalPriority,Oa={$$typeof:T,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Pa(){return{controller:new Aa,data:new Map,refCount:0}}function Da(e){e.refCount--,0===e.refCount&&Na(Ra,function(){e.controller.abort()})}var La=null,Ma=0,Fa=0,Ua=null;function ja(){if(0===--Ma&&null!==La){null!==Ua&&(Ua.status="fulfilled");var e=La;La=null,Fa=0,Ua=null;for(var t=0;t<e.length;t++)(0,e[t])()}}var Va=D.S;D.S=function(e,t){"object"===typeof t&&null!==t&&"function"===typeof t.then&&function(e,t){if(null===La){var n=La=[];Ma=0,Fa=Au(),Ua={status:"pending",value:void 0,then:function(e){n.push(e)}}}Ma++,t.then(ja,ja)}(0,t),null!==Va&&Va(e,t)};var za=j(null);function Ba(){var e=za.current;return null!==e?e:rc.pooledCache}function Ha(e,t){z(za,null===t?za.current:t.pool)}function Wa(){var e=Ba();return null===e?null:{parent:Oa._currentValue,pool:e}}var Ga=Error(s(460)),Ka=Error(s(474)),qa=Error(s(542)),$a={then:function(){}};function Xa(e){return"fulfilled"===(e=e.status)||"rejected"===e}function Ya(){}function Qa(e,t,n){switch(void 0===(n=e[n])?e.push(t):n!==t&&(t.then(Ya,Ya),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw ei(e=t.reason),e;default:if("string"===typeof t.status)t.then(Ya,Ya);else{if(null!==(e=rc)&&100<e.shellSuspendCounter)throw Error(s(482));(e=t).status="pending",e.then(function(e){if("pending"===t.status){var n=t;n.status="fulfilled",n.value=e}},function(e){if("pending"===t.status){var n=t;n.status="rejected",n.reason=e}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw ei(e=t.reason),e}throw Ja=t,Ga}}var Ja=null;function Za(){if(null===Ja)throw Error(s(459));var e=Ja;return Ja=null,e}function ei(e){if(e===Ga||e===qa)throw Error(s(483))}var ti=!1;function ni(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ri(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function ai(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function ii(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&nc)){var a=r.pending;return null===a?t.next=t:(t.next=a.next,a.next=t),r.pending=t,t=Pr(e),Or(e,null,n),t}return Ar(e,r,t,n),Pr(e)}function si(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194048&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,Ce(e,n)}}function oi(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var a=null,i=null;if(null!==(n=n.firstBaseUpdate)){do{var s={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};null===i?a=i=s:i=i.next=s,n=n.next}while(null!==n);null===i?a=i=t:i=i.next=t}else a=i=t;return n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:r.shared,callbacks:r.callbacks},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var li=!1;function ci(){if(li){if(null!==Ua)throw Ua}}function ui(e,t,n,r){li=!1;var a=e.updateQueue;ti=!1;var i=a.firstBaseUpdate,s=a.lastBaseUpdate,o=a.shared.pending;if(null!==o){a.shared.pending=null;var l=o,c=l.next;l.next=null,null===s?i=c:s.next=c,s=l;var u=e.alternate;null!==u&&((o=(u=u.updateQueue).lastBaseUpdate)!==s&&(null===o?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(null!==i){var h=a.baseState;for(s=0,u=c=l=null,o=i;;){var d=-536870913&o.lane,p=d!==o.lane;if(p?(ic&d)===d:(r&d)===d){0!==d&&d===Fa&&(li=!0),null!==u&&(u=u.next={lane:0,tag:o.tag,payload:o.payload,callback:null,next:null});e:{var m=e,g=o;d=t;var v=n;switch(g.tag){case 1:if("function"===typeof(m=g.payload)){h=m.call(v,h,d);break e}h=m;break e;case 3:m.flags=-65537&m.flags|128;case 0:if(null===(d="function"===typeof(m=g.payload)?m.call(v,h,d):m)||void 0===d)break e;h=f({},h,d);break e;case 2:ti=!0}}null!==(d=o.callback)&&(e.flags|=64,p&&(e.flags|=8192),null===(p=a.callbacks)?a.callbacks=[d]:p.push(d))}else p={lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===u?(c=u=p,l=h):u=u.next=p,s|=d;if(null===(o=o.next)){if(null===(o=a.shared.pending))break;o=(p=o).next,p.next=null,a.lastBaseUpdate=p,a.shared.pending=null}}null===u&&(l=h),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=u,null===i&&(a.shared.lanes=0),dc|=s,e.lanes=s,e.memoizedState=h}}function hi(e,t){if("function"!==typeof e)throw Error(s(191,e));e.call(t)}function fi(e,t){var n=e.callbacks;if(null!==n)for(e.callbacks=null,e=0;e<n.length;e++)hi(n[e],t)}var di=j(null),pi=j(0);function mi(e,t){z(pi,e=hc),z(di,t),hc=e|t.baseLanes}function gi(){z(pi,hc),z(di,di.current)}function vi(){hc=pi.current,V(di),V(pi)}var yi=0,bi=null,wi=null,Ti=null,Si=!1,Ei=!1,ki=!1,_i=0,xi=0,Ci=null,Ii=0;function Ai(){throw Error(s(321))}function Ni(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Xn(e[n],t[n]))return!1;return!0}function Ri(e,t,n,r,a,i){return yi=i,bi=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,D.H=null===e||null===e.memoizedState?Gs:Ks,ki=!1,i=n(r,a),ki=!1,Ei&&(i=Pi(t,n,r,a)),Oi(e),i}function Oi(e){D.H=Ws;var t=null!==wi&&null!==wi.next;if(yi=0,Ti=wi=bi=null,Si=!1,xi=0,Ci=null,t)throw Error(s(300));null===e||Co||null!==(e=e.dependencies)&&ka(e)&&(Co=!0)}function Pi(e,t,n,r){bi=e;var a=0;do{if(Ei&&(Ci=null),xi=0,Ei=!1,25<=a)throw Error(s(301));if(a+=1,Ti=wi=null,null!=e.updateQueue){var i=e.updateQueue;i.lastEffect=null,i.events=null,i.stores=null,null!=i.memoCache&&(i.memoCache.index=0)}D.H=qs,i=t(n,r)}while(Ei);return i}function Di(){var e=D.H,t=e.useState()[0];return t="function"===typeof t.then?Vi(t):t,e=e.useState()[0],(null!==wi?wi.memoizedState:null)!==e&&(bi.flags|=1024),t}function Li(){var e=0!==_i;return _i=0,e}function Mi(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function Fi(e){if(Si){for(e=e.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next}Si=!1}yi=0,Ti=wi=bi=null,Ei=!1,xi=_i=0,Ci=null}function Ui(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Ti?bi.memoizedState=Ti=e:Ti=Ti.next=e,Ti}function ji(){if(null===wi){var e=bi.alternate;e=null!==e?e.memoizedState:null}else e=wi.next;var t=null===Ti?bi.memoizedState:Ti.next;if(null!==t)Ti=t,wi=e;else{if(null===e){if(null===bi.alternate)throw Error(s(467));throw Error(s(310))}e={memoizedState:(wi=e).memoizedState,baseState:wi.baseState,baseQueue:wi.baseQueue,queue:wi.queue,next:null},null===Ti?bi.memoizedState=Ti=e:Ti=Ti.next=e}return Ti}function Vi(e){var t=xi;return xi+=1,null===Ci&&(Ci=[]),e=Qa(Ci,e,t),t=bi,null===(null===Ti?t.memoizedState:Ti.next)&&(t=t.alternate,D.H=null===t||null===t.memoizedState?Gs:Ks),e}function zi(e){if(null!==e&&"object"===typeof e){if("function"===typeof e.then)return Vi(e);if(e.$$typeof===T)return xa(e)}throw Error(s(438,String(e)))}function Bi(e){var t=null,n=bi.updateQueue;if(null!==n&&(t=n.memoCache),null==t){var r=bi.alternate;null!==r&&(null!==(r=r.updateQueue)&&(null!=(r=r.memoCache)&&(t={data:r.data.map(function(e){return e.slice()}),index:0})))}if(null==t&&(t={data:[],index:0}),null===n&&(n={lastEffect:null,events:null,stores:null,memoCache:null},bi.updateQueue=n),n.memoCache=t,void 0===(n=t.data[t.index]))for(n=t.data[t.index]=Array(e),r=0;r<e;r++)n[r]=I;return t.index++,n}function Hi(e,t){return"function"===typeof t?t(e):t}function Wi(e){return Gi(ji(),wi,e)}function Gi(e,t,n){var r=e.queue;if(null===r)throw Error(s(311));r.lastRenderedReducer=n;var a=e.baseQueue,i=r.pending;if(null!==i){if(null!==a){var o=a.next;a.next=i.next,i.next=o}t.baseQueue=a=i,r.pending=null}if(i=e.baseState,null===a)e.memoizedState=i;else{var l=o=null,c=null,u=t=a.next,h=!1;do{var f=-536870913&u.lane;if(f!==u.lane?(ic&f)===f:(yi&f)===f){var d=u.revertLane;if(0===d)null!==c&&(c=c.next={lane:0,revertLane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),f===Fa&&(h=!0);else{if((yi&d)===d){u=u.next,d===Fa&&(h=!0);continue}f={lane:0,revertLane:u.revertLane,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=f,o=i):c=c.next=f,bi.lanes|=d,dc|=d}f=u.action,ki&&n(i,f),i=u.hasEagerState?u.eagerState:n(i,f)}else d={lane:f,revertLane:u.revertLane,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=d,o=i):c=c.next=d,bi.lanes|=f,dc|=f;u=u.next}while(null!==u&&u!==t);if(null===c?o=i:c.next=l,!Xn(i,e.memoizedState)&&(Co=!0,h&&null!==(n=Ua)))throw n;e.memoizedState=i,e.baseState=o,e.baseQueue=c,r.lastRenderedState=i}return null===a&&(r.lanes=0),[e.memoizedState,r.dispatch]}function Ki(e){var t=ji(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,i=t.memoizedState;if(null!==a){n.pending=null;var o=a=a.next;do{i=e(i,o.action),o=o.next}while(o!==a);Xn(i,t.memoizedState)||(Co=!0),t.memoizedState=i,null===t.baseQueue&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function qi(e,t,n){var r=bi,a=ji(),i=ia;if(i){if(void 0===n)throw Error(s(407));n=n()}else n=t();var o=!Xn((wi||a).memoizedState,n);if(o&&(a.memoizedState=n,Co=!0),a=a.queue,gs(2048,8,Yi.bind(null,r,a,e),[e]),a.getSnapshot!==t||o||null!==Ti&&1&Ti.memoizedState.tag){if(r.flags|=2048,ds(9,{destroy:void 0,resource:void 0},Xi.bind(null,r,a,n,t),null),null===rc)throw Error(s(349));i||0!==(124&yi)||$i(r,t,n)}return n}function $i(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=bi.updateQueue)?(t={lastEffect:null,events:null,stores:null,memoCache:null},bi.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Xi(e,t,n,r){t.value=n,t.getSnapshot=r,Qi(t)&&Ji(e)}function Yi(e,t,n){return n(function(){Qi(t)&&Ji(e)})}function Qi(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Xn(e,n)}catch(r){return!0}}function Ji(e){var t=Rr(e,2);null!==t&&Mc(t,e,2)}function Zi(e){var t=Ui();if("function"===typeof e){var n=e;if(e=n(),ki){fe(!0);try{n()}finally{fe(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Hi,lastRenderedState:e},t}function es(e,t,n,r){return e.baseState=n,Gi(e,wi,"function"===typeof r?r:Hi)}function ts(e,t,n,r,a){if(zs(e))throw Error(s(485));if(null!==(e=t.action)){var i={payload:a,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(e){i.listeners.push(e)}};null!==D.T?n(!0):i.isTransition=!1,r(i),null===(n=t.pending)?(i.next=t.pending=i,ns(t,i)):(i.next=n.next,t.pending=n.next=i)}}function ns(e,t){var n=t.action,r=t.payload,a=e.state;if(t.isTransition){var i=D.T,s={};D.T=s;try{var o=n(a,r),l=D.S;null!==l&&l(s,o),rs(e,t,o)}catch(c){is(e,t,c)}finally{D.T=i}}else try{rs(e,t,i=n(a,r))}catch(u){is(e,t,u)}}function rs(e,t,n){null!==n&&"object"===typeof n&&"function"===typeof n.then?n.then(function(n){as(e,t,n)},function(n){return is(e,t,n)}):as(e,t,n)}function as(e,t,n){t.status="fulfilled",t.value=n,ss(t),e.state=n,null!==(t=e.pending)&&((n=t.next)===t?e.pending=null:(n=n.next,t.next=n,ns(e,n)))}function is(e,t,n){var r=e.pending;if(e.pending=null,null!==r){r=r.next;do{t.status="rejected",t.reason=n,ss(t),t=t.next}while(t!==r)}e.action=null}function ss(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function os(e,t){return t}function ls(e,t){if(ia){var n=rc.formState;if(null!==n){e:{var r=bi;if(ia){if(aa){t:{for(var a=aa,i=oa;8!==a.nodeType;){if(!i){a=null;break t}if(null===(a=vh(a.nextSibling))){a=null;break t}}a="F!"===(i=a.data)||"F"===i?a:null}if(a){aa=vh(a.nextSibling),r="F!"===a.data;break e}}ca(r)}r=!1}r&&(t=n[0])}}return(n=Ui()).memoizedState=n.baseState=t,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:os,lastRenderedState:t},n.queue=r,n=Us.bind(null,bi,r),r.dispatch=n,r=Zi(!1),i=Vs.bind(null,bi,!1,r.queue),a={state:t,dispatch:null,action:e,pending:null},(r=Ui()).queue=a,n=ts.bind(null,bi,a,i,n),a.dispatch=n,r.memoizedState=e,[t,n,!1]}function cs(e){return us(ji(),wi,e)}function us(e,t,n){if(t=Gi(e,t,os)[0],e=Wi(Hi)[0],"object"===typeof t&&null!==t&&"function"===typeof t.then)try{var r=Vi(t)}catch(s){if(s===Ga)throw qa;throw s}else r=t;var a=(t=ji()).queue,i=a.dispatch;return n!==t.memoizedState&&(bi.flags|=2048,ds(9,{destroy:void 0,resource:void 0},hs.bind(null,a,n),null)),[r,i,e]}function hs(e,t){e.action=t}function fs(e){var t=ji(),n=wi;if(null!==n)return us(t,n,e);ji(),t=t.memoizedState;var r=(n=ji()).queue.dispatch;return n.memoizedState=e,[t,r,!1]}function ds(e,t,n,r){return e={tag:e,create:n,deps:r,inst:t,next:null},null===(t=bi.updateQueue)&&(t={lastEffect:null,events:null,stores:null,memoCache:null},bi.updateQueue=t),null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function ps(){return ji().memoizedState}function ms(e,t,n,r){var a=Ui();r=void 0===r?null:r,bi.flags|=e,a.memoizedState=ds(1|t,{destroy:void 0,resource:void 0},n,r)}function gs(e,t,n,r){var a=ji();r=void 0===r?null:r;var i=a.memoizedState.inst;null!==wi&&null!==r&&Ni(r,wi.memoizedState.deps)?a.memoizedState=ds(t,i,n,r):(bi.flags|=e,a.memoizedState=ds(1|t,i,n,r))}function vs(e,t){ms(8390656,8,e,t)}function ys(e,t){gs(2048,8,e,t)}function bs(e,t){return gs(4,2,e,t)}function ws(e,t){return gs(4,4,e,t)}function Ts(e,t){if("function"===typeof t){e=e();var n=t(e);return function(){"function"===typeof n?n():t(null)}}if(null!==t&&void 0!==t)return e=e(),t.current=e,function(){t.current=null}}function Ss(e,t,n){n=null!==n&&void 0!==n?n.concat([e]):null,gs(4,4,Ts.bind(null,t,e),n)}function Es(){}function ks(e,t){var n=ji();t=void 0===t?null:t;var r=n.memoizedState;return null!==t&&Ni(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function _s(e,t){var n=ji();t=void 0===t?null:t;var r=n.memoizedState;if(null!==t&&Ni(t,r[1]))return r[0];if(r=e(),ki){fe(!0);try{e()}finally{fe(!1)}}return n.memoizedState=[r,t],r}function xs(e,t,n){return void 0===n||0!==(1073741824&yi)?e.memoizedState=t:(e.memoizedState=n,e=Lc(),bi.lanes|=e,dc|=e,n)}function Cs(e,t,n,r){return Xn(n,t)?n:null!==di.current?(e=xs(e,n,r),Xn(e,t)||(Co=!0),e):0===(42&yi)?(Co=!0,e.memoizedState=n):(e=Lc(),bi.lanes|=e,dc|=e,t)}function Is(e,t,n,r,a){var i=L.p;L.p=0!==i&&8>i?i:8;var s=D.T,o={};D.T=o,Vs(e,!1,t,n);try{var l=a(),c=D.S;if(null!==c&&c(o,l),null!==l&&"object"===typeof l&&"function"===typeof l.then)js(e,t,function(e,t){var n=[],r={status:"pending",value:null,reason:null,then:function(e){n.push(e)}};return e.then(function(){r.status="fulfilled",r.value=t;for(var e=0;e<n.length;e++)(0,n[e])(t)},function(e){for(r.status="rejected",r.reason=e,e=0;e<n.length;e++)(0,n[e])(void 0)}),r}(l,r),Dc());else js(e,t,r,Dc())}catch(u){js(e,t,{then:function(){},status:"rejected",reason:u},Dc())}finally{L.p=i,D.T=s}}function As(){}function Ns(e,t,n,r){if(5!==e.tag)throw Error(s(476));var a=Rs(e).queue;Is(e,a,t,M,null===n?As:function(){return Os(e),n(r)})}function Rs(e){var t=e.memoizedState;if(null!==t)return t;var n={};return(t={memoizedState:M,baseState:M,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Hi,lastRenderedState:M},next:null}).next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Hi,lastRenderedState:n},next:null},e.memoizedState=t,null!==(e=e.alternate)&&(e.memoizedState=t),t}function Os(e){js(e,Rs(e).next.queue,{},Dc())}function Ps(){return xa($h)}function Ds(){return ji().memoizedState}function Ls(){return ji().memoizedState}function Ms(e){for(var t=e.return;null!==t;){switch(t.tag){case 24:case 3:var n=Dc(),r=ii(t,e=ai(n),n);return null!==r&&(Mc(r,t,n),si(r,t,n)),t={cache:Pa()},void(e.payload=t)}t=t.return}}function Fs(e,t,n){var r=Dc();n={lane:r,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null},zs(e)?Bs(t,n):null!==(n=Nr(e,t,n,r))&&(Mc(n,e,r),Hs(n,t,r))}function Us(e,t,n){js(e,t,n,Dc())}function js(e,t,n,r){var a={lane:r,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null};if(zs(e))Bs(t,a);else{var i=e.alternate;if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var s=t.lastRenderedState,o=i(s,n);if(a.hasEagerState=!0,a.eagerState=o,Xn(o,s))return Ar(e,t,a,0),null===rc&&Ir(),!1}catch(l){}if(null!==(n=Nr(e,t,a,r)))return Mc(n,e,r),Hs(n,t,r),!0}return!1}function Vs(e,t,n,r){if(r={lane:2,revertLane:Au(),action:r,hasEagerState:!1,eagerState:null,next:null},zs(e)){if(t)throw Error(s(479))}else null!==(t=Nr(e,n,r,2))&&Mc(t,e,2)}function zs(e){var t=e.alternate;return e===bi||null!==t&&t===bi}function Bs(e,t){Ei=Si=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Hs(e,t,n){if(0!==(4194048&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,Ce(e,n)}}var Ws={readContext:xa,use:zi,useCallback:Ai,useContext:Ai,useEffect:Ai,useImperativeHandle:Ai,useLayoutEffect:Ai,useInsertionEffect:Ai,useMemo:Ai,useReducer:Ai,useRef:Ai,useState:Ai,useDebugValue:Ai,useDeferredValue:Ai,useTransition:Ai,useSyncExternalStore:Ai,useId:Ai,useHostTransitionStatus:Ai,useFormState:Ai,useActionState:Ai,useOptimistic:Ai,useMemoCache:Ai,useCacheRefresh:Ai},Gs={readContext:xa,use:zi,useCallback:function(e,t){return Ui().memoizedState=[e,void 0===t?null:t],e},useContext:xa,useEffect:vs,useImperativeHandle:function(e,t,n){n=null!==n&&void 0!==n?n.concat([e]):null,ms(4194308,4,Ts.bind(null,t,e),n)},useLayoutEffect:function(e,t){return ms(4194308,4,e,t)},useInsertionEffect:function(e,t){ms(4,2,e,t)},useMemo:function(e,t){var n=Ui();t=void 0===t?null:t;var r=e();if(ki){fe(!0);try{e()}finally{fe(!1)}}return n.memoizedState=[r,t],r},useReducer:function(e,t,n){var r=Ui();if(void 0!==n){var a=n(t);if(ki){fe(!0);try{n(t)}finally{fe(!1)}}}else a=t;return r.memoizedState=r.baseState=a,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:a},r.queue=e,e=e.dispatch=Fs.bind(null,bi,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},Ui().memoizedState=e},useState:function(e){var t=(e=Zi(e)).queue,n=Us.bind(null,bi,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:Es,useDeferredValue:function(e,t){return xs(Ui(),e,t)},useTransition:function(){var e=Zi(!1);return e=Is.bind(null,bi,e.queue,!0,!1),Ui().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var r=bi,a=Ui();if(ia){if(void 0===n)throw Error(s(407));n=n()}else{if(n=t(),null===rc)throw Error(s(349));0!==(124&ic)||$i(r,t,n)}a.memoizedState=n;var i={value:n,getSnapshot:t};return a.queue=i,vs(Yi.bind(null,r,i,e),[e]),r.flags|=2048,ds(9,{destroy:void 0,resource:void 0},Xi.bind(null,r,i,n,t),null),n},useId:function(){var e=Ui(),t=rc.identifierPrefix;if(ia){var n=Jr;t="\xab"+t+"R"+(n=(Qr&~(1<<32-de(Qr)-1)).toString(32)+n),0<(n=_i++)&&(t+="H"+n.toString(32)),t+="\xbb"}else t="\xab"+t+"r"+(n=Ii++).toString(32)+"\xbb";return e.memoizedState=t},useHostTransitionStatus:Ps,useFormState:ls,useActionState:ls,useOptimistic:function(e){var t=Ui();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=Vs.bind(null,bi,!0,n),n.dispatch=t,[e,t]},useMemoCache:Bi,useCacheRefresh:function(){return Ui().memoizedState=Ms.bind(null,bi)}},Ks={readContext:xa,use:zi,useCallback:ks,useContext:xa,useEffect:ys,useImperativeHandle:Ss,useInsertionEffect:bs,useLayoutEffect:ws,useMemo:_s,useReducer:Wi,useRef:ps,useState:function(){return Wi(Hi)},useDebugValue:Es,useDeferredValue:function(e,t){return Cs(ji(),wi.memoizedState,e,t)},useTransition:function(){var e=Wi(Hi)[0],t=ji().memoizedState;return["boolean"===typeof e?e:Vi(e),t]},useSyncExternalStore:qi,useId:Ds,useHostTransitionStatus:Ps,useFormState:cs,useActionState:cs,useOptimistic:function(e,t){return es(ji(),0,e,t)},useMemoCache:Bi,useCacheRefresh:Ls},qs={readContext:xa,use:zi,useCallback:ks,useContext:xa,useEffect:ys,useImperativeHandle:Ss,useInsertionEffect:bs,useLayoutEffect:ws,useMemo:_s,useReducer:Ki,useRef:ps,useState:function(){return Ki(Hi)},useDebugValue:Es,useDeferredValue:function(e,t){var n=ji();return null===wi?xs(n,e,t):Cs(n,wi.memoizedState,e,t)},useTransition:function(){var e=Ki(Hi)[0],t=ji().memoizedState;return["boolean"===typeof e?e:Vi(e),t]},useSyncExternalStore:qi,useId:Ds,useHostTransitionStatus:Ps,useFormState:fs,useActionState:fs,useOptimistic:function(e,t){var n=ji();return null!==wi?es(n,0,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:Bi,useCacheRefresh:Ls},$s=null,Xs=0;function Ys(e){var t=Xs;return Xs+=1,null===$s&&($s=[]),Qa($s,e,t)}function Qs(e,t){t=t.props.ref,e.ref=void 0!==t?t:null}function Js(e,t){if(t.$$typeof===d)throw Error(s(525));throw e=Object.prototype.toString.call(t),Error(s(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Zs(e){return(0,e._init)(e._payload)}function eo(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e){for(var t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function a(e,t){return(e=Ur(e,t)).index=0,e.sibling=null,e}function i(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=67108866,n):r:(t.flags|=67108866,n):(t.flags|=1048576,n)}function o(t){return e&&null===t.alternate&&(t.flags|=67108866),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Br(n,e.mode,r)).return=e,t):((t=a(t,n)).return=e,t)}function c(e,t,n,r){var i=n.type;return i===g?h(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===i||"object"===typeof i&&null!==i&&i.$$typeof===x&&Zs(i)===t.type)?(Qs(t=a(t,n.props),n),t.return=e,t):(Qs(t=Vr(n.type,n.key,n.props,null,e.mode,r),n),t.return=e,t)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Hr(n,e.mode,r)).return=e,t):((t=a(t,n.children||[])).return=e,t)}function h(e,t,n,r,i){return null===t||7!==t.tag?((t=zr(n,e.mode,r,i)).return=e,t):((t=a(t,n)).return=e,t)}function f(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t||"bigint"===typeof t)return(t=Br(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case p:return Qs(n=Vr(t.type,t.key,t.props,null,e.mode,n),t),n.return=e,n;case m:return(t=Hr(t,e.mode,n)).return=e,t;case x:return f(e,t=(0,t._init)(t._payload),n)}if(P(t)||N(t))return(t=zr(t,e.mode,n,null)).return=e,t;if("function"===typeof t.then)return f(e,Ys(t),n);if(t.$$typeof===T)return f(e,Ca(e,t),n);Js(e,t)}return null}function d(e,t,n,r){var a=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n||"bigint"===typeof n)return null!==a?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case p:return n.key===a?c(e,t,n,r):null;case m:return n.key===a?u(e,t,n,r):null;case x:return d(e,t,n=(a=n._init)(n._payload),r)}if(P(n)||N(n))return null!==a?null:h(e,t,n,r,null);if("function"===typeof n.then)return d(e,t,Ys(n),r);if(n.$$typeof===T)return d(e,t,Ca(e,n),r);Js(e,n)}return null}function v(e,t,n,r,a){if("string"===typeof r&&""!==r||"number"===typeof r||"bigint"===typeof r)return l(t,e=e.get(n)||null,""+r,a);if("object"===typeof r&&null!==r){switch(r.$$typeof){case p:return c(t,e=e.get(null===r.key?n:r.key)||null,r,a);case m:return u(t,e=e.get(null===r.key?n:r.key)||null,r,a);case x:return v(e,t,n,r=(0,r._init)(r._payload),a)}if(P(r)||N(r))return h(t,e=e.get(n)||null,r,a,null);if("function"===typeof r.then)return v(e,t,n,Ys(r),a);if(r.$$typeof===T)return v(e,t,n,Ca(t,r),a);Js(t,r)}return null}function y(l,c,u,h){if("object"===typeof u&&null!==u&&u.type===g&&null===u.key&&(u=u.props.children),"object"===typeof u&&null!==u){switch(u.$$typeof){case p:e:{for(var b=u.key;null!==c;){if(c.key===b){if((b=u.type)===g){if(7===c.tag){n(l,c.sibling),(h=a(c,u.props.children)).return=l,l=h;break e}}else if(c.elementType===b||"object"===typeof b&&null!==b&&b.$$typeof===x&&Zs(b)===c.type){n(l,c.sibling),Qs(h=a(c,u.props),u),h.return=l,l=h;break e}n(l,c);break}t(l,c),c=c.sibling}u.type===g?((h=zr(u.props.children,l.mode,h,u.key)).return=l,l=h):(Qs(h=Vr(u.type,u.key,u.props,null,l.mode,h),u),h.return=l,l=h)}return o(l);case m:e:{for(b=u.key;null!==c;){if(c.key===b){if(4===c.tag&&c.stateNode.containerInfo===u.containerInfo&&c.stateNode.implementation===u.implementation){n(l,c.sibling),(h=a(c,u.children||[])).return=l,l=h;break e}n(l,c);break}t(l,c),c=c.sibling}(h=Hr(u,l.mode,h)).return=l,l=h}return o(l);case x:return y(l,c,u=(b=u._init)(u._payload),h)}if(P(u))return function(a,s,o,l){for(var c=null,u=null,h=s,p=s=0,m=null;null!==h&&p<o.length;p++){h.index>p?(m=h,h=null):m=h.sibling;var g=d(a,h,o[p],l);if(null===g){null===h&&(h=m);break}e&&h&&null===g.alternate&&t(a,h),s=i(g,s,p),null===u?c=g:u.sibling=g,u=g,h=m}if(p===o.length)return n(a,h),ia&&Zr(a,p),c;if(null===h){for(;p<o.length;p++)null!==(h=f(a,o[p],l))&&(s=i(h,s,p),null===u?c=h:u.sibling=h,u=h);return ia&&Zr(a,p),c}for(h=r(h);p<o.length;p++)null!==(m=v(h,a,p,o[p],l))&&(e&&null!==m.alternate&&h.delete(null===m.key?p:m.key),s=i(m,s,p),null===u?c=m:u.sibling=m,u=m);return e&&h.forEach(function(e){return t(a,e)}),ia&&Zr(a,p),c}(l,c,u,h);if(N(u)){if("function"!==typeof(b=N(u)))throw Error(s(150));return function(a,o,l,c){if(null==l)throw Error(s(151));for(var u=null,h=null,p=o,m=o=0,g=null,y=l.next();null!==p&&!y.done;m++,y=l.next()){p.index>m?(g=p,p=null):g=p.sibling;var b=d(a,p,y.value,c);if(null===b){null===p&&(p=g);break}e&&p&&null===b.alternate&&t(a,p),o=i(b,o,m),null===h?u=b:h.sibling=b,h=b,p=g}if(y.done)return n(a,p),ia&&Zr(a,m),u;if(null===p){for(;!y.done;m++,y=l.next())null!==(y=f(a,y.value,c))&&(o=i(y,o,m),null===h?u=y:h.sibling=y,h=y);return ia&&Zr(a,m),u}for(p=r(p);!y.done;m++,y=l.next())null!==(y=v(p,a,m,y.value,c))&&(e&&null!==y.alternate&&p.delete(null===y.key?m:y.key),o=i(y,o,m),null===h?u=y:h.sibling=y,h=y);return e&&p.forEach(function(e){return t(a,e)}),ia&&Zr(a,m),u}(l,c,u=b.call(u),h)}if("function"===typeof u.then)return y(l,c,Ys(u),h);if(u.$$typeof===T)return y(l,c,Ca(l,u),h);Js(l,u)}return"string"===typeof u&&""!==u||"number"===typeof u||"bigint"===typeof u?(u=""+u,null!==c&&6===c.tag?(n(l,c.sibling),(h=a(c,u)).return=l,l=h):(n(l,c),(h=Br(u,l.mode,h)).return=l,l=h),o(l)):n(l,c)}return function(e,t,n,r){try{Xs=0;var a=y(e,t,n,r);return $s=null,a}catch(s){if(s===Ga||s===qa)throw s;var i=Mr(29,s,null,e.mode);return i.lanes=r,i.return=e,i}}}var to=eo(!0),no=eo(!1),ro=j(null),ao=null;function io(e){var t=e.alternate;z(co,1&co.current),z(ro,e),null===ao&&(null===t||null!==di.current||null!==t.memoizedState)&&(ao=e)}function so(e){if(22===e.tag){if(z(co,co.current),z(ro,e),null===ao){var t=e.alternate;null!==t&&null!==t.memoizedState&&(ao=e)}}else oo()}function oo(){z(co,co.current),z(ro,ro.current)}function lo(e){V(ro),ao===e&&(ao=null),V(co)}var co=j(0);function uo(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||gh(n)))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}function ho(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:f({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var fo={enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Dc(),a=ai(r);a.payload=t,void 0!==n&&null!==n&&(a.callback=n),null!==(t=ii(e,a,r))&&(Mc(t,e,r),si(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Dc(),a=ai(r);a.tag=1,a.payload=t,void 0!==n&&null!==n&&(a.callback=n),null!==(t=ii(e,a,r))&&(Mc(t,e,r),si(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Dc(),r=ai(n);r.tag=2,void 0!==t&&null!==t&&(r.callback=t),null!==(t=ii(e,r,n))&&(Mc(t,e,n),si(t,e,n))}};function po(e,t,n,r,a,i,s){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,i,s):!t.prototype||!t.prototype.isPureReactComponent||(!Yn(n,r)||!Yn(a,i))}function mo(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&fo.enqueueReplaceState(t,t.state,null)}function go(e,t){var n=t;if("ref"in t)for(var r in n={},t)"ref"!==r&&(n[r]=t[r]);if(e=e.defaultProps)for(var a in n===t&&(n=f({},n)),e)void 0===n[a]&&(n[a]=e[a]);return n}var vo="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)};function yo(e){vo(e)}function bo(e){console.error(e)}function wo(e){vo(e)}function To(e,t){try{(0,e.onUncaughtError)(t.value,{componentStack:t.stack})}catch(n){setTimeout(function(){throw n})}}function So(e,t,n){try{(0,e.onCaughtError)(n.value,{componentStack:n.stack,errorBoundary:1===t.tag?t.stateNode:null})}catch(r){setTimeout(function(){throw r})}}function Eo(e,t,n){return(n=ai(n)).tag=3,n.payload={element:null},n.callback=function(){To(e,t)},n}function ko(e){return(e=ai(e)).tag=3,e}function _o(e,t,n,r){var a=n.type.getDerivedStateFromError;if("function"===typeof a){var i=r.value;e.payload=function(){return a(i)},e.callback=function(){So(t,n,r)}}var s=n.stateNode;null!==s&&"function"===typeof s.componentDidCatch&&(e.callback=function(){So(t,n,r),"function"!==typeof a&&(null===kc?kc=new Set([this]):kc.add(this));var e=r.stack;this.componentDidCatch(r.value,{componentStack:null!==e?e:""})})}var xo=Error(s(461)),Co=!1;function Io(e,t,n,r){t.child=null===e?no(t,null,n,r):to(t,e.child,n,r)}function Ao(e,t,n,r,a){n=n.render;var i=t.ref;if("ref"in r){var s={};for(var o in r)"ref"!==o&&(s[o]=r[o])}else s=r;return _a(t),r=Ri(e,t,n,s,i,a),o=Li(),null===e||Co?(ia&&o&&ta(t),t.flags|=1,Io(e,t,r,a),t.child):(Mi(e,t,a),Xo(e,t,a))}function No(e,t,n,r,a){if(null===e){var i=n.type;return"function"!==typeof i||Fr(i)||void 0!==i.defaultProps||null!==n.compare?((e=Vr(n.type,null,r,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,Ro(e,t,i,r,a))}if(i=e.child,!Yo(e,a)){var s=i.memoizedProps;if((n=null!==(n=n.compare)?n:Yn)(s,r)&&e.ref===t.ref)return Xo(e,t,a)}return t.flags|=1,(e=Ur(i,r)).ref=t.ref,e.return=t,t.child=e}function Ro(e,t,n,r,a){if(null!==e){var i=e.memoizedProps;if(Yn(i,r)&&e.ref===t.ref){if(Co=!1,t.pendingProps=r=i,!Yo(e,a))return t.lanes=e.lanes,Xo(e,t,a);0!==(131072&e.flags)&&(Co=!0)}}return Lo(e,t,n,r,a)}function Oo(e,t,n){var r=t.pendingProps,a=r.children,i=null!==e?e.memoizedState:null;if("hidden"===r.mode){if(0!==(128&t.flags)){if(r=null!==i?i.baseLanes|n:n,null!==e){for(a=t.child=e.child,i=0;null!==a;)i=i|a.lanes|a.childLanes,a=a.sibling;t.childLanes=i&~r}else t.childLanes=0,t.child=null;return Po(e,t,r,n)}if(0===(536870912&n))return t.lanes=t.childLanes=536870912,Po(e,t,null!==i?i.baseLanes|n:n,n);t.memoizedState={baseLanes:0,cachePool:null},null!==e&&Ha(0,null!==i?i.cachePool:null),null!==i?mi(t,i):gi(),so(t)}else null!==i?(Ha(0,i.cachePool),mi(t,i),oo(),t.memoizedState=null):(null!==e&&Ha(0,null),gi(),oo());return Io(e,t,a,n),t.child}function Po(e,t,n,r){var a=Ba();return a=null===a?null:{parent:Oa._currentValue,pool:a},t.memoizedState={baseLanes:n,cachePool:a},null!==e&&Ha(0,null),gi(),so(t),null!==e&&Ea(e,t,r,!0),null}function Do(e,t){var n=t.ref;if(null===n)null!==e&&null!==e.ref&&(t.flags|=4194816);else{if("function"!==typeof n&&"object"!==typeof n)throw Error(s(284));null!==e&&e.ref===n||(t.flags|=4194816)}}function Lo(e,t,n,r,a){return _a(t),n=Ri(e,t,n,r,void 0,a),r=Li(),null===e||Co?(ia&&r&&ta(t),t.flags|=1,Io(e,t,n,a),t.child):(Mi(e,t,a),Xo(e,t,a))}function Mo(e,t,n,r,a,i){return _a(t),t.updateQueue=null,n=Pi(t,r,n,a),Oi(e),r=Li(),null===e||Co?(ia&&r&&ta(t),t.flags|=1,Io(e,t,n,i),t.child):(Mi(e,t,i),Xo(e,t,i))}function Fo(e,t,n,r,a){if(_a(t),null===t.stateNode){var i=Dr,s=n.contextType;"object"===typeof s&&null!==s&&(i=xa(s)),i=new n(r,i),t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,i.updater=fo,t.stateNode=i,i._reactInternals=t,(i=t.stateNode).props=r,i.state=t.memoizedState,i.refs={},ni(t),s=n.contextType,i.context="object"===typeof s&&null!==s?xa(s):Dr,i.state=t.memoizedState,"function"===typeof(s=n.getDerivedStateFromProps)&&(ho(t,n,s,r),i.state=t.memoizedState),"function"===typeof n.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(s=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),s!==i.state&&fo.enqueueReplaceState(i,i.state,null),ui(t,r,i,a),ci(),i.state=t.memoizedState),"function"===typeof i.componentDidMount&&(t.flags|=4194308),r=!0}else if(null===e){i=t.stateNode;var o=t.memoizedProps,l=go(n,o);i.props=l;var c=i.context,u=n.contextType;s=Dr,"object"===typeof u&&null!==u&&(s=xa(u));var h=n.getDerivedStateFromProps;u="function"===typeof h||"function"===typeof i.getSnapshotBeforeUpdate,o=t.pendingProps!==o,u||"function"!==typeof i.UNSAFE_componentWillReceiveProps&&"function"!==typeof i.componentWillReceiveProps||(o||c!==s)&&mo(t,i,r,s),ti=!1;var f=t.memoizedState;i.state=f,ui(t,r,i,a),ci(),c=t.memoizedState,o||f!==c||ti?("function"===typeof h&&(ho(t,n,h,r),c=t.memoizedState),(l=ti||po(t,n,l,r,f,c,s))?(u||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||("function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount()),"function"===typeof i.componentDidMount&&(t.flags|=4194308)):("function"===typeof i.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),i.props=r,i.state=c,i.context=s,r=l):("function"===typeof i.componentDidMount&&(t.flags|=4194308),r=!1)}else{i=t.stateNode,ri(e,t),u=go(n,s=t.memoizedProps),i.props=u,h=t.pendingProps,f=i.context,c=n.contextType,l=Dr,"object"===typeof c&&null!==c&&(l=xa(c)),(c="function"===typeof(o=n.getDerivedStateFromProps)||"function"===typeof i.getSnapshotBeforeUpdate)||"function"!==typeof i.UNSAFE_componentWillReceiveProps&&"function"!==typeof i.componentWillReceiveProps||(s!==h||f!==l)&&mo(t,i,r,l),ti=!1,f=t.memoizedState,i.state=f,ui(t,r,i,a),ci();var d=t.memoizedState;s!==h||f!==d||ti||null!==e&&null!==e.dependencies&&ka(e.dependencies)?("function"===typeof o&&(ho(t,n,o,r),d=t.memoizedState),(u=ti||po(t,n,u,r,f,d,l)||null!==e&&null!==e.dependencies&&ka(e.dependencies))?(c||"function"!==typeof i.UNSAFE_componentWillUpdate&&"function"!==typeof i.componentWillUpdate||("function"===typeof i.componentWillUpdate&&i.componentWillUpdate(r,d,l),"function"===typeof i.UNSAFE_componentWillUpdate&&i.UNSAFE_componentWillUpdate(r,d,l)),"function"===typeof i.componentDidUpdate&&(t.flags|=4),"function"===typeof i.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof i.componentDidUpdate||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),"function"!==typeof i.getSnapshotBeforeUpdate||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=d),i.props=r,i.state=d,i.context=l,r=u):("function"!==typeof i.componentDidUpdate||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),"function"!==typeof i.getSnapshotBeforeUpdate||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),r=!1)}return i=r,Do(e,t),r=0!==(128&t.flags),i||r?(i=t.stateNode,n=r&&"function"!==typeof n.getDerivedStateFromError?null:i.render(),t.flags|=1,null!==e&&r?(t.child=to(t,e.child,null,a),t.child=to(t,null,n,a)):Io(e,t,n,a),t.memoizedState=i.state,e=t.child):e=Xo(e,t,a),e}function Uo(e,t,n,r){return da(),t.flags|=256,Io(e,t,n,r),t.child}var jo={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Vo(e){return{baseLanes:e,cachePool:Wa()}}function zo(e,t,n){return e=null!==e?e.childLanes&~n:0,t&&(e|=gc),e}function Bo(e,t,n){var r,a=t.pendingProps,i=!1,o=0!==(128&t.flags);if((r=o)||(r=(null===e||null!==e.memoizedState)&&0!==(2&co.current)),r&&(i=!0,t.flags&=-129),r=0!==(32&t.flags),t.flags&=-33,null===e){if(ia){if(i?io(t):oo(),ia){var l,c=aa;if(l=c){e:{for(l=c,c=oa;8!==l.nodeType;){if(!c){c=null;break e}if(null===(l=vh(l.nextSibling))){c=null;break e}}c=l}null!==c?(t.memoizedState={dehydrated:c,treeContext:null!==Yr?{id:Qr,overflow:Jr}:null,retryLane:536870912,hydrationErrors:null},(l=Mr(18,null,null,0)).stateNode=c,l.return=t,t.child=l,ra=t,aa=null,l=!0):l=!1}l||ca(t)}if(null!==(c=t.memoizedState)&&null!==(c=c.dehydrated))return gh(c)?t.lanes=32:t.lanes=536870912,null;lo(t)}return c=a.children,a=a.fallback,i?(oo(),c=Wo({mode:"hidden",children:c},i=t.mode),a=zr(a,i,n,null),c.return=t,a.return=t,c.sibling=a,t.child=c,(i=t.child).memoizedState=Vo(n),i.childLanes=zo(e,r,n),t.memoizedState=jo,a):(io(t),Ho(t,c))}if(null!==(l=e.memoizedState)&&null!==(c=l.dehydrated)){if(o)256&t.flags?(io(t),t.flags&=-257,t=Go(e,t,n)):null!==t.memoizedState?(oo(),t.child=e.child,t.flags|=128,t=null):(oo(),i=a.fallback,c=t.mode,a=Wo({mode:"visible",children:a.children},c),(i=zr(i,c,n,null)).flags|=2,a.return=t,i.return=t,a.sibling=i,t.child=a,to(t,e.child,null,n),(a=t.child).memoizedState=Vo(n),a.childLanes=zo(e,r,n),t.memoizedState=jo,t=i);else if(io(t),gh(c)){if(r=c.nextSibling&&c.nextSibling.dataset)var u=r.dgst;r=u,(a=Error(s(419))).stack="",a.digest=r,ma({value:a,source:null,stack:null}),t=Go(e,t,n)}else if(Co||Ea(e,t,n,!1),r=0!==(n&e.childLanes),Co||r){if(null!==(r=rc)&&(0!==(a=0!==((a=0!==(42&(a=n&-n))?1:Ie(a))&(r.suspendedLanes|n))?0:a)&&a!==l.retryLane))throw l.retryLane=a,Rr(e,a),Mc(r,e,a),xo;"$?"===c.data||qc(),t=Go(e,t,n)}else"$?"===c.data?(t.flags|=192,t.child=e.child,t=null):(e=l.treeContext,aa=vh(c.nextSibling),ra=t,ia=!0,sa=null,oa=!1,null!==e&&($r[Xr++]=Qr,$r[Xr++]=Jr,$r[Xr++]=Yr,Qr=e.id,Jr=e.overflow,Yr=t),(t=Ho(t,a.children)).flags|=4096);return t}return i?(oo(),i=a.fallback,c=t.mode,u=(l=e.child).sibling,(a=Ur(l,{mode:"hidden",children:a.children})).subtreeFlags=65011712&l.subtreeFlags,null!==u?i=Ur(u,i):(i=zr(i,c,n,null)).flags|=2,i.return=t,a.return=t,a.sibling=i,t.child=a,a=i,i=t.child,null===(c=e.child.memoizedState)?c=Vo(n):(null!==(l=c.cachePool)?(u=Oa._currentValue,l=l.parent!==u?{parent:u,pool:u}:l):l=Wa(),c={baseLanes:c.baseLanes|n,cachePool:l}),i.memoizedState=c,i.childLanes=zo(e,r,n),t.memoizedState=jo,a):(io(t),e=(n=e.child).sibling,(n=Ur(n,{mode:"visible",children:a.children})).return=t,n.sibling=null,null!==e&&(null===(r=t.deletions)?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n)}function Ho(e,t){return(t=Wo({mode:"visible",children:t},e.mode)).return=e,e.child=t}function Wo(e,t){return(e=Mr(22,e,null,t)).lanes=0,e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},e}function Go(e,t,n){return to(t,e.child,null,n),(e=Ho(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Ko(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Ta(e.return,t,n)}function qo(e,t,n,r,a){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=a)}function $o(e,t,n){var r=t.pendingProps,a=r.revealOrder,i=r.tail;if(Io(e,t,r.children,n),0!==(2&(r=co.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Ko(e,n,t);else if(19===e.tag)Ko(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}switch(z(co,r),a){case"forwards":for(n=t.child,a=null;null!==n;)null!==(e=n.alternate)&&null===uo(e)&&(a=n),n=n.sibling;null===(n=a)?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),qo(t,!1,a,n,i);break;case"backwards":for(n=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===uo(e)){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}qo(t,!0,n,null,i);break;case"together":qo(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Xo(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),dc|=t.lanes,0===(n&t.childLanes)){if(null===e)return null;if(Ea(e,t,n,!1),0===(n&t.childLanes))return null}if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(n=Ur(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Ur(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Yo(e,t){return 0!==(e.lanes&t)||!(null===(e=e.dependencies)||!ka(e))}function Qo(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps)Co=!0;else{if(!Yo(e,n)&&0===(128&t.flags))return Co=!1,function(e,t,n){switch(t.tag){case 3:K(t,t.stateNode.containerInfo),ba(0,Oa,e.memoizedState.cache),da();break;case 27:case 5:$(t);break;case 4:K(t,t.stateNode.containerInfo);break;case 10:ba(0,t.type,t.memoizedProps.value);break;case 13:var r=t.memoizedState;if(null!==r)return null!==r.dehydrated?(io(t),t.flags|=128,null):0!==(n&t.child.childLanes)?Bo(e,t,n):(io(t),null!==(e=Xo(e,t,n))?e.sibling:null);io(t);break;case 19:var a=0!==(128&e.flags);if((r=0!==(n&t.childLanes))||(Ea(e,t,n,!1),r=0!==(n&t.childLanes)),a){if(r)return $o(e,t,n);t.flags|=128}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),z(co,co.current),r)break;return null;case 22:case 23:return t.lanes=0,Oo(e,t,n);case 24:ba(0,Oa,e.memoizedState.cache)}return Xo(e,t,n)}(e,t,n);Co=0!==(131072&e.flags)}else Co=!1,ia&&0!==(1048576&t.flags)&&ea(t,qr,t.index);switch(t.lanes=0,t.tag){case 16:e:{e=t.pendingProps;var r=t.elementType,a=r._init;if(r=a(r._payload),t.type=r,"function"!==typeof r){if(void 0!==r&&null!==r){if((a=r.$$typeof)===S){t.tag=11,t=Ao(null,t,r,e,n);break e}if(a===_){t.tag=14,t=No(null,t,r,e,n);break e}}throw t=O(r)||r,Error(s(306,t,""))}Fr(r)?(e=go(r,e),t.tag=1,t=Fo(null,t,r,e,n)):(t.tag=0,t=Lo(null,t,r,e,n))}return t;case 0:return Lo(e,t,t.type,t.pendingProps,n);case 1:return Fo(e,t,r=t.type,a=go(r,t.pendingProps),n);case 3:e:{if(K(t,t.stateNode.containerInfo),null===e)throw Error(s(387));r=t.pendingProps;var i=t.memoizedState;a=i.element,ri(e,t),ui(t,r,null,n);var o=t.memoizedState;if(r=o.cache,ba(0,Oa,r),r!==i.cache&&Sa(t,[Oa],n,!0),ci(),r=o.element,i.isDehydrated){if(i={element:r,isDehydrated:!1,cache:o.cache},t.updateQueue.baseState=i,t.memoizedState=i,256&t.flags){t=Uo(e,t,r,n);break e}if(r!==a){ma(a=kr(Error(s(424)),t)),t=Uo(e,t,r,n);break e}if(9===(e=t.stateNode.containerInfo).nodeType)e=e.body;else e="HTML"===e.nodeName?e.ownerDocument.body:e;for(aa=vh(e.firstChild),ra=t,ia=!0,sa=null,oa=!0,n=no(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(da(),r===a){t=Xo(e,t,n);break e}Io(e,t,r,n)}t=t.child}return t;case 26:return Do(e,t),null===e?(n=Ih(t.type,null,t.pendingProps,null))?t.memoizedState=n:ia||(n=t.type,e=t.pendingProps,(r=rh(W.current).createElement(n))[Oe]=t,r[Pe]=e,eh(r,n,e),Ge(r),t.stateNode=r):t.memoizedState=Ih(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return $(t),null===e&&ia&&(r=t.stateNode=wh(t.type,t.pendingProps,W.current),ra=t,oa=!0,a=aa,dh(t.type)?(yh=a,aa=vh(r.firstChild)):aa=a),Io(e,t,t.pendingProps.children,n),Do(e,t),null===e&&(t.flags|=4194304),t.child;case 5:return null===e&&ia&&((a=r=aa)&&(null!==(r=function(e,t,n,r){for(;1===e.nodeType;){var a=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!r&&("INPUT"!==e.nodeName||"hidden"!==e.type))break}else if(r){if(!e[je])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if("stylesheet"===(i=e.getAttribute("rel"))&&e.hasAttribute("data-precedence"))break;if(i!==a.rel||e.getAttribute("href")!==(null==a.href||""===a.href?null:a.href)||e.getAttribute("crossorigin")!==(null==a.crossOrigin?null:a.crossOrigin)||e.getAttribute("title")!==(null==a.title?null:a.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(((i=e.getAttribute("src"))!==(null==a.src?null:a.src)||e.getAttribute("type")!==(null==a.type?null:a.type)||e.getAttribute("crossorigin")!==(null==a.crossOrigin?null:a.crossOrigin))&&i&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else{if("input"!==t||"hidden"!==e.type)return e;var i=null==a.name?null:""+a.name;if("hidden"===a.type&&e.getAttribute("name")===i)return e}if(null===(e=vh(e.nextSibling)))break}return null}(r,t.type,t.pendingProps,oa))?(t.stateNode=r,ra=t,aa=vh(r.firstChild),oa=!1,a=!0):a=!1),a||ca(t)),$(t),a=t.type,i=t.pendingProps,o=null!==e?e.memoizedProps:null,r=i.children,sh(a,i)?r=null:null!==o&&sh(a,o)&&(t.flags|=32),null!==t.memoizedState&&(a=Ri(e,t,Di,null,null,n),$h._currentValue=a),Do(e,t),Io(e,t,r,n),t.child;case 6:return null===e&&ia&&((e=n=aa)&&(null!==(n=function(e,t,n){if(""===t)return null;for(;3!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!n)return null;if(null===(e=vh(e.nextSibling)))return null}return e}(n,t.pendingProps,oa))?(t.stateNode=n,ra=t,aa=null,e=!0):e=!1),e||ca(t)),null;case 13:return Bo(e,t,n);case 4:return K(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=to(t,null,r,n):Io(e,t,r,n),t.child;case 11:return Ao(e,t,t.type,t.pendingProps,n);case 7:return Io(e,t,t.pendingProps,n),t.child;case 8:case 12:return Io(e,t,t.pendingProps.children,n),t.child;case 10:return r=t.pendingProps,ba(0,t.type,r.value),Io(e,t,r.children,n),t.child;case 9:return a=t.type._context,r=t.pendingProps.children,_a(t),r=r(a=xa(a)),t.flags|=1,Io(e,t,r,n),t.child;case 14:return No(e,t,t.type,t.pendingProps,n);case 15:return Ro(e,t,t.type,t.pendingProps,n);case 19:return $o(e,t,n);case 31:return r=t.pendingProps,n=t.mode,r={mode:r.mode,children:r.children},null===e?((n=Wo(r,n)).ref=t.ref,t.child=n,n.return=t,t=n):((n=Ur(e.child,r)).ref=t.ref,t.child=n,n.return=t,t=n),t;case 22:return Oo(e,t,n);case 24:return _a(t),r=xa(Oa),null===e?(null===(a=Ba())&&(a=rc,i=Pa(),a.pooledCache=i,i.refCount++,null!==i&&(a.pooledCacheLanes|=n),a=i),t.memoizedState={parent:r,cache:a},ni(t),ba(0,Oa,a)):(0!==(e.lanes&n)&&(ri(e,t),ui(t,null,null,n),ci()),a=e.memoizedState,i=t.memoizedState,a.parent!==r?(a={parent:r,cache:r},t.memoizedState=a,0===t.lanes&&(t.memoizedState=t.updateQueue.baseState=a),ba(0,Oa,r)):(r=i.cache,ba(0,Oa,r),r!==a.cache&&Sa(t,[Oa],n,!0))),Io(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(s(156,t.tag))}function Jo(e){e.flags|=4}function Zo(e,t){if("stylesheet"!==t.type||0!==(4&t.state.loading))e.flags&=-16777217;else if(e.flags|=16777216,!zh(t)){if(null!==(t=ro.current)&&((4194048&ic)===ic?null!==ao:(62914560&ic)!==ic&&0===(536870912&ic)||t!==ao))throw Ja=$a,Ka;e.flags|=8192}}function el(e,t){null!==t&&(e.flags|=4),16384&e.flags&&(t=22!==e.tag?Ee():536870912,e.lanes|=t,vc|=t)}function tl(e,t){if(!ia)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function nl(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=65011712&a.subtreeFlags,r|=65011712&a.flags,a.return=e,a=a.sibling;else for(a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function rl(e,t,n){var r=t.pendingProps;switch(na(t),t.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return nl(t),null;case 3:return n=t.stateNode,r=null,null!==e&&(r=e.memoizedState.cache),t.memoizedState.cache!==r&&(t.flags|=2048),wa(Oa),q(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(fa(t)?Jo(t):null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,pa())),nl(t),null;case 26:return n=t.memoizedState,null===e?(Jo(t),null!==n?(nl(t),Zo(t,n)):(nl(t),t.flags&=-16777217)):n?n!==e.memoizedState?(Jo(t),nl(t),Zo(t,n)):(nl(t),t.flags&=-16777217):(e.memoizedProps!==r&&Jo(t),nl(t),t.flags&=-16777217),null;case 27:X(t),n=W.current;var a=t.type;if(null!==e&&null!=t.stateNode)e.memoizedProps!==r&&Jo(t);else{if(!r){if(null===t.stateNode)throw Error(s(166));return nl(t),null}e=B.current,fa(t)?ua(t):(e=wh(a,r,n),t.stateNode=e,Jo(t))}return nl(t),null;case 5:if(X(t),n=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==r&&Jo(t);else{if(!r){if(null===t.stateNode)throw Error(s(166));return nl(t),null}if(e=B.current,fa(t))ua(t);else{switch(a=rh(W.current),e){case 1:e=a.createElementNS("http://www.w3.org/2000/svg",n);break;case 2:e=a.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;default:switch(n){case"svg":e=a.createElementNS("http://www.w3.org/2000/svg",n);break;case"math":e=a.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;case"script":(e=a.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild);break;case"select":e="string"===typeof r.is?a.createElement("select",{is:r.is}):a.createElement("select"),r.multiple?e.multiple=!0:r.size&&(e.size=r.size);break;default:e="string"===typeof r.is?a.createElement(n,{is:r.is}):a.createElement(n)}}e[Oe]=t,e[Pe]=r;e:for(a=t.child;null!==a;){if(5===a.tag||6===a.tag)e.appendChild(a.stateNode);else if(4!==a.tag&&27!==a.tag&&null!==a.child){a.child.return=a,a=a.child;continue}if(a===t)break e;for(;null===a.sibling;){if(null===a.return||a.return===t)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}t.stateNode=e;e:switch(eh(e,n,r),n){case"button":case"input":case"select":case"textarea":e=!!r.autoFocus;break e;case"img":e=!0;break e;default:e=!1}e&&Jo(t)}}return nl(t),t.flags&=-16777217,null;case 6:if(e&&null!=t.stateNode)e.memoizedProps!==r&&Jo(t);else{if("string"!==typeof r&&null===t.stateNode)throw Error(s(166));if(e=W.current,fa(t)){if(e=t.stateNode,n=t.memoizedProps,r=null,null!==(a=ra))switch(a.tag){case 27:case 5:r=a.memoizedProps}e[Oe]=t,(e=!!(e.nodeValue===n||null!==r&&!0===r.suppressHydrationWarning||Yu(e.nodeValue,n)))||ca(t)}else(e=rh(e).createTextNode(r))[Oe]=t,t.stateNode=e}return nl(t),null;case 13:if(r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(a=fa(t),null!==r&&null!==r.dehydrated){if(null===e){if(!a)throw Error(s(318));if(!(a=null!==(a=t.memoizedState)?a.dehydrated:null))throw Error(s(317));a[Oe]=t}else da(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;nl(t),a=!1}else a=pa(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=a),a=!0;if(!a)return 256&t.flags?(lo(t),t):(lo(t),null)}if(lo(t),0!==(128&t.flags))return t.lanes=n,t;if(n=null!==r,e=null!==e&&null!==e.memoizedState,n){a=null,null!==(r=t.child).alternate&&null!==r.alternate.memoizedState&&null!==r.alternate.memoizedState.cachePool&&(a=r.alternate.memoizedState.cachePool.pool);var i=null;null!==r.memoizedState&&null!==r.memoizedState.cachePool&&(i=r.memoizedState.cachePool.pool),i!==a&&(r.flags|=2048)}return n!==e&&n&&(t.child.flags|=8192),el(t,t.updateQueue),nl(t),null;case 4:return q(),null===e&&Vu(t.stateNode.containerInfo),nl(t),null;case 10:return wa(t.type),nl(t),null;case 19:if(V(co),null===(a=t.memoizedState))return nl(t),null;if(r=0!==(128&t.flags),null===(i=a.rendering))if(r)tl(a,!1);else{if(0!==fc||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(i=uo(e))){for(t.flags|=128,tl(a,!1),e=i.updateQueue,t.updateQueue=e,el(t,e),t.subtreeFlags=0,e=n,n=t.child;null!==n;)jr(n,e),n=n.sibling;return z(co,1&co.current|2),t.child}e=e.sibling}null!==a.tail&&te()>Sc&&(t.flags|=128,r=!0,tl(a,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=uo(i))){if(t.flags|=128,r=!0,e=e.updateQueue,t.updateQueue=e,el(t,e),tl(a,!0),null===a.tail&&"hidden"===a.tailMode&&!i.alternate&&!ia)return nl(t),null}else 2*te()-a.renderingStartTime>Sc&&536870912!==n&&(t.flags|=128,r=!0,tl(a,!1),t.lanes=4194304);a.isBackwards?(i.sibling=t.child,t.child=i):(null!==(e=a.last)?e.sibling=i:t.child=i,a.last=i)}return null!==a.tail?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=te(),t.sibling=null,e=co.current,z(co,r?1&e|2:1&e),t):(nl(t),null);case 22:case 23:return lo(t),vi(),r=null!==t.memoizedState,null!==e?null!==e.memoizedState!==r&&(t.flags|=8192):r&&(t.flags|=8192),r?0!==(536870912&n)&&0===(128&t.flags)&&(nl(t),6&t.subtreeFlags&&(t.flags|=8192)):nl(t),null!==(n=t.updateQueue)&&el(t,n.retryQueue),n=null,null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),r=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(r=t.memoizedState.cachePool.pool),r!==n&&(t.flags|=2048),null!==e&&V(za),null;case 24:return n=null,null!==e&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),wa(Oa),nl(t),null;case 25:case 30:return null}throw Error(s(156,t.tag))}function al(e,t){switch(na(t),t.tag){case 1:return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return wa(Oa),q(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 26:case 27:case 5:return X(t),null;case 13:if(lo(t),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(s(340));da()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return V(co),null;case 4:return q(),null;case 10:return wa(t.type),null;case 22:case 23:return lo(t),vi(),null!==e&&V(za),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 24:return wa(Oa),null;default:return null}}function il(e,t){switch(na(t),t.tag){case 3:wa(Oa),q();break;case 26:case 27:case 5:X(t);break;case 4:q();break;case 13:lo(t);break;case 19:V(co);break;case 10:wa(t.type);break;case 22:case 23:lo(t),vi(),null!==e&&V(za);break;case 24:wa(Oa)}}function sl(e,t){try{var n=t.updateQueue,r=null!==n?n.lastEffect:null;if(null!==r){var a=r.next;n=a;do{if((n.tag&e)===e){r=void 0;var i=n.create,s=n.inst;r=i(),s.destroy=r}n=n.next}while(n!==a)}}catch(o){uu(t,t.return,o)}}function ol(e,t,n){try{var r=t.updateQueue,a=null!==r?r.lastEffect:null;if(null!==a){var i=a.next;r=i;do{if((r.tag&e)===e){var s=r.inst,o=s.destroy;if(void 0!==o){s.destroy=void 0,a=t;var l=n,c=o;try{c()}catch(u){uu(a,l,u)}}}r=r.next}while(r!==i)}}catch(u){uu(t,t.return,u)}}function ll(e){var t=e.updateQueue;if(null!==t){var n=e.stateNode;try{fi(t,n)}catch(r){uu(e,e.return,r)}}}function cl(e,t,n){n.props=go(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(r){uu(e,t,r)}}function ul(e,t){try{var n=e.ref;if(null!==n){switch(e.tag){case 26:case 27:case 5:var r=e.stateNode;break;default:r=e.stateNode}"function"===typeof n?e.refCleanup=n(r):n.current=r}}catch(a){uu(e,t,a)}}function hl(e,t){var n=e.ref,r=e.refCleanup;if(null!==n)if("function"===typeof r)try{r()}catch(a){uu(e,t,a)}finally{e.refCleanup=null,null!=(e=e.alternate)&&(e.refCleanup=null)}else if("function"===typeof n)try{n(null)}catch(i){uu(e,t,i)}else n.current=null}function fl(e){var t=e.type,n=e.memoizedProps,r=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&r.focus();break e;case"img":n.src?r.src=n.src:n.srcSet&&(r.srcset=n.srcSet)}}catch(a){uu(e,e.return,a)}}function dl(e,t,n){try{var r=e.stateNode;!function(e,t,n,r){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var a=null,i=null,o=null,l=null,c=null,u=null,h=null;for(p in n){var f=n[p];if(n.hasOwnProperty(p)&&null!=f)switch(p){case"checked":case"value":break;case"defaultValue":c=f;default:r.hasOwnProperty(p)||Ju(e,t,p,null,r,f)}}for(var d in r){var p=r[d];if(f=n[d],r.hasOwnProperty(d)&&(null!=p||null!=f))switch(d){case"type":i=p;break;case"name":a=p;break;case"checked":u=p;break;case"defaultChecked":h=p;break;case"value":o=p;break;case"defaultValue":l=p;break;case"children":case"dangerouslySetInnerHTML":if(null!=p)throw Error(s(137,t));break;default:p!==f&&Ju(e,t,d,p,r,f)}}return void gt(e,o,l,c,u,h,i,a);case"select":for(i in p=o=l=d=null,n)if(c=n[i],n.hasOwnProperty(i)&&null!=c)switch(i){case"value":break;case"multiple":p=c;default:r.hasOwnProperty(i)||Ju(e,t,i,null,r,c)}for(a in r)if(i=r[a],c=n[a],r.hasOwnProperty(a)&&(null!=i||null!=c))switch(a){case"value":d=i;break;case"defaultValue":l=i;break;case"multiple":o=i;default:i!==c&&Ju(e,t,a,i,r,c)}return t=l,n=o,r=p,void(null!=d?bt(e,!!n,d,!1):!!r!==!!n&&(null!=t?bt(e,!!n,t,!0):bt(e,!!n,n?[]:"",!1)));case"textarea":for(l in p=d=null,n)if(a=n[l],n.hasOwnProperty(l)&&null!=a&&!r.hasOwnProperty(l))switch(l){case"value":case"children":break;default:Ju(e,t,l,null,r,a)}for(o in r)if(a=r[o],i=n[o],r.hasOwnProperty(o)&&(null!=a||null!=i))switch(o){case"value":d=a;break;case"defaultValue":p=a;break;case"children":break;case"dangerouslySetInnerHTML":if(null!=a)throw Error(s(91));break;default:a!==i&&Ju(e,t,o,a,r,i)}return void wt(e,d,p);case"option":for(var m in n)if(d=n[m],n.hasOwnProperty(m)&&null!=d&&!r.hasOwnProperty(m))if("selected"===m)e.selected=!1;else Ju(e,t,m,null,r,d);for(c in r)if(d=r[c],p=n[c],r.hasOwnProperty(c)&&d!==p&&(null!=d||null!=p))if("selected"===c)e.selected=d&&"function"!==typeof d&&"symbol"!==typeof d;else Ju(e,t,c,d,r,p);return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var g in n)d=n[g],n.hasOwnProperty(g)&&null!=d&&!r.hasOwnProperty(g)&&Ju(e,t,g,null,r,d);for(u in r)if(d=r[u],p=n[u],r.hasOwnProperty(u)&&d!==p&&(null!=d||null!=p))switch(u){case"children":case"dangerouslySetInnerHTML":if(null!=d)throw Error(s(137,t));break;default:Ju(e,t,u,d,r,p)}return;default:if(xt(t)){for(var v in n)d=n[v],n.hasOwnProperty(v)&&void 0!==d&&!r.hasOwnProperty(v)&&Zu(e,t,v,void 0,r,d);for(h in r)d=r[h],p=n[h],!r.hasOwnProperty(h)||d===p||void 0===d&&void 0===p||Zu(e,t,h,d,r,p);return}}for(var y in n)d=n[y],n.hasOwnProperty(y)&&null!=d&&!r.hasOwnProperty(y)&&Ju(e,t,y,null,r,d);for(f in r)d=r[f],p=n[f],!r.hasOwnProperty(f)||d===p||null==d&&null==p||Ju(e,t,f,d,r,p)}(r,e.type,n,t),r[Pe]=t}catch(a){uu(e,e.return,a)}}function pl(e){return 5===e.tag||3===e.tag||26===e.tag||27===e.tag&&dh(e.type)||4===e.tag}function ml(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||pl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(27===e.tag&&dh(e.type))continue e;if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function gl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?(9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).insertBefore(e,t):((t=9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Qu));else if(4!==r&&(27===r&&dh(e.type)&&(n=e.stateNode,t=null),null!==(e=e.child)))for(gl(e,t,n),e=e.sibling;null!==e;)gl(e,t,n),e=e.sibling}function vl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&(27===r&&dh(e.type)&&(n=e.stateNode),null!==(e=e.child)))for(vl(e,t,n),e=e.sibling;null!==e;)vl(e,t,n),e=e.sibling}function yl(e){var t=e.stateNode,n=e.memoizedProps;try{for(var r=e.type,a=t.attributes;a.length;)t.removeAttributeNode(a[0]);eh(t,r,n),t[Oe]=e,t[Pe]=n}catch(i){uu(e,e.return,i)}}var bl=!1,wl=!1,Tl=!1,Sl="function"===typeof WeakSet?WeakSet:Set,El=null;function kl(e,t,n){var r=n.flags;switch(n.tag){case 0:case 11:case 15:Fl(e,n),4&r&&sl(5,n);break;case 1:if(Fl(e,n),4&r)if(e=n.stateNode,null===t)try{e.componentDidMount()}catch(s){uu(n,n.return,s)}else{var a=go(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(a,t,e.__reactInternalSnapshotBeforeUpdate)}catch(o){uu(n,n.return,o)}}64&r&&ll(n),512&r&&ul(n,n.return);break;case 3:if(Fl(e,n),64&r&&null!==(e=n.updateQueue)){if(t=null,null!==n.child)switch(n.child.tag){case 27:case 5:case 1:t=n.child.stateNode}try{fi(e,t)}catch(s){uu(n,n.return,s)}}break;case 27:null===t&&4&r&&yl(n);case 26:case 5:Fl(e,n),null===t&&4&r&&fl(n),512&r&&ul(n,n.return);break;case 12:Fl(e,n);break;case 13:Fl(e,n),4&r&&Nl(e,n),64&r&&(null!==(e=n.memoizedState)&&(null!==(e=e.dehydrated)&&function(e,t){var n=e.ownerDocument;if("$?"!==e.data||"complete"===n.readyState)t();else{var r=function(){t(),n.removeEventListener("DOMContentLoaded",r)};n.addEventListener("DOMContentLoaded",r),e._reactRetry=r}}(e,n=pu.bind(null,n))));break;case 22:if(!(r=null!==n.memoizedState||bl)){t=null!==t&&null!==t.memoizedState||wl,a=bl;var i=wl;bl=r,(wl=t)&&!i?jl(e,n,0!==(8772&n.subtreeFlags)):Fl(e,n),bl=a,wl=i}break;case 30:break;default:Fl(e,n)}}function _l(e){var t=e.alternate;null!==t&&(e.alternate=null,_l(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&Ve(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var xl=null,Cl=!1;function Il(e,t,n){for(n=n.child;null!==n;)Al(e,t,n),n=n.sibling}function Al(e,t,n){if(he&&"function"===typeof he.onCommitFiberUnmount)try{he.onCommitFiberUnmount(ue,n)}catch(i){}switch(n.tag){case 26:wl||hl(n,t),Il(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode).parentNode.removeChild(n);break;case 27:wl||hl(n,t);var r=xl,a=Cl;dh(n.type)&&(xl=n.stateNode,Cl=!1),Il(e,t,n),Th(n.stateNode),xl=r,Cl=a;break;case 5:wl||hl(n,t);case 6:if(r=xl,a=Cl,xl=null,Il(e,t,n),Cl=a,null!==(xl=r))if(Cl)try{(9===xl.nodeType?xl.body:"HTML"===xl.nodeName?xl.ownerDocument.body:xl).removeChild(n.stateNode)}catch(s){uu(n,t,s)}else try{xl.removeChild(n.stateNode)}catch(s){uu(n,t,s)}break;case 18:null!==xl&&(Cl?(ph(9===(e=xl).nodeType?e.body:"HTML"===e.nodeName?e.ownerDocument.body:e,n.stateNode),If(e)):ph(xl,n.stateNode));break;case 4:r=xl,a=Cl,xl=n.stateNode.containerInfo,Cl=!0,Il(e,t,n),xl=r,Cl=a;break;case 0:case 11:case 14:case 15:wl||ol(2,n,t),wl||ol(4,n,t),Il(e,t,n);break;case 1:wl||(hl(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount&&cl(n,t,r)),Il(e,t,n);break;case 21:Il(e,t,n);break;case 22:wl=(r=wl)||null!==n.memoizedState,Il(e,t,n),wl=r;break;default:Il(e,t,n)}}function Nl(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&(null!==(e=e.memoizedState)&&null!==(e=e.dehydrated))))try{If(e)}catch(n){uu(t,t.return,n)}}function Rl(e,t){var n=function(e){switch(e.tag){case 13:case 19:var t=e.stateNode;return null===t&&(t=e.stateNode=new Sl),t;case 22:return null===(t=(e=e.stateNode)._retryCache)&&(t=e._retryCache=new Sl),t;default:throw Error(s(435,e.tag))}}(e);t.forEach(function(t){var r=mu.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))})}function Ol(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var a=n[r],i=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 27:if(dh(l.type)){xl=l.stateNode,Cl=!1;break e}break;case 5:xl=l.stateNode,Cl=!1;break e;case 3:case 4:xl=l.stateNode.containerInfo,Cl=!0;break e}l=l.return}if(null===xl)throw Error(s(160));Al(i,o,a),xl=null,Cl=!1,null!==(i=a.alternate)&&(i.return=null),a.return=null}if(13878&t.subtreeFlags)for(t=t.child;null!==t;)Dl(t,e),t=t.sibling}var Pl=null;function Dl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Ol(t,e),Ll(e),4&r&&(ol(3,e,e.return),sl(3,e),ol(5,e,e.return));break;case 1:Ol(t,e),Ll(e),512&r&&(wl||null===n||hl(n,n.return)),64&r&&bl&&(null!==(e=e.updateQueue)&&(null!==(r=e.callbacks)&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=null===n?r:n.concat(r))));break;case 26:var a=Pl;if(Ol(t,e),Ll(e),512&r&&(wl||null===n||hl(n,n.return)),4&r){var i=null!==n?n.memoizedState:null;if(r=e.memoizedState,null===n)if(null===r)if(null===e.stateNode){e:{r=e.type,n=e.memoizedProps,a=a.ownerDocument||a;t:switch(r){case"title":(!(i=a.getElementsByTagName("title")[0])||i[je]||i[Oe]||"http://www.w3.org/2000/svg"===i.namespaceURI||i.hasAttribute("itemprop"))&&(i=a.createElement(r),a.head.insertBefore(i,a.querySelector("head > title"))),eh(i,r,n),i[Oe]=e,Ge(i),r=i;break e;case"link":var o=jh("link","href",a).get(r+(n.href||""));if(o)for(var l=0;l<o.length;l++)if((i=o[l]).getAttribute("href")===(null==n.href||""===n.href?null:n.href)&&i.getAttribute("rel")===(null==n.rel?null:n.rel)&&i.getAttribute("title")===(null==n.title?null:n.title)&&i.getAttribute("crossorigin")===(null==n.crossOrigin?null:n.crossOrigin)){o.splice(l,1);break t}eh(i=a.createElement(r),r,n),a.head.appendChild(i);break;case"meta":if(o=jh("meta","content",a).get(r+(n.content||"")))for(l=0;l<o.length;l++)if((i=o[l]).getAttribute("content")===(null==n.content?null:""+n.content)&&i.getAttribute("name")===(null==n.name?null:n.name)&&i.getAttribute("property")===(null==n.property?null:n.property)&&i.getAttribute("http-equiv")===(null==n.httpEquiv?null:n.httpEquiv)&&i.getAttribute("charset")===(null==n.charSet?null:n.charSet)){o.splice(l,1);break t}eh(i=a.createElement(r),r,n),a.head.appendChild(i);break;default:throw Error(s(468,r))}i[Oe]=e,Ge(i),r=i}e.stateNode=r}else Vh(a,e.type,e.stateNode);else e.stateNode=Dh(a,r,e.memoizedProps);else i!==r?(null===i?null!==n.stateNode&&(n=n.stateNode).parentNode.removeChild(n):i.count--,null===r?Vh(a,e.type,e.stateNode):Dh(a,r,e.memoizedProps)):null===r&&null!==e.stateNode&&dl(e,e.memoizedProps,n.memoizedProps)}break;case 27:Ol(t,e),Ll(e),512&r&&(wl||null===n||hl(n,n.return)),null!==n&&4&r&&dl(e,e.memoizedProps,n.memoizedProps);break;case 5:if(Ol(t,e),Ll(e),512&r&&(wl||null===n||hl(n,n.return)),32&e.flags){a=e.stateNode;try{St(a,"")}catch(p){uu(e,e.return,p)}}4&r&&null!=e.stateNode&&dl(e,a=e.memoizedProps,null!==n?n.memoizedProps:a),1024&r&&(Tl=!0);break;case 6:if(Ol(t,e),Ll(e),4&r){if(null===e.stateNode)throw Error(s(162));r=e.memoizedProps,n=e.stateNode;try{n.nodeValue=r}catch(p){uu(e,e.return,p)}}break;case 3:if(Uh=null,a=Pl,Pl=kh(t.containerInfo),Ol(t,e),Pl=a,Ll(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{If(t.containerInfo)}catch(p){uu(e,e.return,p)}Tl&&(Tl=!1,Ml(e));break;case 4:r=Pl,Pl=kh(e.stateNode.containerInfo),Ol(t,e),Ll(e),Pl=r;break;case 12:default:Ol(t,e),Ll(e);break;case 13:Ol(t,e),Ll(e),8192&e.child.flags&&null!==e.memoizedState!==(null!==n&&null!==n.memoizedState)&&(Tc=te()),4&r&&(null!==(r=e.updateQueue)&&(e.updateQueue=null,Rl(e,r)));break;case 22:a=null!==e.memoizedState;var c=null!==n&&null!==n.memoizedState,u=bl,h=wl;if(bl=u||a,wl=h||c,Ol(t,e),wl=h,bl=u,Ll(e),8192&r)e:for(t=e.stateNode,t._visibility=a?-2&t._visibility:1|t._visibility,a&&(null===n||c||bl||wl||Ul(e)),n=null,t=e;;){if(5===t.tag||26===t.tag){if(null===n){c=n=t;try{if(i=c.stateNode,a)"function"===typeof(o=i.style).setProperty?o.setProperty("display","none","important"):o.display="none";else{l=c.stateNode;var f=c.memoizedProps.style,d=void 0!==f&&null!==f&&f.hasOwnProperty("display")?f.display:null;l.style.display=null==d||"boolean"===typeof d?"":(""+d).trim()}}catch(p){uu(c,c.return,p)}}}else if(6===t.tag){if(null===n){c=t;try{c.stateNode.nodeValue=a?"":c.memoizedProps}catch(p){uu(c,c.return,p)}}}else if((22!==t.tag&&23!==t.tag||null===t.memoizedState||t===e)&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;null===t.sibling;){if(null===t.return||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}4&r&&(null!==(r=e.updateQueue)&&(null!==(n=r.retryQueue)&&(r.retryQueue=null,Rl(e,n))));break;case 19:Ol(t,e),Ll(e),4&r&&(null!==(r=e.updateQueue)&&(e.updateQueue=null,Rl(e,r)));case 30:case 21:}}function Ll(e){var t=e.flags;if(2&t){try{for(var n,r=e.return;null!==r;){if(pl(r)){n=r;break}r=r.return}if(null==n)throw Error(s(160));switch(n.tag){case 27:var a=n.stateNode;vl(e,ml(e),a);break;case 5:var i=n.stateNode;32&n.flags&&(St(i,""),n.flags&=-33),vl(e,ml(e),i);break;case 3:case 4:var o=n.stateNode.containerInfo;gl(e,ml(e),o);break;default:throw Error(s(161))}}catch(l){uu(e,e.return,l)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function Ml(e){if(1024&e.subtreeFlags)for(e=e.child;null!==e;){var t=e;Ml(t),5===t.tag&&1024&t.flags&&t.stateNode.reset(),e=e.sibling}}function Fl(e,t){if(8772&t.subtreeFlags)for(t=t.child;null!==t;)kl(e,t.alternate,t),t=t.sibling}function Ul(e){for(e=e.child;null!==e;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:ol(4,t,t.return),Ul(t);break;case 1:hl(t,t.return);var n=t.stateNode;"function"===typeof n.componentWillUnmount&&cl(t,t.return,n),Ul(t);break;case 27:Th(t.stateNode);case 26:case 5:hl(t,t.return),Ul(t);break;case 22:null===t.memoizedState&&Ul(t);break;default:Ul(t)}e=e.sibling}}function jl(e,t,n){for(n=n&&0!==(8772&t.subtreeFlags),t=t.child;null!==t;){var r=t.alternate,a=e,i=t,s=i.flags;switch(i.tag){case 0:case 11:case 15:jl(a,i,n),sl(4,i);break;case 1:if(jl(a,i,n),"function"===typeof(a=(r=i).stateNode).componentDidMount)try{a.componentDidMount()}catch(c){uu(r,r.return,c)}if(null!==(a=(r=i).updateQueue)){var o=r.stateNode;try{var l=a.shared.hiddenCallbacks;if(null!==l)for(a.shared.hiddenCallbacks=null,a=0;a<l.length;a++)hi(l[a],o)}catch(c){uu(r,r.return,c)}}n&&64&s&&ll(i),ul(i,i.return);break;case 27:yl(i);case 26:case 5:jl(a,i,n),n&&null===r&&4&s&&fl(i),ul(i,i.return);break;case 12:jl(a,i,n);break;case 13:jl(a,i,n),n&&4&s&&Nl(a,i);break;case 22:null===i.memoizedState&&jl(a,i,n),ul(i,i.return);break;case 30:break;default:jl(a,i,n)}t=t.sibling}}function Vl(e,t){var n=null;null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),e=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(e=t.memoizedState.cachePool.pool),e!==n&&(null!=e&&e.refCount++,null!=n&&Da(n))}function zl(e,t){e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Da(e))}function Bl(e,t,n,r){if(10256&t.subtreeFlags)for(t=t.child;null!==t;)Hl(e,t,n,r),t=t.sibling}function Hl(e,t,n,r){var a=t.flags;switch(t.tag){case 0:case 11:case 15:Bl(e,t,n,r),2048&a&&sl(9,t);break;case 1:case 13:default:Bl(e,t,n,r);break;case 3:Bl(e,t,n,r),2048&a&&(e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Da(e)));break;case 12:if(2048&a){Bl(e,t,n,r),e=t.stateNode;try{var i=t.memoizedProps,s=i.id,o=i.onPostCommit;"function"===typeof o&&o(s,null===t.alternate?"mount":"update",e.passiveEffectDuration,-0)}catch(l){uu(t,t.return,l)}}else Bl(e,t,n,r);break;case 23:break;case 22:i=t.stateNode,s=t.alternate,null!==t.memoizedState?2&i._visibility?Bl(e,t,n,r):Gl(e,t):2&i._visibility?Bl(e,t,n,r):(i._visibility|=2,Wl(e,t,n,r,0!==(10256&t.subtreeFlags))),2048&a&&Vl(s,t);break;case 24:Bl(e,t,n,r),2048&a&&zl(t.alternate,t)}}function Wl(e,t,n,r,a){for(a=a&&0!==(10256&t.subtreeFlags),t=t.child;null!==t;){var i=e,s=t,o=n,l=r,c=s.flags;switch(s.tag){case 0:case 11:case 15:Wl(i,s,o,l,a),sl(8,s);break;case 23:break;case 22:var u=s.stateNode;null!==s.memoizedState?2&u._visibility?Wl(i,s,o,l,a):Gl(i,s):(u._visibility|=2,Wl(i,s,o,l,a)),a&&2048&c&&Vl(s.alternate,s);break;case 24:Wl(i,s,o,l,a),a&&2048&c&&zl(s.alternate,s);break;default:Wl(i,s,o,l,a)}t=t.sibling}}function Gl(e,t){if(10256&t.subtreeFlags)for(t=t.child;null!==t;){var n=e,r=t,a=r.flags;switch(r.tag){case 22:Gl(n,r),2048&a&&Vl(r.alternate,r);break;case 24:Gl(n,r),2048&a&&zl(r.alternate,r);break;default:Gl(n,r)}t=t.sibling}}var Kl=8192;function ql(e){if(e.subtreeFlags&Kl)for(e=e.child;null!==e;)$l(e),e=e.sibling}function $l(e){switch(e.tag){case 26:ql(e),e.flags&Kl&&null!==e.memoizedState&&function(e,t,n){if(null===Bh)throw Error(s(475));var r=Bh;if("stylesheet"===t.type&&("string"!==typeof n.media||!1!==matchMedia(n.media).matches)&&0===(4&t.state.loading)){if(null===t.instance){var a=Ah(n.href),i=e.querySelector(Nh(a));if(i)return null!==(e=i._p)&&"object"===typeof e&&"function"===typeof e.then&&(r.count++,r=Wh.bind(r),e.then(r,r)),t.state.loading|=4,t.instance=i,void Ge(i);i=e.ownerDocument||e,n=Rh(n),(a=Sh.get(a))&&Mh(n,a),Ge(i=i.createElement("link"));var o=i;o._p=new Promise(function(e,t){o.onload=e,o.onerror=t}),eh(i,"link",n),t.instance=i}null===r.stylesheets&&(r.stylesheets=new Map),r.stylesheets.set(t,e),(e=t.state.preload)&&0===(3&t.state.loading)&&(r.count++,t=Wh.bind(r),e.addEventListener("load",t),e.addEventListener("error",t))}}(Pl,e.memoizedState,e.memoizedProps);break;case 5:default:ql(e);break;case 3:case 4:var t=Pl;Pl=kh(e.stateNode.containerInfo),ql(e),Pl=t;break;case 22:null===e.memoizedState&&(null!==(t=e.alternate)&&null!==t.memoizedState?(t=Kl,Kl=16777216,ql(e),Kl=t):ql(e))}}function Xl(e){var t=e.alternate;if(null!==t&&null!==(e=t.child)){t.child=null;do{t=e.sibling,e.sibling=null,e=t}while(null!==e)}}function Yl(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var r=t[n];El=r,Zl(r,e)}Xl(e)}if(10256&e.subtreeFlags)for(e=e.child;null!==e;)Ql(e),e=e.sibling}function Ql(e){switch(e.tag){case 0:case 11:case 15:Yl(e),2048&e.flags&&ol(9,e,e.return);break;case 3:case 12:default:Yl(e);break;case 22:var t=e.stateNode;null!==e.memoizedState&&2&t._visibility&&(null===e.return||13!==e.return.tag)?(t._visibility&=-3,Jl(e)):Yl(e)}}function Jl(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var r=t[n];El=r,Zl(r,e)}Xl(e)}for(e=e.child;null!==e;){switch((t=e).tag){case 0:case 11:case 15:ol(8,t,t.return),Jl(t);break;case 22:2&(n=t.stateNode)._visibility&&(n._visibility&=-3,Jl(t));break;default:Jl(t)}e=e.sibling}}function Zl(e,t){for(;null!==El;){var n=El;switch(n.tag){case 0:case 11:case 15:ol(8,n,t);break;case 23:case 22:if(null!==n.memoizedState&&null!==n.memoizedState.cachePool){var r=n.memoizedState.cachePool.pool;null!=r&&r.refCount++}break;case 24:Da(n.memoizedState.cache)}if(null!==(r=n.child))r.return=n,El=r;else e:for(n=e;null!==El;){var a=(r=El).sibling,i=r.return;if(_l(r),r===n){El=null;break e}if(null!==a){a.return=i,El=a;break e}El=i}}}var ec={getCacheForType:function(e){var t=xa(Oa),n=t.data.get(e);return void 0===n&&(n=e(),t.data.set(e,n)),n}},tc="function"===typeof WeakMap?WeakMap:Map,nc=0,rc=null,ac=null,ic=0,sc=0,oc=null,lc=!1,cc=!1,uc=!1,hc=0,fc=0,dc=0,pc=0,mc=0,gc=0,vc=0,yc=null,bc=null,wc=!1,Tc=0,Sc=1/0,Ec=null,kc=null,_c=0,xc=null,Cc=null,Ic=0,Ac=0,Nc=null,Rc=null,Oc=0,Pc=null;function Dc(){if(0!==(2&nc)&&0!==ic)return ic&-ic;if(null!==D.T){return 0!==Fa?Fa:Au()}return Ne()}function Lc(){0===gc&&(gc=0===(536870912&ic)||ia?Se():536870912);var e=ro.current;return null!==e&&(e.flags|=32),gc}function Mc(e,t,n){(e!==rc||2!==sc&&9!==sc)&&null===e.cancelPendingCommit||(Hc(e,0),Vc(e,ic,gc,!1)),_e(e,n),0!==(2&nc)&&e===rc||(e===rc&&(0===(2&nc)&&(pc|=n),4===fc&&Vc(e,ic,gc,!1)),Su(e))}function Fc(e,t,n){if(0!==(6&nc))throw Error(s(327));for(var r=!n&&0===(124&t)&&0===(t&e.expiredLanes)||we(e,t),a=r?function(e,t){var n=nc;nc|=2;var r=Gc(),a=Kc();rc!==e||ic!==t?(Ec=null,Sc=te()+500,Hc(e,t)):cc=we(e,t);e:for(;;)try{if(0!==sc&&null!==ac){t=ac;var i=oc;t:switch(sc){case 1:sc=0,oc=null,Zc(e,t,i,1);break;case 2:case 9:if(Xa(i)){sc=0,oc=null,Jc(t);break}t=function(){2!==sc&&9!==sc||rc!==e||(sc=7),Su(e)},i.then(t,t);break e;case 3:sc=7;break e;case 4:sc=5;break e;case 7:Xa(i)?(sc=0,oc=null,Jc(t)):(sc=0,oc=null,Zc(e,t,i,7));break;case 5:var o=null;switch(ac.tag){case 26:o=ac.memoizedState;case 5:case 27:var l=ac;if(!o||zh(o)){sc=0,oc=null;var c=l.sibling;if(null!==c)ac=c;else{var u=l.return;null!==u?(ac=u,eu(u)):ac=null}break t}}sc=0,oc=null,Zc(e,t,i,5);break;case 6:sc=0,oc=null,Zc(e,t,i,6);break;case 8:Bc(),fc=6;break e;default:throw Error(s(462))}}Yc();break}catch(h){Wc(e,h)}return ya=va=null,D.H=r,D.A=a,nc=n,null!==ac?0:(rc=null,ic=0,Ir(),fc)}(e,t):$c(e,t,!0),i=r;;){if(0===a){cc&&!r&&Vc(e,t,0,!1);break}if(n=e.current.alternate,!i||jc(n)){if(2===a){if(i=t,e.errorRecoveryDisabledLanes&i)var o=0;else o=0!==(o=-536870913&e.pendingLanes)?o:536870912&o?536870912:0;if(0!==o){t=o;e:{var l=e;a=yc;var c=l.current.memoizedState.isDehydrated;if(c&&(Hc(l,o).flags|=256),2!==(o=$c(l,o,!1))){if(uc&&!c){l.errorRecoveryDisabledLanes|=i,pc|=i,a=4;break e}i=bc,bc=a,null!==i&&(null===bc?bc=i:bc.push.apply(bc,i))}a=o}if(i=!1,2!==a)continue}}if(1===a){Hc(e,0),Vc(e,t,0,!0);break}e:{switch(r=e,i=a){case 0:case 1:throw Error(s(345));case 4:if((4194048&t)!==t)break;case 6:Vc(r,t,gc,!lc);break e;case 2:bc=null;break;case 3:case 5:break;default:throw Error(s(329))}if((62914560&t)===t&&10<(a=Tc+300-te())){if(Vc(r,t,gc,!lc),0!==be(r,0,!0))break e;r.timeoutHandle=lh(Uc.bind(null,r,n,bc,Ec,wc,t,gc,pc,vc,lc,i,2,-0,0),a)}else Uc(r,n,bc,Ec,wc,t,gc,pc,vc,lc,i,0,-0,0)}break}a=$c(e,t,!1),i=!1}Su(e)}function Uc(e,t,n,r,a,i,o,l,c,u,h,f,d,p){if(e.timeoutHandle=-1,(8192&(f=t.subtreeFlags)||16785408===(16785408&f))&&(Bh={stylesheets:null,count:0,unsuspend:Hh},$l(t),null!==(f=function(){if(null===Bh)throw Error(s(475));var e=Bh;return e.stylesheets&&0===e.count&&Kh(e,e.stylesheets),0<e.count?function(t){var n=setTimeout(function(){if(e.stylesheets&&Kh(e,e.stylesheets),e.unsuspend){var t=e.unsuspend;e.unsuspend=null,t()}},6e4);return e.unsuspend=t,function(){e.unsuspend=null,clearTimeout(n)}}:null}())))return e.cancelPendingCommit=f(nu.bind(null,e,t,i,n,r,a,o,l,c,h,1,d,p)),void Vc(e,i,o,!u);nu(e,t,i,n,r,a,o,l,c)}function jc(e){for(var t=e;;){var n=t.tag;if((0===n||11===n||15===n)&&16384&t.flags&&(null!==(n=t.updateQueue)&&null!==(n=n.stores)))for(var r=0;r<n.length;r++){var a=n[r],i=a.getSnapshot;a=a.value;try{if(!Xn(i(),a))return!1}catch(s){return!1}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Vc(e,t,n,r){t&=~mc,t&=~pc,e.suspendedLanes|=t,e.pingedLanes&=~t,r&&(e.warmLanes|=t),r=e.expirationTimes;for(var a=t;0<a;){var i=31-de(a),s=1<<i;r[i]=-1,a&=~s}0!==n&&xe(e,n,t)}function zc(){return 0!==(6&nc)||(Eu(0,!1),!1)}function Bc(){if(null!==ac){if(0===sc)var e=ac.return;else ya=va=null,Fi(e=ac),$s=null,Xs=0,e=ac;for(;null!==e;)il(e.alternate,e),e=e.return;ac=null}}function Hc(e,t){var n=e.timeoutHandle;-1!==n&&(e.timeoutHandle=-1,ch(n)),null!==(n=e.cancelPendingCommit)&&(e.cancelPendingCommit=null,n()),Bc(),rc=e,ac=n=Ur(e.current,null),ic=t,sc=0,oc=null,lc=!1,cc=we(e,t),uc=!1,vc=gc=mc=pc=dc=fc=0,bc=yc=null,wc=!1,0!==(8&t)&&(t|=32&t);var r=e.entangledLanes;if(0!==r)for(e=e.entanglements,r&=t;0<r;){var a=31-de(r),i=1<<a;t|=e[a],r&=~i}return hc=t,Ir(),n}function Wc(e,t){bi=null,D.H=Ws,t===Ga||t===qa?(t=Za(),sc=3):t===Ka?(t=Za(),sc=4):sc=t===xo?8:null!==t&&"object"===typeof t&&"function"===typeof t.then?6:1,oc=t,null===ac&&(fc=1,To(e,kr(t,e.current)))}function Gc(){var e=D.H;return D.H=Ws,null===e?Ws:e}function Kc(){var e=D.A;return D.A=ec,e}function qc(){fc=4,lc||(4194048&ic)!==ic&&null!==ro.current||(cc=!0),0===(134217727&dc)&&0===(134217727&pc)||null===rc||Vc(rc,ic,gc,!1)}function $c(e,t,n){var r=nc;nc|=2;var a=Gc(),i=Kc();rc===e&&ic===t||(Ec=null,Hc(e,t)),t=!1;var s=fc;e:for(;;)try{if(0!==sc&&null!==ac){var o=ac,l=oc;switch(sc){case 8:Bc(),s=6;break e;case 3:case 2:case 9:case 6:null===ro.current&&(t=!0);var c=sc;if(sc=0,oc=null,Zc(e,o,l,c),n&&cc){s=0;break e}break;default:c=sc,sc=0,oc=null,Zc(e,o,l,c)}}Xc(),s=fc;break}catch(u){Wc(e,u)}return t&&e.shellSuspendCounter++,ya=va=null,nc=r,D.H=a,D.A=i,null===ac&&(rc=null,ic=0,Ir()),s}function Xc(){for(;null!==ac;)Qc(ac)}function Yc(){for(;null!==ac&&!Z();)Qc(ac)}function Qc(e){var t=Qo(e.alternate,e,hc);e.memoizedProps=e.pendingProps,null===t?eu(e):ac=t}function Jc(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=Mo(n,t,t.pendingProps,t.type,void 0,ic);break;case 11:t=Mo(n,t,t.pendingProps,t.type.render,t.ref,ic);break;case 5:Fi(t);default:il(n,t),t=Qo(n,t=ac=jr(t,hc),hc)}e.memoizedProps=e.pendingProps,null===t?eu(e):ac=t}function Zc(e,t,n,r){ya=va=null,Fi(t),$s=null,Xs=0;var a=t.return;try{if(function(e,t,n,r,a){if(n.flags|=32768,null!==r&&"object"===typeof r&&"function"===typeof r.then){if(null!==(t=n.alternate)&&Ea(t,n,a,!0),null!==(n=ro.current)){switch(n.tag){case 13:return null===ao?qc():null===n.alternate&&0===fc&&(fc=3),n.flags&=-257,n.flags|=65536,n.lanes=a,r===$a?n.flags|=16384:(null===(t=n.updateQueue)?n.updateQueue=new Set([r]):t.add(r),hu(e,r,a)),!1;case 22:return n.flags|=65536,r===$a?n.flags|=16384:(null===(t=n.updateQueue)?(t={transitions:null,markerInstances:null,retryQueue:new Set([r])},n.updateQueue=t):null===(n=t.retryQueue)?t.retryQueue=new Set([r]):n.add(r),hu(e,r,a)),!1}throw Error(s(435,n.tag))}return hu(e,r,a),qc(),!1}if(ia)return null!==(t=ro.current)?(0===(65536&t.flags)&&(t.flags|=256),t.flags|=65536,t.lanes=a,r!==la&&ma(kr(e=Error(s(422),{cause:r}),n))):(r!==la&&ma(kr(t=Error(s(423),{cause:r}),n)),(e=e.current.alternate).flags|=65536,a&=-a,e.lanes|=a,r=kr(r,n),oi(e,a=Eo(e.stateNode,r,a)),4!==fc&&(fc=2)),!1;var i=Error(s(520),{cause:r});if(i=kr(i,n),null===yc?yc=[i]:yc.push(i),4!==fc&&(fc=2),null===t)return!0;r=kr(r,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=a&-a,n.lanes|=e,oi(n,e=Eo(n.stateNode,r,e)),!1;case 1:if(t=n.type,i=n.stateNode,0===(128&n.flags)&&("function"===typeof t.getDerivedStateFromError||null!==i&&"function"===typeof i.componentDidCatch&&(null===kc||!kc.has(i))))return n.flags|=65536,a&=-a,n.lanes|=a,_o(a=ko(a),e,n,r),oi(n,a),!1}n=n.return}while(null!==n);return!1}(e,a,t,n,ic))return fc=1,To(e,kr(n,e.current)),void(ac=null)}catch(i){if(null!==a)throw ac=a,i;return fc=1,To(e,kr(n,e.current)),void(ac=null)}32768&t.flags?(ia||1===r?e=!0:cc||0!==(536870912&ic)?e=!1:(lc=e=!0,(2===r||9===r||3===r||6===r)&&(null!==(r=ro.current)&&13===r.tag&&(r.flags|=16384))),tu(t,e)):eu(t)}function eu(e){var t=e;do{if(0!==(32768&t.flags))return void tu(t,lc);e=t.return;var n=rl(t.alternate,t,hc);if(null!==n)return void(ac=n);if(null!==(t=t.sibling))return void(ac=t);ac=t=e}while(null!==t);0===fc&&(fc=5)}function tu(e,t){do{var n=al(e.alternate,e);if(null!==n)return n.flags&=32767,void(ac=n);if(null!==(n=e.return)&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&null!==(e=e.sibling))return void(ac=e);ac=e=n}while(null!==e);fc=6,ac=null}function nu(e,t,n,r,a,i,o,l,c){e.cancelPendingCommit=null;do{ou()}while(0!==_c);if(0!==(6&nc))throw Error(s(327));if(null!==t){if(t===e.current)throw Error(s(177));if(i=t.lanes|t.childLanes,function(e,t,n,r,a,i){var s=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var o=e.entanglements,l=e.expirationTimes,c=e.hiddenUpdates;for(n=s&~n;0<n;){var u=31-de(n),h=1<<u;o[u]=0,l[u]=-1;var f=c[u];if(null!==f)for(c[u]=null,u=0;u<f.length;u++){var d=f[u];null!==d&&(d.lane&=-536870913)}n&=~h}0!==r&&xe(e,r,0),0!==i&&0===a&&0!==e.tag&&(e.suspendedLanes|=i&~(s&~t))}(e,n,i|=Cr,o,l,c),e===rc&&(ac=rc=null,ic=0),Cc=t,xc=e,Ic=n,Ac=i,Nc=a,Rc=r,0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?(e.callbackNode=null,e.callbackPriority=0,Q(ie,function(){return lu(),null})):(e.callbackNode=null,e.callbackPriority=0),r=0!==(13878&t.flags),0!==(13878&t.subtreeFlags)||r){r=D.T,D.T=null,a=L.p,L.p=2,o=nc,nc|=4;try{!function(e,t){if(e=e.containerInfo,th=nf,tr(e=er(e))){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var a=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch(g){n=null;break e}var o=0,l=-1,c=-1,u=0,h=0,f=e,d=null;t:for(;;){for(var p;f!==n||0!==a&&3!==f.nodeType||(l=o+a),f!==i||0!==r&&3!==f.nodeType||(c=o+r),3===f.nodeType&&(o+=f.nodeValue.length),null!==(p=f.firstChild);)d=f,f=p;for(;;){if(f===e)break t;if(d===n&&++u===a&&(l=o),d===i&&++h===r&&(c=o),null!==(p=f.nextSibling))break;d=(f=d).parentNode}f=p}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(nh={focusedElem:e,selectionRange:n},nf=!1,El=t;null!==El;)if(e=(t=El).child,0!==(1024&t.subtreeFlags)&&null!==e)e.return=t,El=e;else for(;null!==El;){switch(i=(t=El).alternate,e=t.flags,t.tag){case 0:case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:if(0!==(1024&e)&&null!==i){e=void 0,n=t,a=i.memoizedProps,i=i.memoizedState,r=n.stateNode;try{var m=go(n.type,a,(n.elementType,n.type));e=r.getSnapshotBeforeUpdate(m,i),r.__reactInternalSnapshotBeforeUpdate=e}catch(v){uu(n,n.return,v)}}break;case 3:if(0!==(1024&e))if(9===(n=(e=t.stateNode.containerInfo).nodeType))mh(e);else if(1===n)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":mh(e);break;default:e.textContent=""}break;default:if(0!==(1024&e))throw Error(s(163))}if(null!==(e=t.sibling)){e.return=t.return,El=e;break}El=t.return}}(e,t)}finally{nc=o,L.p=a,D.T=r}}_c=1,ru(),au(),iu()}}function ru(){if(1===_c){_c=0;var e=xc,t=Cc,n=0!==(13878&t.flags);if(0!==(13878&t.subtreeFlags)||n){n=D.T,D.T=null;var r=L.p;L.p=2;var a=nc;nc|=4;try{Dl(t,e);var i=nh,s=er(e.containerInfo),o=i.focusedElem,l=i.selectionRange;if(s!==o&&o&&o.ownerDocument&&Zn(o.ownerDocument.documentElement,o)){if(null!==l&&tr(o)){var c=l.start,u=l.end;if(void 0===u&&(u=c),"selectionStart"in o)o.selectionStart=c,o.selectionEnd=Math.min(u,o.value.length);else{var h=o.ownerDocument||document,f=h&&h.defaultView||window;if(f.getSelection){var d=f.getSelection(),p=o.textContent.length,m=Math.min(l.start,p),g=void 0===l.end?m:Math.min(l.end,p);!d.extend&&m>g&&(s=g,g=m,m=s);var v=Jn(o,m),y=Jn(o,g);if(v&&y&&(1!==d.rangeCount||d.anchorNode!==v.node||d.anchorOffset!==v.offset||d.focusNode!==y.node||d.focusOffset!==y.offset)){var b=h.createRange();b.setStart(v.node,v.offset),d.removeAllRanges(),m>g?(d.addRange(b),d.extend(y.node,y.offset)):(b.setEnd(y.node,y.offset),d.addRange(b))}}}}for(h=[],d=o;d=d.parentNode;)1===d.nodeType&&h.push({element:d,left:d.scrollLeft,top:d.scrollTop});for("function"===typeof o.focus&&o.focus(),o=0;o<h.length;o++){var w=h[o];w.element.scrollLeft=w.left,w.element.scrollTop=w.top}}nf=!!th,nh=th=null}finally{nc=a,L.p=r,D.T=n}}e.current=t,_c=2}}function au(){if(2===_c){_c=0;var e=xc,t=Cc,n=0!==(8772&t.flags);if(0!==(8772&t.subtreeFlags)||n){n=D.T,D.T=null;var r=L.p;L.p=2;var a=nc;nc|=4;try{kl(e,t.alternate,t)}finally{nc=a,L.p=r,D.T=n}}_c=3}}function iu(){if(4===_c||3===_c){_c=0,ee();var e=xc,t=Cc,n=Ic,r=Rc;0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?_c=5:(_c=0,Cc=xc=null,su(e,e.pendingLanes));var a=e.pendingLanes;if(0===a&&(kc=null),Ae(n),t=t.stateNode,he&&"function"===typeof he.onCommitFiberRoot)try{he.onCommitFiberRoot(ue,t,void 0,128===(128&t.current.flags))}catch(l){}if(null!==r){t=D.T,a=L.p,L.p=2,D.T=null;try{for(var i=e.onRecoverableError,s=0;s<r.length;s++){var o=r[s];i(o.value,{componentStack:o.stack})}}finally{D.T=t,L.p=a}}0!==(3&Ic)&&ou(),Su(e),a=e.pendingLanes,0!==(4194090&n)&&0!==(42&a)?e===Pc?Oc++:(Oc=0,Pc=e):Oc=0,Eu(0,!1)}}function su(e,t){0===(e.pooledCacheLanes&=t)&&(null!=(t=e.pooledCache)&&(e.pooledCache=null,Da(t)))}function ou(e){return ru(),au(),iu(),lu()}function lu(){if(5!==_c)return!1;var e=xc,t=Ac;Ac=0;var n=Ae(Ic),r=D.T,a=L.p;try{L.p=32>n?32:n,D.T=null,n=Nc,Nc=null;var i=xc,o=Ic;if(_c=0,Cc=xc=null,Ic=0,0!==(6&nc))throw Error(s(331));var l=nc;if(nc|=4,Ql(i.current),Hl(i,i.current,o,n),nc=l,Eu(0,!1),he&&"function"===typeof he.onPostCommitFiberRoot)try{he.onPostCommitFiberRoot(ue,i)}catch(c){}return!0}finally{L.p=a,D.T=r,su(e,t)}}function cu(e,t,n){t=kr(n,t),null!==(e=ii(e,t=Eo(e.stateNode,t,2),2))&&(_e(e,2),Su(e))}function uu(e,t,n){if(3===e.tag)cu(e,e,n);else for(;null!==t;){if(3===t.tag){cu(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===kc||!kc.has(r))){e=kr(n,e),null!==(r=ii(t,n=ko(2),2))&&(_o(n,r,t,e),_e(r,2),Su(r));break}}t=t.return}}function hu(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new tc;var a=new Set;r.set(t,a)}else void 0===(a=r.get(t))&&(a=new Set,r.set(t,a));a.has(n)||(uc=!0,a.add(n),e=fu.bind(null,e,t,n),t.then(e,e))}function fu(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,rc===e&&(ic&n)===n&&(4===fc||3===fc&&(62914560&ic)===ic&&300>te()-Tc?0===(2&nc)&&Hc(e,0):mc|=n,vc===ic&&(vc=0)),Su(e)}function du(e,t){0===t&&(t=Ee()),null!==(e=Rr(e,t))&&(_e(e,t),Su(e))}function pu(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),du(e,n)}function mu(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,a=e.memoizedState;null!==a&&(n=a.retryLane);break;case 19:r=e.stateNode;break;case 22:r=e.stateNode._retryCache;break;default:throw Error(s(314))}null!==r&&r.delete(t),du(e,n)}var gu=null,vu=null,yu=!1,bu=!1,wu=!1,Tu=0;function Su(e){e!==vu&&null===e.next&&(null===vu?gu=vu=e:vu=vu.next=e),bu=!0,yu||(yu=!0,hh(function(){0!==(6&nc)?Q(re,ku):_u()}))}function Eu(e,t){if(!wu&&bu){wu=!0;do{for(var n=!1,r=gu;null!==r;){if(!t)if(0!==e){var a=r.pendingLanes;if(0===a)var i=0;else{var s=r.suspendedLanes,o=r.pingedLanes;i=(1<<31-de(42|e)+1)-1,i=201326741&(i&=a&~(s&~o))?201326741&i|1:i?2|i:0}0!==i&&(n=!0,Iu(r,i))}else i=ic,0===(3&(i=be(r,r===rc?i:0,null!==r.cancelPendingCommit||-1!==r.timeoutHandle)))||we(r,i)||(n=!0,Iu(r,i));r=r.next}}while(n);wu=!1}}function ku(){_u()}function _u(){bu=yu=!1;var e=0;0!==Tu&&(function(){var e=window.event;if(e&&"popstate"===e.type)return e!==oh&&(oh=e,!0);return oh=null,!1}()&&(e=Tu),Tu=0);for(var t=te(),n=null,r=gu;null!==r;){var a=r.next,i=xu(r,t);0===i?(r.next=null,null===n?gu=a:n.next=a,null===a&&(vu=n)):(n=r,(0!==e||0!==(3&i))&&(bu=!0)),r=a}Eu(e,!1)}function xu(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,a=e.expirationTimes,i=-62914561&e.pendingLanes;0<i;){var s=31-de(i),o=1<<s,l=a[s];-1===l?0!==(o&n)&&0===(o&r)||(a[s]=Te(o,t)):l<=t&&(e.expiredLanes|=o),i&=~o}if(n=ic,n=be(e,e===(t=rc)?n:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle),r=e.callbackNode,0===n||e===t&&(2===sc||9===sc)||null!==e.cancelPendingCommit)return null!==r&&null!==r&&J(r),e.callbackNode=null,e.callbackPriority=0;if(0===(3&n)||we(e,n)){if((t=n&-n)===e.callbackPriority)return t;switch(null!==r&&J(r),Ae(n)){case 2:case 8:n=ae;break;case 32:default:n=ie;break;case 268435456:n=oe}return r=Cu.bind(null,e),n=Q(n,r),e.callbackPriority=t,e.callbackNode=n,t}return null!==r&&null!==r&&J(r),e.callbackPriority=2,e.callbackNode=null,2}function Cu(e,t){if(0!==_c&&5!==_c)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(ou()&&e.callbackNode!==n)return null;var r=ic;return 0===(r=be(e,e===rc?r:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle))?null:(Fc(e,r,t),xu(e,te()),null!=e.callbackNode&&e.callbackNode===n?Cu.bind(null,e):null)}function Iu(e,t){if(ou())return null;Fc(e,t,!0)}function Au(){return 0===Tu&&(Tu=Se()),Tu}function Nu(e){return null==e||"symbol"===typeof e||"boolean"===typeof e?null:"function"===typeof e?e:At(""+e)}function Ru(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}for(var Ou=0;Ou<Tr.length;Ou++){var Pu=Tr[Ou];Sr(Pu.toLowerCase(),"on"+(Pu[0].toUpperCase()+Pu.slice(1)))}Sr(dr,"onAnimationEnd"),Sr(pr,"onAnimationIteration"),Sr(mr,"onAnimationStart"),Sr("dblclick","onDoubleClick"),Sr("focusin","onFocus"),Sr("focusout","onBlur"),Sr(gr,"onTransitionRun"),Sr(vr,"onTransitionStart"),Sr(yr,"onTransitionCancel"),Sr(br,"onTransitionEnd"),Xe("onMouseEnter",["mouseout","mouseover"]),Xe("onMouseLeave",["mouseout","mouseover"]),Xe("onPointerEnter",["pointerout","pointerover"]),Xe("onPointerLeave",["pointerout","pointerover"]),$e("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),$e("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),$e("onBeforeInput",["compositionend","keypress","textInput","paste"]),$e("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),$e("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),$e("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Du="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Lu=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Du));function Mu(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var s=r.length-1;0<=s;s--){var o=r[s],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==i&&a.isPropagationStopped())break e;i=o,a.currentTarget=c;try{i(a)}catch(u){vo(u)}a.currentTarget=null,i=l}else for(s=0;s<r.length;s++){if(l=(o=r[s]).instance,c=o.currentTarget,o=o.listener,l!==i&&a.isPropagationStopped())break e;i=o,a.currentTarget=c;try{i(a)}catch(u){vo(u)}a.currentTarget=null,i=l}}}}function Fu(e,t){var n=t[Le];void 0===n&&(n=t[Le]=new Set);var r=e+"__bubble";n.has(r)||(zu(t,e,2,!1),n.add(r))}function Uu(e,t,n){var r=0;t&&(r|=4),zu(n,e,r,t)}var ju="_reactListening"+Math.random().toString(36).slice(2);function Vu(e){if(!e[ju]){e[ju]=!0,Ke.forEach(function(t){"selectionchange"!==t&&(Lu.has(t)||Uu(t,!1,e),Uu(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[ju]||(t[ju]=!0,Uu("selectionchange",!1,t))}}function zu(e,t,n,r){switch(uf(t)){case 2:var a=rf;break;case 8:a=af;break;default:a=sf}n=a.bind(null,t,n,e),a=void 0,!jt||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),r?void 0!==a?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):void 0!==a?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function Bu(e,t,n,r,a){var i=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var s=r.tag;if(3===s||4===s){var o=r.stateNode.containerInfo;if(o===a)break;if(4===s)for(s=r.return;null!==s;){var c=s.tag;if((3===c||4===c)&&s.stateNode.containerInfo===a)return;s=s.return}for(;null!==o;){if(null===(s=ze(o)))return;if(5===(c=s.tag)||6===c||26===c||27===c){r=i=s;continue e}o=o.parentNode}}r=r.return}Mt(function(){var r=i,a=Rt(n),s=[];e:{var o=wr.get(e);if(void 0!==o){var c=Zt,u=e;switch(e){case"keypress":if(0===Gt(n))break e;case"keydown":case"keyup":c=mn;break;case"focusin":u="focus",c=sn;break;case"focusout":u="blur",c=sn;break;case"beforeblur":case"afterblur":c=sn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=rn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=an;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=vn;break;case dr:case pr:case mr:c=on;break;case br:c=yn;break;case"scroll":case"scrollend":c=tn;break;case"wheel":c=bn;break;case"copy":case"cut":case"paste":c=ln;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=gn;break;case"toggle":case"beforetoggle":c=wn}var h=0!==(4&t),f=!h&&("scroll"===e||"scrollend"===e),d=h?null!==o?o+"Capture":null:o;h=[];for(var p,m=r;null!==m;){var g=m;if(p=g.stateNode,5!==(g=g.tag)&&26!==g&&27!==g||null===p||null===d||null!=(g=Ft(m,d))&&h.push(Hu(m,g,p)),f)break;m=m.return}0<h.length&&(o=new c(o,u,null,n,a),s.push({event:o,listeners:h}))}}if(0===(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||n===Nt||!(u=n.relatedTarget||n.fromElement)||!ze(u)&&!u[De])&&(c||o)&&(o=a.window===a?a:(o=a.ownerDocument)?o.defaultView||o.parentWindow:window,c?(c=r,null!==(u=(u=n.relatedTarget||n.toElement)?ze(u):null)&&(f=l(u),h=u.tag,u!==f||5!==h&&27!==h&&6!==h)&&(u=null)):(c=null,u=r),c!==u)){if(h=rn,g="onMouseLeave",d="onMouseEnter",m="mouse","pointerout"!==e&&"pointerover"!==e||(h=gn,g="onPointerLeave",d="onPointerEnter",m="pointer"),f=null==c?o:He(c),p=null==u?o:He(u),(o=new h(g,m+"leave",c,n,a)).target=f,o.relatedTarget=p,g=null,ze(a)===r&&((h=new h(d,m+"enter",u,n,a)).target=p,h.relatedTarget=f,g=h),f=g,c&&u)e:{for(d=u,m=0,p=h=c;p;p=Gu(p))m++;for(p=0,g=d;g;g=Gu(g))p++;for(;0<m-p;)h=Gu(h),m--;for(;0<p-m;)d=Gu(d),p--;for(;m--;){if(h===d||null!==d&&h===d.alternate)break e;h=Gu(h),d=Gu(d)}h=null}else h=null;null!==c&&Ku(s,o,c,h,!1),null!==u&&null!==f&&Ku(s,f,u,h,!0)}if("select"===(c=(o=r?He(r):window).nodeName&&o.nodeName.toLowerCase())||"input"===c&&"file"===o.type)var v=Un;else if(On(o))if(jn)v=$n;else{v=Kn;var y=Gn}else!(c=o.nodeName)||"input"!==c.toLowerCase()||"checkbox"!==o.type&&"radio"!==o.type?r&&xt(r.elementType)&&(v=Un):v=qn;switch(v&&(v=v(e,r))?Pn(s,v,n,a):(y&&y(e,o,r),"focusout"===e&&r&&"number"===o.type&&null!=r.memoizedProps.value&&yt(o,"number",o.value)),y=r?He(r):window,e){case"focusin":(On(y)||"true"===y.contentEditable)&&(rr=y,ar=r,ir=null);break;case"focusout":ir=ar=rr=null;break;case"mousedown":sr=!0;break;case"contextmenu":case"mouseup":case"dragend":sr=!1,or(s,n,a);break;case"selectionchange":if(nr)break;case"keydown":case"keyup":or(s,n,a)}var b;if(Sn)e:{switch(e){case"compositionstart":var w="onCompositionStart";break e;case"compositionend":w="onCompositionEnd";break e;case"compositionupdate":w="onCompositionUpdate";break e}w=void 0}else Nn?In(e,n)&&(w="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(w="onCompositionStart");w&&(_n&&"ko"!==n.locale&&(Nn||"onCompositionStart"!==w?"onCompositionEnd"===w&&Nn&&(b=Wt()):(Bt="value"in(zt=a)?zt.value:zt.textContent,Nn=!0)),0<(y=Wu(r,w)).length&&(w=new cn(w,e,null,n,a),s.push({event:w,listeners:y}),b?w.data=b:null!==(b=An(n))&&(w.data=b))),(b=kn?function(e,t){switch(e){case"compositionend":return An(t);case"keypress":return 32!==t.which?null:(Cn=!0,xn);case"textInput":return(e=t.data)===xn&&Cn?null:e;default:return null}}(e,n):function(e,t){if(Nn)return"compositionend"===e||!Sn&&In(e,t)?(e=Wt(),Ht=Bt=zt=null,Nn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return _n&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(w=Wu(r,"onBeforeInput")).length&&(y=new cn("onBeforeInput","beforeinput",null,n,a),s.push({event:y,listeners:w}),y.data=b)),function(e,t,n,r,a){if("submit"===t&&n&&n.stateNode===a){var i=Nu((a[Pe]||null).action),s=r.submitter;s&&null!==(t=(t=s[Pe]||null)?Nu(t.formAction):s.getAttribute("formAction"))&&(i=t,s=null);var o=new Zt("action","action",null,r,a);e.push({event:o,listeners:[{instance:null,listener:function(){if(r.defaultPrevented){if(0!==Tu){var e=s?Ru(a,s):new FormData(a);Ns(n,{pending:!0,data:e,method:a.method,action:i},null,e)}}else"function"===typeof i&&(o.preventDefault(),e=s?Ru(a,s):new FormData(a),Ns(n,{pending:!0,data:e,method:a.method,action:i},i,e))},currentTarget:a}]})}}(s,e,r,n,a)}Mu(s,t)})}function Hu(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Wu(e,t){for(var n=t+"Capture",r=[];null!==e;){var a=e,i=a.stateNode;if(5!==(a=a.tag)&&26!==a&&27!==a||null===i||(null!=(a=Ft(e,n))&&r.unshift(Hu(e,a,i)),null!=(a=Ft(e,t))&&r.push(Hu(e,a,i))),3===e.tag)return r;e=e.return}return[]}function Gu(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag&&27!==e.tag);return e||null}function Ku(e,t,n,r,a){for(var i=t._reactName,s=[];null!==n&&n!==r;){var o=n,l=o.alternate,c=o.stateNode;if(o=o.tag,null!==l&&l===r)break;5!==o&&26!==o&&27!==o||null===c||(l=c,a?null!=(c=Ft(n,i))&&s.unshift(Hu(n,c,l)):a||null!=(c=Ft(n,i))&&s.push(Hu(n,c,l))),n=n.return}0!==s.length&&e.push({event:t,listeners:s})}var qu=/\r\n?/g,$u=/\u0000|\uFFFD/g;function Xu(e){return("string"===typeof e?e:""+e).replace(qu,"\n").replace($u,"")}function Yu(e,t){return t=Xu(t),Xu(e)===t}function Qu(){}function Ju(e,t,n,r,a,i){switch(n){case"children":"string"===typeof r?"body"===t||"textarea"===t&&""===r||St(e,r):("number"===typeof r||"bigint"===typeof r)&&"body"!==t&&St(e,""+r);break;case"className":nt(e,"class",r);break;case"tabIndex":nt(e,"tabindex",r);break;case"dir":case"role":case"viewBox":case"width":case"height":nt(e,n,r);break;case"style":_t(e,r,i);break;case"data":if("object"!==t){nt(e,"data",r);break}case"src":case"href":if(""===r&&("a"!==t||"href"!==n)){e.removeAttribute(n);break}if(null==r||"function"===typeof r||"symbol"===typeof r||"boolean"===typeof r){e.removeAttribute(n);break}r=At(""+r),e.setAttribute(n,r);break;case"action":case"formAction":if("function"===typeof r){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}if("function"===typeof i&&("formAction"===n?("input"!==t&&Ju(e,t,"name",a.name,a,null),Ju(e,t,"formEncType",a.formEncType,a,null),Ju(e,t,"formMethod",a.formMethod,a,null),Ju(e,t,"formTarget",a.formTarget,a,null)):(Ju(e,t,"encType",a.encType,a,null),Ju(e,t,"method",a.method,a,null),Ju(e,t,"target",a.target,a,null))),null==r||"symbol"===typeof r||"boolean"===typeof r){e.removeAttribute(n);break}r=At(""+r),e.setAttribute(n,r);break;case"onClick":null!=r&&(e.onclick=Qu);break;case"onScroll":null!=r&&Fu("scroll",e);break;case"onScrollEnd":null!=r&&Fu("scrollend",e);break;case"dangerouslySetInnerHTML":if(null!=r){if("object"!==typeof r||!("__html"in r))throw Error(s(61));if(null!=(n=r.__html)){if(null!=a.children)throw Error(s(60));e.innerHTML=n}}break;case"multiple":e.multiple=r&&"function"!==typeof r&&"symbol"!==typeof r;break;case"muted":e.muted=r&&"function"!==typeof r&&"symbol"!==typeof r;break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":case"autoFocus":break;case"xlinkHref":if(null==r||"function"===typeof r||"boolean"===typeof r||"symbol"===typeof r){e.removeAttribute("xlink:href");break}n=At(""+r),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":null!=r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,""+r):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":!0===r?e.setAttribute(n,""):!1!==r&&null!=r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,r):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":null!=r&&"function"!==typeof r&&"symbol"!==typeof r&&!isNaN(r)&&1<=r?e.setAttribute(n,r):e.removeAttribute(n);break;case"rowSpan":case"start":null==r||"function"===typeof r||"symbol"===typeof r||isNaN(r)?e.removeAttribute(n):e.setAttribute(n,r);break;case"popover":Fu("beforetoggle",e),Fu("toggle",e),tt(e,"popover",r);break;case"xlinkActuate":rt(e,"http://www.w3.org/1999/xlink","xlink:actuate",r);break;case"xlinkArcrole":rt(e,"http://www.w3.org/1999/xlink","xlink:arcrole",r);break;case"xlinkRole":rt(e,"http://www.w3.org/1999/xlink","xlink:role",r);break;case"xlinkShow":rt(e,"http://www.w3.org/1999/xlink","xlink:show",r);break;case"xlinkTitle":rt(e,"http://www.w3.org/1999/xlink","xlink:title",r);break;case"xlinkType":rt(e,"http://www.w3.org/1999/xlink","xlink:type",r);break;case"xmlBase":rt(e,"http://www.w3.org/XML/1998/namespace","xml:base",r);break;case"xmlLang":rt(e,"http://www.w3.org/XML/1998/namespace","xml:lang",r);break;case"xmlSpace":rt(e,"http://www.w3.org/XML/1998/namespace","xml:space",r);break;case"is":tt(e,"is",r);break;case"innerText":case"textContent":break;default:(!(2<n.length)||"o"!==n[0]&&"O"!==n[0]||"n"!==n[1]&&"N"!==n[1])&&tt(e,n=Ct.get(n)||n,r)}}function Zu(e,t,n,r,a,i){switch(n){case"style":_t(e,r,i);break;case"dangerouslySetInnerHTML":if(null!=r){if("object"!==typeof r||!("__html"in r))throw Error(s(61));if(null!=(n=r.__html)){if(null!=a.children)throw Error(s(60));e.innerHTML=n}}break;case"children":"string"===typeof r?St(e,r):("number"===typeof r||"bigint"===typeof r)&&St(e,""+r);break;case"onScroll":null!=r&&Fu("scroll",e);break;case"onScrollEnd":null!=r&&Fu("scrollend",e);break;case"onClick":null!=r&&(e.onclick=Qu);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":case"innerText":case"textContent":break;default:qe.hasOwnProperty(n)||("o"!==n[0]||"n"!==n[1]||(a=n.endsWith("Capture"),t=n.slice(2,a?n.length-7:void 0),"function"===typeof(i=null!=(i=e[Pe]||null)?i[n]:null)&&e.removeEventListener(t,i,a),"function"!==typeof r)?n in e?e[n]=r:!0===r?e.setAttribute(n,""):tt(e,n,r):("function"!==typeof i&&null!==i&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,r,a)))}}function eh(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Fu("error",e),Fu("load",e);var r,a=!1,i=!1;for(r in n)if(n.hasOwnProperty(r)){var o=n[r];if(null!=o)switch(r){case"src":a=!0;break;case"srcSet":i=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,t));default:Ju(e,t,r,o,n,null)}}return i&&Ju(e,t,"srcSet",n.srcSet,n,null),void(a&&Ju(e,t,"src",n.src,n,null));case"input":Fu("invalid",e);var l=r=o=i=null,c=null,u=null;for(a in n)if(n.hasOwnProperty(a)){var h=n[a];if(null!=h)switch(a){case"name":i=h;break;case"type":o=h;break;case"checked":c=h;break;case"defaultChecked":u=h;break;case"value":r=h;break;case"defaultValue":l=h;break;case"children":case"dangerouslySetInnerHTML":if(null!=h)throw Error(s(137,t));break;default:Ju(e,t,a,h,n,null)}}return vt(e,r,l,c,u,o,i,!1),void ht(e);case"select":for(i in Fu("invalid",e),a=o=r=null,n)if(n.hasOwnProperty(i)&&null!=(l=n[i]))switch(i){case"value":r=l;break;case"defaultValue":o=l;break;case"multiple":a=l;default:Ju(e,t,i,l,n,null)}return t=r,n=o,e.multiple=!!a,void(null!=t?bt(e,!!a,t,!1):null!=n&&bt(e,!!a,n,!0));case"textarea":for(o in Fu("invalid",e),r=i=a=null,n)if(n.hasOwnProperty(o)&&null!=(l=n[o]))switch(o){case"value":a=l;break;case"defaultValue":i=l;break;case"children":r=l;break;case"dangerouslySetInnerHTML":if(null!=l)throw Error(s(91));break;default:Ju(e,t,o,l,n,null)}return Tt(e,a,i,r),void ht(e);case"option":for(c in n)if(n.hasOwnProperty(c)&&null!=(a=n[c]))if("selected"===c)e.selected=a&&"function"!==typeof a&&"symbol"!==typeof a;else Ju(e,t,c,a,n,null);return;case"dialog":Fu("beforetoggle",e),Fu("toggle",e),Fu("cancel",e),Fu("close",e);break;case"iframe":case"object":Fu("load",e);break;case"video":case"audio":for(a=0;a<Du.length;a++)Fu(Du[a],e);break;case"image":Fu("error",e),Fu("load",e);break;case"details":Fu("toggle",e);break;case"embed":case"source":case"link":Fu("error",e),Fu("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(u in n)if(n.hasOwnProperty(u)&&null!=(a=n[u]))switch(u){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,t));default:Ju(e,t,u,a,n,null)}return;default:if(xt(t)){for(h in n)n.hasOwnProperty(h)&&(void 0!==(a=n[h])&&Zu(e,t,h,a,n,void 0));return}}for(l in n)n.hasOwnProperty(l)&&(null!=(a=n[l])&&Ju(e,t,l,a,n,null))}var th=null,nh=null;function rh(e){return 9===e.nodeType?e:e.ownerDocument}function ah(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function ih(e,t){if(0===e)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return 1===e&&"foreignObject"===t?0:e}function sh(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"bigint"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var oh=null;var lh="function"===typeof setTimeout?setTimeout:void 0,ch="function"===typeof clearTimeout?clearTimeout:void 0,uh="function"===typeof Promise?Promise:void 0,hh="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof uh?function(e){return uh.resolve(null).then(e).catch(fh)}:lh;function fh(e){setTimeout(function(){throw e})}function dh(e){return"head"===e}function ph(e,t){var n=t,r=0,a=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0<r&&8>r){n=r;var s=e.ownerDocument;if(1&n&&Th(s.documentElement),2&n&&Th(s.body),4&n)for(Th(n=s.head),s=n.firstChild;s;){var o=s.nextSibling,l=s.nodeName;s[je]||"SCRIPT"===l||"STYLE"===l||"LINK"===l&&"stylesheet"===s.rel.toLowerCase()||n.removeChild(s),s=o}}if(0===a)return e.removeChild(i),void If(t);a--}else"$"===n||"$?"===n||"$!"===n?a++:r=n.charCodeAt(0)-48;else r=0;n=i}while(n);If(t)}function mh(e){var t=e.firstChild;for(t&&10===t.nodeType&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":mh(n),Ve(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if("stylesheet"===n.rel.toLowerCase())continue}e.removeChild(n)}}function gh(e){return"$!"===e.data||"$?"===e.data&&"complete"===e.ownerDocument.readyState}function vh(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t||"F!"===t||"F"===t)break;if("/$"===t)return null}}return e}var yh=null;function bh(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}function wh(e,t,n){switch(t=rh(n),e){case"html":if(!(e=t.documentElement))throw Error(s(452));return e;case"head":if(!(e=t.head))throw Error(s(453));return e;case"body":if(!(e=t.body))throw Error(s(454));return e;default:throw Error(s(451))}}function Th(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Ve(e)}var Sh=new Map,Eh=new Set;function kh(e){return"function"===typeof e.getRootNode?e.getRootNode():9===e.nodeType?e:e.ownerDocument}var _h=L.d;L.d={f:function(){var e=_h.f(),t=zc();return e||t},r:function(e){var t=Be(e);null!==t&&5===t.tag&&"form"===t.type?Os(t):_h.r(e)},D:function(e){_h.D(e),Ch("dns-prefetch",e,null)},C:function(e,t){_h.C(e,t),Ch("preconnect",e,t)},L:function(e,t,n){_h.L(e,t,n);var r=xh;if(r&&e&&t){var a='link[rel="preload"][as="'+mt(t)+'"]';"image"===t&&n&&n.imageSrcSet?(a+='[imagesrcset="'+mt(n.imageSrcSet)+'"]',"string"===typeof n.imageSizes&&(a+='[imagesizes="'+mt(n.imageSizes)+'"]')):a+='[href="'+mt(e)+'"]';var i=a;switch(t){case"style":i=Ah(e);break;case"script":i=Oh(e)}Sh.has(i)||(e=f({rel:"preload",href:"image"===t&&n&&n.imageSrcSet?void 0:e,as:t},n),Sh.set(i,e),null!==r.querySelector(a)||"style"===t&&r.querySelector(Nh(i))||"script"===t&&r.querySelector(Ph(i))||(eh(t=r.createElement("link"),"link",e),Ge(t),r.head.appendChild(t)))}},m:function(e,t){_h.m(e,t);var n=xh;if(n&&e){var r=t&&"string"===typeof t.as?t.as:"script",a='link[rel="modulepreload"][as="'+mt(r)+'"][href="'+mt(e)+'"]',i=a;switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":i=Oh(e)}if(!Sh.has(i)&&(e=f({rel:"modulepreload",href:e},t),Sh.set(i,e),null===n.querySelector(a))){switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(Ph(i)))return}eh(r=n.createElement("link"),"link",e),Ge(r),n.head.appendChild(r)}}},X:function(e,t){_h.X(e,t);var n=xh;if(n&&e){var r=We(n).hoistableScripts,a=Oh(e),i=r.get(a);i||((i=n.querySelector(Ph(a)))||(e=f({src:e,async:!0},t),(t=Sh.get(a))&&Fh(e,t),Ge(i=n.createElement("script")),eh(i,"link",e),n.head.appendChild(i)),i={type:"script",instance:i,count:1,state:null},r.set(a,i))}},S:function(e,t,n){_h.S(e,t,n);var r=xh;if(r&&e){var a=We(r).hoistableStyles,i=Ah(e);t=t||"default";var s=a.get(i);if(!s){var o={loading:0,preload:null};if(s=r.querySelector(Nh(i)))o.loading=5;else{e=f({rel:"stylesheet",href:e,"data-precedence":t},n),(n=Sh.get(i))&&Mh(e,n);var l=s=r.createElement("link");Ge(l),eh(l,"link",e),l._p=new Promise(function(e,t){l.onload=e,l.onerror=t}),l.addEventListener("load",function(){o.loading|=1}),l.addEventListener("error",function(){o.loading|=2}),o.loading|=4,Lh(s,t,r)}s={type:"stylesheet",instance:s,count:1,state:o},a.set(i,s)}}},M:function(e,t){_h.M(e,t);var n=xh;if(n&&e){var r=We(n).hoistableScripts,a=Oh(e),i=r.get(a);i||((i=n.querySelector(Ph(a)))||(e=f({src:e,async:!0,type:"module"},t),(t=Sh.get(a))&&Fh(e,t),Ge(i=n.createElement("script")),eh(i,"link",e),n.head.appendChild(i)),i={type:"script",instance:i,count:1,state:null},r.set(a,i))}}};var xh="undefined"===typeof document?null:document;function Ch(e,t,n){var r=xh;if(r&&"string"===typeof t&&t){var a=mt(t);a='link[rel="'+e+'"][href="'+a+'"]',"string"===typeof n&&(a+='[crossorigin="'+n+'"]'),Eh.has(a)||(Eh.add(a),e={rel:e,crossOrigin:n,href:t},null===r.querySelector(a)&&(eh(t=r.createElement("link"),"link",e),Ge(t),r.head.appendChild(t)))}}function Ih(e,t,n,r){var a,i,o,l,c=(c=W.current)?kh(c):null;if(!c)throw Error(s(446));switch(e){case"meta":case"title":return null;case"style":return"string"===typeof n.precedence&&"string"===typeof n.href?(t=Ah(n.href),(r=(n=We(c).hoistableStyles).get(t))||(r={type:"style",instance:null,count:0,state:null},n.set(t,r)),r):{type:"void",instance:null,count:0,state:null};case"link":if("stylesheet"===n.rel&&"string"===typeof n.href&&"string"===typeof n.precedence){e=Ah(n.href);var u=We(c).hoistableStyles,h=u.get(e);if(h||(c=c.ownerDocument||c,h={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},u.set(e,h),(u=c.querySelector(Nh(e)))&&!u._p&&(h.instance=u,h.state.loading=5),Sh.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},Sh.set(e,n),u||(a=c,i=e,o=n,l=h.state,a.querySelector('link[rel="preload"][as="style"]['+i+"]")?l.loading=1:(i=a.createElement("link"),l.preload=i,i.addEventListener("load",function(){return l.loading|=1}),i.addEventListener("error",function(){return l.loading|=2}),eh(i,"link",o),Ge(i),a.head.appendChild(i))))),t&&null===r)throw Error(s(528,""));return h}if(t&&null!==r)throw Error(s(529,""));return null;case"script":return t=n.async,"string"===typeof(n=n.src)&&t&&"function"!==typeof t&&"symbol"!==typeof t?(t=Oh(n),(r=(n=We(c).hoistableScripts).get(t))||(r={type:"script",instance:null,count:0,state:null},n.set(t,r)),r):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,e))}}function Ah(e){return'href="'+mt(e)+'"'}function Nh(e){return'link[rel="stylesheet"]['+e+"]"}function Rh(e){return f({},e,{"data-precedence":e.precedence,precedence:null})}function Oh(e){return'[src="'+mt(e)+'"]'}function Ph(e){return"script[async]"+e}function Dh(e,t,n){if(t.count++,null===t.instance)switch(t.type){case"style":var r=e.querySelector('style[data-href~="'+mt(n.href)+'"]');if(r)return t.instance=r,Ge(r),r;var a=f({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return Ge(r=(e.ownerDocument||e).createElement("style")),eh(r,"style",a),Lh(r,n.precedence,e),t.instance=r;case"stylesheet":a=Ah(n.href);var i=e.querySelector(Nh(a));if(i)return t.state.loading|=4,t.instance=i,Ge(i),i;r=Rh(n),(a=Sh.get(a))&&Mh(r,a),Ge(i=(e.ownerDocument||e).createElement("link"));var o=i;return o._p=new Promise(function(e,t){o.onload=e,o.onerror=t}),eh(i,"link",r),t.state.loading|=4,Lh(i,n.precedence,e),t.instance=i;case"script":return i=Oh(n.src),(a=e.querySelector(Ph(i)))?(t.instance=a,Ge(a),a):(r=n,(a=Sh.get(i))&&Fh(r=f({},n),a),Ge(a=(e=e.ownerDocument||e).createElement("script")),eh(a,"link",r),e.head.appendChild(a),t.instance=a);case"void":return null;default:throw Error(s(443,t.type))}else"stylesheet"===t.type&&0===(4&t.state.loading)&&(r=t.instance,t.state.loading|=4,Lh(r,n.precedence,e));return t.instance}function Lh(e,t,n){for(var r=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),a=r.length?r[r.length-1]:null,i=a,s=0;s<r.length;s++){var o=r[s];if(o.dataset.precedence===t)i=o;else if(i!==a)break}i?i.parentNode.insertBefore(e,i.nextSibling):(t=9===n.nodeType?n.head:n).insertBefore(e,t.firstChild)}function Mh(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.title&&(e.title=t.title)}function Fh(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.integrity&&(e.integrity=t.integrity)}var Uh=null;function jh(e,t,n){if(null===Uh){var r=new Map,a=Uh=new Map;a.set(n,r)}else(r=(a=Uh).get(n))||(r=new Map,a.set(n,r));if(r.has(e))return r;for(r.set(e,null),n=n.getElementsByTagName(e),a=0;a<n.length;a++){var i=n[a];if(!(i[je]||i[Oe]||"link"===e&&"stylesheet"===i.getAttribute("rel"))&&"http://www.w3.org/2000/svg"!==i.namespaceURI){var s=i.getAttribute(t)||"";s=e+s;var o=r.get(s);o?o.push(i):r.set(s,[i])}}return r}function Vh(e,t,n){(e=e.ownerDocument||e).head.insertBefore(n,"title"===t?e.querySelector("head > title"):null)}function zh(e){return"stylesheet"!==e.type||0!==(3&e.state.loading)}var Bh=null;function Hh(){}function Wh(){if(this.count--,0===this.count)if(this.stylesheets)Kh(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}var Gh=null;function Kh(e,t){e.stylesheets=null,null!==e.unsuspend&&(e.count++,Gh=new Map,t.forEach(qh,e),Gh=null,Wh.call(e))}function qh(e,t){if(!(4&t.state.loading)){var n=Gh.get(e);if(n)var r=n.get(null);else{n=new Map,Gh.set(e,n);for(var a=e.querySelectorAll("link[data-precedence],style[data-precedence]"),i=0;i<a.length;i++){var s=a[i];"LINK"!==s.nodeName&&"not all"===s.getAttribute("media")||(n.set(s.dataset.precedence,s),r=s)}r&&n.set(null,r)}s=(a=t.instance).getAttribute("data-precedence"),(i=n.get(s)||r)===r&&n.set(null,a),n.set(s,a),this.count++,r=Wh.bind(this),a.addEventListener("load",r),a.addEventListener("error",r),i?i.parentNode.insertBefore(a,i.nextSibling):(e=9===e.nodeType?e.head:e).insertBefore(a,e.firstChild),t.state.loading|=4}}var $h={$$typeof:T,Provider:null,Consumer:null,_currentValue:M,_currentValue2:M,_threadCount:0};function Xh(e,t,n,r,a,i,s,o){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ke(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ke(0),this.hiddenUpdates=ke(null),this.identifierPrefix=r,this.onUncaughtError=a,this.onCaughtError=i,this.onRecoverableError=s,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=o,this.incompleteTransitions=new Map}function Yh(e,t,n,r,a,i,s,o,l,c,u,h){return e=new Xh(e,t,n,s,o,l,c,h),t=1,!0===i&&(t|=24),i=Mr(3,null,null,t),e.current=i,i.stateNode=e,(t=Pa()).refCount++,e.pooledCache=t,t.refCount++,i.memoizedState={element:r,isDehydrated:n,cache:t},ni(i),e}function Qh(e){return e?e=Dr:Dr}function Jh(e,t,n,r,a,i){a=Qh(a),null===r.context?r.context=a:r.pendingContext=a,(r=ai(t)).payload={element:n},null!==(i=void 0===i?null:i)&&(r.callback=i),null!==(n=ii(e,r,t))&&(Mc(n,0,t),si(n,e,t))}function Zh(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function ef(e,t){Zh(e,t),(e=e.alternate)&&Zh(e,t)}function tf(e){if(13===e.tag){var t=Rr(e,67108864);null!==t&&Mc(t,0,67108864),ef(e,67108864)}}var nf=!0;function rf(e,t,n,r){var a=D.T;D.T=null;var i=L.p;try{L.p=2,sf(e,t,n,r)}finally{L.p=i,D.T=a}}function af(e,t,n,r){var a=D.T;D.T=null;var i=L.p;try{L.p=8,sf(e,t,n,r)}finally{L.p=i,D.T=a}}function sf(e,t,n,r){if(nf){var a=of(r);if(null===a)Bu(e,t,r,lf,n),bf(e,r);else if(function(e,t,n,r,a){switch(t){case"focusin":return ff=wf(ff,e,t,n,r,a),!0;case"dragenter":return df=wf(df,e,t,n,r,a),!0;case"mouseover":return pf=wf(pf,e,t,n,r,a),!0;case"pointerover":var i=a.pointerId;return mf.set(i,wf(mf.get(i)||null,e,t,n,r,a)),!0;case"gotpointercapture":return i=a.pointerId,gf.set(i,wf(gf.get(i)||null,e,t,n,r,a)),!0}return!1}(a,e,t,n,r))r.stopPropagation();else if(bf(e,r),4&t&&-1<yf.indexOf(e)){for(;null!==a;){var i=Be(a);if(null!==i)switch(i.tag){case 3:if((i=i.stateNode).current.memoizedState.isDehydrated){var s=ye(i.pendingLanes);if(0!==s){var o=i;for(o.pendingLanes|=2,o.entangledLanes|=2;s;){var l=1<<31-de(s);o.entanglements[1]|=l,s&=~l}Su(i),0===(6&nc)&&(Sc=te()+500,Eu(0,!1))}}break;case 13:null!==(o=Rr(i,2))&&Mc(o,0,2),zc(),ef(i,2)}if(null===(i=of(r))&&Bu(e,t,r,lf,n),i===a)break;a=i}null!==a&&r.stopPropagation()}else Bu(e,t,r,null,n)}}function of(e){return cf(e=Rt(e))}var lf=null;function cf(e){if(lf=null,null!==(e=ze(e))){var t=l(e);if(null===t)e=null;else{var n=t.tag;if(13===n){if(null!==(e=c(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return lf=e,null}function uf(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ne()){case re:return 2;case ae:return 8;case ie:case se:return 32;case oe:return 268435456;default:return 32}default:return 32}}var hf=!1,ff=null,df=null,pf=null,mf=new Map,gf=new Map,vf=[],yf="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function bf(e,t){switch(e){case"focusin":case"focusout":ff=null;break;case"dragenter":case"dragleave":df=null;break;case"mouseover":case"mouseout":pf=null;break;case"pointerover":case"pointerout":mf.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":gf.delete(t.pointerId)}}function wf(e,t,n,r,a,i){return null===e||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[a]},null!==t&&(null!==(t=Be(t))&&tf(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function Tf(e){var t=ze(e.target);if(null!==t){var n=l(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=c(n)))return e.blockedOn=t,void function(e,t){var n=L.p;try{return L.p=e,t()}finally{L.p=n}}(e.priority,function(){if(13===n.tag){var e=Dc();e=Ie(e);var t=Rr(n,e);null!==t&&Mc(t,0,e),ef(n,e)}})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Sf(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=of(e.nativeEvent);if(null!==n)return null!==(t=Be(n))&&tf(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);Nt=r,n.target.dispatchEvent(r),Nt=null,t.shift()}return!0}function Ef(e,t,n){Sf(e)&&n.delete(t)}function kf(){hf=!1,null!==ff&&Sf(ff)&&(ff=null),null!==df&&Sf(df)&&(df=null),null!==pf&&Sf(pf)&&(pf=null),mf.forEach(Ef),gf.forEach(Ef)}function _f(e,t){e.blockedOn===t&&(e.blockedOn=null,hf||(hf=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,kf)))}var xf=null;function Cf(e){xf!==e&&(xf=e,r.unstable_scheduleCallback(r.unstable_NormalPriority,function(){xf===e&&(xf=null);for(var t=0;t<e.length;t+=3){var n=e[t],r=e[t+1],a=e[t+2];if("function"!==typeof r){if(null===cf(r||n))continue;break}var i=Be(n);null!==i&&(e.splice(t,3),t-=3,Ns(i,{pending:!0,data:a,method:n.method,action:r},r,a))}}))}function If(e){function t(t){return _f(t,e)}null!==ff&&_f(ff,e),null!==df&&_f(df,e),null!==pf&&_f(pf,e),mf.forEach(t),gf.forEach(t);for(var n=0;n<vf.length;n++){var r=vf[n];r.blockedOn===e&&(r.blockedOn=null)}for(;0<vf.length&&null===(n=vf[0]).blockedOn;)Tf(n),null===n.blockedOn&&vf.shift();if(null!=(n=(e.ownerDocument||e).$$reactFormReplay))for(r=0;r<n.length;r+=3){var a=n[r],i=n[r+1],s=a[Pe]||null;if("function"===typeof i)s||Cf(n);else if(s){var o=null;if(i&&i.hasAttribute("formAction")){if(a=i,s=i[Pe]||null)o=s.formAction;else if(null!==cf(a))continue}else o=s.action;"function"===typeof o?n[r+1]=o:(n.splice(r,3),r-=3),Cf(n)}}}function Af(e){this._internalRoot=e}function Nf(e){this._internalRoot=e}Nf.prototype.render=Af.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(s(409));Jh(t.current,Dc(),e,t,null,null)},Nf.prototype.unmount=Af.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;Jh(e.current,2,null,e,null,null),zc(),t[De]=null}},Nf.prototype.unstable_scheduleHydration=function(e){if(e){var t=Ne();e={blockedOn:null,target:e,priority:t};for(var n=0;n<vf.length&&0!==t&&t<vf[n].priority;n++);vf.splice(n,0,e),0===n&&Tf(e)}};var Rf=a.version;if("19.1.1"!==Rf)throw Error(s(527,Rf,"19.1.1"));L.findDOMNode=function(e){var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw e=Object.keys(e).join(","),Error(s(268,e))}return e=function(e){var t=e.alternate;if(!t){if(null===(t=l(e)))throw Error(s(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(null===a)break;var i=a.alternate;if(null===i){if(null!==(r=a.return)){n=r;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===n)return u(a),e;if(i===r)return u(a),t;i=i.sibling}throw Error(s(188))}if(n.return!==r.return)n=a,r=i;else{for(var o=!1,c=a.child;c;){if(c===n){o=!0,n=a,r=i;break}if(c===r){o=!0,r=a,n=i;break}c=c.sibling}if(!o){for(c=i.child;c;){if(c===n){o=!0,n=i,r=a;break}if(c===r){o=!0,r=i,n=a;break}c=c.sibling}if(!o)throw Error(s(189))}}if(n.alternate!==r)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?e:t}(t),e=null===(e=null!==e?h(e):null)?null:e.stateNode};var Of={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:D,reconcilerVersion:"19.1.1"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var Pf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Pf.isDisabled&&Pf.supportsFiber)try{ue=Pf.inject(Of),he=Pf}catch(Lf){}}t.createRoot=function(e,t){if(!o(e))throw Error(s(299));var n=!1,r="",a=yo,i=bo,l=wo;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onUncaughtError&&(a=t.onUncaughtError),void 0!==t.onCaughtError&&(i=t.onCaughtError),void 0!==t.onRecoverableError&&(l=t.onRecoverableError),void 0!==t.unstable_transitionCallbacks&&t.unstable_transitionCallbacks),t=Yh(e,1,!1,null,0,n,r,a,i,l,0,null),e[De]=t.current,Vu(e),new Af(t)},t.hydrateRoot=function(e,t,n){if(!o(e))throw Error(s(299));var r=!1,a="",i=yo,l=bo,c=wo,u=null;return null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(r=!0),void 0!==n.identifierPrefix&&(a=n.identifierPrefix),void 0!==n.onUncaughtError&&(i=n.onUncaughtError),void 0!==n.onCaughtError&&(l=n.onCaughtError),void 0!==n.onRecoverableError&&(c=n.onRecoverableError),void 0!==n.unstable_transitionCallbacks&&n.unstable_transitionCallbacks,void 0!==n.formState&&(u=n.formState)),(t=Yh(e,1,!0,t,0,r,a,i,l,c,0,u)).context=Qh(null),n=t.current,(a=ai(r=Ie(r=Dc()))).callback=null,ii(n,a,r),n=r,t.current.lanes=n,_e(t,n),Su(t),e[De]=t.current,Vu(e),new Nf(t)},t.version="19.1.1"},43:(e,t,n)=>{"use strict";e.exports=n(288)},288:(e,t)=>{"use strict";var n=Symbol.for("react.transitional.element"),r=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),d=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function v(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}function y(){}function b(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var w=b.prototype=new y;w.constructor=b,m(w,v.prototype),w.isPureReactComponent=!0;var T=Array.isArray,S={H:null,A:null,T:null,S:null,V:null},E=Object.prototype.hasOwnProperty;function k(e,t,r,a,i,s){return r=s.ref,{$$typeof:n,type:e,key:t,ref:void 0!==r?r:null,props:s}}function _(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var x=/\/+/g;function C(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function I(){}function A(e,t,a,i,s){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l,c,u=!1;if(null===e)u=!0;else switch(o){case"bigint":case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case n:case r:u=!0;break;case f:return A((u=e._init)(e._payload),t,a,i,s)}}if(u)return s=s(e),u=""===i?"."+C(e,0):i,T(s)?(a="",null!=u&&(a=u.replace(x,"$&/")+"/"),A(s,t,a,"",function(e){return e})):null!=s&&(_(s)&&(l=s,c=a+(null==s.key||e&&e.key===s.key?"":(""+s.key).replace(x,"$&/")+"/")+u,s=k(l.type,c,void 0,0,0,l.props)),t.push(s)),1;u=0;var h,p=""===i?".":i+":";if(T(e))for(var m=0;m<e.length;m++)u+=A(i=e[m],t,a,o=p+C(i,m),s);else if("function"===typeof(m=null===(h=e)||"object"!==typeof h?null:"function"===typeof(h=d&&h[d]||h["@@iterator"])?h:null))for(e=m.call(e),m=0;!(i=e.next()).done;)u+=A(i=i.value,t,a,o=p+C(i,m++),s);else if("object"===o){if("function"===typeof e.then)return A(function(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch("string"===typeof e.status?e.then(I,I):(e.status="pending",e.then(function(t){"pending"===e.status&&(e.status="fulfilled",e.value=t)},function(t){"pending"===e.status&&(e.status="rejected",e.reason=t)})),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}(e),t,a,i,s);throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.")}return u}function N(e,t,n){if(null==e)return e;var r=[],a=0;return A(e,r,"","",function(e){return t.call(n,e,a++)}),r}function R(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var O="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)};function P(){}t.Children={map:N,forEach:function(e,t,n){N(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return N(e,function(){t++}),t},toArray:function(e){return N(e,function(e){return e})||[]},only:function(e){if(!_(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=a,t.Profiler=s,t.PureComponent=b,t.StrictMode=i,t.Suspense=u,t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=S,t.__COMPILER_RUNTIME={__proto__:null,c:function(e){return S.H.useMemoCache(e)}},t.cache=function(e){return function(){return e.apply(null,arguments)}},t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error("The argument must be a React element, but you passed "+e+".");var r=m({},e.props),a=e.key;if(null!=t)for(i in void 0!==t.ref&&void 0,void 0!==t.key&&(a=""+t.key),t)!E.call(t,i)||"key"===i||"__self"===i||"__source"===i||"ref"===i&&void 0===t.ref||(r[i]=t[i]);var i=arguments.length-2;if(1===i)r.children=n;else if(1<i){for(var s=Array(i),o=0;o<i;o++)s[o]=arguments[o+2];r.children=s}return k(e.type,a,void 0,0,0,r)},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider=e,e.Consumer={$$typeof:o,_context:e},e},t.createElement=function(e,t,n){var r,a={},i=null;if(null!=t)for(r in void 0!==t.key&&(i=""+t.key),t)E.call(t,r)&&"key"!==r&&"__self"!==r&&"__source"!==r&&(a[r]=t[r]);var s=arguments.length-2;if(1===s)a.children=n;else if(1<s){for(var o=Array(s),l=0;l<s;l++)o[l]=arguments[l+2];a.children=o}if(e&&e.defaultProps)for(r in s=e.defaultProps)void 0===a[r]&&(a[r]=s[r]);return k(e,i,void 0,0,0,a)},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=_,t.lazy=function(e){return{$$typeof:f,_payload:{_status:-1,_result:e},_init:R}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=S.T,n={};S.T=n;try{var r=e(),a=S.S;null!==a&&a(n,r),"object"===typeof r&&null!==r&&"function"===typeof r.then&&r.then(P,O)}catch(i){O(i)}finally{S.T=t}},t.unstable_useCacheRefresh=function(){return S.H.useCacheRefresh()},t.use=function(e){return S.H.use(e)},t.useActionState=function(e,t,n){return S.H.useActionState(e,t,n)},t.useCallback=function(e,t){return S.H.useCallback(e,t)},t.useContext=function(e){return S.H.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e,t){return S.H.useDeferredValue(e,t)},t.useEffect=function(e,t,n){var r=S.H;if("function"===typeof n)throw Error("useEffect CRUD overload is not enabled in this build of React.");return r.useEffect(e,t)},t.useId=function(){return S.H.useId()},t.useImperativeHandle=function(e,t,n){return S.H.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return S.H.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return S.H.useLayoutEffect(e,t)},t.useMemo=function(e,t){return S.H.useMemo(e,t)},t.useOptimistic=function(e,t){return S.H.useOptimistic(e,t)},t.useReducer=function(e,t,n){return S.H.useReducer(e,t,n)},t.useRef=function(e){return S.H.useRef(e)},t.useState=function(e){return S.H.useState(e)},t.useSyncExternalStore=function(e,t,n){return S.H.useSyncExternalStore(e,t,n)},t.useTransition=function(){return S.H.useTransition()},t.version="19.1.1"},391:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(4)},579:(e,t,n)=>{"use strict";e.exports=n(799)},672:(e,t,n)=>{"use strict";var r=n(43);function a(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(){}var s={d:{f:i,r:function(){throw Error(a(522))},D:i,C:i,L:i,m:i,X:i,S:i,M:i},p:0,findDOMNode:null},o=Symbol.for("react.portal");var l=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(e,t){return"font"===e?"":"string"===typeof t?"use-credentials"===t?t:"":void 0}t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)throw Error(a(299));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:o,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.flushSync=function(e){var t=l.T,n=s.p;try{if(l.T=null,s.p=2,e)return e()}finally{l.T=t,s.p=n,s.d.f()}},t.preconnect=function(e,t){"string"===typeof e&&(t?t="string"===typeof(t=t.crossOrigin)?"use-credentials"===t?t:"":void 0:t=null,s.d.C(e,t))},t.prefetchDNS=function(e){"string"===typeof e&&s.d.D(e)},t.preinit=function(e,t){if("string"===typeof e&&t&&"string"===typeof t.as){var n=t.as,r=c(n,t.crossOrigin),a="string"===typeof t.integrity?t.integrity:void 0,i="string"===typeof t.fetchPriority?t.fetchPriority:void 0;"style"===n?s.d.S(e,"string"===typeof t.precedence?t.precedence:void 0,{crossOrigin:r,integrity:a,fetchPriority:i}):"script"===n&&s.d.X(e,{crossOrigin:r,integrity:a,fetchPriority:i,nonce:"string"===typeof t.nonce?t.nonce:void 0})}},t.preinitModule=function(e,t){if("string"===typeof e)if("object"===typeof t&&null!==t){if(null==t.as||"script"===t.as){var n=c(t.as,t.crossOrigin);s.d.M(e,{crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0})}}else null==t&&s.d.M(e)},t.preload=function(e,t){if("string"===typeof e&&"object"===typeof t&&null!==t&&"string"===typeof t.as){var n=t.as,r=c(n,t.crossOrigin);s.d.L(e,n,{crossOrigin:r,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0,type:"string"===typeof t.type?t.type:void 0,fetchPriority:"string"===typeof t.fetchPriority?t.fetchPriority:void 0,referrerPolicy:"string"===typeof t.referrerPolicy?t.referrerPolicy:void 0,imageSrcSet:"string"===typeof t.imageSrcSet?t.imageSrcSet:void 0,imageSizes:"string"===typeof t.imageSizes?t.imageSizes:void 0,media:"string"===typeof t.media?t.media:void 0})}},t.preloadModule=function(e,t){if("string"===typeof e)if(t){var n=c(t.as,t.crossOrigin);s.d.m(e,{as:"string"===typeof t.as&&"script"!==t.as?t.as:void 0,crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0})}else s.d.m(e)},t.requestFormReset=function(e){s.d.r(e)},t.unstable_batchedUpdates=function(e,t){return e(t)},t.useFormState=function(e,t,n){return l.H.useFormState(e,t,n)},t.useFormStatus=function(){return l.H.useHostTransitionStatus()},t.version="19.1.1"},736:(e,t,n)=>{"use strict";n.r(t),n.d(t,{compare:()=>f,compareSync:()=>h,decodeBase64:()=>L,default:()=>M,encodeBase64:()=>D,genSalt:()=>o,genSaltSync:()=>s,getRounds:()=>d,getSalt:()=>p,hash:()=>c,hashSync:()=>l,setRandomFallback:()=>i,truncates:()=>m});var r=n(825),a=null;function i(e){a=e}function s(e,t){if("number"!==typeof(e=e||E))throw Error("Illegal arguments: "+typeof e+", "+typeof t);e<4?e=4:e>31&&(e=31);var n=[];return n.push("$2b$"),e<10&&n.push("0"),n.push(e.toString()),n.push("$"),n.push(w(function(e){try{return crypto.getRandomValues(new Uint8Array(e))}catch(t){}try{return r.randomBytes(e)}catch(n){}if(!a)throw Error("Neither WebCryptoAPI nor a crypto module is available. Use bcrypt.setRandomFallback to set an alternative");return a(e)}(S),S)),n.join("")}function o(e,t,n){if("function"===typeof t&&(n=t,t=void 0),"function"===typeof e&&(n=e,e=void 0),"undefined"===typeof e)e=E;else if("number"!==typeof e)throw Error("illegal arguments: "+typeof e);function r(t){g(function(){try{t(null,s(e))}catch(n){t(n)}})}if(!n)return new Promise(function(e,t){r(function(n,r){n?t(n):e(r)})});if("function"!==typeof n)throw Error("Illegal callback: "+typeof n);r(n)}function l(e,t){if("undefined"===typeof t&&(t=E),"number"===typeof t&&(t=s(t)),"string"!==typeof e||"string"!==typeof t)throw Error("Illegal arguments: "+typeof e+", "+typeof t);return P(e,t)}function c(e,t,n,r){function a(n){"string"===typeof e&&"number"===typeof t?o(t,function(t,a){P(e,a,n,r)}):"string"===typeof e&&"string"===typeof t?P(e,t,n,r):g(n.bind(this,Error("Illegal arguments: "+typeof e+", "+typeof t)))}if(!n)return new Promise(function(e,t){a(function(n,r){n?t(n):e(r)})});if("function"!==typeof n)throw Error("Illegal callback: "+typeof n);a(n)}function u(e,t){for(var n=e.length^t.length,r=0;r<e.length;++r)n|=e.charCodeAt(r)^t.charCodeAt(r);return 0===n}function h(e,t){if("string"!==typeof e||"string"!==typeof t)throw Error("Illegal arguments: "+typeof e+", "+typeof t);return 60===t.length&&u(l(e,t.substring(0,t.length-31)),t)}function f(e,t,n,r){function a(n){"string"===typeof e&&"string"===typeof t?60===t.length?c(e,t.substring(0,29),function(e,r){e?n(e):n(null,u(r,t))},r):g(n.bind(this,null,!1)):g(n.bind(this,Error("Illegal arguments: "+typeof e+", "+typeof t)))}if(!n)return new Promise(function(e,t){a(function(n,r){n?t(n):e(r)})});if("function"!==typeof n)throw Error("Illegal callback: "+typeof n);a(n)}function d(e){if("string"!==typeof e)throw Error("Illegal arguments: "+typeof e);return parseInt(e.split("$")[2],10)}function p(e){if("string"!==typeof e)throw Error("Illegal arguments: "+typeof e);if(60!==e.length)throw Error("Illegal hash length: "+e.length+" != 60");return e.substring(0,29)}function m(e){if("string"!==typeof e)throw Error("Illegal arguments: "+typeof e);return v(e)>72}var g="undefined"!==typeof process&&process&&"function"===typeof process.nextTick?"function"===typeof setImmediate?setImmediate:process.nextTick:setTimeout;function v(e){for(var t=0,n=0,r=0;r<e.length;++r)(n=e.charCodeAt(r))<128?t+=1:n<2048?t+=2:55296===(64512&n)&&56320===(64512&e.charCodeAt(r+1))?(++r,t+=4):t+=3;return t}var y="./ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),b=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,54,55,56,57,58,59,60,61,62,63,-1,-1,-1,-1,-1,-1,-1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,-1,-1,-1,-1,-1,-1,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,-1,-1,-1,-1,-1];function w(e,t){var n,r,a=0,i=[];if(t<=0||t>e.length)throw Error("Illegal len: "+t);for(;a<t;){if(n=255&e[a++],i.push(y[n>>2&63]),n=(3&n)<<4,a>=t){i.push(y[63&n]);break}if(n|=(r=255&e[a++])>>4&15,i.push(y[63&n]),n=(15&r)<<2,a>=t){i.push(y[63&n]);break}n|=(r=255&e[a++])>>6&3,i.push(y[63&n]),i.push(y[63&r])}return i.join("")}function T(e,t){var n,r,a,i,s,o=0,l=e.length,c=0,u=[];if(t<=0)throw Error("Illegal len: "+t);for(;o<l-1&&c<t&&(n=(s=e.charCodeAt(o++))<b.length?b[s]:-1,r=(s=e.charCodeAt(o++))<b.length?b[s]:-1,-1!=n&&-1!=r)&&(i=n<<2>>>0,i|=(48&r)>>4,u.push(String.fromCharCode(i)),!(++c>=t||o>=l))&&-1!=(a=(s=e.charCodeAt(o++))<b.length?b[s]:-1)&&(i=(15&r)<<4>>>0,i|=(60&a)>>2,u.push(String.fromCharCode(i)),!(++c>=t||o>=l));)i=(3&a)<<6>>>0,i|=(s=e.charCodeAt(o++))<b.length?b[s]:-1,u.push(String.fromCharCode(i)),++c;var h=[];for(o=0;o<c;o++)h.push(u[o].charCodeAt(0));return h}var S=16,E=10,k=16,_=100,x=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],C=[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946,1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055,3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504,976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462],I=[1332899944,1700884034,1701343084,1684370003,1668446532,1869963892];function A(e,t,n,r){var a,i=e[t],s=e[t+1];return a=r[(i^=n[0])>>>24],a+=r[256|i>>16&255],a^=r[512|i>>8&255],a=r[(s^=(a+=r[768|255&i])^n[1])>>>24],a+=r[256|s>>16&255],a^=r[512|s>>8&255],a=r[(i^=(a+=r[768|255&s])^n[2])>>>24],a+=r[256|i>>16&255],a^=r[512|i>>8&255],a=r[(s^=(a+=r[768|255&i])^n[3])>>>24],a+=r[256|s>>16&255],a^=r[512|s>>8&255],a=r[(i^=(a+=r[768|255&s])^n[4])>>>24],a+=r[256|i>>16&255],a^=r[512|i>>8&255],a=r[(s^=(a+=r[768|255&i])^n[5])>>>24],a+=r[256|s>>16&255],a^=r[512|s>>8&255],a=r[(i^=(a+=r[768|255&s])^n[6])>>>24],a+=r[256|i>>16&255],a^=r[512|i>>8&255],a=r[(s^=(a+=r[768|255&i])^n[7])>>>24],a+=r[256|s>>16&255],a^=r[512|s>>8&255],a=r[(i^=(a+=r[768|255&s])^n[8])>>>24],a+=r[256|i>>16&255],a^=r[512|i>>8&255],a=r[(s^=(a+=r[768|255&i])^n[9])>>>24],a+=r[256|s>>16&255],a^=r[512|s>>8&255],a=r[(i^=(a+=r[768|255&s])^n[10])>>>24],a+=r[256|i>>16&255],a^=r[512|i>>8&255],a=r[(s^=(a+=r[768|255&i])^n[11])>>>24],a+=r[256|s>>16&255],a^=r[512|s>>8&255],a=r[(i^=(a+=r[768|255&s])^n[12])>>>24],a+=r[256|i>>16&255],a^=r[512|i>>8&255],a=r[(s^=(a+=r[768|255&i])^n[13])>>>24],a+=r[256|s>>16&255],a^=r[512|s>>8&255],a=r[(i^=(a+=r[768|255&s])^n[14])>>>24],a+=r[256|i>>16&255],a^=r[512|i>>8&255],a=r[(s^=(a+=r[768|255&i])^n[15])>>>24],a+=r[256|s>>16&255],a^=r[512|s>>8&255],i^=(a+=r[768|255&s])^n[16],e[t]=s^n[k+1],e[t+1]=i,e}function N(e,t){for(var n=0,r=0;n<4;++n)r=r<<8|255&e[t],t=(t+1)%e.length;return{key:r,offp:t}}function R(e,t,n){for(var r,a=0,i=[0,0],s=t.length,o=n.length,l=0;l<s;l++)a=(r=N(e,a)).offp,t[l]=t[l]^r.key;for(l=0;l<s;l+=2)i=A(i,0,t,n),t[l]=i[0],t[l+1]=i[1];for(l=0;l<o;l+=2)i=A(i,0,t,n),n[l]=i[0],n[l+1]=i[1]}function O(e,t,n,r,a){var i,s=I.slice(),o=s.length;if(n<4||n>31){if(i=Error("Illegal number of rounds (4-31): "+n),r)return void g(r.bind(this,i));throw i}if(t.length!==S){if(i=Error("Illegal salt length: "+t.length+" != "+S),r)return void g(r.bind(this,i));throw i}n=1<<n>>>0;var l,c,u,h=0;function f(){if(a&&a(h/n),!(h<n)){for(h=0;h<64;h++)for(u=0;u<o>>1;u++)A(s,u<<1,l,c);var i=[];for(h=0;h<o;h++)i.push((s[h]>>24&255)>>>0),i.push((s[h]>>16&255)>>>0),i.push((s[h]>>8&255)>>>0),i.push((255&s[h])>>>0);return r?void r(null,i):i}for(var d=Date.now();h<n&&(h+=1,R(e,l,c),R(t,l,c),!(Date.now()-d>_)););r&&g(f)}if("function"===typeof Int32Array?(l=new Int32Array(x),c=new Int32Array(C)):(l=x.slice(),c=C.slice()),function(e,t,n,r){for(var a,i=0,s=[0,0],o=n.length,l=r.length,c=0;c<o;c++)i=(a=N(t,i)).offp,n[c]=n[c]^a.key;for(i=0,c=0;c<o;c+=2)i=(a=N(e,i)).offp,s[0]^=a.key,i=(a=N(e,i)).offp,s[1]^=a.key,s=A(s,0,n,r),n[c]=s[0],n[c+1]=s[1];for(c=0;c<l;c+=2)i=(a=N(e,i)).offp,s[0]^=a.key,i=(a=N(e,i)).offp,s[1]^=a.key,s=A(s,0,n,r),r[c]=s[0],r[c+1]=s[1]}(t,e,l,c),"undefined"!==typeof r)f();else for(var d;;)if("undefined"!==typeof(d=f()))return d||[]}function P(e,t,n,r){var a,i,s;if("string"!==typeof e||"string"!==typeof t){if(a=Error("Invalid string / salt: Not a string"),n)return void g(n.bind(this,a));throw a}if("$"!==t.charAt(0)||"2"!==t.charAt(1)){if(a=Error("Invalid salt version: "+t.substring(0,2)),n)return void g(n.bind(this,a));throw a}if("$"===t.charAt(2))i=String.fromCharCode(0),s=3;else{if("a"!==(i=t.charAt(2))&&"b"!==i&&"y"!==i||"$"!==t.charAt(3)){if(a=Error("Invalid salt revision: "+t.substring(2,4)),n)return void g(n.bind(this,a));throw a}s=4}if(t.charAt(s+2)>"$"){if(a=Error("Missing salt rounds"),n)return void g(n.bind(this,a));throw a}var o=10*parseInt(t.substring(s,s+1),10)+parseInt(t.substring(s+1,s+2),10),l=t.substring(s+3,s+25),c=function(e){for(var t,n,r=0,a=new Array(v(e)),i=0,s=e.length;i<s;++i)(t=e.charCodeAt(i))<128?a[r++]=t:t<2048?(a[r++]=t>>6|192,a[r++]=63&t|128):55296===(64512&t)&&56320===(64512&(n=e.charCodeAt(i+1)))?(t=65536+((1023&t)<<10)+(1023&n),++i,a[r++]=t>>18|240,a[r++]=t>>12&63|128,a[r++]=t>>6&63|128,a[r++]=63&t|128):(a[r++]=t>>12|224,a[r++]=t>>6&63|128,a[r++]=63&t|128);return a}(e+=i>="a"?"\0":""),u=T(l,S);function h(e){var t=[];return t.push("$2"),i>="a"&&t.push(i),t.push("$"),o<10&&t.push("0"),t.push(o.toString()),t.push("$"),t.push(w(u,u.length)),t.push(w(e,4*I.length-1)),t.join("")}if("undefined"==typeof n)return h(O(c,u,o));O(c,u,o,function(e,t){e?n(e,null):n(null,h(t))},r)}function D(e,t){return w(e,t)}function L(e,t){return T(e,t)}const M={setRandomFallback:i,genSaltSync:s,genSalt:o,hashSync:l,hash:c,compareSync:h,compare:f,getRounds:d,getSalt:p,truncates:m,encodeBase64:D,decodeBase64:L}},799:(e,t)=>{"use strict";var n=Symbol.for("react.transitional.element"),r=Symbol.for("react.fragment");function a(e,t,r){var a=null;if(void 0!==r&&(a=""+r),void 0!==t.key&&(a=""+t.key),"key"in t)for(var i in r={},t)"key"!==i&&(r[i]=t[i]);else r=t;return t=r.ref,{$$typeof:n,type:e,key:a,ref:void 0!==t?t:null,props:r}}t.Fragment=r,t.jsx=a,t.jsxs=a},825:()=>{},853:(e,t,n)=>{"use strict";e.exports=n(896)},896:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,a=e[r];if(!(0<i(a,t)))break e;e[r]=t,e[n]=a,n=r}}function r(e){return 0===e.length?null:e[0]}function a(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,a=e.length,s=a>>>1;r<s;){var o=2*(r+1)-1,l=e[o],c=o+1,u=e[c];if(0>i(l,n))c<a&&0>i(u,l)?(e[r]=u,e[c]=n,r=c):(e[r]=l,e[o]=n,r=o);else{if(!(c<a&&0>i(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function i(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if(t.unstable_now=void 0,"object"===typeof performance&&"function"===typeof performance.now){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],h=1,f=null,d=3,p=!1,m=!1,g=!1,v=!1,y="function"===typeof setTimeout?setTimeout:null,b="function"===typeof clearTimeout?clearTimeout:null,w="undefined"!==typeof setImmediate?setImmediate:null;function T(e){for(var t=r(u);null!==t;){if(null===t.callback)a(u);else{if(!(t.startTime<=e))break;a(u),t.sortIndex=t.expirationTime,n(c,t)}t=r(u)}}function S(e){if(g=!1,T(e),!m)if(null!==r(c))m=!0,k||(k=!0,E());else{var t=r(u);null!==t&&O(S,t.startTime-e)}}var E,k=!1,_=-1,x=5,C=-1;function I(){return!!v||!(t.unstable_now()-C<x)}function A(){if(v=!1,k){var e=t.unstable_now();C=e;var n=!0;try{e:{m=!1,g&&(g=!1,b(_),_=-1),p=!0;var i=d;try{t:{for(T(e),f=r(c);null!==f&&!(f.expirationTime>e&&I());){var s=f.callback;if("function"===typeof s){f.callback=null,d=f.priorityLevel;var o=s(f.expirationTime<=e);if(e=t.unstable_now(),"function"===typeof o){f.callback=o,T(e),n=!0;break t}f===r(c)&&a(c),T(e)}else a(c);f=r(c)}if(null!==f)n=!0;else{var l=r(u);null!==l&&O(S,l.startTime-e),n=!1}}break e}finally{f=null,d=i,p=!1}n=void 0}}finally{n?E():k=!1}}}if("function"===typeof w)E=function(){w(A)};else if("undefined"!==typeof MessageChannel){var N=new MessageChannel,R=N.port2;N.port1.onmessage=A,E=function(){R.postMessage(null)}}else E=function(){y(A,0)};function O(e,n){_=y(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):x=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_next=function(e){switch(d){case 1:case 2:case 3:var t=3;break;default:t=d}var n=d;d=t;try{return e()}finally{d=n}},t.unstable_requestPaint=function(){v=!0},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=d;d=e;try{return t()}finally{d=n}},t.unstable_scheduleCallback=function(e,a,i){var s=t.unstable_now();switch("object"===typeof i&&null!==i?i="number"===typeof(i=i.delay)&&0<i?s+i:s:i=s,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:h++,callback:a,priorityLevel:e,startTime:i,expirationTime:o=i+o,sortIndex:-1},i>s?(e.sortIndex=i,n(u,e),null===r(c)&&e===r(u)&&(g?(b(_),_=-1):g=!0,O(S,i-s))):(e.sortIndex=o,n(c,e),m||p||(m=!0,k||(k=!0,E()))),e},t.unstable_shouldYield=I,t.unstable_wrapCallback=function(e){var t=d;return function(){var n=d;d=t;try{return e.apply(this,arguments)}finally{d=n}}}},950:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(672)}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}n.m=e,n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce((t,r)=>(n.f[r](e,t),t),[])),n.u=e=>"static/js/"+e+".5b07557f.chunk.js",n.miniCssF=e=>{},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="tool:";n.l=(r,a,i,s)=>{if(e[r])e[r].push(a);else{var o,l;if(void 0!==i)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var h=c[u];if(h.getAttribute("src")==r||h.getAttribute("data-webpack")==t+i){o=h;break}}o||(l=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,n.nc&&o.setAttribute("nonce",n.nc),o.setAttribute("data-webpack",t+i),o.src=r),e[r]=[a];var f=(t,n)=>{o.onerror=o.onload=null,clearTimeout(d);var a=e[r];if(delete e[r],o.parentNode&&o.parentNode.removeChild(o),a&&a.forEach(e=>e(n)),t)return t(n)},d=setTimeout(f.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=f.bind(null,o.onerror),o.onload=f.bind(null,o.onload),l&&document.head.appendChild(o)}}})(),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="/ingredients-tool/",(()=>{var e={792:0};n.f.j=(t,r)=>{var a=n.o(e,t)?e[t]:void 0;if(0!==a)if(a)r.push(a[2]);else{var i=new Promise((n,r)=>a=e[t]=[n,r]);r.push(a[2]=i);var s=n.p+n.u(t),o=new Error;n.l(s,r=>{if(n.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var i=r&&("load"===r.type?"missing":r.type),s=r&&r.target&&r.target.src;o.message="Loading chunk "+t+" failed.\n("+i+": "+s+")",o.name="ChunkLoadError",o.type=i,o.request=s,a[1](o)}},"chunk-"+t,t)}};var t=(t,r)=>{var a,i,s=r[0],o=r[1],l=r[2],c=0;if(s.some(t=>0!==e[t])){for(a in o)n.o(o,a)&&(n.m[a]=o[a]);if(l)l(n)}for(t&&t(r);c<s.length;c++)i=s[c],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0},r=self.webpackChunktool=self.webpackChunktool||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})(),(()=>{"use strict";var e=n(43),t=n(391);function r(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function i(e){var t=function(e,t){if("object"!=a(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==a(t)?t:t+""}function s(e,t,n){return(t=i(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach(function(t){s(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}const c=["sri"],u=["page"],h=["page","matches"],f=["onClick","discover","prefetch","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],d=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],p=["discover","fetcherKey","navigate","reloadDocument","replace","state","method","action","onSubmit","relative","preventScrollReset","viewTransition"];var m="popstate";function g(){return E(function(e,t){let{pathname:n="/",search:r="",hash:a=""}=S(e.location.hash.substring(1));return n.startsWith("/")||n.startsWith(".")||(n="/"+n),w("",{pathname:n,search:r,hash:a},t.state&&t.state.usr||null,t.state&&t.state.key||"default")},function(e,t){let n=e.document.querySelector("base"),r="";if(n&&n.getAttribute("href")){let t=e.location.href,n=t.indexOf("#");r=-1===n?t:t.slice(0,n)}return r+"#"+("string"===typeof t?t:T(t))},function(e,t){y("/"===e.pathname.charAt(0),"relative pathnames are not supported in hash history.push(".concat(JSON.stringify(t),")"))},arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}function v(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function y(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(n){}}}function b(e,t){return{usr:e.state,key:e.key,idx:t}}function w(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;return l(l({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?S(t):t),{},{state:n,key:t&&t.key||r||Math.random().toString(36).substring(2,10)})}function T(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),r&&"#"!==r&&(t+="#"===r.charAt(0)?r:"#"+r),t}function S(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substring(n),e=e.substring(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substring(r),e=e.substring(0,r)),e&&(t.pathname=e)}return t}function E(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},{window:a=document.defaultView,v5Compat:i=!1}=r,s=a.history,o="POP",c=null,u=h();function h(){return(s.state||{idx:null}).idx}function f(){o="POP";let e=h(),t=null==e?null:e-u;u=e,c&&c({action:o,location:p.location,delta:t})}function d(e){return k(e)}null==u&&(u=0,s.replaceState(l(l({},s.state),{},{idx:u}),""));let p={get action(){return o},get location(){return e(a,s)},listen(e){if(c)throw new Error("A history only accepts one active listener");return a.addEventListener(m,f),c=e,()=>{a.removeEventListener(m,f),c=null}},createHref:e=>t(a,e),createURL:d,encodeLocation(e){let t=d(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){o="PUSH";let r=w(p.location,e,t);n&&n(r,e),u=h()+1;let l=b(r,u),f=p.createHref(r);try{s.pushState(l,"",f)}catch(d){if(d instanceof DOMException&&"DataCloneError"===d.name)throw d;a.location.assign(f)}i&&c&&c({action:o,location:p.location,delta:1})},replace:function(e,t){o="REPLACE";let r=w(p.location,e,t);n&&n(r,e),u=h();let a=b(r,u),l=p.createHref(r);s.replaceState(a,"",l),i&&c&&c({action:o,location:p.location,delta:0})},go:e=>s.go(e)};return p}function k(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n="http://localhost";"undefined"!==typeof window&&(n="null"!==window.location.origin?window.location.origin:window.location.href),v(n,"No window.location.(origin|href) available to create URL");let r="string"===typeof e?e:T(e);return r=r.replace(/ $/,"%20"),!t&&r.startsWith("//")&&(r=n+r),new URL(r,n)}new WeakMap;function _(e,t){return x(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/",!1)}function x(e,t,n,r){let a=z(("string"===typeof t?S(t):t).pathname||"/",n);if(null==a)return null;let i=C(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every((e,n)=>e===t[n]);return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(i);let s=null;for(let o=0;null==s&&o<i.length;++o){let e=V(a);s=F(i[o],e,r)}return s}function C(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=function(e,i){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a,o=arguments.length>3?arguments[3]:void 0,l={relativePath:void 0===o?e.path||"":o,caseSensitive:!0===e.caseSensitive,childrenIndex:i,route:e};if(l.relativePath.startsWith("/")){if(!l.relativePath.startsWith(r)&&s)return;v(l.relativePath.startsWith(r),'Absolute route path "'.concat(l.relativePath,'" nested under path "').concat(r,'" is not valid. An absolute child route path must start with the combined path of all its parent routes.')),l.relativePath=l.relativePath.slice(r.length)}let c=K([r,l.relativePath]),u=n.concat(l);e.children&&e.children.length>0&&(v(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'.concat(c,'".')),C(e.children,t,u,c,s)),(null!=e.path||e.index)&&t.push({path:c,score:M(c,e.index),routesMeta:u})};return e.forEach((e,t)=>{var n;if(""!==e.path&&null!==(n=e.path)&&void 0!==n&&n.includes("?"))for(let r of I(e.path))i(e,t,!0,r);else i(e,t)}),t}function I(e){let t=e.split("/");if(0===t.length)return[];let[n,...r]=t,a=n.endsWith("?"),i=n.replace(/\?$/,"");if(0===r.length)return a?[i,""]:[i];let s=I(r.join("/")),o=[];return o.push(...s.map(e=>""===e?i:[i,e].join("/"))),a&&o.push(...s),o.map(t=>e.startsWith("/")&&""===t?"/":t)}var A=/^:[\w-]+$/,N=3,R=2,O=1,P=10,D=-2,L=e=>"*"===e;function M(e,t){let n=e.split("/"),r=n.length;return n.some(L)&&(r+=D),t&&(r+=R),n.filter(e=>!L(e)).reduce((e,t)=>e+(A.test(t)?N:""===t?O:P),r)}function F(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{routesMeta:r}=e,a={},i="/",s=[];for(let o=0;o<r.length;++o){let e=r[o],l=o===r.length-1,c="/"===i?t:t.slice(i.length)||"/",u=U({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},c),h=e.route;if(!u&&l&&n&&!r[r.length-1].route.index&&(u=U({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!u)return null;Object.assign(a,u.params),s.push({params:a,pathname:K([i,u.pathname]),pathnameBase:q(K([i,u.pathnameBase])),route:h}),"/"!==u.pathnameBase&&(i=K([i,u.pathnameBase]))}return s}function U(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=j(e.path,e.caseSensitive,e.end),a=t.match(n);if(!a)return null;let i=a[0],s=i.replace(/(.)\/+$/,"$1"),o=a.slice(1);return{params:r.reduce((e,t,n)=>{let{paramName:r,isOptional:a}=t;if("*"===r){let e=o[n]||"";s=i.slice(0,i.length-e.length).replace(/(.)\/+$/,"$1")}const l=o[n];return e[r]=a&&!l?void 0:(l||"").replace(/%2F/g,"/"),e},{}),pathname:i,pathnameBase:s,pattern:e}}function j(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];y("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'.concat(e,'" will be treated as if it were "').concat(e.replace(/\*$/,"/*"),'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "').concat(e.replace(/\*$/,"/*"),'".'));let r=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,n)=>(r.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(r.push({paramName:"*"}),a+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":""!==e&&"/"!==e&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),r]}function V(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(t){return y(!1,'The URL path "'.concat(e,'" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (').concat(t,").")),e}}function z(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&"/"!==r?null:e.slice(n)||"/"}function B(e,t,n,r){return"Cannot include a '".concat(e,"' character in a manually specified `to.").concat(t,"` field [").concat(JSON.stringify(r),"].  Please separate it out to the `to.").concat(n,'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.')}function H(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}function W(e){let t=H(e);return t.map((e,n)=>n===t.length-1?e.pathname:e.pathnameBase)}function G(e,t,n){let r,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];"string"===typeof e?r=S(e):(r=l({},e),v(!r.pathname||!r.pathname.includes("?"),B("?","pathname","search",r)),v(!r.pathname||!r.pathname.includes("#"),B("#","pathname","hash",r)),v(!r.search||!r.search.includes("#"),B("#","search","hash",r)));let i,s=""===e||""===r.pathname,o=s?"/":r.pathname;if(null==o)i=n;else{let e=t.length-1;if(!a&&o.startsWith("..")){let t=o.split("/");for(;".."===t[0];)t.shift(),e-=1;r.pathname=t.join("/")}i=e>=0?t[e]:"/"}let c=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/",{pathname:n,search:r="",hash:a=""}="string"===typeof e?S(e):e,i=n?n.startsWith("/")?n:function(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)}),n.length>1?n.join("/"):"/"}(n,t):t;return{pathname:i,search:X(r),hash:Y(a)}}(r,i),u=o&&"/"!==o&&o.endsWith("/"),h=(s||"."===o)&&n.endsWith("/");return c.pathname.endsWith("/")||!u&&!h||(c.pathname+="/"),c}var K=e=>e.join("/").replace(/\/\/+/g,"/"),q=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),X=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",Y=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";function Q(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}var J=["POST","PUT","PATCH","DELETE"],Z=(new Set(J),["GET",...J]);new Set(Z),Symbol("ResetLoaderData");var ee=e.createContext(null);ee.displayName="DataRouter";var te=e.createContext(null);te.displayName="DataRouterState";var ne=e.createContext(!1);var re=e.createContext({isTransitioning:!1});re.displayName="ViewTransition";var ae=e.createContext(new Map);ae.displayName="Fetchers";var ie=e.createContext(null);ie.displayName="Await";var se=e.createContext(null);se.displayName="Navigation";var oe=e.createContext(null);oe.displayName="Location";var le=e.createContext({outlet:null,matches:[],isDataRoute:!1});le.displayName="Route";var ce=e.createContext(null);ce.displayName="RouteError";function ue(){return null!=e.useContext(oe)}function he(){return v(ue(),"useLocation() may be used only in the context of a <Router> component."),e.useContext(oe).location}var fe="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function de(t){e.useContext(se).static||e.useLayoutEffect(t)}function pe(){let{isDataRoute:t}=e.useContext(le);return t?function(){let{router:t}=Ee("useNavigate"),n=_e("useNavigate"),r=e.useRef(!1);de(()=>{r.current=!0});let a=e.useCallback(async function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};y(r.current,fe),r.current&&("number"===typeof e?t.navigate(e):await t.navigate(e,l({fromRouteId:n},a)))},[t,n]);return a}():function(){v(ue(),"useNavigate() may be used only in the context of a <Router> component.");let t=e.useContext(ee),{basename:n,navigator:r}=e.useContext(se),{matches:a}=e.useContext(le),{pathname:i}=he(),s=JSON.stringify(W(a)),o=e.useRef(!1);de(()=>{o.current=!0});let l=e.useCallback(function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(y(o.current,fe),!o.current)return;if("number"===typeof e)return void r.go(e);let l=G(e,JSON.parse(s),i,"path"===a.relative);null==t&&"/"!==n&&(l.pathname="/"===l.pathname?n:K([n,l.pathname])),(a.replace?r.replace:r.push)(l,a.state,a)},[n,r,s,i,t]);return l}()}e.createContext(null);function me(t){let{relative:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{matches:r}=e.useContext(le),{pathname:a}=he(),i=JSON.stringify(W(r));return e.useMemo(()=>G(t,JSON.parse(i),a,"path"===n),[t,i,a,n])}function ge(t,n,r,a,i){v(ue(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s}=e.useContext(se),{matches:o}=e.useContext(le),c=o[o.length-1],u=c?c.params:{},h=c?c.pathname:"/",f=c?c.pathnameBase:"/",d=c&&c.route;{let e=d&&d.path||"";Ie(h,!d||e.endsWith("*")||e.endsWith("*?"),'You rendered descendant <Routes> (or called `useRoutes()`) at "'.concat(h,'" (under <Route path="').concat(e,'">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won\'t match anymore and therefore the child routes will never render.\n\nPlease change the parent <Route path="').concat(e,'"> to <Route path="').concat("/"===e?"*":"".concat(e,"/*"),'">.'))}let p,m=he();if(n){var g;let e="string"===typeof n?S(n):n;v("/"===f||(null===(g=e.pathname)||void 0===g?void 0:g.startsWith(f)),'When overriding the location using `<Routes location>` or `useRoutes(routes, location)`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "'.concat(f,'" but pathname "').concat(e.pathname,'" was given in the `location` prop.')),p=e}else p=m;let b=p.pathname||"/",w=b;if("/"!==f){let e=f.replace(/^\//,"").split("/");w="/"+b.replace(/^\//,"").split("/").slice(e.length).join("/")}let T=_(t,{pathname:w});y(d||null!=T,'No routes matched location "'.concat(p.pathname).concat(p.search).concat(p.hash,'" ')),y(null==T||void 0!==T[T.length-1].route.element||void 0!==T[T.length-1].route.Component||void 0!==T[T.length-1].route.lazy,'Matched leaf route at location "'.concat(p.pathname).concat(p.search).concat(p.hash,'" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.'));let E=Te(T&&T.map(e=>Object.assign({},e,{params:Object.assign({},u,e.params),pathname:K([f,s.encodeLocation?s.encodeLocation(e.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?f:K([f,s.encodeLocation?s.encodeLocation(e.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:e.pathnameBase])})),o,r,a,i);return n&&E?e.createElement(oe.Provider,{value:{location:l({pathname:"/",search:"",hash:"",state:null,key:"default"},p),navigationType:"POP"}},E):E}function ve(){let t=xe(),n=Q(t)?"".concat(t.status," ").concat(t.statusText):t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,a="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:a},s={padding:"2px 4px",backgroundColor:a},o=null;return console.error("Error handled by React Router default ErrorBoundary:",t),o=e.createElement(e.Fragment,null,e.createElement("p",null,"\ud83d\udcbf Hey developer \ud83d\udc4b"),e.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",e.createElement("code",{style:s},"ErrorBoundary")," or"," ",e.createElement("code",{style:s},"errorElement")," prop on your route.")),e.createElement(e.Fragment,null,e.createElement("h2",null,"Unexpected Application Error!"),e.createElement("h3",{style:{fontStyle:"italic"}},n),r?e.createElement("pre",{style:i},r):null,o)}var ye=e.createElement(ve,null),be=class extends e.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.unstable_onError?this.props.unstable_onError(e,t):console.error("React Router caught the following error during render",e)}render(){return void 0!==this.state.error?e.createElement(le.Provider,{value:this.props.routeContext},e.createElement(ce.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function we(t){let{routeContext:n,match:r,children:a}=t,i=e.useContext(ee);return i&&i.static&&i.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=r.route.id),e.createElement(le.Provider,{value:n},a)}function Te(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(null==t){if(!r)return null;if(r.errors)t=r.matches;else{if(0!==n.length||r.initialized||!(r.matches.length>0))return null;t=r.matches}}let i=t,s=null===r||void 0===r?void 0:r.errors;if(null!=s){let e=i.findIndex(e=>e.route.id&&void 0!==(null===s||void 0===s?void 0:s[e.route.id]));v(e>=0,"Could not find a matching route for errors on route IDs: ".concat(Object.keys(s).join(","))),i=i.slice(0,Math.min(i.length,e+1))}let o=!1,l=-1;if(r)for(let e=0;e<i.length;e++){let t=i[e];if((t.route.HydrateFallback||t.route.hydrateFallbackElement)&&(l=e),t.route.id){let{loaderData:e,errors:n}=r,a=t.route.loader&&!e.hasOwnProperty(t.route.id)&&(!n||void 0===n[t.route.id]);if(t.route.lazy||a){o=!0,i=l>=0?i.slice(0,l+1):[i[0]];break}}}return i.reduceRight((t,c,u)=>{let h,f=!1,d=null,p=null;r&&(h=s&&c.route.id?s[c.route.id]:void 0,d=c.route.errorElement||ye,o&&(l<0&&0===u?(Ie("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),f=!0,p=null):l===u&&(f=!0,p=c.route.hydrateFallbackElement||null)));let m=n.concat(i.slice(0,u+1)),g=()=>{let n;return n=h?d:f?p:c.route.Component?e.createElement(c.route.Component,null):c.route.element?c.route.element:t,e.createElement(we,{match:c,routeContext:{outlet:t,matches:m,isDataRoute:null!=r},children:n})};return r&&(c.route.ErrorBoundary||c.route.errorElement||0===u)?e.createElement(be,{location:r.location,revalidation:r.revalidation,component:d,error:h,children:g(),routeContext:{outlet:null,matches:m,isDataRoute:!0},unstable_onError:a}):g()},null)}function Se(e){return"".concat(e," must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.")}function Ee(t){let n=e.useContext(ee);return v(n,Se(t)),n}function ke(t){let n=e.useContext(te);return v(n,Se(t)),n}function _e(t){let n=function(t){let n=e.useContext(le);return v(n,Se(t)),n}(t),r=n.matches[n.matches.length-1];return v(r.route.id,"".concat(t,' can only be used on routes that contain a unique "id"')),r.route.id}function xe(){var t;let n=e.useContext(ce),r=ke("useRouteError"),a=_e("useRouteError");return void 0!==n?n:null===(t=r.errors)||void 0===t?void 0:t[a]}var Ce={};function Ie(e,t,n){t||Ce[e]||(Ce[e]=!0,y(!1,n))}var Ae={};function Ne(e,t){e||Ae[t]||(Ae[t]=!0,console.warn(t))}e.memo(function(e){let{routes:t,future:n,state:r,unstable_onError:a}=e;return ge(t,void 0,r,a,n)});function Re(t){let{to:n,replace:r,state:a,relative:i}=t;v(ue(),"<Navigate> may be used only in the context of a <Router> component.");let{static:s}=e.useContext(se);y(!s,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:o}=e.useContext(le),{pathname:l}=he(),c=pe(),u=G(n,W(o),l,"path"===i),h=JSON.stringify(u);return e.useEffect(()=>{c(JSON.parse(h),{replace:r,state:a,relative:i})},[c,h,i,r,a]),null}function Oe(e){v(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Pe(t){let{basename:n="/",children:r=null,location:a,navigationType:i="POP",navigator:s,static:o=!1}=t;v(!ue(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=n.replace(/^\/*/,"/"),c=e.useMemo(()=>({basename:l,navigator:s,static:o,future:{}}),[l,s,o]);"string"===typeof a&&(a=S(a));let{pathname:u="/",search:h="",hash:f="",state:d=null,key:p="default"}=a,m=e.useMemo(()=>{let e=z(u,l);return null==e?null:{location:{pathname:e,search:h,hash:f,state:d,key:p},navigationType:i}},[l,u,h,f,d,p,i]);return y(null!=m,'<Router basename="'.concat(l,'"> is not able to match the URL "').concat(u).concat(h).concat(f,"\" because it does not start with the basename, so the <Router> won't render anything.")),null==m?null:e.createElement(se.Provider,{value:c},e.createElement(oe.Provider,{children:r,value:m}))}function De(e){let{children:t,location:n}=e;return ge(Le(t),n)}e.Component;function Le(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=[];return e.Children.forEach(t,(t,a)=>{if(!e.isValidElement(t))return;let i=[...n,a];if(t.type===e.Fragment)return void r.push.apply(r,Le(t.props.children,i));v(t.type===Oe,"[".concat("string"===typeof t.type?t.type:t.type.name,"] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>")),v(!t.props.index||!t.props.children,"An index route cannot have child routes.");let s={id:t.props.id||i.join("-"),caseSensitive:t.props.caseSensitive,element:t.props.element,Component:t.props.Component,index:t.props.index,path:t.props.path,middleware:t.props.middleware,loader:t.props.loader,action:t.props.action,hydrateFallbackElement:t.props.hydrateFallbackElement,HydrateFallback:t.props.HydrateFallback,errorElement:t.props.errorElement,ErrorBoundary:t.props.ErrorBoundary,hasErrorBoundary:!0===t.props.hasErrorBoundary||null!=t.props.ErrorBoundary||null!=t.props.errorElement,shouldRevalidate:t.props.shouldRevalidate,handle:t.props.handle,lazy:t.props.lazy};t.props.children&&(s.children=Le(t.props.children,i)),r.push(s)}),r}var Me="get",Fe="application/x-www-form-urlencoded";function Ue(e){return null!=e&&"string"===typeof e.tagName}var je=null;var Ve=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function ze(e){return null==e||Ve.has(e)?e:(y(!1,'"'.concat(e,'" is not a valid `encType` for `<Form>`/`<fetcher.Form>` and will default to "').concat(Fe,'"')),null)}function Be(e,t){let n,r,a,i,s;if(Ue(o=e)&&"form"===o.tagName.toLowerCase()){let s=e.getAttribute("action");r=s?z(s,t):null,n=e.getAttribute("method")||Me,a=ze(e.getAttribute("enctype"))||Fe,i=new FormData(e)}else if(function(e){return Ue(e)&&"button"===e.tagName.toLowerCase()}(e)||function(e){return Ue(e)&&"input"===e.tagName.toLowerCase()}(e)&&("submit"===e.type||"image"===e.type)){let s=e.form;if(null==s)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let o=e.getAttribute("formaction")||s.getAttribute("action");if(r=o?z(o,t):null,n=e.getAttribute("formmethod")||s.getAttribute("method")||Me,a=ze(e.getAttribute("formenctype"))||ze(s.getAttribute("enctype"))||Fe,i=new FormData(s,e),!function(){if(null===je)try{new FormData(document.createElement("form"),0),je=!1}catch(e){je=!0}return je}()){let{name:t,type:n,value:r}=e;if("image"===n){let e=t?"".concat(t,"."):"";i.append("".concat(e,"x"),"0"),i.append("".concat(e,"y"),"0")}else t&&i.append(t,r)}}else{if(Ue(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=Me,r=null,a=Fe,s=e}var o;return i&&"text/plain"===a&&(s=i,i=void 0),{action:r,method:n.toLowerCase(),encType:a,formData:i,body:s}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");"undefined"!==typeof window?window:"undefined"!==typeof globalThis&&globalThis;function He(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}Symbol("SingleFetchRedirect");function We(e,t,n){let r="string"===typeof e?new URL(e,"undefined"===typeof window?"server://singlefetch/":window.location.origin):e;return"/"===r.pathname?r.pathname="_root.".concat(n):t&&"/"===z(r.pathname,t)?r.pathname="".concat(t.replace(/\/$/,""),"/_root.").concat(n):r.pathname="".concat(r.pathname.replace(/\/$/,""),".").concat(n),r}async function Ge(e,t){if(e.id in t)return t[e.id];try{let n=await import(e.module);return t[e.id]=n,n}catch(n){return console.error("Error loading route module `".concat(e.module,"`, reloading page...")),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Ke(e){return null!=e&&"string"===typeof e.page}function qe(e){return null!=e&&(null==e.href?"preload"===e.rel&&"string"===typeof e.imageSrcSet&&"string"===typeof e.imageSizes:"string"===typeof e.rel&&"string"===typeof e.href)}function $e(e,t,n,r,a,i){let s=(e,t)=>!n[t]||e.route.id!==n[t].route.id,o=(e,t)=>{var r;return n[t].pathname!==e.pathname||(null===(r=n[t].route.path)||void 0===r?void 0:r.endsWith("*"))&&n[t].params["*"]!==e.params["*"]};return"assets"===i?t.filter((e,t)=>s(e,t)||o(e,t)):"data"===i?t.filter((t,i)=>{let l=r.routes[t.route.id];if(!l||!l.hasLoader)return!1;if(s(t,i)||o(t,i))return!0;if(t.route.shouldRevalidate){var c;let r=t.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:(null===(c=n[0])||void 0===c?void 0:c.params)||{},nextUrl:new URL(e,window.origin),nextParams:t.params,defaultShouldRevalidate:!0});if("boolean"===typeof r)return r}return!0}):[]}function Xe(e,t){let{includeHydrateFallback:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r=e.map(e=>{let r=t.routes[e.route.id];if(!r)return[];let a=[r.module];return r.clientActionModule&&(a=a.concat(r.clientActionModule)),r.clientLoaderModule&&(a=a.concat(r.clientLoaderModule)),n&&r.hydrateFallbackModule&&(a=a.concat(r.hydrateFallbackModule)),r.imports&&(a=a.concat(r.imports)),a}).flat(1),[...new Set(r)];var r}function Ye(e,t){let n=new Set,r=new Set(t);return e.reduce((e,a)=>{if(t&&!Ke(a)&&"script"===a.as&&a.href&&r.has(a.href))return e;let i=JSON.stringify(function(e){let t={},n=Object.keys(e).sort();for(let r of n)t[r]=e[r];return t}(a));return n.has(i)||(n.add(i),e.push({key:i,link:a})),e},[])}function Qe(e,t){return"lazy"===e.mode&&!0===t}function Je(){let t=e.useContext(ee);return He(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function Ze(){let t=e.useContext(te);return He(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var et=e.createContext(void 0);function tt(){let t=e.useContext(et);return He(t,"You must render this element inside a <HydratedRouter> element"),t}function nt(e,t){return n=>{e&&e(n),n.defaultPrevented||t(n)}}function rt(e,t,n){if(n&&!ot)return[e[0]];if(t){let n=e.findIndex(e=>void 0!==t[e.route.id]);return e.slice(0,n+1)}return e}et.displayName="FrameworkContext";function at(t){let{page:n}=t,a=r(t,u),{router:i}=Je(),s=e.useMemo(()=>_(i.routes,n,i.basename),[i.routes,n,i.basename]);return s?e.createElement(st,l({page:n,matches:s},a)):null}function it(t){let{manifest:n,routeModules:r}=tt(),[a,i]=e.useState([]);return e.useEffect(()=>{let e=!1;return async function(e,t,n){return Ye((await Promise.all(e.map(async e=>{let r=t.routes[e.route.id];if(r){let e=await Ge(r,n);return e.links?e.links():[]}return[]}))).flat(1).filter(qe).filter(e=>"stylesheet"===e.rel||"preload"===e.rel).map(e=>"stylesheet"===e.rel?l(l({},e),{},{rel:"prefetch",as:"style"}):l(l({},e),{},{rel:"prefetch"})))}(t,n,r).then(t=>{e||i(t)}),()=>{e=!0}},[t,n,r]),a}function st(t){let{page:n,matches:a}=t,i=r(t,h),s=he(),{manifest:o,routeModules:c}=tt(),{basename:u}=Je(),{loaderData:f,matches:d}=Ze(),p=e.useMemo(()=>$e(n,a,d,o,s,"data"),[n,a,d,o,s]),m=e.useMemo(()=>$e(n,a,d,o,s,"assets"),[n,a,d,o,s]),g=e.useMemo(()=>{if(n===s.pathname+s.search+s.hash)return[];let e=new Set,t=!1;if(a.forEach(n=>{var r;let a=o.routes[n.route.id];a&&a.hasLoader&&(!p.some(e=>e.route.id===n.route.id)&&n.route.id in f&&null!==(r=c[n.route.id])&&void 0!==r&&r.shouldRevalidate||a.hasClientLoader?t=!0:e.add(n.route.id))}),0===e.size)return[];let r=We(n,u,"data");return t&&e.size>0&&r.searchParams.set("_routes",a.filter(t=>e.has(t.route.id)).map(e=>e.route.id).join(",")),[r.pathname+r.search]},[u,f,s,o,p,a,n,c]),v=e.useMemo(()=>Xe(m,o),[m,o]),y=it(m);return e.createElement(e.Fragment,null,g.map(t=>e.createElement("link",l({key:t,rel:"prefetch",as:"fetch",href:t},i))),v.map(t=>e.createElement("link",l({key:t,rel:"modulepreload",href:t},i))),y.map(t=>{let{key:n,link:r}=t;return e.createElement("link",l({key:n,nonce:i.nonce},r))}))}var ot=!1;function lt(t){let{manifest:n,serverHandoffString:a,isSpaMode:i,renderMeta:s,routeDiscovery:o,ssr:u}=tt(),{router:h,static:f,staticContext:d}=Je(),{matches:p}=Ze(),m=e.useContext(ne),g=Qe(o,u);s&&(s.didRenderScripts=!0);let v=rt(p,null,i);e.useEffect(()=>{0},[]);let y=e.useMemo(()=>{var i;if(m)return null;let s=d?"window.__reactRouterContext = ".concat(a,";").concat("window.__reactRouterContext.stream = new ReadableStream({start(controller){window.__reactRouterContext.streamController = controller;}}).pipeThrough(new TextEncoderStream());"):" ",o=f?"".concat(null!==n.hmr&&void 0!==i&&i.runtime?"import ".concat(JSON.stringify(n.hmr.runtime),";"):"").concat(g?"":"import ".concat(JSON.stringify(n.url)),";\n").concat(v.map((e,t)=>{let r="route".concat(t),a=n.routes[e.route.id];He(a,"Route ".concat(e.route.id," not found in manifest"));let{clientActionModule:i,clientLoaderModule:s,clientMiddlewareModule:o,hydrateFallbackModule:l,module:c}=a,u=[...i?[{module:i,varName:"".concat(r,"_clientAction")}]:[],...s?[{module:s,varName:"".concat(r,"_clientLoader")}]:[],...o?[{module:o,varName:"".concat(r,"_clientMiddleware")}]:[],...l?[{module:l,varName:"".concat(r,"_HydrateFallback")}]:[],{module:c,varName:"".concat(r,"_main")}];return 1===u.length?"import * as ".concat(r," from ").concat(JSON.stringify(c),";"):[u.map(e=>"import * as ".concat(e.varName,' from "').concat(e.module,'";')).join("\n"),"const ".concat(r," = {").concat(u.map(e=>"...".concat(e.varName)).join(","),"};")].join("\n")}).join("\n"),"\n  ").concat(g?"window.__reactRouterManifest = ".concat(JSON.stringify(function(e,t){let{sri:n}=e,a=r(e,c),i=new Set(t.state.matches.map(e=>e.route.id)),s=t.state.location.pathname.split("/").filter(Boolean),o=["/"];for(s.pop();s.length>0;)o.push("/".concat(s.join("/"))),s.pop();o.forEach(e=>{let n=_(t.routes,e,t.basename);n&&n.forEach(e=>i.add(e.route.id))});let u=[...i].reduce((e,t)=>Object.assign(e,{[t]:a.routes[t]}),{});return l(l({},a),{},{routes:u,sri:!!n||void 0})}(n,h),null,2),";"):"","\n  window.__reactRouterRouteModules = {").concat(v.map((e,t)=>"".concat(JSON.stringify(e.route.id),":route").concat(t)).join(","),"};\n\nimport(").concat(JSON.stringify(n.entry.module),");"):" ";return e.createElement(e.Fragment,null,e.createElement("script",l(l({},t),{},{suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:s},type:void 0})),e.createElement("script",l(l({},t),{},{suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:o},type:"module",async:!0})))},[]),b=ot||m?[]:(n.entry.imports.concat(Xe(v,n,{includeHydrateFallback:!0})),[...new Set(w)]);var w;let T="object"===typeof n.sri?n.sri:{};return Ne(!m,"The <Scripts /> element is a no-op when using RSC and can be safely removed."),ot||m?null:e.createElement(e.Fragment,null,"object"===typeof n.sri?e.createElement("script",{"rr-importmap":"",type:"importmap",suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:JSON.stringify({integrity:T})}}):null,g?null:e.createElement("link",{rel:"modulepreload",href:n.url,crossOrigin:t.crossOrigin,integrity:T[n.url],suppressHydrationWarning:!0}),e.createElement("link",{rel:"modulepreload",href:n.entry.module,crossOrigin:t.crossOrigin,integrity:T[n.entry.module],suppressHydrationWarning:!0}),b.map(n=>e.createElement("link",{key:n,rel:"modulepreload",href:n,crossOrigin:t.crossOrigin,integrity:T[n],suppressHydrationWarning:!0})),y)}function ct(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return e=>{t.forEach(t=>{"function"===typeof t?t(e):null!=t&&(t.current=e)})}}e.Component;function ut(t){let{error:n,isOutsideRemixApp:r}=t;console.error(n);let a,i=e.createElement("script",{dangerouslySetInnerHTML:{__html:'\n        console.log(\n          "\ud83d\udcbf Hey developer \ud83d\udc4b. You can provide a way better UX than this when your app throws errors. Check out https://reactrouter.com/how-to/error-boundary for more information."\n        );\n      '}});if(Q(n))return e.createElement(ht,{title:"Unhandled Thrown Response!"},e.createElement("h1",{style:{fontSize:"24px"}},n.status," ",n.statusText),i);if(n instanceof Error)0;else{let e=null==n?"Unknown Error":"object"===typeof n&&"toString"in n?n.toString():JSON.stringify(n);new Error(e)}return e.createElement(ht,{title:"Application Error!",isOutsideRemixApp:r},e.createElement("h1",{style:{fontSize:"24px"}},"Application Error"),e.createElement("pre",{style:{padding:"2rem",background:"hsla(10, 50%, 50%, 0.1)",color:"red",overflow:"auto"}},a.stack),i)}function ht(t){var n;let{title:r,renderScripts:a,isOutsideRemixApp:i,children:s}=t,{routeModules:o}=tt();return null!==o.root&&void 0!==n&&n.Layout&&!i?s:e.createElement("html",{lang:"en"},e.createElement("head",null,e.createElement("meta",{charSet:"utf-8"}),e.createElement("meta",{name:"viewport",content:"width=device-width,initial-scale=1,viewport-fit=cover"}),e.createElement("title",null,r)),e.createElement("body",null,e.createElement("main",{style:{fontFamily:"system-ui, sans-serif",padding:"2rem"}},s,a?e.createElement(lt,null):null)))}var ft="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement;try{ft&&(window.__reactRouterVersion="7.9.2")}catch(AR){}function dt(t){let{basename:n,children:r,window:a}=t,i=e.useRef();null==i.current&&(i.current=g({window:a,v5Compat:!0}));let s=i.current,[o,l]=e.useState({action:s.action,location:s.location}),c=e.useCallback(t=>{e.startTransition(()=>l(t))},[l]);return e.useLayoutEffect(()=>s.listen(c),[s,c]),e.createElement(Pe,{basename:n,children:r,location:o.location,navigationType:o.action,navigator:s})}var pt=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,mt=e.forwardRef(function(t,n){let a,{onClick:i,discover:s="render",prefetch:o="none",relative:c,reloadDocument:u,replace:h,state:d,target:p,to:m,preventScrollReset:g,viewTransition:b}=t,w=r(t,f),{basename:S}=e.useContext(se),E="string"===typeof m&&pt.test(m),k=!1;if("string"===typeof m&&E&&(a=m,ft))try{let e=new URL(window.location.href),t=m.startsWith("//")?new URL(e.protocol+m):new URL(m),n=z(t.pathname,S);t.origin===e.origin&&null!=n?m=n+t.search+t.hash:k=!0}catch(AR){y(!1,'<Link to="'.concat(m,'"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.'))}let _=function(t){let{relative:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};v(ue(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:a}=e.useContext(se),{hash:i,pathname:s,search:o}=me(t,{relative:n}),l=s;return"/"!==r&&(l="/"===s?r:K([r,s])),a.createHref({pathname:l,search:o,hash:i})}(m,{relative:c}),[x,C,I]=function(t,n){let r=e.useContext(et),[a,i]=e.useState(!1),[s,o]=e.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:u,onMouseLeave:h,onTouchStart:f}=n,d=e.useRef(null);e.useEffect(()=>{if("render"===t&&o(!0),"viewport"===t){let e=new IntersectionObserver(e=>{e.forEach(e=>{o(e.isIntersecting)})},{threshold:.5});return d.current&&e.observe(d.current),()=>{e.disconnect()}}},[t]),e.useEffect(()=>{if(a){let e=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(e)}}},[a]);let p=()=>{i(!0)},m=()=>{i(!1),o(!1)};return r?"intent"!==t?[s,d,{}]:[s,d,{onFocus:nt(l,p),onBlur:nt(c,m),onMouseEnter:nt(u,p),onMouseLeave:nt(h,m),onTouchStart:nt(f,p)}]:[!1,d,{}]}(o,w),A=function(t){let{target:n,replace:r,state:a,preventScrollReset:i,relative:s,viewTransition:o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=pe(),c=he(),u=me(t,{relative:s});return e.useCallback(e=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(e,n)){e.preventDefault();let n=void 0!==r?r:T(c)===T(u);l(t,{replace:n,state:a,preventScrollReset:i,relative:s,viewTransition:o})}},[c,l,u,r,a,n,t,i,s,o])}(m,{replace:h,state:d,target:p,preventScrollReset:g,relative:c,viewTransition:b});let N=e.createElement("a",l(l(l({},w),I),{},{href:a||_,onClick:k||u?i:function(e){i&&i(e),e.defaultPrevented||A(e)},ref:ct(n,C),target:p,"data-discover":E||"render"!==s?void 0:"true"}));return x&&!E?e.createElement(e.Fragment,null,N,e.createElement(at,{page:_})):N});mt.displayName="Link",e.forwardRef(function(t,n){let{"aria-current":a="page",caseSensitive:i=!1,className:s="",end:o=!1,style:c,to:u,viewTransition:h,children:f}=t,p=r(t,d),m=me(u,{relative:p.relative}),g=he(),y=e.useContext(te),{navigator:b,basename:w}=e.useContext(se),T=null!=y&&function(t){let{relative:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.useContext(re);v(null!=r,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:a}=yt("useViewTransitionState"),i=me(t,{relative:n});if(!r.isTransitioning)return!1;let s=z(r.currentLocation.pathname,a)||r.currentLocation.pathname,o=z(r.nextLocation.pathname,a)||r.nextLocation.pathname;return null!=U(i.pathname,o)||null!=U(i.pathname,s)}(m)&&!0===h,S=b.encodeLocation?b.encodeLocation(m).pathname:m.pathname,E=g.pathname,k=y&&y.navigation&&y.navigation.location?y.navigation.location.pathname:null;i||(E=E.toLowerCase(),k=k?k.toLowerCase():null,S=S.toLowerCase()),k&&w&&(k=z(k,w)||k);const _="/"!==S&&S.endsWith("/")?S.length-1:S.length;let x,C=E===S||!o&&E.startsWith(S)&&"/"===E.charAt(_),I=null!=k&&(k===S||!o&&k.startsWith(S)&&"/"===k.charAt(S.length)),A={isActive:C,isPending:I,isTransitioning:T},N=C?a:void 0;x="function"===typeof s?s(A):[s,C?"active":null,I?"pending":null,T?"transitioning":null].filter(Boolean).join(" ");let R="function"===typeof c?c(A):c;return e.createElement(mt,l(l({},p),{},{"aria-current":N,className:x,ref:n,style:R,to:u,viewTransition:h}),"function"===typeof f?f(A):f)}).displayName="NavLink";var gt=e.forwardRef((t,n)=>{let{discover:a="render",fetcherKey:i,navigate:s,reloadDocument:o,replace:c,state:u,method:h=Me,action:f,onSubmit:d,relative:m,preventScrollReset:g,viewTransition:y}=t,b=r(t,p),w=Tt(),S=function(t){let{relative:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{basename:r}=e.useContext(se),a=e.useContext(le);v(a,"useFormAction must be used inside a RouteContext");let[i]=a.matches.slice(-1),s=l({},me(t||".",{relative:n})),o=he();if(null==t){s.search=o.search;let e=new URLSearchParams(s.search),t=e.getAll("index");if(t.some(e=>""===e)){e.delete("index"),t.filter(e=>e).forEach(t=>e.append("index",t));let n=e.toString();s.search=n?"?".concat(n):""}}t&&"."!==t||!i.route.index||(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index");"/"!==r&&(s.pathname="/"===s.pathname?r:K([r,s.pathname]));return T(s)}(f,{relative:m}),E="get"===h.toLowerCase()?"get":"post",k="string"===typeof f&&pt.test(f);return e.createElement("form",l(l({ref:n,method:E,action:S,onSubmit:o?d:e=>{if(d&&d(e),e.defaultPrevented)return;e.preventDefault();let t=e.nativeEvent.submitter,n=(null===t||void 0===t?void 0:t.getAttribute("formmethod"))||h;w(t||e.currentTarget,{fetcherKey:i,method:n,navigate:s,replace:c,state:u,relative:m,preventScrollReset:g,viewTransition:y})}},b),{},{"data-discover":k||"render"!==a?void 0:"true"}))});function vt(e){return"".concat(e," must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.")}function yt(t){let n=e.useContext(ee);return v(n,vt(t)),n}gt.displayName="Form";var bt=0,wt=()=>"__".concat(String(++bt),"__");function Tt(){let{router:t}=yt("useSubmit"),{basename:n}=e.useContext(se),r=_e("useRouteId");return e.useCallback(async function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{action:i,method:s,encType:o,formData:l,body:c}=Be(e,n);if(!1===a.navigate){let e=a.fetcherKey||wt();await t.fetch(e,r,a.action||i,{preventScrollReset:a.preventScrollReset,formData:l,body:c,formMethod:a.method||s,formEncType:a.encType||o,flushSync:a.flushSync})}else await t.navigate(a.action||i,{preventScrollReset:a.preventScrollReset,formData:l,body:c,formMethod:a.method||s,formEncType:a.encType||o,replace:a.replace,state:a.state,fromRouteId:r,flushSync:a.flushSync,viewTransition:a.viewTransition})},[t,n,r])}const St=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let a=e.charCodeAt(r);a<128?t[n++]=a:a<2048?(t[n++]=a>>6|192,t[n++]=63&a|128):55296===(64512&a)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(a=65536+((1023&a)<<10)+(1023&e.charCodeAt(++r)),t[n++]=a>>18|240,t[n++]=a>>12&63|128,t[n++]=a>>6&63|128,t[n++]=63&a|128):(t[n++]=a>>12|224,t[n++]=a>>6&63|128,t[n++]=63&a|128)}return t},Et={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let a=0;a<e.length;a+=3){const t=e[a],i=a+1<e.length,s=i?e[a+1]:0,o=a+2<e.length,l=o?e[a+2]:0,c=t>>2,u=(3&t)<<4|s>>4;let h=(15&s)<<2|l>>6,f=63&l;o||(f=64,i||(h=64)),r.push(n[c],n[u],n[h],n[f])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(St(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const a=e[n++];if(a<128)t[r++]=String.fromCharCode(a);else if(a>191&&a<224){const i=e[n++];t[r++]=String.fromCharCode((31&a)<<6|63&i)}else if(a>239&&a<365){const i=((7&a)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(i>>10)),t[r++]=String.fromCharCode(56320+(1023&i))}else{const i=e[n++],s=e[n++];t[r++]=String.fromCharCode((15&a)<<12|(63&i)<<6|63&s)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let a=0;a<e.length;){const t=n[e.charAt(a++)],i=a<e.length?n[e.charAt(a)]:0;++a;const s=a<e.length?n[e.charAt(a)]:64;++a;const o=a<e.length?n[e.charAt(a)]:64;if(++a,null==t||null==i||null==s||null==o)throw new kt;const l=t<<2|i>>4;if(r.push(l),64!==s){const e=i<<4&240|s>>2;if(r.push(e),64!==o){const e=s<<6&192|o;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class kt extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const _t=function(e){return function(e){const t=St(e);return Et.encodeByteArray(t,!0)}(e).replace(/\./g,"")},xt=function(e){try{return Et.decodeString(e,!0)}catch(AR){console.error("base64Decode failed: ",AR)}return null};function Ct(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}const It=()=>{try{return Ct().__FIREBASE_DEFAULTS__||(()=>{if("undefined"===typeof process)return;const e={NODE_ENV:"production",PUBLIC_URL:"/ingredients-tool",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"===typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(AR){return}const t=e&&xt(e[1]);return t&&JSON.parse(t)})()}catch(AR){return void console.info("Unable to get __FIREBASE_DEFAULTS__ due to: ".concat(AR))}},At=e=>{var t;return null===(t=It())||void 0===t||null===(t=t.emulatorHosts)||void 0===t?void 0:t[e]},Nt=()=>{var e;return null===(e=It())||void 0===e?void 0:e.config},Rt=e=>{var t;return null===(t=It())||void 0===t?void 0:t["_".concat(e)]};class Ot{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"===typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,n))}}}function Pt(e){try{return(e.startsWith("http://")||e.startsWith("https://")?new URL(e).hostname:e).endsWith(".cloudworkstations.dev")}catch(t){return!1}}async function Dt(e){return(await fetch(e,{credentials:"include"})).ok}const Lt={};let Mt=!1;function Ft(e,t){if("undefined"===typeof window||"undefined"===typeof document||!Pt(window.location.host)||Lt[e]===t||Lt[e]||Mt)return;function n(e){return"__firebase__banner__".concat(e)}Lt[e]=t;const r="__firebase__banner",a=function(){const e={prod:[],emulator:[]};for(const t of Object.keys(Lt))Lt[t]?e.emulator.push(t):e.prod.push(t);return e}().prod.length>0;function i(){const e=document.createElement("span");return e.style.cursor="pointer",e.style.marginLeft="16px",e.style.fontSize="24px",e.innerHTML=" &times;",e.onclick=()=>{Mt=!0,function(){const e=document.getElementById(r);e&&e.remove()}()},e}function s(){const e=function(e){let t=document.getElementById(e),n=!1;return t||(t=document.createElement("div"),t.setAttribute("id",e),n=!0),{created:n,element:t}}(r),t=n("text"),s=document.getElementById(t)||document.createElement("span"),o=n("learnmore"),l=document.getElementById(o)||document.createElement("a"),c=n("preprendIcon"),u=document.getElementById(c)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(e.created){const t=e.element;!function(e){e.style.display="flex",e.style.background="#7faaf0",e.style.position="fixed",e.style.bottom="5px",e.style.left="5px",e.style.padding=".5em",e.style.borderRadius="5px",e.style.alignItems="center"}(t),function(e,t){e.setAttribute("id",t),e.innerText="Learn more",e.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",e.setAttribute("target","__blank"),e.style.paddingLeft="5px",e.style.textDecoration="underline"}(l,o);const n=i();!function(e,t){e.setAttribute("width","24"),e.setAttribute("id",t),e.setAttribute("height","24"),e.setAttribute("viewBox","0 0 24 24"),e.setAttribute("fill","none"),e.style.marginLeft="-6px"}(u,c),t.append(u,s,l,n),document.body.appendChild(t)}a?(s.innerText="Preview backend disconnected.",u.innerHTML='<g clip-path="url(#clip0_6013_33858)">\n<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6013_33858">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>'):(u.innerHTML='<g clip-path="url(#clip0_6083_34804)">\n<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6083_34804">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>',s.innerText="Preview backend running in this workspace."),s.setAttribute("id",t)}"loading"===document.readyState?window.addEventListener("DOMContentLoaded",s):s()}function Ut(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function jt(){var e;const t=null===(e=It())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(AR){return!1}}function Vt(){const e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id}function zt(){return!jt()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Bt(){try{return"object"===typeof indexedDB}catch(AR){return!1}}function Ht(){return new Promise((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(r);a.onsuccess=()=>{a.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},a.onupgradeneeded=()=>{n=!1},a.onerror=()=>{var e;t((null===(e=a.error)||void 0===e?void 0:e.message)||"")}}catch(n){t(n)}})}class Wt extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,Wt.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Gt.prototype.create)}}class Gt{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e){const t=(arguments.length<=1?void 0:arguments[1])||{},n="".concat(this.service,"/").concat(e),r=this.errors[e],a=r?function(e,t){return e.replace(Kt,(e,n)=>{const r=t[n];return null!=r?String(r):"<".concat(n,"?>")})}(r,t):"Error",i="".concat(this.serviceName,": ").concat(a," (").concat(n,").");return new Wt(n,i,t)}}const Kt=/\{\$([^}]+)}/g;function qt(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const a of n){if(!r.includes(a))return!1;const n=e[a],i=t[a];if($t(n)&&$t(i)){if(!qt(n,i))return!1}else if(n!==i)return!1}for(const a of r)if(!n.includes(a))return!1;return!0}function $t(e){return null!==e&&"object"===typeof e}function Xt(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach(e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function Yt(e){const t={};return e.replace(/^\?/,"").split("&").forEach(e=>{if(e){const[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}}),t}function Qt(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}class Jt{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(e=>{this.error(e)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!==typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"===typeof e[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=Zt),void 0===r.error&&(r.error=Zt),void 0===r.complete&&(r.complete=Zt);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(AR){}}),this.observers.push(r),a}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(AR){"undefined"!==typeof console&&console.error&&console.error(AR)}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Zt(){}function en(e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;const n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3)*Math.pow(t,e),r=Math.round(.5*n*(Math.random()-.5)*2);return Math.min(144e5,n+r)}function tn(e){return e&&e._delegate?e._delegate:e}class nn{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const rn="[DEFAULT]";class an{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new Ot;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(AR){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),r=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(AR){if(r)return null;throw AR}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:rn})}catch(AR){}for(const[e,t]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:n});t.resolve(e)}catch(AR){}}}}clearInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:rn;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return null!=this.component}isInitialized(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:rn;return this.instances.has(e)}getOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:rn;return this.instancesOptions.get(e)||{}}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error("".concat(this.name,"(").concat(n,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[a,i]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(a)&&i.resolve(r)}return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),a=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;a.add(e),this.onInitCallbacks.set(r,a);const i=this.instances.get(r);return i&&e(i,r),()=>{a.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const a of n)try{a(e,t)}catch(r){}}getOrInitializeService(e){let{instanceIdentifier:t,options:n={}}=e,r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(a=t,a===rn?void 0:a),options:n}),this.instances.set(t,r),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch(i){}var a;return r||null}normalizeInstanceIdentifier(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:rn;return this.component?this.component.multipleInstances?e:rn:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class sn{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new an(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const on=[];var ln;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(ln||(ln={}));const cn={debug:ln.DEBUG,verbose:ln.VERBOSE,info:ln.INFO,warn:ln.WARN,error:ln.ERROR,silent:ln.SILENT},un=ln.INFO,hn={[ln.DEBUG]:"log",[ln.VERBOSE]:"log",[ln.INFO]:"info",[ln.WARN]:"warn",[ln.ERROR]:"error"},fn=function(e,t){if(t<e.logLevel)return;const n=(new Date).toISOString(),r=hn[t];if(!r)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));for(var a=arguments.length,i=new Array(a>2?a-2:0),s=2;s<a;s++)i[s-2]=arguments[s];console[r]("[".concat(n,"]  ").concat(e.name,":"),...i)};class dn{constructor(e){this.name=e,this._logLevel=un,this._logHandler=fn,this._userLogHandler=null,on.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ln))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}setLogLevel(e){this._logLevel="string"===typeof e?cn[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,ln.DEBUG,...t),this._logHandler(this,ln.DEBUG,...t)}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,ln.VERBOSE,...t),this._logHandler(this,ln.VERBOSE,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,ln.INFO,...t),this._logHandler(this,ln.INFO,...t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,ln.WARN,...t),this._logHandler(this,ln.WARN,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,ln.ERROR,...t),this._logHandler(this,ln.ERROR,...t)}}let pn,mn;const gn=new WeakMap,vn=new WeakMap,yn=new WeakMap,bn=new WeakMap,wn=new WeakMap;let Tn={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return vn.get(e);if("objectStoreNames"===t)return e.objectStoreNames||yn.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return kn(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function Sn(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(mn||(mn=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(_n(this),n),kn(gn.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return kn(e.apply(_n(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];const i=e.call(_n(this),t,...r);return yn.set(i,t.sort?t.sort():[t]),kn(i)}}function En(e){return"function"===typeof e?Sn(e):(e instanceof IDBTransaction&&function(e){if(vn.has(e))return;const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("complete",a),e.removeEventListener("error",i),e.removeEventListener("abort",i)},a=()=>{t(),r()},i=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",a),e.addEventListener("error",i),e.addEventListener("abort",i)});vn.set(e,t)}(e),t=e,(pn||(pn=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some(e=>t instanceof e)?new Proxy(e,Tn):e);var t}function kn(e){if(e instanceof IDBRequest)return function(e){const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("success",a),e.removeEventListener("error",i)},a=()=>{t(kn(e.result)),r()},i=()=>{n(e.error),r()};e.addEventListener("success",a),e.addEventListener("error",i)});return t.then(t=>{t instanceof IDBCursor&&gn.set(t,e)}).catch(()=>{}),wn.set(t,e),t}(e);if(bn.has(e))return bn.get(e);const t=En(e);return t!==e&&(bn.set(e,t),wn.set(t,e)),t}const _n=e=>wn.get(e);function xn(e,t){let{blocked:n,upgrade:r,blocking:a,terminated:i}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const s=indexedDB.open(e,t),o=kn(s);return r&&s.addEventListener("upgradeneeded",e=>{r(kn(s.result),e.oldVersion,e.newVersion,kn(s.transaction),e)}),n&&s.addEventListener("blocked",e=>n(e.oldVersion,e.newVersion,e)),o.then(e=>{i&&e.addEventListener("close",()=>i()),a&&e.addEventListener("versionchange",e=>a(e.oldVersion,e.newVersion,e))}).catch(()=>{}),o}const Cn=["get","getKey","getAll","getAllKeys","count"],In=["put","add","delete","clear"],An=new Map;function Nn(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(An.get(t))return An.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,a=In.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!a&&!Cn.includes(n))return;const i=async function(e){const t=this.transaction(e,a?"readwrite":"readonly");let i=t.store;for(var s=arguments.length,o=new Array(s>1?s-1:0),l=1;l<s;l++)o[l-1]=arguments[l];return r&&(i=i.index(o.shift())),(await Promise.all([i[n](...o),a&&t.done]))[0]};return An.set(t,i),i}Tn=(e=>l(l({},e),{},{get:(t,n,r)=>Nn(t,n)||e.get(t,n,r),has:(t,n)=>!!Nn(t,n)||e.has(t,n)}))(Tn);class Rn{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){const t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null}).filter(e=>e).join(" ")}}const On="@firebase/app",Pn="0.14.6",Dn=new dn("@firebase/app"),Ln="@firebase/app-compat",Mn="@firebase/analytics-compat",Fn="@firebase/analytics",Un="@firebase/app-check-compat",jn="@firebase/app-check",Vn="@firebase/auth",zn="@firebase/auth-compat",Bn="@firebase/database",Hn="@firebase/data-connect",Wn="@firebase/database-compat",Gn="@firebase/functions",Kn="@firebase/functions-compat",qn="@firebase/installations",$n="@firebase/installations-compat",Xn="@firebase/messaging",Yn="@firebase/messaging-compat",Qn="@firebase/performance",Jn="@firebase/performance-compat",Zn="@firebase/remote-config",er="@firebase/remote-config-compat",tr="@firebase/storage",nr="@firebase/storage-compat",rr="@firebase/firestore",ar="@firebase/ai",ir="@firebase/firestore-compat",sr="firebase",or="[DEFAULT]",lr={[On]:"fire-core",[Ln]:"fire-core-compat",[Fn]:"fire-analytics",[Mn]:"fire-analytics-compat",[jn]:"fire-app-check",[Un]:"fire-app-check-compat",[Vn]:"fire-auth",[zn]:"fire-auth-compat",[Bn]:"fire-rtdb",[Hn]:"fire-data-connect",[Wn]:"fire-rtdb-compat",[Gn]:"fire-fn",[Kn]:"fire-fn-compat",[qn]:"fire-iid",[$n]:"fire-iid-compat",[Xn]:"fire-fcm",[Yn]:"fire-fcm-compat",[Qn]:"fire-perf",[Jn]:"fire-perf-compat",[Zn]:"fire-rc",[er]:"fire-rc-compat",[tr]:"fire-gcs",[nr]:"fire-gcs-compat",[rr]:"fire-fst",[ir]:"fire-fst-compat",[ar]:"fire-vertex","fire-js":"fire-js",[sr]:"fire-js-all"},cr=new Map,ur=new Map,hr=new Map;function fr(e,t){try{e.container.addComponent(t)}catch(AR){Dn.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),AR)}}function dr(e){const t=e.name;if(hr.has(t))return Dn.debug("There were multiple attempts to register component ".concat(t,".")),!1;hr.set(t,e);for(const n of cr.values())fr(n,e);for(const n of ur.values())fr(n,e);return!0}function pr(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function mr(e){return null!==e&&void 0!==e&&void 0!==e.settings}const gr=new Gt("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class vr{constructor(e,t,n){this._isDeleted=!1,this._options=l({},e),this._config=l({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new nn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw gr.create("app-deleted",{appName:this._name})}}const yr="12.6.0";function br(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;if("object"!==typeof t){t={name:t}}const r=l({name:or,automaticDataCollectionEnabled:!0},t),a=r.name;if("string"!==typeof a||!a)throw gr.create("bad-app-name",{appName:String(a)});if(n||(n=Nt()),!n)throw gr.create("no-options");const i=cr.get(a);if(i){if(qt(n,i.options)&&qt(r,i.config))return i;throw gr.create("duplicate-app",{appName:a})}const s=new sn(a);for(const l of hr.values())s.addComponent(l);const o=new vr(n,r,s);return cr.set(a,o),o}function wr(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:or;const t=cr.get(e);if(!t&&e===or&&Nt())return br();if(!t)throw gr.create("no-app",{appName:e});return t}function Tr(e,t,n){var r;let a=null!==(r=lr[e])&&void 0!==r?r:e;n&&(a+="-".concat(n));const i=a.match(/\s|\//),s=t.match(/\s|\//);if(i||s){const e=['Unable to register library "'.concat(a,'" with version "').concat(t,'":')];return i&&e.push('library name "'.concat(a,'" contains illegal characters (whitespace or "/")')),i&&s&&e.push("and"),s&&e.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void Dn.warn(e.join(" "))}dr(new nn("".concat(a,"-version"),()=>({library:a,version:t}),"VERSION"))}const Sr="firebase-heartbeat-store";let Er=null;function kr(){return Er||(Er=xn("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(Sr)}catch(AR){console.warn(AR)}}}).catch(e=>{throw gr.create("idb-open",{originalErrorMessage:e.message})})),Er}async function _r(e,t){try{const n=(await kr()).transaction(Sr,"readwrite"),r=n.objectStore(Sr);await r.put(t,xr(e)),await n.done}catch(AR){if(AR instanceof Wt)Dn.warn(AR.message);else{const t=gr.create("idb-set",{originalErrorMessage:null===AR||void 0===AR?void 0:AR.message});Dn.warn(t.message)}}}function xr(e){return"".concat(e.name,"!").concat(e.options.appId)}class Cr{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Ar(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){try{var e;const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=Ir();var t;if(null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats))if(this._heartbeatsCache=await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats))return;if(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(e=>e.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats.length>30){const e=function(e){if(0===e.length)return-1;let t=0,n=e[0].date;for(let r=1;r<e.length;r++)e[r].date<n&&(n=e[r].date,t=r);return t}(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(e,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(AR){Dn.warn(AR)}}async getHeartbeatsHeader(){try{var e;if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=Ir(),{heartbeatsToSend:n,unsentEntries:r}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const n=[];let r=e.slice();for(const a of e){const e=n.find(e=>e.agent===a.agent);if(e){if(e.dates.push(a.date),Nr(n)>t){e.dates.pop();break}}else if(n.push({agent:a.agent,dates:[a.date]}),Nr(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),a=_t(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(AR){return Dn.warn(AR),""}}}function Ir(){return(new Date).toISOString().substring(0,10)}class Ar{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!Bt()&&Ht().then(()=>!0).catch(()=>!1)}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await kr()).transaction(Sr),n=await t.objectStore(Sr).get(xr(e));return await t.done,n}catch(AR){if(AR instanceof Wt)Dn.warn(AR.message);else{const t=gr.create("idb-get",{originalErrorMessage:null===AR||void 0===AR?void 0:AR.message});Dn.warn(t.message)}}}(this.app);return null!==e&&void 0!==e&&e.heartbeats?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){var t;const n=await this.read();return _r(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){if(await this._canUseIndexedDBPromise){var t;const n=await this.read();return _r(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function Nr(e){return _t(JSON.stringify({version:2,heartbeats:e})).length}var Rr;Rr="",dr(new nn("platform-logger",e=>new Rn(e),"PRIVATE")),dr(new nn("heartbeat",e=>new Cr(e),"PRIVATE")),Tr(On,Pn,Rr),Tr(On,Pn,"esm2020"),Tr("fire-js","");Tr("firebase","12.7.0","app");var Or,Pr,Dr="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},Lr={};(function(){var e;function t(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}function n(e,t,n){n||(n=0);const r=Array(16);if("string"===typeof t)for(var a=0;a<16;++a)r[a]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(a=0;a<16;++a)r[a]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],a=e.g[2];let i,s=e.g[3];i=t+(s^n&(a^s))+r[0]+3614090360&4294967295,i=s+(a^(t=n+(i<<7&4294967295|i>>>25))&(n^a))+r[1]+3905402710&4294967295,s=t+(i<<12&4294967295|i>>>20),i=a+(n^s&(t^n))+r[2]+606105819&4294967295,i=n+(t^(a=s+(i<<17&4294967295|i>>>15))&(s^t))+r[3]+3250441966&4294967295,i=t+(s^(n=a+(i<<22&4294967295|i>>>10))&(a^s))+r[4]+4118548399&4294967295,i=s+(a^(t=n+(i<<7&4294967295|i>>>25))&(n^a))+r[5]+1200080426&4294967295,s=t+(i<<12&4294967295|i>>>20),i=a+(n^s&(t^n))+r[6]+2821735955&4294967295,i=n+(t^(a=s+(i<<17&4294967295|i>>>15))&(s^t))+r[7]+4249261313&4294967295,i=t+(s^(n=a+(i<<22&4294967295|i>>>10))&(a^s))+r[8]+1770035416&4294967295,i=s+(a^(t=n+(i<<7&4294967295|i>>>25))&(n^a))+r[9]+2336552879&4294967295,s=t+(i<<12&4294967295|i>>>20),i=a+(n^s&(t^n))+r[10]+4294925233&4294967295,i=n+(t^(a=s+(i<<17&4294967295|i>>>15))&(s^t))+r[11]+2304563134&4294967295,i=t+(s^(n=a+(i<<22&4294967295|i>>>10))&(a^s))+r[12]+1804603682&4294967295,i=s+(a^(t=n+(i<<7&4294967295|i>>>25))&(n^a))+r[13]+4254626195&4294967295,s=t+(i<<12&4294967295|i>>>20),i=a+(n^s&(t^n))+r[14]+2792965006&4294967295,i=n+(t^(a=s+(i<<17&4294967295|i>>>15))&(s^t))+r[15]+1236535329&4294967295,i=t+(a^s&((n=a+(i<<22&4294967295|i>>>10))^a))+r[1]+4129170786&4294967295,i=s+(n^a&((t=n+(i<<5&4294967295|i>>>27))^n))+r[6]+3225465664&4294967295,s=t+(i<<9&4294967295|i>>>23),i=a+(t^n&(s^t))+r[11]+643717713&4294967295,i=n+(s^t&((a=s+(i<<14&4294967295|i>>>18))^s))+r[0]+3921069994&4294967295,i=t+(a^s&((n=a+(i<<20&4294967295|i>>>12))^a))+r[5]+3593408605&4294967295,i=s+(n^a&((t=n+(i<<5&4294967295|i>>>27))^n))+r[10]+38016083&4294967295,s=t+(i<<9&4294967295|i>>>23),i=a+(t^n&(s^t))+r[15]+3634488961&4294967295,i=n+(s^t&((a=s+(i<<14&4294967295|i>>>18))^s))+r[4]+3889429448&4294967295,i=t+(a^s&((n=a+(i<<20&4294967295|i>>>12))^a))+r[9]+568446438&4294967295,i=s+(n^a&((t=n+(i<<5&4294967295|i>>>27))^n))+r[14]+3275163606&4294967295,s=t+(i<<9&4294967295|i>>>23),i=a+(t^n&(s^t))+r[3]+4107603335&4294967295,i=n+(s^t&((a=s+(i<<14&4294967295|i>>>18))^s))+r[8]+1163531501&4294967295,i=t+(a^s&((n=a+(i<<20&4294967295|i>>>12))^a))+r[13]+2850285829&4294967295,i=s+(n^a&((t=n+(i<<5&4294967295|i>>>27))^n))+r[2]+4243563512&4294967295,s=t+(i<<9&4294967295|i>>>23),i=a+(t^n&(s^t))+r[7]+1735328473&4294967295,i=n+(s^t&((a=s+(i<<14&4294967295|i>>>18))^s))+r[12]+2368359562&4294967295,i=t+((n=a+(i<<20&4294967295|i>>>12))^a^s)+r[5]+4294588738&4294967295,i=s+((t=n+(i<<4&4294967295|i>>>28))^n^a)+r[8]+2272392833&4294967295,s=t+(i<<11&4294967295|i>>>21),i=a+(s^t^n)+r[11]+1839030562&4294967295,i=n+((a=s+(i<<16&4294967295|i>>>16))^s^t)+r[14]+4259657740&4294967295,i=t+((n=a+(i<<23&4294967295|i>>>9))^a^s)+r[1]+2763975236&4294967295,i=s+((t=n+(i<<4&4294967295|i>>>28))^n^a)+r[4]+1272893353&4294967295,s=t+(i<<11&4294967295|i>>>21),i=a+(s^t^n)+r[7]+4139469664&4294967295,i=n+((a=s+(i<<16&4294967295|i>>>16))^s^t)+r[10]+3200236656&4294967295,i=t+((n=a+(i<<23&4294967295|i>>>9))^a^s)+r[13]+681279174&4294967295,i=s+((t=n+(i<<4&4294967295|i>>>28))^n^a)+r[0]+3936430074&4294967295,s=t+(i<<11&4294967295|i>>>21),i=a+(s^t^n)+r[3]+3572445317&4294967295,i=n+((a=s+(i<<16&4294967295|i>>>16))^s^t)+r[6]+76029189&4294967295,i=t+((n=a+(i<<23&4294967295|i>>>9))^a^s)+r[9]+3654602809&4294967295,i=s+((t=n+(i<<4&4294967295|i>>>28))^n^a)+r[12]+3873151461&4294967295,s=t+(i<<11&4294967295|i>>>21),i=a+(s^t^n)+r[15]+530742520&4294967295,i=n+((a=s+(i<<16&4294967295|i>>>16))^s^t)+r[2]+3299628645&4294967295,i=t+(a^((n=a+(i<<23&4294967295|i>>>9))|~s))+r[0]+4096336452&4294967295,i=s+(n^((t=n+(i<<6&4294967295|i>>>26))|~a))+r[7]+1126891415&4294967295,s=t+(i<<10&4294967295|i>>>22),i=a+(t^(s|~n))+r[14]+2878612391&4294967295,i=n+(s^((a=s+(i<<15&4294967295|i>>>17))|~t))+r[5]+4237533241&4294967295,i=t+(a^((n=a+(i<<21&4294967295|i>>>11))|~s))+r[12]+1700485571&4294967295,i=s+(n^((t=n+(i<<6&4294967295|i>>>26))|~a))+r[3]+2399980690&4294967295,s=t+(i<<10&4294967295|i>>>22),i=a+(t^(s|~n))+r[10]+4293915773&4294967295,i=n+(s^((a=s+(i<<15&4294967295|i>>>17))|~t))+r[1]+2240044497&4294967295,i=t+(a^((n=a+(i<<21&4294967295|i>>>11))|~s))+r[8]+1873313359&4294967295,i=s+(n^((t=n+(i<<6&4294967295|i>>>26))|~a))+r[15]+4264355552&4294967295,s=t+(i<<10&4294967295|i>>>22),i=a+(t^(s|~n))+r[6]+2734768916&4294967295,i=n+(s^((a=s+(i<<15&4294967295|i>>>17))|~t))+r[13]+1309151649&4294967295,i=t+(a^((n=a+(i<<21&4294967295|i>>>11))|~s))+r[4]+4149444226&4294967295,i=s+(n^((t=n+(i<<6&4294967295|i>>>26))|~a))+r[11]+3174756917&4294967295,s=t+(i<<10&4294967295|i>>>22),i=a+(t^(s|~n))+r[2]+718787259&4294967295,i=n+(s^((a=s+(i<<15&4294967295|i>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(a+(i<<21&4294967295|i>>>11))&4294967295,e.g[2]=e.g[2]+a&4294967295,e.g[3]=e.g[3]+s&4294967295}function r(e,t){this.h=t;const n=[];let r=!0;for(let a=e.length-1;a>=0;a--){const i=0|e[a];r&&i==t||(n[a]=i,r=!1)}this.g=n}!function(e,t){function n(){}n.prototype=t.prototype,e.F=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.D=function(e,n,r){for(var a=Array(arguments.length-2),i=2;i<arguments.length;i++)a[i-2]=arguments[i];return t.prototype[n].apply(e,a)}}(t,function(){this.blockSize=-1}),t.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},t.prototype.v=function(e,t){void 0===t&&(t=e.length);const r=t-this.blockSize,a=this.C;let i=this.h,s=0;for(;s<t;){if(0==i)for(;s<=r;)n(this,e,s),s+=this.blockSize;if("string"===typeof e){for(;s<t;)if(a[i++]=e.charCodeAt(s++),i==this.blockSize){n(this,a),i=0;break}}else for(;s<t;)if(a[i++]=e[s++],i==this.blockSize){n(this,a),i=0;break}}this.h=i,this.o+=t},t.prototype.A=function(){var e=Array((this.h<56?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;t=8*this.o;for(var n=e.length-8;n<e.length;++n)e[n]=255&t,t/=256;for(this.v(e),e=Array(16),t=0,n=0;n<4;++n)for(let r=0;r<32;r+=8)e[t++]=this.g[n]>>>r&255;return e};var a={};function i(e){return-128<=e&&e<128?function(e,t){var n=a;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,function(e){return new r([0|e],e<0?-1:0)}):new r([0|e],e<0?-1:0)}function s(e){if(isNaN(e)||!isFinite(e))return o;if(e<0)return f(s(-e));const t=[];let n=1;for(let r=0;e>=n;r++)t[r]=e/n|0,n*=4294967296;return new r(t,0)}var o=i(0),l=i(1),c=i(16777216);function u(e){if(0!=e.h)return!1;for(let t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function h(e){return-1==e.h}function f(e){const t=e.g.length,n=[];for(let r=0;r<t;r++)n[r]=~e.g[r];return new r(n,~e.h).add(l)}function d(e,t){return e.add(f(t))}function p(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function m(e,t){this.g=e,this.h=t}function g(e,t){if(u(t))throw Error("division by zero");if(u(e))return new m(o,o);if(h(e))return t=g(f(e),t),new m(f(t.g),f(t.h));if(h(t))return t=g(e,f(t)),new m(f(t.g),t.h);if(e.g.length>30){if(h(e)||h(t))throw Error("slowDivide_ only works with positive integers.");for(var n=l,r=t;r.l(e)<=0;)n=v(n),r=v(r);var a=y(n,1),i=y(r,1);for(r=y(r,2),n=y(n,2);!u(r);){var c=i.add(r);c.l(e)<=0&&(a=a.add(n),i=c),r=y(r,1),n=y(n,1)}return t=d(e,a.j(t)),new m(a,t)}for(a=o;e.l(t)>=0;){for(n=Math.max(1,Math.floor(e.m()/t.m())),r=(r=Math.ceil(Math.log(n)/Math.LN2))<=48?1:Math.pow(2,r-48),c=(i=s(n)).j(t);h(c)||c.l(e)>0;)c=(i=s(n-=r)).j(t);u(i)&&(i=l),a=a.add(i),e=d(e,c)}return new m(a,e)}function v(e){const t=e.g.length+1,n=[];for(let r=0;r<t;r++)n[r]=e.i(r)<<1|e.i(r-1)>>>31;return new r(n,e.h)}function y(e,t){const n=t>>5;t%=32;const a=e.g.length-n,i=[];for(let r=0;r<a;r++)i[r]=t>0?e.i(r+n)>>>t|e.i(r+n+1)<<32-t:e.i(r+n);return new r(i,e.h)}(e=r.prototype).m=function(){if(h(this))return-f(this).m();let e=0,t=1;for(let n=0;n<this.g.length;n++){const r=this.i(n);e+=(r>=0?r:4294967296+r)*t,t*=4294967296}return e},e.toString=function(e){if((e=e||10)<2||36<e)throw Error("radix out of range: "+e);if(u(this))return"0";if(h(this))return"-"+f(this).toString(e);const t=s(Math.pow(e,6));var n=this;let r="";for(;;){const a=g(n,t).g;let i=(((n=d(n,a.j(t))).g.length>0?n.g[0]:n.h)>>>0).toString(e);if(u(n=a))return i+r;for(;i.length<6;)i="0"+i;r=i+r}},e.i=function(e){return e<0?0:e<this.g.length?this.g[e]:this.h},e.l=function(e){return h(e=d(this,e))?-1:u(e)?0:1},e.abs=function(){return h(this)?f(this):this},e.add=function(e){const t=Math.max(this.g.length,e.g.length),n=[];let a=0;for(let r=0;r<=t;r++){let t=a+(65535&this.i(r))+(65535&e.i(r)),i=(t>>>16)+(this.i(r)>>>16)+(e.i(r)>>>16);a=i>>>16,t&=65535,i&=65535,n[r]=i<<16|t}return new r(n,-2147483648&n[n.length-1]?-1:0)},e.j=function(e){if(u(this)||u(e))return o;if(h(this))return h(e)?f(this).j(f(e)):f(f(this).j(e));if(h(e))return f(this.j(f(e)));if(this.l(c)<0&&e.l(c)<0)return s(this.m()*e.m());const t=this.g.length+e.g.length,n=[];for(var a=0;a<2*t;a++)n[a]=0;for(a=0;a<this.g.length;a++)for(let t=0;t<e.g.length;t++){const r=this.i(a)>>>16,i=65535&this.i(a),s=e.i(t)>>>16,o=65535&e.i(t);n[2*a+2*t]+=i*o,p(n,2*a+2*t),n[2*a+2*t+1]+=r*o,p(n,2*a+2*t+1),n[2*a+2*t+1]+=i*s,p(n,2*a+2*t+1),n[2*a+2*t+2]+=r*s,p(n,2*a+2*t+2)}for(e=0;e<t;e++)n[e]=n[2*e+1]<<16|n[2*e];for(e=t;e<2*t;e++)n[e]=0;return new r(n,0)},e.B=function(e){return g(this,e).h},e.and=function(e){const t=Math.max(this.g.length,e.g.length),n=[];for(let r=0;r<t;r++)n[r]=this.i(r)&e.i(r);return new r(n,this.h&e.h)},e.or=function(e){const t=Math.max(this.g.length,e.g.length),n=[];for(let r=0;r<t;r++)n[r]=this.i(r)|e.i(r);return new r(n,this.h|e.h)},e.xor=function(e){const t=Math.max(this.g.length,e.g.length),n=[];for(let r=0;r<t;r++)n[r]=this.i(r)^e.i(r);return new r(n,this.h^e.h)},t.prototype.digest=t.prototype.A,t.prototype.reset=t.prototype.u,t.prototype.update=t.prototype.v,Pr=Lr.Md5=t,r.prototype.add=r.prototype.add,r.prototype.multiply=r.prototype.j,r.prototype.modulo=r.prototype.B,r.prototype.compare=r.prototype.l,r.prototype.toNumber=r.prototype.m,r.prototype.toString=r.prototype.toString,r.prototype.getBits=r.prototype.i,r.fromNumber=s,r.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if((n=n||10)<2||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return f(e(t.substring(1),n));if(t.indexOf("-")>=0)throw Error('number format error: interior "-" character');const r=s(Math.pow(n,8));let a=o;for(let o=0;o<t.length;o+=8){var i=Math.min(8,t.length-o);const e=parseInt(t.substring(o,o+i),n);i<8?(i=s(Math.pow(n,i)),a=a.j(i).add(s(e))):(a=a.j(r),a=a.add(s(e)))}return a},Or=Lr.Integer=r}).apply("undefined"!==typeof Dr?Dr:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});var Mr,Fr,Ur,jr,Vr,zr,Br,Hr,Wr="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},Gr={};(function(){var e,t=Object.defineProperty;var n=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof Wr&&Wr];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);function r(e,r){if(r)e:{var a=n;e=e.split(".");for(var i=0;i<e.length-1;i++){var s=e[i];if(!(s in a))break e;a=a[s]}(r=r(i=a[e=e[e.length-1]]))!=i&&null!=r&&t(a,e,{configurable:!0,writable:!0,value:r})}}r("Symbol.dispose",function(e){return e||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(e){return e||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(e){return e||function(e){var t,n=[];for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&n.push([t,e[t]]);return n}});var a=a||{},i=this||self;function s(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function o(e,t,n){return e.call.apply(e.bind,arguments)}function l(e,t,n){return(l=o).apply(null,arguments)}function c(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function u(e,t){function n(){}n.prototype=t.prototype,e.Z=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Ob=function(e,n,r){for(var a=Array(arguments.length-2),i=2;i<arguments.length;i++)a[i-2]=arguments[i];return t.prototype[n].apply(e,a)}}var h="undefined"!==typeof AsyncContext&&"function"===typeof AsyncContext.Snapshot?e=>e&&AsyncContext.Snapshot.wrap(e):e=>e;function f(e){const t=e.length;if(t>0){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function d(e,t){for(let r=1;r<arguments.length;r++){const t=arguments[r];var n=typeof t;if("array"==(n="object"!=n?n:t?Array.isArray(t)?"array":n:"null")||"object"==n&&"number"==typeof t.length){n=e.length||0;const r=t.length||0;e.length=n+r;for(let a=0;a<r;a++)e[n+a]=t[a]}else e.push(t)}}function p(e){i.setTimeout(()=>{throw e},0)}function m(){var e=w;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var g=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return this.h>0?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new v,e=>e.reset());class v{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let y,b=!1,w=new class{constructor(){this.h=this.g=null}add(e,t){const n=g.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},T=()=>{const e=Promise.resolve(void 0);y=()=>{e.then(S)}};function S(){for(var e;e=m();){try{e.h.call(e.g)}catch(n){p(n)}var t=g;t.j(e),t.h<100&&(t.h++,e.next=t.g,t.g=e)}b=!1}function E(){this.u=this.u,this.C=this.C}function k(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}E.prototype.u=!1,E.prototype.dispose=function(){this.u||(this.u=!0,this.N())},E.prototype[Symbol.dispose]=function(){this.dispose()},E.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},k.prototype.h=function(){this.defaultPrevented=!0};var _=function(){if(!i.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const e=()=>{};i.addEventListener("test",e,t),i.removeEventListener("test",e,t)}catch(n){}return e}();function x(e){return/^[\s\xa0]*$/.test(e)}function C(e,t){k.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e&&this.init(e,t)}u(C,k),C.prototype.init=function(e,t){const n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;this.target=e.target||e.srcElement,this.g=t,(t=e.relatedTarget)||("mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement)),this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType=e.pointerType,this.state=e.state,this.i=e,e.defaultPrevented&&C.Z.h.call(this)},C.prototype.h=function(){C.Z.h.call(this);const e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var I="closure_listenable_"+(1e6*Math.random()|0),A=0;function N(e,t,n,r,a){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ha=a,this.key=++A,this.da=this.fa=!1}function R(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function O(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function P(e){const t={};for(const n in e)t[n]=e[n];return t}const D="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function L(e,t){let n,r;for(let a=1;a<arguments.length;a++){for(n in r=arguments[a],r)e[n]=r[n];for(let t=0;t<D.length;t++)n=D[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function M(e){this.src=e,this.g={},this.h=0}function F(e,t){const n=t.type;if(n in e.g){var r,a=e.g[n],i=Array.prototype.indexOf.call(a,t,void 0);(r=i>=0)&&Array.prototype.splice.call(a,i,1),r&&(R(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function U(e,t,n,r){for(let a=0;a<e.length;++a){const i=e[a];if(!i.da&&i.listener==t&&i.capture==!!n&&i.ha==r)return a}return-1}M.prototype.add=function(e,t,n,r,a){const i=e.toString();(e=this.g[i])||(e=this.g[i]=[],this.h++);const s=U(e,t,r,a);return s>-1?(t=e[s],n||(t.fa=!1)):((t=new N(t,this.src,i,!!r,a)).fa=n,e.push(t)),t};var j="closure_lm_"+(1e6*Math.random()|0),V={};function z(e,t,n,r,a){if(r&&r.once)return H(e,t,n,r,a);if(Array.isArray(t)){for(let i=0;i<t.length;i++)z(e,t[i],n,r,a);return null}return n=Y(n),e&&e[I]?e.J(t,n,s(r)?!!r.capture:!!r,a):B(e,t,n,!1,r,a)}function B(e,t,n,r,a,i){if(!t)throw Error("Invalid event type");const o=s(a)?!!a.capture:!!a;let l=$(e);if(l||(e[j]=l=new M(e)),(n=l.add(t,n,r,o,i)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}const t=q;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)_||(a=o),void 0===a&&(a=!1),e.addEventListener(t.toString(),r,a);else if(e.attachEvent)e.attachEvent(K(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function H(e,t,n,r,a){if(Array.isArray(t)){for(let i=0;i<t.length;i++)H(e,t[i],n,r,a);return null}return n=Y(n),e&&e[I]?e.K(t,n,s(r)?!!r.capture:!!r,a):B(e,t,n,!0,r,a)}function W(e,t,n,r,a){if(Array.isArray(t))for(var i=0;i<t.length;i++)W(e,t[i],n,r,a);else r=s(r)?!!r.capture:!!r,n=Y(n),e&&e[I]?(e=e.i,(i=String(t).toString())in e.g&&((n=U(t=e.g[i],n,r,a))>-1&&(R(t[n]),Array.prototype.splice.call(t,n,1),0==t.length&&(delete e.g[i],e.h--)))):e&&(e=$(e))&&(t=e.g[t.toString()],e=-1,t&&(e=U(t,n,r,a)),(n=e>-1?t[e]:null)&&G(n))}function G(e){if("number"!==typeof e&&e&&!e.da){var t=e.src;if(t&&t[I])F(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(K(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=$(t))?(F(n,e),0==n.h&&(n.src=null,t[j]=null)):R(e)}}}function K(e){return e in V?V[e]:V[e]="on"+e}function q(e,t){if(e.da)e=!0;else{t=new C(t,this);const n=e.listener,r=e.ha||e.src;e.fa&&G(e),e=n.call(r,t)}return e}function $(e){return(e=e[j])instanceof M?e:null}var X="__closure_events_fn_"+(1e9*Math.random()>>>0);function Y(e){return"function"===typeof e?e:(e[X]||(e[X]=function(t){return e.handleEvent(t)}),e[X])}function Q(){E.call(this),this.i=new M(this),this.M=this,this.G=null}function J(e,t){var n,r=e.G;if(r)for(n=[];r;r=r.G)n.push(r);if(e=e.M,r=t.type||t,"string"===typeof t)t=new k(t,e);else if(t instanceof k)t.target=t.target||e;else{var a=t;L(t=new k(r,e),a)}let i,s;if(a=!0,n)for(s=n.length-1;s>=0;s--)i=t.g=n[s],a=Z(i,r,!0,t)&&a;if(i=t.g=e,a=Z(i,r,!0,t)&&a,a=Z(i,r,!1,t)&&a,n)for(s=0;s<n.length;s++)i=t.g=n[s],a=Z(i,r,!1,t)&&a}function Z(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();let a=!0;for(let i=0;i<t.length;++i){const s=t[i];if(s&&!s.da&&s.capture==n){const t=s.listener,n=s.ha||s.src;s.fa&&F(e.i,s),a=!1!==t.call(n,r)&&a}}return a&&!r.defaultPrevented}function ee(e){e.g=function(e,t){if("function"!==typeof e){if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=l(e.handleEvent,e)}return Number(t)>2147483647?-1:i.setTimeout(e,t||0)}(()=>{e.g=null,e.i&&(e.i=!1,ee(e))},e.l);const t=e.h;e.h=null,e.m.apply(null,t)}u(Q,E),Q.prototype[I]=!0,Q.prototype.removeEventListener=function(e,t,n,r){W(this,e,t,n,r)},Q.prototype.N=function(){if(Q.Z.N.call(this),this.i){var e=this.i;for(const t in e.g){const n=e.g[t];for(let e=0;e<n.length;e++)R(n[e]);delete e.g[t],e.h--}}this.G=null},Q.prototype.J=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},Q.prototype.K=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};class te extends E{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:ee(this)}N(){super.N(),this.g&&(i.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ne(e){E.call(this),this.h=e,this.g={}}u(ne,E);var re=[];function ae(e){O(e.g,function(e,t){this.g.hasOwnProperty(t)&&G(e)},e),e.g={}}ne.prototype.N=function(){ne.Z.N.call(this),ae(this)},ne.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ie=i.JSON.stringify,se=i.JSON.parse,oe=class{stringify(e){return i.JSON.stringify(e,void 0)}parse(e){return i.JSON.parse(e,void 0)}};function le(){}function ce(){}var ue={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function he(){k.call(this,"d")}function fe(){k.call(this,"c")}u(he,k),u(fe,k);var de={},pe=null;function me(){return pe=pe||new Q}function ge(e){k.call(this,de.Ia,e)}function ve(e){const t=me();J(t,new ge(t))}function ye(e,t){k.call(this,de.STAT_EVENT,e),this.stat=t}function be(e){const t=me();J(t,new ye(t,e))}function we(e,t){k.call(this,de.Ja,e),this.size=t}function Te(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return i.setTimeout(function(){e()},t)}function Se(){this.g=!0}function Ee(e,t,n,r){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{const i=JSON.parse(t);if(i)for(e=0;e<i.length;e++)if(Array.isArray(i[e])){var n=i[e];if(!(n.length<2)){var r=n[1];if(Array.isArray(r)&&!(r.length<1)){var a=r[0];if("noop"!=a&&"stop"!=a&&"close"!=a)for(let e=1;e<r.length;e++)r[e]=""}}}return ie(i)}catch(i){return t}}(e,n)+(r?" "+r:"")})}de.Ia="serverreachability",u(ge,k),de.STAT_EVENT="statevent",u(ye,k),de.Ja="timingevent",u(we,k),Se.prototype.ua=function(){this.g=!1},Se.prototype.info=function(){};var ke,_e={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},xe={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"};function Ce(){}function Ie(e){return encodeURIComponent(String(e))}function Ae(e){var t=1;e=e.split(":");const n=[];for(;t>0&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function Ne(e,t,n,r){this.j=e,this.i=t,this.l=n,this.S=r||1,this.V=new ne(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Re}function Re(){this.i=null,this.g="",this.h=!1}u(Ce,le),Ce.prototype.g=function(){return new XMLHttpRequest},ke=new Ce;var Oe={},Pe={};function De(e,t,n){e.M=1,e.A=it(et(t)),e.u=n,e.R=!0,Le(e,null)}function Le(e,t){e.F=Date.now(),Ue(e),e.B=et(e.A);var n=e.B,r=e.S;Array.isArray(r)||(r=[String(r)]),bt(n.i,"t",r),e.C=0,n=e.j.L,e.h=new Re,e.g=sn(e.j,n?t:null,!e.u),e.P>0&&(e.O=new te(l(e.Y,e,e.g),e.P)),t=e.V,n=e.g,r=e.ba;var a="readystatechange";Array.isArray(a)||(a&&(re[0]=a.toString()),a=re);for(let i=0;i<a.length;i++){const e=z(n,a[i],r||t.handleEvent,!1,t.h||t);if(!e)break;t.g[e.key]=e}t=e.J?P(e.J):{},e.u?(e.v||(e.v="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.B,e.v,e.u,t)):(e.v="GET",e.g.ea(e.B,e.v,null,t)),ve(),function(e,t,n,r,a,i){e.info(function(){if(e.g)if(i){var s="",o=i.split("&");for(let e=0;e<o.length;e++){var l=o[e].split("=");if(l.length>1){const e=l[0];l=l[1];const t=e.split("_");s=t.length>=2&&"type"==t[1]?s+(e+"=")+l+"&":s+(e+"=redacted&")}}}else s=null;else s=i;return"XMLHTTP REQ ("+r+") [attempt "+a+"]: "+t+"\n"+n+"\n"+s})}(e.i,e.v,e.B,e.l,e.S,e.u)}function Me(e){return!!e.g&&("GET"==e.v&&2!=e.M&&e.j.Aa)}function Fe(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?Pe:(n=Number(t.substring(n,r)),isNaN(n)?Oe:(r+=1)+n>t.length?Pe:(t=t.slice(r,r+n),e.C=r+n,t))}function Ue(e){e.T=Date.now()+e.H,je(e,e.H)}function je(e,t){if(null!=e.D)throw Error("WatchDog timer not null");e.D=Te(l(e.aa,e),t)}function Ve(e){e.D&&(i.clearTimeout(e.D),e.D=null)}function ze(e){0==e.j.I||e.K||en(e.j,e)}function Be(e){Ve(e);var t=e.O;t&&"function"==typeof t.dispose&&t.dispose(),e.O=null,ae(e.V),e.g&&(t=e.g,e.g=null,t.abort(),t.dispose())}function He(e,t){try{var n=e.j;if(0!=n.I&&(n.g==e||$e(n.h,e)))if(!e.L&&$e(n.h,e)&&3==n.I){try{var r=n.Ba.g.parse(t)}catch(u){r=null}if(Array.isArray(r)&&3==r.length){var a=r;if(0==a[0]){e:if(!n.v){if(n.g){if(!(n.g.F+3e3<e.F))break e;Zt(n),Ht(n)}Yt(n),be(18)}}else n.xa=a[1],0<n.xa-n.K&&a[2]<37500&&n.F&&0==n.A&&!n.C&&(n.C=Te(l(n.Va,n),6e3));qe(n.h)<=1&&n.ta&&(n.ta=void 0)}else nn(n,11)}else if((e.L||n.g==e)&&Zt(n),!x(t))for(a=n.Ba.g.parse(t),t=0;t<a.length;t++){let l=a[t];const u=l[0];if(!(u<=n.K))if(n.K=u,l=l[1],2==n.I)if("c"==l[0]){n.M=l[1],n.ba=l[2];const t=l[3];null!=t&&(n.ka=t,n.j.info("VER="+n.ka));const a=l[4];null!=a&&(n.za=a,n.j.info("SVER="+n.za));const u=l[5];null!=u&&"number"===typeof u&&u>0&&(r=1.5*u,n.O=r,n.j.info("backChannelRequestTimeoutMs_="+r)),r=n;const h=e.g;if(h){const e=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var i=r.h;i.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(i.j=i.l,i.g=new Set,i.h&&(Xe(i,i.h),i.h=null))}if(r.G){const e=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(r.wa=e,at(r.J,r.G,e))}}n.I=3,n.l&&n.l.ra(),n.aa&&(n.T=Date.now()-e.F,n.j.info("Handshake RTT: "+n.T+"ms"));var s=e;if((r=n).na=an(r,r.L?r.ba:null,r.W),s.L){Ye(r.h,s);var o=s,c=r.O;c&&(o.H=c),o.D&&(Ve(o),Ue(o)),r.g=s}else Xt(r);n.i.length>0&&Gt(n)}else"stop"!=l[0]&&"close"!=l[0]||nn(n,7);else 3==n.I&&("stop"==l[0]||"close"==l[0]?"stop"==l[0]?nn(n,7):Bt(n):"noop"!=l[0]&&n.l&&n.l.qa(l),n.A=0)}ve()}catch(u){}}Ne.prototype.ba=function(e){e=e.target;const t=this.O;t&&3==Ut(e)?t.j():this.Y(e)},Ne.prototype.Y=function(e){try{if(e==this.g)e:{const l=Ut(this.g),c=this.g.ya();this.g.ca();if(!(l<3)&&(3!=l||this.g&&(this.h.h||this.g.la()||jt(this.g)))){this.K||4!=l||7==c||ve(),Ve(this);var t=this.g.ca();this.X=t;var n=function(e){if(!Me(e))return e.g.la();const t=jt(e.g);if(""===t)return"";let n="";const r=t.length,a=4==Ut(e.g);if(!e.h.i){if("undefined"===typeof TextDecoder)return Be(e),ze(e),"";e.h.i=new i.TextDecoder}for(let i=0;i<r;i++)e.h.h=!0,n+=e.h.i.decode(t[i],{stream:!(a&&i==r-1)});return t.length=0,e.h.g+=n,e.C=0,e.h.g}(this);if(this.o=200==t,function(e,t,n,r,a,i,s){e.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+a+"]: "+t+"\n"+n+"\n"+i+" "+s})}(this.i,this.v,this.B,this.l,this.S,l,t),this.o){if(this.U&&!this.L){t:{if(this.g){var r,a=this.g;if((r=a.g?a.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!x(r)){var s=r;break t}}s=null}if(!(e=s)){this.o=!1,this.m=3,be(12),Be(this),ze(this);break e}Ee(this.i,this.l,e,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,He(this,e)}if(this.R){let t;for(e=!0;!this.K&&this.C<n.length;){if(t=Fe(this,n),t==Pe){4==l&&(this.m=4,be(14),e=!1),Ee(this.i,this.l,null,"[Incomplete Response]");break}if(t==Oe){this.m=4,be(15),Ee(this.i,this.l,n,"[Invalid Chunk]"),e=!1;break}Ee(this.i,this.l,t,null),He(this,t)}if(Me(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=l||0!=n.length||this.h.h||(this.m=1,be(16),e=!1),this.o=this.o&&e,e){if(n.length>0&&!this.W){this.W=!0;var o=this.j;o.g==this&&o.aa&&!o.P&&(o.j.info("Great, no buffering proxy detected. Bytes received: "+n.length),Qt(o),o.P=!0,be(11))}}else Ee(this.i,this.l,n,"[Invalid Chunked Response]"),Be(this),ze(this)}else Ee(this.i,this.l,n,null),He(this,n);4==l&&Be(this),this.o&&!this.K&&(4==l?en(this.j,this):(this.o=!1,Ue(this)))}else(function(e){const t={};e=(e.g&&Ut(e)>=2&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<e.length;r++){if(x(e[r]))continue;var n=Ae(e[r]);const a=n[0];if("string"!==typeof(n=n[1]))continue;n=n.trim();const i=t[a]||[];t[a]=i,i.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,function(e){return e.join(", ")})})(this.g),400==t&&n.indexOf("Unknown SID")>0?(this.m=3,be(12)):(this.m=0,be(13)),Be(this),ze(this)}}}catch(_a){}},Ne.prototype.cancel=function(){this.K=!0,Be(this)},Ne.prototype.aa=function(){this.D=null;const e=Date.now();e-this.T>=0?(function(e,t){e.info(function(){return"TIMEOUT: "+t})}(this.i,this.B),2!=this.M&&(ve(),be(17)),Be(this),this.m=2,ze(this)):je(this,this.T-e)};var We=class{constructor(e,t){this.g=e,this.map=t}};function Ge(e){this.l=e||10,i.PerformanceNavigationTiming?e=(e=i.performance.getEntriesByType("navigation")).length>0&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(i.chrome&&i.chrome.loadTimes&&i.chrome.loadTimes()&&i.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Ke(e){return!!e.h||!!e.g&&e.g.size>=e.j}function qe(e){return e.h?1:e.g?e.g.size:0}function $e(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function Xe(e,t){e.g?e.g.add(t):e.h=t}function Ye(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function Qe(e){if(null!=e.h)return e.i.concat(e.h.G);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.G);return t}return f(e.i)}Ge.prototype.cancel=function(){if(this.i=Qe(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var Je=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ze(e){let t;this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1,e instanceof Ze?(this.l=e.l,tt(this,e.j),this.o=e.o,this.g=e.g,nt(this,e.u),this.h=e.h,rt(this,wt(e.i)),this.m=e.m):e&&(t=String(e).match(Je))?(this.l=!1,tt(this,t[1]||"",!0),this.o=st(t[2]||""),this.g=st(t[3]||"",!0),nt(this,t[4]),this.h=st(t[5]||"",!0),rt(this,t[6]||"",!0),this.m=st(t[7]||"")):(this.l=!1,this.i=new pt(null,this.l))}function et(e){return new Ze(e)}function tt(e,t,n){e.j=n?st(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function nt(e,t){if(t){if(t=Number(t),isNaN(t)||t<0)throw Error("Bad port number "+t);e.u=t}else e.u=null}function rt(e,t,n){t instanceof pt?(e.i=t,function(e,t){t&&!e.j&&(mt(e),e.i=null,e.g.forEach(function(e,t){const n=t.toLowerCase();t!=n&&(gt(this,t),bt(this,n,e))},e)),e.j=t}(e.i,e.l)):(n||(t=ot(t,ft)),e.i=new pt(t,e.l))}function at(e,t,n){e.i.set(t,n)}function it(e){return at(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function st(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function ot(e,t,n){return"string"===typeof e?(e=encodeURI(e).replace(t,lt),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function lt(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}Ze.prototype.toString=function(){const e=[];var t=this.j;t&&e.push(ot(t,ct,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(ot(t,ct,!0),"@"),e.push(Ie(n).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.u)&&e.push(":",String(n))),(n=this.h)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(ot(n,"/"==n.charAt(0)?ht:ut,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.m)&&e.push("#",ot(n,dt)),e.join("")},Ze.prototype.resolve=function(e){const t=et(this);let n=!!e.j;n?tt(t,e.j):n=!!e.o,n?t.o=e.o:n=!!e.g,n?t.g=e.g:n=null!=e.u;var r=e.h;if(n)nt(t,e.u);else if(n=!!e.h){if("/"!=r.charAt(0))if(this.g&&!this.h)r="/"+r;else{var a=t.h.lastIndexOf("/");-1!=a&&(r=t.h.slice(0,a+1)+r)}if(".."==(a=r)||"."==a)r="";else if(-1!=a.indexOf("./")||-1!=a.indexOf("/.")){r=0==a.lastIndexOf("/",0),a=a.split("/");const e=[];for(let t=0;t<a.length;){const n=a[t++];"."==n?r&&t==a.length&&e.push(""):".."==n?((e.length>1||1==e.length&&""!=e[0])&&e.pop(),r&&t==a.length&&e.push("")):(e.push(n),r=!0)}r=e.join("/")}else r=a}return n?t.h=r:n=""!==e.i.toString(),n?rt(t,wt(e.i)):n=!!e.m,n&&(t.m=e.m),t};var ct=/[#\/\?@]/g,ut=/[#\?:]/g,ht=/[#\?]/g,ft=/[#\?@]/g,dt=/#/g;function pt(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function mt(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(let n=0;n<e.length;n++){const r=e[n].indexOf("=");let a,i=null;r>=0?(a=e[n].substring(0,r),i=e[n].substring(r+1)):a=e[n],t(a,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}function gt(e,t){mt(e),t=Tt(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function vt(e,t){return mt(e),t=Tt(e,t),e.g.has(t)}function yt(e,t){mt(e);let n=[];if("string"===typeof t)vt(e,t)&&(n=n.concat(e.g.get(Tt(e,t))));else for(e=Array.from(e.g.values()),t=0;t<e.length;t++)n=n.concat(e[t]);return n}function bt(e,t,n){gt(e,t),n.length>0&&(e.i=null,e.g.set(Tt(e,t),f(n)),e.h+=n.length)}function wt(e){const t=new pt;return t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),t}function Tt(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function St(e,t,n,r,a){try{a&&(a.onload=null,a.onerror=null,a.onabort=null,a.ontimeout=null),r(n)}catch(i){}}function Et(){this.g=new oe}function kt(e){this.i=e.Sb||null,this.h=e.ab||!1}function _t(e,t){Q.call(this),this.H=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}function xt(e){e.j.read().then(e.Ma.bind(e)).catch(e.ga.bind(e))}function Ct(e){e.readyState=4,e.l=null,e.j=null,e.B=null,It(e)}function It(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function At(e){let t="";return O(e,function(e,n){t+=n,t+=":",t+=e,t+="\r\n"}),t}function Nt(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=At(n),"string"===typeof e?null!=n&&Ie(n):at(e,t,n))}function Rt(e){Q.call(this),this.headers=new Map,this.L=e||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}(e=pt.prototype).add=function(e,t){mt(this),this.i=null,e=Tt(this,e);let n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},e.forEach=function(e,t){mt(this),this.g.forEach(function(n,r){n.forEach(function(n){e.call(t,n,r,this)},this)},this)},e.set=function(e,t){return mt(this),this.i=null,vt(this,e=Tt(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},e.get=function(e,t){return e&&(e=yt(this,e)).length>0?String(e[0]):t},e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(let r=0;r<t.length;r++){var n=t[r];const a=Ie(n);n=yt(this,n);for(let t=0;t<n.length;t++){let r=a;""!==n[t]&&(r+="="+Ie(n[t])),e.push(r)}}return this.i=e.join("&")},u(kt,le),kt.prototype.g=function(){return new _t(this.i,this.h)},u(_t,Q),(e=_t.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.F=e,this.D=t,this.readyState=1,It(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const t={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};e&&(t.body=e),(this.H||i).fetch(new Request(this.D,t)).then(this.Pa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&4!=this.readyState&&(this.g=!1,Ct(this)),this.readyState=0},e.Pa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,It(this)),this.g&&(this.readyState=3,It(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if("undefined"!==typeof i.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;xt(this)}else e.text().then(this.Oa.bind(this),this.ga.bind(this))},e.Ma=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.B.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Ct(this):It(this),3==this.readyState&&xt(this)}},e.Oa=function(e){this.g&&(this.response=this.responseText=e,Ct(this))},e.Na=function(e){this.g&&(this.response=e,Ct(this))},e.ga=function(){this.g&&Ct(this)},e.setRequestHeader=function(e,t){this.A.append(e,t)},e.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(_t.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),u(Rt,Q);var Ot=/^https?$/i,Pt=["POST","PUT"];function Dt(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.o=5,Lt(e),Ft(e)}function Lt(e){e.A||(e.A=!0,J(e,"complete"),J(e,"error"))}function Mt(e){if(e.h&&"undefined"!=typeof a)if(e.v&&4==Ut(e))setTimeout(e.Ca.bind(e),0);else if(J(e,"readystatechange"),4==Ut(e)){e.h=!1;try{const a=e.ca();e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var r;if(r=0===a){let t=String(e.D).match(Je)[1]||null;!t&&i.self&&i.self.location&&(t=i.self.location.protocol.slice(0,-1)),r=!Ot.test(t?t.toLowerCase():"")}n=r}if(n)J(e,"complete"),J(e,"success");else{e.o=6;try{var s=Ut(e)>2?e.g.statusText:""}catch(o){s=""}e.l=s+" ["+e.ca()+"]",Lt(e)}}finally{Ft(e)}}}function Ft(e,t){if(e.g){e.m&&(clearTimeout(e.m),e.m=null);const r=e.g;e.g=null,t||J(e,"ready");try{r.onreadystatechange=null}catch(n){}}}function Ut(e){return e.g?e.g.readyState:0}function jt(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.F){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(t){return null}}function Vt(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function zt(e){this.za=0,this.i=[],this.j=new Se,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Vt("failFast",!1,e),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Vt("baseRetryDelayMs",5e3,e),this.Za=Vt("retryDelaySeedMs",1e4,e),this.Ta=Vt("forwardChannelMaxRetries",2,e),this.va=Vt("forwardChannelRequestTimeoutMs",2e4,e),this.ma=e&&e.xmlHttpFactory||void 0,this.Ua=e&&e.Rb||void 0,this.Aa=e&&e.useFetchStreams||!1,this.O=void 0,this.L=e&&e.supportsCrossDomainXhr||!1,this.M="",this.h=new Ge(e&&e.concurrentRequestLimit),this.Ba=new Et,this.S=e&&e.fastHandshake||!1,this.R=e&&e.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=e&&e.Pb||!1,e&&e.ua&&this.j.ua(),e&&e.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&e&&e.detectBufferingProxy||!1,this.ia=void 0,e&&e.longPollingTimeout&&e.longPollingTimeout>0&&(this.ia=e.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}function Bt(e){if(Wt(e),3==e.I){var t=e.V++,n=et(e.J);if(at(n,"SID",e.M),at(n,"RID",t),at(n,"TYPE","terminate"),qt(e,n),(t=new Ne(e,e.j,t)).M=2,t.A=it(et(n)),n=!1,i.navigator&&i.navigator.sendBeacon)try{n=i.navigator.sendBeacon(t.A.toString(),"")}catch(r){}!n&&i.Image&&((new Image).src=t.A,n=!0),n||(t.g=sn(t.j,null),t.g.ea(t.A)),t.F=Date.now(),Ue(t)}rn(e)}function Ht(e){e.g&&(Qt(e),e.g.cancel(),e.g=null)}function Wt(e){Ht(e),e.v&&(i.clearTimeout(e.v),e.v=null),Zt(e),e.h.cancel(),e.m&&("number"===typeof e.m&&i.clearTimeout(e.m),e.m=null)}function Gt(e){if(!Ke(e.h)&&!e.m){e.m=!0;var t=e.Ea;y||T(),b||(y(),b=!0),w.add(t,e),e.D=0}}function Kt(e,t){var n;n=t?t.l:e.V++;const r=et(e.J);at(r,"SID",e.M),at(r,"RID",n),at(r,"AID",e.K),qt(e,r),e.u&&e.o&&Nt(r,e.u,e.o),n=new Ne(e,e.j,n,e.D+1),null===e.u&&(n.J=e.o),t&&(e.i=t.G.concat(e.i)),t=$t(e,n,1e3),n.H=Math.round(.5*e.va)+Math.round(.5*e.va*Math.random()),Xe(e.h,n),De(n,r,t)}function qt(e,t){e.H&&O(e.H,function(e,n){at(t,n,e)}),e.l&&O({},function(e,n){at(t,n,e)})}function $t(e,t,n){n=Math.min(e.i.length,n);const r=e.l?l(e.l.Ka,e.l,e):null;e:{var a=e.i;let t=-1;for(;;){const e=["count="+n];-1==t?n>0?(t=a[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let l=!0;for(let c=0;c<n;c++){var i=a[c].g;const n=a[c].map;if((i-=t)<0)t=Math.max(0,a[c].g-100),l=!1;else try{i="req"+i+"_"||0;try{var o=n instanceof Map?n:Object.entries(n);for(const[t,n]of o){let r=n;s(n)&&(r=ie(n)),e.push(i+t+"="+encodeURIComponent(r))}}catch(qr){throw e.push(i+"type="+encodeURIComponent("_badmap")),qr}}catch(qr){r&&r(n)}}if(l){o=e.join("&");break e}}o=void 0}return e=e.i.splice(0,n),t.G=e,o}function Xt(e){if(!e.g&&!e.v){e.Y=1;var t=e.Da;y||T(),b||(y(),b=!0),w.add(t,e),e.A=0}}function Yt(e){return!(e.g||e.v||e.A>=3)&&(e.Y++,e.v=Te(l(e.Da,e),tn(e,e.A)),e.A++,!0)}function Qt(e){null!=e.B&&(i.clearTimeout(e.B),e.B=null)}function Jt(e){e.g=new Ne(e,e.j,"rpc",e.Y),null===e.u&&(e.g.J=e.o),e.g.P=0;var t=et(e.na);at(t,"RID","rpc"),at(t,"SID",e.M),at(t,"AID",e.K),at(t,"CI",e.F?"0":"1"),!e.F&&e.ia&&at(t,"TO",e.ia),at(t,"TYPE","xmlhttp"),qt(e,t),e.u&&e.o&&Nt(t,e.u,e.o),e.O&&(e.g.H=e.O);var n=e.g;e=e.ba,n.M=1,n.A=it(et(t)),n.u=null,n.R=!0,Le(n,e)}function Zt(e){null!=e.C&&(i.clearTimeout(e.C),e.C=null)}function en(e,t){var n=null;if(e.g==t){Zt(e),Qt(e),e.g=null;var r=2}else{if(!$e(e.h,t))return;n=t.G,Ye(e.h,t),r=1}if(0!=e.I)if(t.o)if(1==r){n=t.u?t.u.length:0,t=Date.now()-t.F;var a=e.D;J(r=me(),new we(r,n)),Gt(e)}else Xt(e);else if(3==(a=t.m)||0==a&&t.X>0||!(1==r&&function(e,t){return!(qe(e.h)>=e.h.j-(e.m?1:0))&&(e.m?(e.i=t.G.concat(e.i),!0):!(1==e.I||2==e.I||e.D>=(e.Sa?0:e.Ta))&&(e.m=Te(l(e.Ea,e,t),tn(e,e.D)),e.D++,!0))}(e,t)||2==r&&Yt(e)))switch(n&&n.length>0&&(t=e.h,t.i=t.i.concat(n)),a){case 1:nn(e,5);break;case 4:nn(e,10);break;case 3:nn(e,6);break;default:nn(e,2)}}function tn(e,t){let n=e.Qa+Math.floor(Math.random()*e.Za);return e.isActive()||(n*=2),n*t}function nn(e,t){if(e.j.info("Error code "+t),2==t){var n=l(e.bb,e),r=e.Ua;const t=!r;r=new Ze(r||"//www.google.com/images/cleardot.gif"),i.location&&"http"==i.location.protocol||tt(r,"https"),it(r),t?function(e,t){const n=new Se;if(i.Image){const r=new Image;r.onload=c(St,n,"TestLoadImage: loaded",!0,t,r),r.onerror=c(St,n,"TestLoadImage: error",!1,t,r),r.onabort=c(St,n,"TestLoadImage: abort",!1,t,r),r.ontimeout=c(St,n,"TestLoadImage: timeout",!1,t,r),i.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=e}else t(!1)}(r.toString(),n):function(e,t){new Se;const n=new AbortController,r=setTimeout(()=>{n.abort(),St(0,0,!1,t)},1e4);fetch(e,{signal:n.signal}).then(e=>{clearTimeout(r),e.ok?St(0,0,!0,t):St(0,0,!1,t)}).catch(()=>{clearTimeout(r),St(0,0,!1,t)})}(r.toString(),n)}else be(2);e.I=0,e.l&&e.l.pa(t),rn(e),Wt(e)}function rn(e){if(e.I=0,e.ja=[],e.l){const t=Qe(e.h);0==t.length&&0==e.i.length||(d(e.ja,t),d(e.ja,e.i),e.h.i.length=0,f(e.i),e.i.length=0),e.l.oa()}}function an(e,t,n){var r=n instanceof Ze?et(n):new Ze(n);if(""!=r.g)t&&(r.g=t+"."+r.g),nt(r,r.u);else{var a=i.location;r=a.protocol,t=t?t+"."+a.hostname:a.hostname,a=+a.port;const e=new Ze(null);r&&tt(e,r),t&&(e.g=t),a&&nt(e,a),n&&(e.h=n),r=e}return n=e.G,t=e.wa,n&&t&&at(r,n,t),at(r,"VER",e.ka),qt(e,r),r}function sn(e,t,n){if(t&&!e.L)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Aa&&!e.ma?new Rt(new kt({ab:n})):new Rt(e.ma)).Fa(e.L),t}function on(){}function ln(){}function cn(e,t){Q.call(this),this.g=new zt(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.sa&&(e?e["X-WebChannel-Client-Profile"]=t.sa:e={"X-WebChannel-Client-Profile":t.sa}),this.g.U=e,(e=t&&t.Qb)&&!x(e)&&(this.g.u=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!x(t)&&(this.g.G=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new fn(this)}function un(e){he.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function hn(){fe.call(this),this.status=1}function fn(e){this.g=e}(e=Rt.prototype).Fa=function(e){this.H=e},e.ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+e);t=t?t.toUpperCase():"GET",this.D=e,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():ke.g(),this.g.onreadystatechange=h(l(this.Ca,this));try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(s){return void Dt(this,s)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var a in r)n.set(a,r[a]);else{if("function"!==typeof r.keys||"function"!==typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const e of r.keys())n.set(e,r.get(e))}r=Array.from(n.keys()).find(e=>"content-type"==e.toLowerCase()),a=i.FormData&&e instanceof i.FormData,!(Array.prototype.indexOf.call(Pt,t,void 0)>=0)||r||a||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[i,o]of n)this.g.setRequestHeader(i,o);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(e),this.v=!1}catch(s){Dt(this,s)}},e.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=e||7,J(this,"complete"),J(this,"abort"),Ft(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ft(this,!0)),Rt.Z.N.call(this)},e.Ca=function(){this.u||(this.B||this.v||this.j?Mt(this):this.Xa())},e.Xa=function(){Mt(this)},e.isActive=function(){return!!this.g},e.ca=function(){try{return Ut(this)>2?this.g.status:-1}catch(e){return-1}},e.la=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},e.La=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),se(t)}},e.ya=function(){return this.o},e.Ha=function(){return"string"===typeof this.l?this.l:String(this.l)},(e=zt.prototype).ka=8,e.I=1,e.connect=function(e,t,n,r){be(0),this.W=e,this.H=t||{},n&&void 0!==r&&(this.H.OSID=n,this.H.OAID=r),this.F=this.X,this.J=an(this,null,this.W),Gt(this)},e.Ea=function(e){if(this.m)if(this.m=null,1==this.I){if(!e){this.V=Math.floor(1e5*Math.random()),e=this.V++;const a=new Ne(this,this.j,e);let i=this.o;if(this.U&&(i?(i=P(i),L(i,this.U)):i=this.U),null!==this.u||this.R||(a.J=i,i=null),this.S)e:{for(var t=0,n=0;n<this.i.length;n++){var r=this.i[n];if(void 0===(r="__data__"in r.map&&"string"===typeof(r=r.map.__data__)?r.length:void 0))break;if((t+=r)>4096){t=n;break e}if(4096===t||n===this.i.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=$t(this,a,t),at(n=et(this.J),"RID",e),at(n,"CVER",22),this.G&&at(n,"X-HTTP-Session-Id",this.G),qt(this,n),i&&(this.R?t="headers="+Ie(At(i))+"&"+t:this.u&&Nt(n,this.u,i)),Xe(this.h,a),this.Ra&&at(n,"TYPE","init"),this.S?(at(n,"$req",t),at(n,"SID","null"),a.U=!0,De(a,n,null)):De(a,n,t),this.I=2}}else 3==this.I&&(e?Kt(this,e):0==this.i.length||Ke(this.h)||Kt(this))},e.Da=function(){if(this.v=null,Jt(this),this.aa&&!(this.P||null==this.g||this.T<=0)){var e=4*this.T;this.j.info("BP detection timer enabled: "+e),this.B=Te(l(this.Wa,this),e)}},e.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,be(10),Ht(this),Jt(this))},e.Va=function(){null!=this.C&&(this.C=null,Ht(this),Yt(this),be(19))},e.bb=function(e){e?(this.j.info("Successfully pinged google.com"),be(2)):(this.j.info("Failed to ping google.com"),be(1))},e.isActive=function(){return!!this.l&&this.l.isActive(this)},(e=on.prototype).ra=function(){},e.qa=function(){},e.pa=function(){},e.oa=function(){},e.isActive=function(){return!0},e.Ka=function(){},ln.prototype.g=function(e,t){return new cn(e,t)},u(cn,Q),cn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},cn.prototype.close=function(){Bt(this.g)},cn.prototype.o=function(e){var t=this.g;if("string"===typeof e){var n={};n.__data__=e,e=n}else this.v&&((n={}).__data__=ie(e),e=n);t.i.push(new We(t.Ya++,e)),3==t.I&&Gt(t)},cn.prototype.N=function(){this.g.l=null,delete this.j,Bt(this.g),delete this.g,cn.Z.N.call(this)},u(un,he),u(hn,fe),u(fn,on),fn.prototype.ra=function(){J(this.g,"a")},fn.prototype.qa=function(e){J(this.g,new un(e))},fn.prototype.pa=function(e){J(this.g,new hn)},fn.prototype.oa=function(){J(this.g,"b")},ln.prototype.createWebChannel=ln.prototype.g,cn.prototype.send=cn.prototype.o,cn.prototype.open=cn.prototype.m,cn.prototype.close=cn.prototype.close,Hr=Gr.createWebChannelTransport=function(){return new ln},Br=Gr.getStatEventTarget=function(){return me()},zr=Gr.Event=de,Vr=Gr.Stat={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},_e.NO_ERROR=0,_e.TIMEOUT=8,_e.HTTP_ERROR=6,jr=Gr.ErrorCode=_e,xe.COMPLETE="complete",Ur=Gr.EventType=xe,ce.EventType=ue,ue.OPEN="a",ue.CLOSE="b",ue.ERROR="c",ue.MESSAGE="d",Q.prototype.listen=Q.prototype.J,Fr=Gr.WebChannel=ce,Gr.FetchXmlHttpFactory=kt,Rt.prototype.listenOnce=Rt.prototype.K,Rt.prototype.getLastError=Rt.prototype.Ha,Rt.prototype.getLastErrorCode=Rt.prototype.ya,Rt.prototype.getStatus=Rt.prototype.ca,Rt.prototype.getResponseJson=Rt.prototype.La,Rt.prototype.getResponseText=Rt.prototype.la,Rt.prototype.send=Rt.prototype.ea,Rt.prototype.setWithCredentials=Rt.prototype.Fa,Mr=Gr.XhrIo=Rt}).apply("undefined"!==typeof Wr?Wr:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});const Kr="@firebase/firestore",qr="4.9.3";class $r{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}$r.UNAUTHENTICATED=new $r(null),$r.GOOGLE_CREDENTIALS=new $r("google-credentials-uid"),$r.FIRST_PARTY=new $r("first-party-uid"),$r.MOCK_USER=new $r("mock-user");let Xr="12.7.0";const Yr=new dn("@firebase/firestore");function Qr(){return Yr.logLevel}function Jr(e){if(Yr.logLevel<=ln.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const a=n.map(ta);Yr.debug("Firestore (".concat(Xr,"): ").concat(e),...a)}}function Zr(e){if(Yr.logLevel<=ln.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const a=n.map(ta);Yr.error("Firestore (".concat(Xr,"): ").concat(e),...a)}}function ea(e){if(Yr.logLevel<=ln.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const a=n.map(ta);Yr.warn("Firestore (".concat(Xr,"): ").concat(e),...a)}}function ta(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(t){return e}}function na(e,t,n){let r="Unexpected state";"string"==typeof t?r=t:n=t,ra(e,r,n)}function ra(e,t,n){let r="FIRESTORE (".concat(Xr,") INTERNAL ASSERTION FAILED: ").concat(t," (ID: ").concat(e.toString(16),")");if(void 0!==n)try{r+=" CONTEXT: "+JSON.stringify(n)}catch(e){r+=" CONTEXT: "+n}throw Zr(r),new Error(r)}function aa(e,t,n,r){let a="Unexpected state";"string"==typeof n?a=n:r=n,e||ra(t,a,r)}function ia(e,t){return e}const sa={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class oa extends Wt{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>"".concat(this.name,": [code=").concat(this.code,"]: ").concat(this.message)}}class la{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class ca{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(e))}}class ua{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t($r.UNAUTHENTICATED))}shutdown(){}}class ha{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class fa{constructor(e){this.t=e,this.currentUser=$r.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){aa(void 0===this.o,42304);let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let a=new la;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new la,e.enqueueRetryable(()=>r(this.currentUser))};const i=()=>{const t=a;e.enqueueRetryable(async()=>{await t.promise,await r(this.currentUser)})},s=e=>{Jr("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),i())};this.t.onInit(e=>s(e)),setTimeout(()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?s(e):(Jr("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new la)}},0),i()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(t=>this.i!==e?(Jr("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(aa("string"==typeof t.accessToken,31837,{l:t}),new ca(t.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return aa(null===e||"string"==typeof e,2055,{h:e}),new $r(e)}}class da{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=$r.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class pa{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new da(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t($r.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class ma{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class ga{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,mr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){aa(void 0===this.o,3512);const n=e=>{null!=e.error&&Jr("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(e.error.message));const n=e.token!==this.m;return this.m=e.token,Jr("FirebaseAppCheckTokenProvider","Received ".concat(n?"new":"existing"," token.")),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable(()=>n(t))};const r=e=>{Jr("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(e=>r(e)),setTimeout(()=>{if(!this.appCheck){const e=this.V.getImmediate({optional:!0});e?r(e):Jr("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new ma(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(e=>e?(aa("string"==typeof e.token,44558,{tokenResult:e}),this.m=e.token,new ma(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function va(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}class ya{static newId(){const e=62*Math.floor(256/62);let t="";for(;t.length<20;){const n=va(40);for(let r=0;r<n.length;++r)t.length<20&&n[r]<e&&(t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[r]%62))}return t}}function ba(e,t){return e<t?-1:e>t?1:0}function wa(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.charAt(r),a=t.charAt(r);if(n!==a)return Ea(n)===Ea(a)?ba(n,a):Ea(n)?1:-1}return ba(e.length,t.length)}const Ta=55296,Sa=57343;function Ea(e){const t=e.charCodeAt(0);return t>=Ta&&t<=Sa}function ka(e,t,n){return e.length===t.length&&e.every((e,r)=>n(e,t[r]))}const _a="__name__";class xa{constructor(e,t,n){void 0===t?t=0:t>e.length&&na(637,{offset:t,range:e.length}),void 0===n?n=e.length-t:n>e.length-t&&na(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===xa.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof xa?e.forEach(e=>{t.push(e)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=xa.compareSegments(e.get(r),t.get(r));if(0!==n)return n}return ba(e.length,t.length)}static compareSegments(e,t){const n=xa.isNumericId(e),r=xa.isNumericId(t);return n&&!r?-1:!n&&r?1:n&&r?xa.extractNumericId(e).compare(xa.extractNumericId(t)):wa(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Or.fromString(e.substring(4,e.length-2))}}class Ca extends xa{construct(e,t,n){return new Ca(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(){const e=[];for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const a of n){if(a.indexOf("//")>=0)throw new oa(sa.INVALID_ARGUMENT,"Invalid segment (".concat(a,"). Paths must not contain // in them."));e.push(...a.split("/").filter(e=>e.length>0))}return new Ca(e)}static emptyPath(){return new Ca([])}}const Ia=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Aa extends xa{construct(e,t,n){return new Aa(e,t,n)}static isValidIdentifier(e){return Ia.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Aa.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===_a}static keyField(){return new Aa([_a])}static fromServerFormat(e){const t=[];let n="",r=0;const a=()=>{if(0===n.length)throw new oa(sa.INVALID_ARGUMENT,"Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));t.push(n),n=""};let i=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new oa(sa.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new oa(sa.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(i=!i,r++):"."!==t||i?(n+=t,r++):(a(),r++)}if(a(),i)throw new oa(sa.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Aa(t)}static emptyPath(){return new Aa([])}}class Na{constructor(e){this.path=e}static fromPath(e){return new Na(Ca.fromString(e))}static fromName(e){return new Na(Ca.fromString(e).popFirst(5))}static empty(){return new Na(Ca.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===Ca.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return Ca.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Na(new Ca(e.slice()))}}function Ra(e,t,n){if(!n)throw new oa(sa.INVALID_ARGUMENT,"Function ".concat(e,"() cannot be called with an empty ").concat(t,"."))}function Oa(e){if(!Na.isDocumentKey(e))throw new oa(sa.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(e," has ").concat(e.length,"."))}function Pa(e){if(Na.isDocumentKey(e))throw new oa(sa.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(e," has ").concat(e.length,"."))}function Da(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}function La(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e="".concat(e.substring(0,20),"...")),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?"a custom ".concat(t," object"):"an object"}}return"function"==typeof e?"a function":na(12329,{type:typeof e})}function Ma(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new oa(sa.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=La(e);throw new oa(sa.INVALID_ARGUMENT,"Expected type '".concat(t.name,"', but it was: ").concat(n))}}return e}function Fa(e,t){const n={typeString:e};return t&&(n.value=t),n}function Ua(e,t){if(!Da(e))throw new oa(sa.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in t)if(t[r]){const a=t[r].typeString,i="value"in t[r]?{value:t[r].value}:void 0;if(!(r in e)){n="JSON missing required field: '".concat(r,"'");break}const s=e[r];if(a&&typeof s!==a){n="JSON field '".concat(r,"' must be a ").concat(a,".");break}if(void 0!==i&&s!==i.value){n="Expected '".concat(r,"' field to equal '").concat(i.value,"'");break}}if(n)throw new oa(sa.INVALID_ARGUMENT,n);return!0}const ja=-62135596800,Va=1e6;class za{static now(){return za.fromMillis(Date.now())}static fromDate(e){return za.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*Va);return new za(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new oa(sa.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new oa(sa.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<ja)throw new oa(sa.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new oa(sa.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Va}_compareTo(e){return this.seconds===e.seconds?ba(this.nanoseconds,e.nanoseconds):ba(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:za._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Ua(e,za._jsonSchema))return new za(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-ja;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}za._jsonSchemaVersion="firestore/timestamp/1.0",za._jsonSchema={type:Fa("string",za._jsonSchemaVersion),seconds:Fa("number"),nanoseconds:Fa("number")};class Ba{static fromTimestamp(e){return new Ba(e)}static min(){return new Ba(new za(0,0))}static max(){return new Ba(new za(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Ha=-1;class Wa{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}}Wa.UNKNOWN_ID=-1;function Ga(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,a=Ba.fromTimestamp(1e9===r?new za(n+1,0):new za(n,r));return new qa(a,Na.empty(),t)}function Ka(e){return new qa(e.readTime,e.key,Ha)}class qa{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new qa(Ba.min(),Na.empty(),Ha)}static max(){return new qa(Ba.max(),Na.empty(),Ha)}}function $a(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=Na.comparator(e.documentKey,t.documentKey),0!==n?n:ba(e.largestBatchId,t.largestBatchId))}const Xa="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Ya{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}async function Qa(e){if(e.code!==sa.FAILED_PRECONDITION||e.message!==Xa)throw e;Jr("LocalStore","Unexpectedly lost primary lease")}class Ja{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&na(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Ja((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof Ja?t:Ja.resolve(t)}catch(e){return Ja.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):Ja.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):Ja.reject(t)}static resolve(e){return new Ja((t,n)=>{t(e)})}static reject(e){return new Ja((t,n)=>{n(e)})}static waitFor(e){return new Ja((t,n)=>{let r=0,a=0,i=!1;e.forEach(e=>{++r,e.next(()=>{++a,i&&a===r&&t()},e=>n(e))}),i=!0,a===r&&t()})}static or(e){let t=Ja.resolve(!1);for(const n of e)t=t.next(e=>e?Ja.resolve(e):n());return t}static forEach(e,t){const n=[];return e.forEach((e,r)=>{n.push(t.call(this,e,r))}),this.waitFor(n)}static mapArray(e,t){return new Ja((n,r)=>{const a=e.length,i=new Array(a);let s=0;for(let o=0;o<a;o++){const l=o;t(e[l]).next(e=>{i[l]=e,++s,s===a&&n(i)},e=>r(e))}})}static doWhile(e,t){return new Ja((n,r)=>{const a=()=>{!0===e()?t().next(()=>{a()},r):n()};a()})}}function Za(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function ei(e){return"IndexedDbTransactionError"===e.name}class ti{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ae(e),this.ue=e=>t.writeSequenceNumber(e))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}ti.ce=-1;const ni=-1;function ri(e){return null==e}function ai(e){return 0===e&&1/e==-1/0}function ii(e){return"number"==typeof e&&Number.isInteger(e)&&!ai(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}const si="\x01";function oi(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=ci(t)),t=li(e.get(n),t);return ci(t)}function li(e,t){let n=t;const r=e.length;for(let a=0;a<r;a++){const t=e.charAt(a);switch(t){case"\0":n+="\x01\x10";break;case si:n+="\x01\x11";break;default:n+=t}}return n}function ci(e){return e+si+"\x01"}const ui="remoteDocuments",hi="owner",fi="mutationQueues",di="mutations";const pi="documentMutations",mi="remoteDocumentsV14",gi="remoteDocumentGlobal",vi="targets",yi="targetDocuments",bi="targetGlobal",wi="collectionParents",Ti="clientMetadata",Si="bundles",Ei="namedQueries",ki="indexConfiguration",_i="indexState",xi="indexEntries",Ci="documentOverlays",Ii="globals",Ai=[fi,di,pi,ui,vi,hi,bi,yi,Ti,gi,wi,Si,Ei],Ni=[fi,di,pi,mi,vi,hi,bi,yi,Ti,gi,wi,Si,Ei,Ci],Ri=Ni,Oi=[...Ri,ki,_i,xi];function Pi(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function Di(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function Li(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class Mi{constructor(e,t){this.comparator=e,this.root=t||Ui.EMPTY}insert(e,t){return new Mi(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Ui.BLACK,null,null))}remove(e){return new Mi(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ui.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push("".concat(t,":").concat(n)),!1)),"{".concat(e.join(", "),"}")}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Fi(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Fi(this.root,e,this.comparator,!1)}getReverseIterator(){return new Fi(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Fi(this.root,e,this.comparator,!0)}}class Fi{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=t?n(e.key,t):1,t&&r&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(0===a){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ui{constructor(e,t,n,r,a){this.key=e,this.value=t,this.color=null!=n?n:Ui.RED,this.left=null!=r?r:Ui.EMPTY,this.right=null!=a?a:Ui.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,a){return new Ui(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=a?a:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const a=n(e,r.key);return r=a<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===a?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Ui.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return Ui.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ui.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ui.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw na(43730,{key:this.key,value:this.value});if(this.right.isRed())throw na(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw na(27949);return e+(this.isRed()?0:1)}}Ui.EMPTY=null,Ui.RED=!0,Ui.BLACK=!1,Ui.EMPTY=new class{constructor(){this.size=0}get key(){throw na(57766)}get value(){throw na(16141)}get color(){throw na(16727)}get left(){throw na(29726)}get right(){throw na(36894)}copy(e,t,n,r,a){return this}insert(e,t,n){return new Ui(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class ji{constructor(e){this.comparator=e,this.data=new Mi(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Vi(this.data.getIterator())}getIteratorFrom(e){return new Vi(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(e=>{t=t.add(e)}),t}isEqual(e){if(!(e instanceof ji))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new ji(this.comparator);return t.data=e,t}}class Vi{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class zi{constructor(e){this.fields=e,e.sort(Aa.comparator)}static empty(){return new zi([])}unionWith(e){let t=new ji(Aa.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new zi(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return ka(this.fields,e.fields,(e,t)=>e.isEqual(t))}}class Bi extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Hi{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new Bi("Invalid base64 string: "+e):e}}(e);return new Hi(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new Hi(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ba(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Hi.EMPTY_BYTE_STRING=new Hi("");const Wi=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Gi(e){if(aa(!!e,39018),"string"==typeof e){let t=0;const n=Wi.exec(e);if(aa(!!n,46558,{timestamp:e}),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:Ki(e.seconds),nanos:Ki(e.nanos)}}function Ki(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function qi(e){return"string"==typeof e?Hi.fromBase64String(e):Hi.fromUint8Array(e)}const $i="server_timestamp",Xi="__type__",Yi="__previous_value__",Qi="__local_write_time__";function Ji(e){var t,n;return(null===(t=((null===e||void 0===e||null===(n=e.mapValue)||void 0===n?void 0:n.fields)||{})[Xi])||void 0===t?void 0:t.stringValue)===$i}function Zi(e){const t=e.mapValue.fields[Yi];return Ji(t)?Zi(t):t}function es(e){const t=Gi(e.mapValue.fields[Qi].timestampValue);return new za(t.seconds,t.nanos)}class ts{constructor(e,t,n,r,a,i,s,o,l,c){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=a,this.forceLongPolling=i,this.autoDetectLongPolling=s,this.longPollingOptions=o,this.useFetchStreams=l,this.isUsingEmulator=c}}const ns="(default)";class rs{constructor(e,t){this.projectId=e,this.database=t||ns}static empty(){return new rs("","")}get isDefaultDatabase(){return this.database===ns}isEqual(e){return e instanceof rs&&e.projectId===this.projectId&&e.database===this.database}}const as="__type__",is="__max__",ss={mapValue:{fields:{__type__:{stringValue:is}}}},os="__vector__",ls="value";function cs(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Ji(e)?4:_s(e)?9007199254740991:Es(e)?10:11:na(28295,{value:e})}function us(e,t){if(e===t)return!0;const n=cs(e);if(n!==cs(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return es(e).isEqual(es(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=Gi(e.timestampValue),r=Gi(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return qi(e.bytesValue).isEqual(qi(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return Ki(e.geoPointValue.latitude)===Ki(t.geoPointValue.latitude)&&Ki(e.geoPointValue.longitude)===Ki(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return Ki(e.integerValue)===Ki(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=Ki(e.doubleValue),r=Ki(t.doubleValue);return n===r?ai(n)===ai(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return ka(e.arrayValue.values||[],t.arrayValue.values||[],us);case 10:case 11:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(Pi(n)!==Pi(r))return!1;for(const a in n)if(n.hasOwnProperty(a)&&(void 0===r[a]||!us(n[a],r[a])))return!1;return!0}(e,t);default:return na(52216,{left:e})}}function hs(e,t){return void 0!==(e.values||[]).find(e=>us(e,t))}function fs(e,t){if(e===t)return 0;const n=cs(e),r=cs(t);if(n!==r)return ba(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return ba(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=Ki(e.integerValue||e.doubleValue),r=Ki(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return ds(e.timestampValue,t.timestampValue);case 4:return ds(es(e),es(t));case 5:return wa(e.stringValue,t.stringValue);case 6:return function(e,t){const n=qi(e),r=qi(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let a=0;a<n.length&&a<r.length;a++){const e=ba(n[a],r[a]);if(0!==e)return e}return ba(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=ba(Ki(e.latitude),Ki(t.latitude));return 0!==n?n:ba(Ki(e.longitude),Ki(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return ps(e.arrayValue,t.arrayValue);case 10:return function(e,t,n,r,a,i){const s=e.fields||{},o=t.fields||{},l=null===(n=s[ls])||void 0===n?void 0:n.arrayValue,c=null===(r=o[ls])||void 0===r?void 0:r.arrayValue,u=ba((null===l||void 0===l||null===(a=l.values)||void 0===a?void 0:a.length)||0,(null===c||void 0===c||null===(i=c.values)||void 0===i?void 0:i.length)||0);return 0!==u?u:ps(l,c)}(e.mapValue,t.mapValue);case 11:return function(e,t){if(e===ss.mapValue&&t===ss.mapValue)return 0;if(e===ss.mapValue)return 1;if(t===ss.mapValue)return-1;const n=e.fields||{},r=Object.keys(n),a=t.fields||{},i=Object.keys(a);r.sort(),i.sort();for(let s=0;s<r.length&&s<i.length;++s){const e=wa(r[s],i[s]);if(0!==e)return e;const t=fs(n[r[s]],a[i[s]]);if(0!==t)return t}return ba(r.length,i.length)}(e.mapValue,t.mapValue);default:throw na(23264,{he:n})}}function ds(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return ba(e,t);const n=Gi(e),r=Gi(t),a=ba(n.seconds,r.seconds);return 0!==a?a:ba(n.nanos,r.nanos)}function ps(e,t){const n=e.values||[],r=t.values||[];for(let a=0;a<n.length&&a<r.length;++a){const e=fs(n[a],r[a]);if(e)return e}return ba(n.length,r.length)}function ms(e){return gs(e)}function gs(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=Gi(e);return"time(".concat(t.seconds,",").concat(t.nanos,")")}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return qi(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return Na.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return"geo(".concat(e.latitude,",").concat(e.longitude,")")}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=gs(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const a of t)r?r=!1:n+=",",n+="".concat(a,":").concat(gs(e.fields[a]));return n+"}"}(e.mapValue):na(61005,{value:e})}function vs(e){switch(cs(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=Zi(e);return t?16+vs(t):16;case 5:return 2*e.stringValue.length;case 6:return qi(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return function(e){return(e.values||[]).reduce((e,t)=>e+vs(t),0)}(e.arrayValue);case 10:case 11:return function(e){let t=0;return Di(e.fields,(e,n)=>{t+=e.length+vs(n)}),t}(e.mapValue);default:throw na(13486,{value:e})}}function ys(e){return!!e&&"integerValue"in e}function bs(e){return!!e&&"arrayValue"in e}function ws(e){return!!e&&"nullValue"in e}function Ts(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function Ss(e){return!!e&&"mapValue"in e}function Es(e){var t,n;return(null===(t=((null===e||void 0===e||null===(n=e.mapValue)||void 0===n?void 0:n.fields)||{})[as])||void 0===t?void 0:t.stringValue)===os}function ks(e){if(e.geoPointValue)return{geoPointValue:l({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:l({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return Di(e.mapValue.fields,(e,n)=>t.mapValue.fields[e]=ks(n)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=ks(e.arrayValue.values[n]);return t}return l({},e)}function _s(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===is}class xs{constructor(e){this.value=e}static empty(){return new xs({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!Ss(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ks(t)}setAll(e){let t=Aa.emptyPath(),n={},r=[];e.forEach((e,a)=>{if(!t.isImmediateParentOf(a)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=a.popLast()}e?n[a.lastSegment()]=ks(e):r.push(a.lastSegment())});const a=this.getFieldsMap(t);this.applyChanges(a,n,r)}delete(e){const t=this.field(e.popLast());Ss(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return us(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];Ss(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){Di(t,(t,n)=>e[t]=n);for(const r of n)delete e[r]}clone(){return new xs(ks(this.value))}}function Cs(e){const t=[];return Di(e.fields,(e,n)=>{const r=new Aa([e]);if(Ss(n)){const e=Cs(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)}),new zi(t)}class Is{constructor(e,t,n,r,a,i,s){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=a,this.data=i,this.documentState=s}static newInvalidDocument(e){return new Is(e,0,Ba.min(),Ba.min(),Ba.min(),xs.empty(),0)}static newFoundDocument(e,t,n,r){return new Is(e,1,t,Ba.min(),n,r,0)}static newNoDocument(e,t){return new Is(e,2,t,Ba.min(),Ba.min(),xs.empty(),0)}static newUnknownDocument(e,t){return new Is(e,3,t,Ba.min(),Ba.min(),xs.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ba.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=xs.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=xs.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ba.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Is&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Is(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {createTime: ").concat(this.createTime,"}), {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}class As{constructor(e,t){this.position=e,this.inclusive=t}}function Ns(e,t,n){let r=0;for(let a=0;a<e.position.length;a++){const i=t[a],s=e.position[a];if(r=i.field.isKeyField()?Na.comparator(Na.fromName(s.referenceValue),n.key):fs(s,n.data.field(i.field)),"desc"===i.dir&&(r*=-1),0!==r)break}return r}function Rs(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!us(e.position[n],t.position[n]))return!1;return!0}class Os{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";this.field=e,this.dir=t}}function Ps(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class Ds{}class Ls extends Ds{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new Hs(e,t,n):"array-contains"===t?new qs(e,n):"in"===t?new $s(e,n):"not-in"===t?new Xs(e,n):"array-contains-any"===t?new Ys(e,n):new Ls(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new Ws(e,n):new Gs(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&void 0===t.nullValue&&this.matchesComparison(fs(t,this.value)):null!==t&&cs(this.value)===cs(t)&&this.matchesComparison(fs(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return na(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ms extends Ds{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Ms(e,t)}matches(e){return Fs(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.Pe||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Fs(e){return"and"===e.op}function Us(e){return js(e)&&Fs(e)}function js(e){for(const t of e.filters)if(t instanceof Ms)return!1;return!0}function Vs(e){if(e instanceof Ls)return e.field.canonicalString()+e.op.toString()+ms(e.value);if(Us(e))return e.filters.map(e=>Vs(e)).join(",");{const t=e.filters.map(e=>Vs(e)).join(",");return"".concat(e.op,"(").concat(t,")")}}function zs(e,t){return e instanceof Ls?function(e,t){return t instanceof Ls&&e.op===t.op&&e.field.isEqual(t.field)&&us(e.value,t.value)}(e,t):e instanceof Ms?function(e,t){return t instanceof Ms&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce((e,n,r)=>e&&zs(n,t.filters[r]),!0)}(e,t):void na(19439)}function Bs(e){return e instanceof Ls?function(e){return"".concat(e.field.canonicalString()," ").concat(e.op," ").concat(ms(e.value))}(e):e instanceof Ms?function(e){return e.op.toString()+" {"+e.getFilters().map(Bs).join(" ,")+"}"}(e):"Filter"}class Hs extends Ls{constructor(e,t,n){super(e,t,n),this.key=Na.fromName(n.referenceValue)}matches(e){const t=Na.comparator(e.key,this.key);return this.matchesComparison(t)}}class Ws extends Ls{constructor(e,t){super(e,"in",t),this.keys=Ks("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class Gs extends Ls{constructor(e,t){super(e,"not-in",t),this.keys=Ks("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function Ks(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map(e=>Na.fromName(e.referenceValue))}class qs extends Ls{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return bs(t)&&hs(t.arrayValue,this.value)}}class $s extends Ls{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&hs(this.value.arrayValue,t)}}class Xs extends Ls{constructor(e,t){super(e,"not-in",t)}matches(e){if(hs(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&void 0===t.nullValue&&!hs(this.value.arrayValue,t)}}class Ys extends Ls{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!bs(t)||!t.arrayValue.values)&&t.arrayValue.values.some(e=>hs(this.value.arrayValue,e))}}class Qs{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=a,this.startAt=i,this.endAt=s,this.Te=null}}function Js(e){return new Qs(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function Zs(e){const t=ia(e);if(null===t.Te){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(e=>Vs(e)).join(","),e+="|ob:",e+=t.orderBy.map(e=>function(e){return e.field.canonicalString()+e.dir}(e)).join(","),ri(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(e=>ms(e)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(e=>ms(e)).join(",")),t.Te=e}return t.Te}function eo(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!Ps(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!zs(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!Rs(e.startAt,t.startAt)&&Rs(e.endAt,t.endAt)}function to(e){return Na.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}class no{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=a,this.limitType=i,this.startAt=s,this.endAt=o,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function ro(e,t,n,r,a,i,s,o){return new no(e,t,n,r,a,i,s,o)}function ao(e){return new no(e)}function io(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function so(e){return null!==e.collectionGroup}function oo(e){const t=ia(e);if(null===t.Ie){t.Ie=[];const e=new Set;for(const a of t.explicitOrderBy)t.Ie.push(a),e.add(a.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc",r=function(e){let t=new ji(Aa.comparator);return e.filters.forEach(e=>{e.getFlattenedFilters().forEach(e=>{e.isInequality()&&(t=t.add(e.field))})}),t}(t);r.forEach(r=>{e.has(r.canonicalString())||r.isKeyField()||t.Ie.push(new Os(r,n))}),e.has(Aa.keyField().canonicalString())||t.Ie.push(new Os(Aa.keyField(),n))}return t.Ie}function lo(e){const t=ia(e);return t.Ee||(t.Ee=co(t,oo(e))),t.Ee}function co(e,t){if("F"===e.limitType)return Js(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(e=>{const t="desc"===e.dir?"asc":"desc";return new Os(e.field,t)});const n=e.endAt?new As(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new As(e.startAt.position,e.startAt.inclusive):null;return Js(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function uo(e,t,n){return new no(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function ho(e,t){return eo(lo(e),lo(t))&&e.limitType===t.limitType}function fo(e){return"".concat(Zs(lo(e)),"|lt:").concat(e.limitType)}function po(e){return"Query(target=".concat(function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=", filters: [".concat(e.filters.map(e=>Bs(e)).join(", "),"]")),ri(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=", orderBy: [".concat(e.orderBy.map(e=>function(e){return"".concat(e.field.canonicalString()," (").concat(e.dir,")")}(e)).join(", "),"]")),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(e=>ms(e)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(e=>ms(e)).join(",")),"Target(".concat(t,")")}(lo(e)),"; limitType=").concat(e.limitType,")")}function mo(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):Na.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of oo(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const r=Ns(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,oo(e),t))&&!(e.endAt&&!function(e,t,n){const r=Ns(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,oo(e),t))}(e,t)}function go(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function vo(e){return(t,n)=>{let r=!1;for(const a of oo(e)){const e=yo(a,t,n);if(0!==e)return e;r=r||a.field.isKeyField()}return 0}}function yo(e,t,n){const r=e.field.isKeyField()?Na.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),a=n.data.field(e);return null!==r&&null!==a?fs(r,a):na(42886)}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return na(19790,{direction:e.dir})}}class bo{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[r,a]of n)if(this.equalsFn(r,e))return a}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let a=0;a<r.length;a++)if(this.equalsFn(r[a][0],e))return void(r[a]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Di(this.inner,(t,n)=>{for(const[r,a]of n)e(r,a)})}isEmpty(){return Li(this.inner)}size(){return this.innerSize}}const wo=new Mi(Na.comparator);function To(){return wo}const So=new Mi(Na.comparator);function Eo(){let e=So;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const a of n)e=e.insert(a.key,a);return e}function ko(e){let t=So;return e.forEach((e,n)=>t=t.insert(e,n.overlayedDocument)),t}function _o(){return Co()}function xo(){return Co()}function Co(){return new bo(e=>e.toString(),(e,t)=>e.isEqual(t))}const Io=new Mi(Na.comparator),Ao=new ji(Na.comparator);function No(){let e=Ao;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const a of n)e=e.add(a);return e}const Ro=new ji(ba);function Oo(){return Ro}function Po(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ai(t)?"-0":t}}function Do(e){return{integerValue:""+e}}function Lo(e,t){return ii(t)?Do(t):Po(e,t)}class Mo{constructor(){this._=void 0}}function Fo(e,t,n){return e instanceof Vo?function(e,t){const n={fields:{[Xi]:{stringValue:$i},[Qi]:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&Ji(t)&&(t=Zi(t)),t&&(n.fields[Yi]=t),{mapValue:n}}(n,t):e instanceof zo?Bo(e,t):e instanceof Ho?Wo(e,t):function(e,t){const n=jo(e,t),r=Ko(n)+Ko(e.Ae);return ys(n)&&ys(e.Ae)?Do(r):Po(e.serializer,r)}(e,t)}function Uo(e,t,n){return e instanceof zo?Bo(e,t):e instanceof Ho?Wo(e,t):n}function jo(e,t){return e instanceof Go?function(e){return ys(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}class Vo extends Mo{}class zo extends Mo{constructor(e){super(),this.elements=e}}function Bo(e,t){const n=qo(t);for(const r of e.elements)n.some(e=>us(e,r))||n.push(r);return{arrayValue:{values:n}}}class Ho extends Mo{constructor(e){super(),this.elements=e}}function Wo(e,t){let n=qo(t);for(const r of e.elements)n=n.filter(e=>!us(e,r));return{arrayValue:{values:n}}}class Go extends Mo{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function Ko(e){return Ki(e.integerValue||e.doubleValue)}function qo(e){return bs(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class $o{constructor(e,t){this.version=e,this.transformResults=t}}class Xo{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Xo}static exists(e){return new Xo(void 0,e)}static updateTime(e){return new Xo(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Yo(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class Qo{}function Jo(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new ll(e.key,Xo.none()):new rl(e.key,e.data,Xo.none());{const n=e.data,r=xs.empty();let a=new ji(Aa.comparator);for(let e of t.fields)if(!a.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),a=a.add(e)}return new al(e.key,r,new zi(a.toArray()),Xo.none())}}function Zo(e,t,n){e instanceof rl?function(e,t,n){const r=e.value.clone(),a=sl(e.fieldTransforms,t,n.transformResults);r.setAll(a),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof al?function(e,t,n){if(!Yo(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=sl(e.fieldTransforms,t,n.transformResults),a=t.data;a.setAll(il(e)),a.setAll(r),t.convertToFoundDocument(n.version,a).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function el(e,t,n,r){return e instanceof rl?function(e,t,n,r){if(!Yo(e.precondition,t))return n;const a=e.value.clone(),i=ol(e.fieldTransforms,r,t);return a.setAll(i),t.convertToFoundDocument(t.version,a).setHasLocalMutations(),null}(e,t,n,r):e instanceof al?function(e,t,n,r){if(!Yo(e.precondition,t))return n;const a=ol(e.fieldTransforms,r,t),i=t.data;return i.setAll(il(e)),i.setAll(a),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(e=>e.field))}(e,t,n,r):function(e,t,n){return Yo(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function tl(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),a=jo(r.transform,e||null);null!=a&&(null===n&&(n=xs.empty()),n.set(r.field,a))}return n||null}function nl(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&ka(e,t,(e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof zo&&t instanceof zo||e instanceof Ho&&t instanceof Ho?ka(e.elements,t.elements,us):e instanceof Go&&t instanceof Go?us(e.Ae,t.Ae):e instanceof Vo&&t instanceof Vo}(e.transform,t.transform)}(e,t))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class rl extends Qo{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class al extends Qo{constructor(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function il(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}}),t}function sl(e,t,n){const r=new Map;aa(e.length===n.length,32656,{Re:n.length,Ve:e.length});for(let a=0;a<n.length;a++){const i=e[a],s=i.transform,o=t.data.field(i.field);r.set(i.field,Uo(s,o,n[a]))}return r}function ol(e,t,n){const r=new Map;for(const a of e){const e=a.transform,i=n.data.field(a.field);r.set(a.field,Fo(e,i,t))}return r}class ll extends Qo{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class cl extends Qo{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class ul{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const t=this.mutations[r];t.key.isEqual(e.key)&&Zo(t,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=el(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=el(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=xo();return this.mutations.forEach(r=>{const a=e.get(r.key),i=a.overlayedDocument;let s=this.applyToLocalView(i,a.mutatedFields);s=t.has(r.key)?null:s;const o=Jo(i,s);null!==o&&n.set(r.key,o),i.isValidDocument()||i.convertToNoDocument(Ba.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),No())}isEqual(e){return this.batchId===e.batchId&&ka(this.mutations,e.mutations,(e,t)=>nl(e,t))&&ka(this.baseMutations,e.baseMutations,(e,t)=>nl(e,t))}}class hl{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){aa(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let r=Io;const a=e.mutations;for(let i=0;i<a.length;i++)r=r.insert(a[i].key,n[i].version);return new hl(e,t,n,r)}}class fl{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return"Overlay{\n      largestBatchId: ".concat(this.largestBatchId,",\n      mutation: ").concat(this.mutation.toString(),"\n    }")}}class dl{constructor(e,t){this.count=e,this.unchangedNames=t}}var pl,ml;function gl(e){switch(e){case sa.OK:return na(64938);case sa.CANCELLED:case sa.UNKNOWN:case sa.DEADLINE_EXCEEDED:case sa.RESOURCE_EXHAUSTED:case sa.INTERNAL:case sa.UNAVAILABLE:case sa.UNAUTHENTICATED:return!1;case sa.INVALID_ARGUMENT:case sa.NOT_FOUND:case sa.ALREADY_EXISTS:case sa.PERMISSION_DENIED:case sa.FAILED_PRECONDITION:case sa.ABORTED:case sa.OUT_OF_RANGE:case sa.UNIMPLEMENTED:case sa.DATA_LOSS:return!0;default:return na(15467,{code:e})}}function vl(e){if(void 0===e)return Zr("GRPC error has no .code"),sa.UNKNOWN;switch(e){case pl.OK:return sa.OK;case pl.CANCELLED:return sa.CANCELLED;case pl.UNKNOWN:return sa.UNKNOWN;case pl.DEADLINE_EXCEEDED:return sa.DEADLINE_EXCEEDED;case pl.RESOURCE_EXHAUSTED:return sa.RESOURCE_EXHAUSTED;case pl.INTERNAL:return sa.INTERNAL;case pl.UNAVAILABLE:return sa.UNAVAILABLE;case pl.UNAUTHENTICATED:return sa.UNAUTHENTICATED;case pl.INVALID_ARGUMENT:return sa.INVALID_ARGUMENT;case pl.NOT_FOUND:return sa.NOT_FOUND;case pl.ALREADY_EXISTS:return sa.ALREADY_EXISTS;case pl.PERMISSION_DENIED:return sa.PERMISSION_DENIED;case pl.FAILED_PRECONDITION:return sa.FAILED_PRECONDITION;case pl.ABORTED:return sa.ABORTED;case pl.OUT_OF_RANGE:return sa.OUT_OF_RANGE;case pl.UNIMPLEMENTED:return sa.UNIMPLEMENTED;case pl.DATA_LOSS:return sa.DATA_LOSS;default:return na(39323,{code:e})}}(ml=pl||(pl={}))[ml.OK=0]="OK",ml[ml.CANCELLED=1]="CANCELLED",ml[ml.UNKNOWN=2]="UNKNOWN",ml[ml.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ml[ml.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ml[ml.NOT_FOUND=5]="NOT_FOUND",ml[ml.ALREADY_EXISTS=6]="ALREADY_EXISTS",ml[ml.PERMISSION_DENIED=7]="PERMISSION_DENIED",ml[ml.UNAUTHENTICATED=16]="UNAUTHENTICATED",ml[ml.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ml[ml.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ml[ml.ABORTED=10]="ABORTED",ml[ml.OUT_OF_RANGE=11]="OUT_OF_RANGE",ml[ml.UNIMPLEMENTED=12]="UNIMPLEMENTED",ml[ml.INTERNAL=13]="INTERNAL",ml[ml.UNAVAILABLE=14]="UNAVAILABLE",ml[ml.DATA_LOSS=15]="DATA_LOSS";let yl=null;function bl(){return new TextEncoder}const wl=new Or([4294967295,4294967295],0);function Tl(e){const t=bl().encode(e),n=new Pr;return n.update(t),new Uint8Array(n.digest())}function Sl(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),a=t.getUint32(8,!0),i=t.getUint32(12,!0);return[new Or([n,r],0),new Or([a,i],0)]}class El{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new kl("Invalid padding: ".concat(t));if(n<0)throw new kl("Invalid hash count: ".concat(n));if(e.length>0&&0===this.hashCount)throw new kl("Invalid hash count: ".concat(n));if(0===e.length&&0!==t)throw new kl("Invalid padding when bitmap length is 0: ".concat(t));this.ge=8*e.length-t,this.pe=Or.fromNumber(this.ge)}ye(e,t,n){let r=e.add(t.multiply(Or.fromNumber(n)));return 1===r.compare(wl)&&(r=new Or([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.ge)return!1;const t=Tl(e),[n,r]=Sl(t);for(let a=0;a<this.hashCount;a++){const e=this.ye(n,r,a);if(!this.we(e))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),i=new El(a,r,t);return n.forEach(e=>i.insert(e)),i}insert(e){if(0===this.ge)return;const t=Tl(e),[n,r]=Sl(t);for(let a=0;a<this.hashCount;a++){const e=this.ye(n,r,a);this.Se(e)}}Se(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class kl extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class _l{constructor(e,t,n,r,a){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,xl.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new _l(Ba.min(),r,new Mi(ba),To(),No())}}class xl{constructor(e,t,n,r,a){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new xl(n,t,No(),No(),No())}}class Cl{constructor(e,t,n,r){this.be=e,this.removedTargetIds=t,this.key=n,this.De=r}}class Il{constructor(e,t){this.targetId=e,this.Ce=t}}class Al{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Hi.EMPTY_BYTE_STRING,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class Nl{constructor(){this.ve=0,this.Fe=Pl(),this.Me=Hi.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return 0!==this.ve}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=No(),t=No(),n=No();return this.Fe.forEach((r,a)=>{switch(a){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:na(38017,{changeType:a})}}),new xl(this.Me,this.xe,e,t,n)}qe(){this.Oe=!1,this.Fe=Pl()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,aa(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class Rl{constructor(e){this.Ge=e,this.ze=new Map,this.je=To(),this.Je=Ol(),this.He=Ol(),this.Ye=new Mi(ba)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,t=>{const n=this.nt(t);switch(e.state){case 0:this.rt(t)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),n.Le(e.resumeToken));break;default:na(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach((e,n)=>{this.rt(n)&&t(n)})}st(e){const t=e.targetId,n=e.Ce.count,r=this.ot(t);if(r){const i=r.target;if(to(i))if(0===n){const e=new Na(i.path);this.et(t,e,Is.newNoDocument(e,Ba.min()))}else aa(1===n,20013,{expectedCount:n});else{const r=this._t(t);if(r!==n){var a;const n=this.ut(e),i=n?this.ct(n,e,r):1;if(0!==i){this.it(t);const e=2===i?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,e)}null===(a=yl)||void 0===a||a.lt(function(e,t,n,r,a,i,s,o,l,c){const u={localCacheCount:e,existenceFilterCount:t.count,databaseId:n.database,projectId:n.projectId},h=t.unchangedNames;return h&&(u.bloomFilter={applied:0===a,hashCount:null!==(i=null===h||void 0===h?void 0:h.hashCount)&&void 0!==i?i:0,bitmapLength:null!==(s=null===h||void 0===h||null===(o=h.bits)||void 0===o||null===(o=o.bitmap)||void 0===o?void 0:o.length)&&void 0!==s?s:0,padding:null!==(l=null===h||void 0===h||null===(c=h.bits)||void 0===c?void 0:c.padding)&&void 0!==l?l:0,mightContain:e=>{var t;return null!==(t=null===r||void 0===r?void 0:r.mightContain(e))&&void 0!==t&&t}}),u}(r,e.Ce,this.Ge.ht(),n,i))}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:a=0}=t;let i,s;try{i=qi(n).toUint8Array()}catch(e){if(e instanceof Bi)return ea("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{s=new El(i,r,a)}catch(e){return ea(e instanceof kl?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===s.ge?null:s}ct(e,t,n){return t.Ce.count===n-this.Pt(e,t.targetId)?0:2}Pt(e,t){const n=this.Ge.getRemoteKeysForTarget(t);let r=0;return n.forEach(n=>{const a=this.Ge.ht(),i="projects/".concat(a.projectId,"/databases/").concat(a.database,"/documents/").concat(n.path.canonicalString());e.mightContain(i)||(this.et(t,n,null),r++)}),r}Tt(e){const t=new Map;this.ze.forEach((n,r)=>{const a=this.ot(r);if(a){if(n.current&&to(a.target)){const t=new Na(a.target.path);this.It(t).has(r)||this.Et(r,t)||this.et(r,t,Is.newNoDocument(t,e))}n.Be&&(t.set(r,n.ke()),n.qe())}});let n=No();this.He.forEach((e,t)=>{let r=!0;t.forEachWhile(e=>{const t=this.ot(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1,!1)}),r&&(n=n.add(e))}),this.je.forEach((t,n)=>n.setReadTime(e));const r=new _l(e,t,this.Ye,this.je,n);return this.je=To(),this.Je=Ol(),this.He=Ol(),this.Ye=new Mi(ba),r}Xe(e,t){if(!this.rt(e))return;const n=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,n),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,n){if(!this.rt(e))return;const r=this.nt(e);this.Et(e,t)?r.Qe(t,1):r.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),n&&(this.je=this.je.insert(t,n))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new Nl,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new ji(ba),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new ji(ba),this.Je=this.Je.insert(e,t)),t}rt(e){const t=null!==this.ot(e);return t||Jr("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Nl),this.Ge.getRemoteKeysForTarget(e).forEach(t=>{this.et(e,t,null)})}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Ol(){return new Mi(Na.comparator)}function Pl(){return new Mi(Na.comparator)}const Dl={asc:"ASCENDING",desc:"DESCENDING"},Ll={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Ml={and:"AND",or:"OR"};class Fl{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Ul(e,t){return e.useProto3Json||ri(t)?t:{value:t}}function jl(e,t){return e.useProto3Json?"".concat(new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+t.nanoseconds).slice(-9),"Z"):{seconds:""+t.seconds,nanos:t.nanoseconds}}function Vl(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function zl(e,t){return jl(e,t.toTimestamp())}function Bl(e){return aa(!!e,49232),Ba.fromTimestamp(function(e){const t=Gi(e);return new za(t.seconds,t.nanos)}(e))}function Hl(e,t){return Wl(e,t).canonicalString()}function Wl(e,t){const n=function(e){return new Ca(["projects",e.projectId,"databases",e.database])}(e).child("documents");return void 0===t?n:n.child(t)}function Gl(e){const t=Ca.fromString(e);return aa(hc(t),10190,{key:t.toString()}),t}function Kl(e,t){return Hl(e.databaseId,t.path)}function ql(e,t){const n=Gl(t);if(n.get(1)!==e.databaseId.projectId)throw new oa(sa.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new oa(sa.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new Na(Ql(n))}function $l(e,t){return Hl(e.databaseId,t)}function Xl(e){const t=Gl(e);return 4===t.length?Ca.emptyPath():Ql(t)}function Yl(e){return new Ca(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Ql(e){return aa(e.length>4&&"documents"===e.get(4),29091,{key:e.toString()}),e.popFirst(5)}function Jl(e,t,n){return{name:Kl(e,t),fields:n.value.mapValue.fields}}function Zl(e,t){let n;if(t instanceof rl)n={update:Jl(e,t.key,t.value)};else if(t instanceof ll)n={delete:Kl(e,t.key)};else if(t instanceof al)n={update:Jl(e,t.key,t.data),updateMask:uc(t.fieldMask)};else{if(!(t instanceof cl))return na(16599,{Vt:t.type});n={verify:Kl(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(e=>function(e,t){const n=t.transform;if(n instanceof Vo)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof zo)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Ho)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Go)return{fieldPath:t.field.canonicalString(),increment:n.Ae};throw na(20930,{transform:t.transform})}(0,e))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:zl(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:na(27497)}(e,t.precondition)),n}function ec(e,t){return{documents:[$l(e,t.path)]}}function tc(e,t){const n={structuredQuery:{}},r=t.path;let a;null!==t.collectionGroup?(a=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(a=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=$l(e,a);const i=function(e){if(0!==e.length)return cc(Ms.create(e,"and"))}(t.filters);i&&(n.structuredQuery.where=i);const s=function(e){if(0!==e.length)return e.map(e=>function(e){return{field:oc(e.field),direction:ac(e.dir)}}(e))}(t.orderBy);s&&(n.structuredQuery.orderBy=s);const o=Ul(e,t.limit);return null!==o&&(n.structuredQuery.limit=o),t.startAt&&(n.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{ft:n,parent:a}}function nc(e){let t=Xl(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let a=null;if(r>0){aa(1===r,65062);const e=n.from[0];e.allDescendants?a=e.collectionId:t=t.child(e.collectionId)}let i=[];n.where&&(i=function(e){const t=rc(e);return t instanceof Ms&&Us(t)?t.getFilters():[t]}(n.where));let s=[];n.orderBy&&(s=function(e){return e.map(e=>function(e){return new Os(lc(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e))}(n.orderBy));let o=null;n.limit&&(o=function(e){let t;return t="object"==typeof e?e.value:e,ri(t)?null:t}(n.limit));let l=null;n.startAt&&(l=function(e){const t=!!e.before,n=e.values||[];return new As(n,t)}(n.startAt));let c=null;return n.endAt&&(c=function(e){const t=!e.before,n=e.values||[];return new As(n,t)}(n.endAt)),ro(t,a,s,i,o,"F",l,c)}function rc(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=lc(e.unaryFilter.field);return Ls.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=lc(e.unaryFilter.field);return Ls.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=lc(e.unaryFilter.field);return Ls.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=lc(e.unaryFilter.field);return Ls.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return na(61313);default:return na(60726)}}(e):void 0!==e.fieldFilter?function(e){return Ls.create(lc(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return na(58110);default:return na(50506)}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return Ms.create(e.compositeFilter.filters.map(e=>rc(e)),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return na(1026)}}(e.compositeFilter.op))}(e):na(30097,{filter:e})}function ac(e){return Dl[e]}function ic(e){return Ll[e]}function sc(e){return Ml[e]}function oc(e){return{fieldPath:e.canonicalString()}}function lc(e){return Aa.fromServerFormat(e.fieldPath)}function cc(e){return e instanceof Ls?function(e){if("=="===e.op){if(Ts(e.value))return{unaryFilter:{field:oc(e.field),op:"IS_NAN"}};if(ws(e.value))return{unaryFilter:{field:oc(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(Ts(e.value))return{unaryFilter:{field:oc(e.field),op:"IS_NOT_NAN"}};if(ws(e.value))return{unaryFilter:{field:oc(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:oc(e.field),op:ic(e.op),value:e.value}}}(e):e instanceof Ms?function(e){const t=e.getFilters().map(e=>cc(e));return 1===t.length?t[0]:{compositeFilter:{op:sc(e.op),filters:t}}}(e):na(54877,{filter:e})}function uc(e){const t=[];return e.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function hc(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class fc{constructor(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Ba.min(),i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Ba.min(),s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Hi.EMPTY_BYTE_STRING,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=i,this.resumeToken=s,this.expectedCount=o}withSequenceNumber(e){return new fc(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new fc(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new fc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new fc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class dc{constructor(e){this.yt=e}}function pc(e){const t=nc({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?uo(t,t.limit,"L"):t}class mc{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(Ki(e.integerValue));else if("doubleValue"in e){const n=Ki(e.doubleValue);isNaN(n)?this.Ft(t,13):(this.Ft(t,15),ai(n)?t.Mt(0):t.Mt(n))}else if("timestampValue"in e){let n=e.timestampValue;this.Ft(t,20),"string"==typeof n&&(n=Gi(n)),t.xt("".concat(n.seconds||"")),t.Mt(n.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(qi(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.Ft(t,45),t.Mt(n.latitude||0),t.Mt(n.longitude||0)}else"mapValue"in e?_s(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):Es(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):na(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const n=e.fields||{};this.Ft(t,55);for(const r of Object.keys(n))this.Ot(r,t),this.Ct(n[r],t)}kt(e,t){var n;const r=e.fields||{};this.Ft(t,53);const a=ls,i=(null===(n=r[a].arrayValue)||void 0===n||null===(n=n.values)||void 0===n?void 0:n.length)||0;this.Ft(t,15),t.Mt(Ki(i)),this.Ot(a,t),this.Ct(r[a],t)}Qt(e,t){const n=e.values||[];this.Ft(t,50);for(const r of n)this.Ct(r,t)}Lt(e,t){this.Ft(t,37),Na.fromName(e).path.forEach(e=>{this.Ft(t,60),this.Ut(e,t)})}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}mc.Kt=new mc;class gc{constructor(){this.Cn=new vc}addToCollectionParentIndex(e,t){return this.Cn.add(t),Ja.resolve()}getCollectionParents(e,t){return Ja.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return Ja.resolve()}deleteFieldIndex(e,t){return Ja.resolve()}deleteAllFieldIndexes(e){return Ja.resolve()}createTargetIndexes(e,t){return Ja.resolve()}getDocumentsMatchingTarget(e,t){return Ja.resolve(null)}getIndexType(e,t){return Ja.resolve(0)}getFieldIndexes(e,t){return Ja.resolve([])}getNextCollectionGroupToUpdate(e){return Ja.resolve(null)}getMinOffset(e,t){return Ja.resolve(qa.min())}getMinOffsetFromCollectionGroup(e,t){return Ja.resolve(qa.min())}updateCollectionGroup(e,t,n){return Ja.resolve()}updateIndexEntries(e,t){return Ja.resolve()}}class vc{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new ji(Ca.comparator),a=!r.has(n);return this.index[t]=r.add(n),a}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new ji(Ca.comparator)).toArray()}}new Uint8Array(0);const yc={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},bc=41943040;class wc{static withCacheSize(e){return new wc(e,wc.DEFAULT_COLLECTION_PERCENTILE,wc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}wc.DEFAULT_COLLECTION_PERCENTILE=10,wc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,wc.DEFAULT=new wc(bc,wc.DEFAULT_COLLECTION_PERCENTILE,wc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),wc.DISABLED=new wc(-1,0,0);class Tc{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Tc(0)}static cr(){return new Tc(-1)}}const Sc="LruGarbageCollector",Ec=1048576;function kc(e,t){let[n,r]=e,[a,i]=t;const s=ba(n,a);return 0===s?ba(r,i):s}class _c{constructor(e){this.Ir=e,this.buffer=new ji(kc),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const e=this.buffer.last();kc(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class xc{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Rr=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return null!==this.Rr}Vr(e){Jr(Sc,"Garbage collection scheduled in ".concat(e,"ms")),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){ei(e)?Jr(Sc,"Ignoring IndexedDB error during garbage collection: ",e):await Qa(e)}await this.Vr(3e5)})}}class Cc{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next(e=>Math.floor(t/100*e))}nthSequenceNumber(e,t){if(0===t)return Ja.resolve(ti.ce);const n=new _c(t);return this.mr.forEachTarget(e,e=>n.Ar(e.sequenceNumber)).next(()=>this.mr.pr(e,e=>n.Ar(e))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.mr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(Jr("LruGarbageCollector","Garbage collection skipped; disabled"),Ja.resolve(yc)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(Jr("LruGarbageCollector","Garbage collection skipped; Cache size ".concat(n," is lower than threshold ").concat(this.params.cacheSizeCollectionThreshold)),yc):this.yr(e,t))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let n,r,a,i,s,o,l;const c=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(t=>(t>this.params.maximumSequenceNumbersToCollect?(Jr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of ".concat(this.params.maximumSequenceNumbersToCollect," from ").concat(t)),r=this.params.maximumSequenceNumbersToCollect):r=t,i=Date.now(),this.nthSequenceNumber(e,r))).next(r=>(n=r,s=Date.now(),this.removeTargets(e,n,t))).next(t=>(a=t,o=Date.now(),this.removeOrphanedDocuments(e,n))).next(e=>(l=Date.now(),Qr()<=ln.DEBUG&&Jr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in ".concat(i-c,"ms\n\tDetermined least recently used ").concat(r," in ")+(s-i)+"ms\n"+"\tRemoved ".concat(a," targets in ")+(o-s)+"ms\n"+"\tRemoved ".concat(e," documents in ")+(l-o)+"ms\n"+"Total Duration: ".concat(l-c,"ms")),Ja.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:a,documentsRemoved:e})))}}function Ic(e,t){return new Cc(e,t)}class Ac{constructor(){this.changes=new bo(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Is.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?Ja.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Nc{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class Rc{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(n=r,this.remoteDocumentCache.getEntry(e,t))).next(e=>(null!==n&&el(n.mutation,e,zi.empty(),za.now()),e))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.getLocalViewOfDocuments(e,t,No()).next(()=>t))}getLocalViewOfDocuments(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:No();const r=_o();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,n).next(e=>{let t=Eo();return e.forEach((e,n)=>{t=t.insert(e,n.overlayedDocument)}),t}))}getOverlayedDocuments(e,t){const n=_o();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,No()))}populateOverlays(e,t,n){const r=[];return n.forEach(e=>{t.has(e)||r.push(e)}),this.documentOverlayCache.getOverlays(e,r).next(e=>{e.forEach((e,n)=>{t.set(e,n)})})}computeViews(e,t,n,r){let a=To();const i=Co(),s=Co();return t.forEach((e,t)=>{const s=n.get(t.key);r.has(t.key)&&(void 0===s||s.mutation instanceof al)?a=a.insert(t.key,t):void 0!==s?(i.set(t.key,s.mutation.getFieldMask()),el(s.mutation,t,s.mutation.getFieldMask(),za.now())):i.set(t.key,zi.empty())}),this.recalculateAndSaveOverlays(e,a).next(e=>(e.forEach((e,t)=>i.set(e,t)),t.forEach((e,t)=>{var n;return s.set(e,new Nc(t,null!==(n=i.get(e))&&void 0!==n?n:null))}),s))}recalculateAndSaveOverlays(e,t){const n=Co();let r=new Mi((e,t)=>e-t),a=No();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(e=>{for(const a of e)a.keys().forEach(e=>{const i=t.get(e);if(null===i)return;let s=n.get(e)||zi.empty();s=a.applyToLocalView(i,s),n.set(e,s);const o=(r.get(a.batchId)||No()).add(e);r=r.insert(a.batchId,o)})}).next(()=>{const i=[],s=r.getReverseIterator();for(;s.hasNext();){const r=s.getNext(),o=r.key,l=r.value,c=xo();l.forEach(e=>{if(!a.has(e)){const r=Jo(t.get(e),n.get(e));null!==r&&c.set(e,r),a=a.add(e)}}),i.push(this.documentOverlayCache.saveOverlays(e,o,c))}return Ja.waitFor(i)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.recalculateAndSaveOverlays(e,t))}getDocumentsMatchingQuery(e,t,n,r){return function(e){return Na.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):so(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next(a=>{const i=r-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-a.size):Ja.resolve(_o());let s=Ha,o=a;return i.next(t=>Ja.forEach(t,(t,n)=>(s<n.largestBatchId&&(s=n.largestBatchId),a.get(t)?Ja.resolve():this.remoteDocumentCache.getEntry(e,t).next(e=>{o=o.insert(t,e)}))).next(()=>this.populateOverlays(e,t,a)).next(()=>this.computeViews(e,o,t,No())).next(e=>({batchId:s,changes:ko(e)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Na(t)).next(e=>{let t=Eo();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){const a=t.collectionGroup;let i=Eo();return this.indexManager.getCollectionParents(e,a).next(s=>Ja.forEach(s,s=>{const o=function(e,t){return new no(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,s.child(a));return this.getDocumentsMatchingCollectionQuery(e,o,n,r).next(e=>{e.forEach((e,t)=>{i=i.insert(e,t)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(e,t,n,r){let a;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(i=>(a=i,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,a,r))).next(e=>{a.forEach((t,n)=>{const r=n.getKey();null===e.get(r)&&(e=e.insert(r,Is.newInvalidDocument(r)))});let n=Eo();return e.forEach((e,r)=>{const i=a.get(e);void 0!==i&&el(i.mutation,r,zi.empty(),za.now()),mo(t,r)&&(n=n.insert(e,r))}),n})}}class Oc{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return Ja.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,function(e){return{id:e.id,version:e.version,createTime:Bl(e.createTime)}}(t)),Ja.resolve()}getNamedQuery(e,t){return Ja.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,function(e){return{name:e.name,query:pc(e.bundledQuery),readTime:Bl(e.readTime)}}(t)),Ja.resolve()}}class Pc{constructor(){this.overlays=new Mi(Na.comparator),this.qr=new Map}getOverlay(e,t){return Ja.resolve(this.overlays.get(t))}getOverlays(e,t){const n=_o();return Ja.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&n.set(t,e)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((n,r)=>{this.St(e,t,r)}),Ja.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.qr.get(n);return void 0!==r&&(r.forEach(e=>this.overlays=this.overlays.remove(e)),this.qr.delete(n)),Ja.resolve()}getOverlaysForCollection(e,t,n){const r=_o(),a=t.length+1,i=new Na(t.child("")),s=this.overlays.getIteratorFrom(i);for(;s.hasNext();){const e=s.getNext().value,i=e.getKey();if(!t.isPrefixOf(i.path))break;i.path.length===a&&e.largestBatchId>n&&r.set(e.getKey(),e)}return Ja.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let a=new Mi((e,t)=>e-t);const i=this.overlays.getIterator();for(;i.hasNext();){const e=i.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=a.get(e.largestBatchId);null===t&&(t=_o(),a=a.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const s=_o(),o=a.getIterator();for(;o.hasNext()&&(o.getNext().value.forEach((e,t)=>s.set(e,t)),!(s.size()>=r)););return Ja.resolve(s)}St(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.qr.get(r.largestBatchId).delete(n.key);this.qr.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new fl(t,n));let a=this.qr.get(t);void 0===a&&(a=No(),this.qr.set(t,a)),this.qr.set(t,a.add(n.key))}}class Dc{constructor(){this.sessionToken=Hi.EMPTY_BYTE_STRING}getSessionToken(e){return Ja.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Ja.resolve()}}class Lc{constructor(){this.Qr=new ji(Mc.$r),this.Ur=new ji(Mc.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const n=new Mc(e,t);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,t){e.forEach(e=>this.addReference(e,t))}removeReference(e,t){this.Gr(new Mc(e,t))}zr(e,t){e.forEach(e=>this.removeReference(e,t))}jr(e){const t=new Na(new Ca([])),n=new Mc(t,e),r=new Mc(t,e+1),a=[];return this.Ur.forEachInRange([n,r],e=>{this.Gr(e),a.push(e.key)}),a}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new Na(new Ca([])),n=new Mc(t,e),r=new Mc(t,e+1);let a=No();return this.Ur.forEachInRange([n,r],e=>{a=a.add(e.key)}),a}containsKey(e){const t=new Mc(e,0),n=this.Qr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class Mc{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return Na.comparator(e.key,t.key)||ba(e.Yr,t.Yr)}static Kr(e,t){return ba(e.Yr,t.Yr)||Na.comparator(e.key,t.key)}}class Fc{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new ji(Mc.$r)}checkEmpty(e){return Ja.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const a=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const i=new ul(a,t,n,r);this.mutationQueue.push(i);for(const s of r)this.Zr=this.Zr.add(new Mc(s.key,a)),this.indexManager.addToCollectionParentIndex(e,s.key.path.popLast());return Ja.resolve(i)}lookupMutationBatch(e,t){return Ja.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.ei(n),a=r<0?0:r;return Ja.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return Ja.resolve(0===this.mutationQueue.length?ni:this.tr-1)}getAllMutationBatches(e){return Ja.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new Mc(t,0),r=new Mc(t,Number.POSITIVE_INFINITY),a=[];return this.Zr.forEachInRange([n,r],e=>{const t=this.Xr(e.Yr);a.push(t)}),Ja.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new ji(ba);return t.forEach(e=>{const t=new Mc(e,0),r=new Mc(e,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([t,r],e=>{n=n.add(e.Yr)})}),Ja.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let a=n;Na.isDocumentKey(a)||(a=a.child(""));const i=new Mc(new Na(a),0);let s=new ji(ba);return this.Zr.forEachWhile(e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(s=s.add(e.Yr)),!0)},i),Ja.resolve(this.ti(s))}ti(e){const t=[];return e.forEach(e=>{const n=this.Xr(e);null!==n&&t.push(n)}),t}removeMutationBatch(e,t){aa(0===this.ni(t.batchId,"removed"),55003),this.mutationQueue.shift();let n=this.Zr;return Ja.forEach(t.mutations,r=>{const a=new Mc(r.key,t.batchId);return n=n.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,t){const n=new Mc(t,0),r=this.Zr.firstAfterOrEqual(n);return Ja.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,Ja.resolve()}ni(e,t){return this.ei(e)}ei(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class Uc{constructor(e){this.ri=e,this.docs=new Mi(Na.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),a=r?r.size:0,i=this.ri(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:i}),this.size+=i-a,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return Ja.resolve(n?n.document.mutableCopy():Is.newInvalidDocument(t))}getEntries(e,t){let n=To();return t.forEach(e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():Is.newInvalidDocument(e))}),Ja.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let a=To();const i=t.path,s=new Na(i.child("__id-9223372036854775808__")),o=this.docs.getIteratorFrom(s);for(;o.hasNext();){const{key:e,value:{document:s}}=o.getNext();if(!i.isPrefixOf(e.path))break;e.path.length>i.length+1||$a(Ka(s),n)<=0||(r.has(s.key)||mo(t,s))&&(a=a.insert(s.key,s.mutableCopy()))}return Ja.resolve(a)}getAllFromCollectionGroup(e,t,n,r){na(9500)}ii(e,t){return Ja.forEach(this.docs,e=>t(e))}newChangeBuffer(e){return new jc(this)}getSize(e){return Ja.resolve(this.size)}}class jc extends Ac{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach((n,r)=>{r.isValidDocument()?t.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(n)}),Ja.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class Vc{constructor(e){this.persistence=e,this.si=new bo(e=>Zs(e),eo),this.lastRemoteSnapshotVersion=Ba.min(),this.highestTargetId=0,this.oi=0,this._i=new Lc,this.targetCount=0,this.ai=Tc.ur()}forEachTarget(e,t){return this.si.forEach((e,n)=>t(n)),Ja.resolve()}getLastRemoteSnapshotVersion(e){return Ja.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Ja.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),Ja.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.oi&&(this.oi=t),Ja.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Tc(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,Ja.resolve()}updateTargetData(e,t){return this.Pr(t),Ja.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,Ja.resolve()}removeTargets(e,t,n){let r=0;const a=[];return this.si.forEach((i,s)=>{s.sequenceNumber<=t&&null===n.get(s.targetId)&&(this.si.delete(i),a.push(this.removeMatchingKeysForTargetId(e,s.targetId)),r++)}),Ja.waitFor(a).next(()=>r)}getTargetCount(e){return Ja.resolve(this.targetCount)}getTargetData(e,t){const n=this.si.get(t)||null;return Ja.resolve(n)}addMatchingKeys(e,t,n){return this._i.Wr(t,n),Ja.resolve()}removeMatchingKeys(e,t,n){this._i.zr(t,n);const r=this.persistence.referenceDelegate,a=[];return r&&t.forEach(t=>{a.push(r.markPotentiallyOrphaned(e,t))}),Ja.waitFor(a)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),Ja.resolve()}getMatchingKeysForTargetId(e,t){const n=this._i.Hr(t);return Ja.resolve(n)}containsKey(e,t){return Ja.resolve(this._i.containsKey(t))}}class zc{constructor(e,t){this.ui={},this.overlays={},this.ci=new ti(0),this.li=!1,this.li=!0,this.hi=new Dc,this.referenceDelegate=e(this),this.Pi=new Vc(this),this.indexManager=new gc,this.remoteDocumentCache=function(e){return new Uc(e)}(e=>this.referenceDelegate.Ti(e)),this.serializer=new dc(t),this.Ii=new Oc(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Pc,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.ui[e.toKey()];return n||(n=new Fc(t,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,n){Jr("MemoryPersistence","Starting transaction:",e);const r=new Bc(this.ci.next());return this.referenceDelegate.Ei(),n(r).next(e=>this.referenceDelegate.di(r).next(()=>e)).toPromise().then(e=>(r.raiseOnCommittedEvent(),e))}Ai(e,t){return Ja.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,t)))}}class Bc extends Ya{constructor(e){super(),this.currentSequenceNumber=e}}class Hc{constructor(e){this.persistence=e,this.Ri=new Lc,this.Vi=null}static mi(e){return new Hc(e)}get fi(){if(this.Vi)return this.Vi;throw na(60996)}addReference(e,t,n){return this.Ri.addReference(n,t),this.fi.delete(n.toString()),Ja.resolve()}removeReference(e,t,n){return this.Ri.removeReference(n,t),this.fi.add(n.toString()),Ja.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),Ja.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach(e=>this.fi.add(e.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(e=>{e.forEach(e=>this.fi.add(e.toString()))}).next(()=>n.removeTargetData(e,t))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Ja.forEach(this.fi,n=>{const r=Na.fromPath(n);return this.gi(e,r).next(e=>{e||t.removeEntry(r,Ba.min())})}).next(()=>(this.Vi=null,t.apply(e)))}updateLimboDocument(e,t){return this.gi(e,t).next(e=>{e?this.fi.delete(t.toString()):this.fi.add(t.toString())})}Ti(e){return 0}gi(e,t){return Ja.or([()=>Ja.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Wc{constructor(e,t){this.persistence=e,this.pi=new bo(e=>oi(e.path),(e,t)=>e.isEqual(t)),this.garbageCollector=Ic(this,t)}static mi(e,t){return new Wc(e,t)}Ei(){}di(e){return Ja.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(e=>t.next(t=>e+t))}wr(e){let t=0;return this.pr(e,e=>{t++}).next(()=>t)}pr(e,t){return Ja.forEach(this.pi,(n,r)=>this.br(e,n,r).next(e=>e?Ja.resolve():t(r)))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const r=this.persistence.getRemoteDocumentCache(),a=r.newChangeBuffer();return r.ii(e,r=>this.br(e,r,t).next(e=>{e||(n++,a.removeEntry(r,Ba.min()))})).next(()=>a.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),Ja.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),Ja.resolve()}removeReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),Ja.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),Ja.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=vs(e.data.value)),t}br(e,t,n){return Ja.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const e=this.pi.get(t);return Ja.resolve(void 0!==e&&e>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class Gc{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Es=n,this.ds=r}static As(e,t){let n=No(),r=No();for(const a of t.docChanges)switch(a.type){case 0:n=n.add(a.doc.key);break;case 1:r=r.add(a.doc.key)}return new Gc(e,t.fromCache,n,r)}}class Kc{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class qc{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=zt()?8:Za(Ut())>0?6:4}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,n,r){const a={result:null};return this.ys(e,t).next(e=>{a.result=e}).next(()=>{if(!a.result)return this.ws(e,t,r,n).next(e=>{a.result=e})}).next(()=>{if(a.result)return;const n=new Kc;return this.Ss(e,t,n).next(r=>{if(a.result=r,this.Vs)return this.bs(e,t,n,r.size)})}).next(()=>a.result)}bs(e,t,n,r){return n.documentReadCount<this.fs?(Qr()<=ln.DEBUG&&Jr("QueryEngine","SDK will not create cache indexes for query:",po(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),Ja.resolve()):(Qr()<=ln.DEBUG&&Jr("QueryEngine","Query:",po(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.gs*r?(Qr()<=ln.DEBUG&&Jr("QueryEngine","The SDK decides to create cache indexes for query:",po(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,lo(t))):Ja.resolve())}ys(e,t){if(io(t))return Ja.resolve(null);let n=lo(t);return this.indexManager.getIndexType(e,n).next(r=>0===r?null:(null!==t.limit&&1===r&&(t=uo(t,null,"F"),n=lo(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(r=>{const a=No(...r);return this.ps.getDocuments(e,a).next(r=>this.indexManager.getMinOffset(e,n).next(n=>{const i=this.Ds(t,r);return this.Cs(t,i,a,n.readTime)?this.ys(e,uo(t,null,"F")):this.vs(e,i,t,n)}))})))}ws(e,t,n,r){return io(t)||r.isEqual(Ba.min())?Ja.resolve(null):this.ps.getDocuments(e,n).next(a=>{const i=this.Ds(t,a);return this.Cs(t,i,n,r)?Ja.resolve(null):(Qr()<=ln.DEBUG&&Jr("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),po(t)),this.vs(e,i,t,Ga(r,Ha)).next(e=>e))})}Ds(e,t){let n=new ji(vo(e));return t.forEach((t,r)=>{mo(e,r)&&(n=n.add(r))}),n}Cs(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const a="F"===e.limitType?t.last():t.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(r)>0)}Ss(e,t,n){return Qr()<=ln.DEBUG&&Jr("QueryEngine","Using full collection scan to execute query:",po(t)),this.ps.getDocumentsMatchingQuery(e,t,qa.min(),n)}vs(e,t,n,r){return this.ps.getDocumentsMatchingQuery(e,n,r).next(e=>(t.forEach(t=>{e=e.insert(t.key,t)}),e))}}const $c="LocalStore";class Xc{constructor(e,t,n,r){this.persistence=e,this.Fs=t,this.serializer=r,this.Ms=new Mi(ba),this.xs=new bo(e=>Zs(e),eo),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Rc(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ms))}}function Yc(e,t,n,r){return new Xc(e,t,n,r)}async function Qc(e,t){const n=ia(e);return await n.persistence.runTransaction("Handle user change","readonly",e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next(a=>(r=a,n.Bs(t),n.mutationQueue.getAllMutationBatches(e))).next(t=>{const a=[],i=[];let s=No();for(const e of r){a.push(e.batchId);for(const t of e.mutations)s=s.add(t.key)}for(const e of t){i.push(e.batchId);for(const t of e.mutations)s=s.add(t.key)}return n.localDocuments.getDocuments(e,s).next(e=>({Ls:e,removedBatchIds:a,addedBatchIds:i}))})})}function Jc(e){const t=ia(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.Pi.getLastRemoteSnapshotVersion(e))}function Zc(e,t,n){let r=No(),a=No();return n.forEach(e=>r=r.add(e)),t.getEntries(e,r).next(e=>{let r=To();return n.forEach((n,i)=>{const s=e.get(n);i.isFoundDocument()!==s.isFoundDocument()&&(a=a.add(n)),i.isNoDocument()&&i.version.isEqual(Ba.min())?(t.removeEntry(n,i.readTime),r=r.insert(n,i)):!s.isValidDocument()||i.version.compareTo(s.version)>0||0===i.version.compareTo(s.version)&&s.hasPendingWrites?(t.addEntry(i),r=r.insert(n,i)):Jr($c,"Ignoring outdated watch update for ",n,". Current version:",s.version," Watch version:",i.version)}),{ks:r,qs:a}})}function eu(e,t){const n=ia(e);return n.persistence.runTransaction("Get next mutation batch","readonly",e=>(void 0===t&&(t=ni),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t)))}function tu(e,t){const n=ia(e);return n.persistence.runTransaction("Allocate target","readwrite",e=>{let r;return n.Pi.getTargetData(e,t).next(a=>a?(r=a,Ja.resolve(r)):n.Pi.allocateTargetId(e).next(a=>(r=new fc(t,a,"TargetPurposeListen",e.currentSequenceNumber),n.Pi.addTargetData(e,r).next(()=>r))))}).then(e=>{const r=n.Ms.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(e.targetId,e),n.xs.set(t,e.targetId)),e})}async function nu(e,t,n){const r=ia(e),a=r.Ms.get(t),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,e=>r.persistence.referenceDelegate.removeTarget(e,a))}catch(e){if(!ei(e))throw e;Jr($c,"Failed to update sequence numbers for target ".concat(t,": ").concat(e))}r.Ms=r.Ms.remove(t),r.xs.delete(a.target)}function ru(e,t,n){const r=ia(e);let a=Ba.min(),i=No();return r.persistence.runTransaction("Execute query","readwrite",e=>function(e,t,n){const r=ia(e),a=r.xs.get(n);return void 0!==a?Ja.resolve(r.Ms.get(a)):r.Pi.getTargetData(t,n)}(r,e,lo(t)).next(t=>{if(t)return a=t.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(e,t.targetId).next(e=>{i=e})}).next(()=>r.Fs.getDocumentsMatchingQuery(e,t,n?a:Ba.min(),n?i:No())).next(e=>(au(r,go(t),e),{documents:e,Qs:i})))}function au(e,t,n){let r=e.Os.get(t)||Ba.min();n.forEach((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)}),e.Os.set(t,r)}class iu{constructor(){this.activeTargetIds=Oo()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class su{constructor(){this.Mo=new iu,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,n){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new iu,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class ou{Oo(e){}shutdown(){}}const lu="ConnectivityMonitor";class cu{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Jr(lu,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Jr(lu,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let uu=null;function hu(){return null===uu?uu=268435456+Math.round(2147483648*Math.random()):uu++,"0x"+uu.toString(16)}const fu="RestConnection",du={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class pu{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko="projects/".concat(n,"/databases/").concat(r),this.Wo=this.databaseId.database===ns?"project_id=".concat(n):"project_id=".concat(n,"&database_id=").concat(r)}Go(e,t,n,r,a){const i=hu(),s=this.zo(e,t.toUriEncodedString());Jr(fu,"Sending RPC '".concat(e,"' ").concat(i,":"),s,n);const o={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(o,r,a);const{host:l}=new URL(s),c=Pt(l);return this.Jo(e,s,o,n,c).then(t=>(Jr(fu,"Received RPC '".concat(e,"' ").concat(i,": "),t),t),t=>{throw ea(fu,"RPC '".concat(e,"' ").concat(i," failed with error: "),t,"url: ",s,"request:",n),t})}Ho(e,t,n,r,a,i){return this.Go(e,t,n,r,a)}jo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+Xr,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((t,n)=>e[n]=t),n&&n.headers.forEach((t,n)=>e[n]=t)}zo(e,t){const n=du[e];return"".concat(this.Uo,"/v1/").concat(t,":").concat(n)}terminate(){}}class mu{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const gu="WebChannelConnection";class vu extends pu{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,n,r,a){const i=hu();return new Promise((a,s)=>{const o=new Mr;o.setWithCredentials(!0),o.listenOnce(Ur.COMPLETE,()=>{try{switch(o.getLastErrorCode()){case jr.NO_ERROR:const n=o.getResponseJson();Jr(gu,"XHR for RPC '".concat(e,"' ").concat(i," received:"),JSON.stringify(n)),a(n);break;case jr.TIMEOUT:Jr(gu,"RPC '".concat(e,"' ").concat(i," timed out")),s(new oa(sa.DEADLINE_EXCEEDED,"Request time out"));break;case jr.HTTP_ERROR:const r=o.getStatus();if(Jr(gu,"RPC '".concat(e,"' ").concat(i," failed with status:"),r,"response text:",o.getResponseText()),r>0){var t;let e=o.getResponseJson();Array.isArray(e)&&(e=e[0]);const n=null===(t=e)||void 0===t?void 0:t.error;if(n&&n.status&&n.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(sa).indexOf(t)>=0?t:sa.UNKNOWN}(n.status);s(new oa(e,n.message))}else s(new oa(sa.UNKNOWN,"Server responded with status "+o.getStatus()))}else s(new oa(sa.UNAVAILABLE,"Connection failed."));break;default:na(9055,{l_:e,streamId:i,h_:o.getLastErrorCode(),P_:o.getLastError()})}}finally{Jr(gu,"RPC '".concat(e,"' ").concat(i," completed."))}});const l=JSON.stringify(r);Jr(gu,"RPC '".concat(e,"' ").concat(i," sending request:"),r),o.send(t,"POST",l,n,15)})}T_(e,t,n){const r=hu(),a=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=Hr(),s=Br(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(o.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(o.useFetchStreams=!0),this.jo(o.initMessageHeaders,t,n),o.encodeInitMessageHeaders=!0;const c=a.join("");Jr(gu,"Creating RPC '".concat(e,"' stream ").concat(r,": ").concat(c),o);const u=i.createWebChannel(c,o);this.I_(u);let h=!1,f=!1;const d=new mu({Yo:t=>{f?Jr(gu,"Not sending because RPC '".concat(e,"' stream ").concat(r," is closed:"),t):(h||(Jr(gu,"Opening RPC '".concat(e,"' stream ").concat(r," transport.")),u.open(),h=!0),Jr(gu,"RPC '".concat(e,"' stream ").concat(r," sending:"),t),u.send(t))},Zo:()=>u.close()}),p=(e,t,n)=>{e.listen(t,e=>{try{n(e)}catch(e){setTimeout(()=>{throw e},0)}})};return p(u,Fr.EventType.OPEN,()=>{f||(Jr(gu,"RPC '".concat(e,"' stream ").concat(r," transport opened.")),d.o_())}),p(u,Fr.EventType.CLOSE,()=>{f||(f=!0,Jr(gu,"RPC '".concat(e,"' stream ").concat(r," transport closed")),d.a_(),this.E_(u))}),p(u,Fr.EventType.ERROR,t=>{f||(f=!0,ea(gu,"RPC '".concat(e,"' stream ").concat(r," transport errored. Name:"),t.name,"Message:",t.message),d.a_(new oa(sa.UNAVAILABLE,"The operation could not be completed")))}),p(u,Fr.EventType.MESSAGE,t=>{if(!f){var n;const a=t.data[0];aa(!!a,16349);const i=a,s=(null===i||void 0===i?void 0:i.error)||(null===(n=i[0])||void 0===n?void 0:n.error);if(s){Jr(gu,"RPC '".concat(e,"' stream ").concat(r," received error:"),s);const t=s.status;let n=function(e){const t=pl[e];if(void 0!==t)return vl(t)}(t),a=s.message;void 0===n&&(n=sa.INTERNAL,a="Unknown error status: "+t+" with message "+s.message),f=!0,d.a_(new oa(n,a)),u.close()}else Jr(gu,"RPC '".concat(e,"' stream ").concat(r," received:"),a),d.u_(a)}}),p(s,zr.STAT_EVENT,t=>{t.stat===Vr.PROXY?Jr(gu,"RPC '".concat(e,"' stream ").concat(r," detected buffering proxy")):t.stat===Vr.NOPROXY&&Jr(gu,"RPC '".concat(e,"' stream ").concat(r," detected no buffering proxy"))}),setTimeout(()=>{d.__()},0),d}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(t=>t===e)}}function yu(){return"undefined"!=typeof document?document:null}function bu(e){return new Fl(e,!0)}class wu{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;this.Mi=e,this.timerId=t,this.d_=n,this.A_=r,this.R_=a,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-n);r>0&&Jr("ExponentialBackoff","Backing off for ".concat(r," ms (base delay: ").concat(this.V_," ms, delay with jitter: ").concat(t," ms, last attempt: ").concat(n," ms ago)")),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){null!==this.m_&&(this.m_.skipDelay(),this.m_=null)}cancel(){null!==this.m_&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const Tu="PersistentStream";class Su{constructor(e,t,n,r,a,i,s,o){this.Mi=e,this.S_=n,this.b_=r,this.connection=a,this.authCredentialsProvider=i,this.appCheckCredentialsProvider=s,this.listener=o,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new wu(e,t)}x_(){return 1===this.state||5===this.state||this.O_()}O_(){return 2===this.state||3===this.state}start(){this.F_=0,4!==this.state?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&null===this.C_&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,4!==e?this.M_.reset():t&&t.code===sa.RESOURCE_EXHAUSTED?(Zr(t.toString()),Zr("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===sa.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(e=>{let[n,r]=e;this.D_===t&&this.G_(n,r)},t=>{e(()=>{const e=new oa(sa.UNKNOWN,"Fetching auth token failed: "+t.message);return this.z_(e)})})}G_(e,t){const n=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(e=>{n(()=>this.z_(e))}),this.stream.onMessage(e=>{n(()=>1==++this.F_?this.J_(e):this.onNext(e))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return Jr(Tu,"close with error: ".concat(e)),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget(()=>this.D_===e?t():(Jr(Tu,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Eu extends Su{constructor(e,t,n,r,a,i){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,i),this.serializer=a}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:na(39313,{state:e})}(t.targetChange.targetChangeType||"NO_CHANGE"),a=t.targetChange.targetIds||[],i=function(e,t){return e.useProto3Json?(aa(void 0===t||"string"==typeof t,58123),Hi.fromBase64String(t||"")):(aa(void 0===t||t instanceof Buffer||t instanceof Uint8Array,16193),Hi.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),s=t.targetChange.cause,o=s&&function(e){const t=void 0===e.code?sa.UNKNOWN:vl(e.code);return new oa(t,e.message||"")}(s);n=new Al(r,a,i,o||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const a=ql(e,r.document.name),i=Bl(r.document.updateTime),s=r.document.createTime?Bl(r.document.createTime):Ba.min(),o=new xs({mapValue:{fields:r.document.fields}}),l=Is.newFoundDocument(a,i,s,o),c=r.targetIds||[],u=r.removedTargetIds||[];n=new Cl(c,u,l.key,l)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const a=ql(e,r.document),i=r.readTime?Bl(r.readTime):Ba.min(),s=Is.newNoDocument(a,i),o=r.removedTargetIds||[];n=new Cl([],o,s.key,s)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const a=ql(e,r.document),i=r.removedTargetIds||[];n=new Cl([],i,a,null)}else{if(!("filter"in t))return na(11601,{Rt:t});{t.filter;const e=t.filter;e.targetId;const{count:r=0,unchangedNames:a}=e,i=new dl(r,a),s=e.targetId;n=new Il(s,i)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return Ba.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?Ba.min():t.readTime?Bl(t.readTime):Ba.min()}(e);return this.listener.H_(t,n)}Y_(e){const t={};t.database=Yl(this.serializer),t.addTarget=function(e,t){let n;const r=t.target;if(n=to(r)?{documents:ec(e,r)}:{query:tc(e,r).ft},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=Vl(e,t.resumeToken);const r=Ul(e,t.expectedCount);null!==r&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo(Ba.min())>0){n.readTime=jl(e,t.snapshotVersion.toTimestamp());const r=Ul(e,t.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return na(28987,{purpose:e})}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.q_(t)}Z_(e){const t={};t.database=Yl(this.serializer),t.removeTarget=e,this.q_(t)}}class ku extends Su{constructor(e,t,n,r,a,i){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,i),this.serializer=a}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return aa(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,aa(!e.writeResults||0===e.writeResults.length,55816),this.listener.ta()}onNext(e){aa(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=function(e,t){return e&&e.length>0?(aa(void 0!==t,14353),e.map(e=>function(e,t){let n=e.updateTime?Bl(e.updateTime):Bl(t);return n.isEqual(Ba.min())&&(n=Bl(t)),new $o(n,e.transformResults||[])}(e,t))):[]}(e.writeResults,e.commitTime),n=Bl(e.commitTime);return this.listener.na(n,t)}ra(){const e={};e.database=Yl(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map(e=>Zl(this.serializer,e))};this.q_(t)}}class _u{}class xu extends _u{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new oa(sa.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,n,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(a=>{let[i,s]=a;return this.connection.Go(e,Wl(t,n),r,i,s)}).catch(e=>{throw"FirebaseError"===e.name?(e.code===sa.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new oa(sa.UNKNOWN,e.toString())})}Ho(e,t,n,r,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(i=>{let[s,o]=i;return this.connection.Ho(e,Wl(t,n),r,s,o,a)}).catch(e=>{throw"FirebaseError"===e.name?(e.code===sa.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new oa(sa.UNKNOWN,e.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class Cu{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){0===this.oa&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){"Online"===this.state?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la("Connection failed 1 times. Most recent error: ".concat(e.toString())),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,"Online"===e&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t="Could not reach Cloud Firestore backend. ".concat(e,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.aa?(Zr(t),this.aa=!1):Jr("OnlineStateTracker",t)}Pa(){null!==this._a&&(this._a.cancel(),this._a=null)}}const Iu="RemoteStore";class Au{constructor(e,t,n,r,a){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=a,this.Aa.Oo(e=>{n.enqueueAndForget(async()=>{Uu(this)&&(Jr(Iu,"Restarting streams for network reachability change."),await async function(e){const t=ia(e);t.Ea.add(4),await Ru(t),t.Ra.set("Unknown"),t.Ea.delete(4),await Nu(t)}(this))})}),this.Ra=new Cu(n,r)}}async function Nu(e){if(Uu(e))for(const t of e.da)await t(!0)}async function Ru(e){for(const t of e.da)await t(!1)}function Ou(e,t){const n=ia(e);n.Ia.has(t.targetId)||(n.Ia.set(t.targetId,t),Fu(n)?Mu(n):rh(n).O_()&&Du(n,t))}function Pu(e,t){const n=ia(e),r=rh(n);n.Ia.delete(t),r.O_()&&Lu(n,t),0===n.Ia.size&&(r.O_()?r.L_():Uu(n)&&n.Ra.set("Unknown"))}function Du(e,t){if(e.Va.Ue(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(Ba.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}rh(e).Y_(t)}function Lu(e,t){e.Va.Ue(t),rh(e).Z_(t)}function Mu(e){e.Va=new Rl({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),At:t=>e.Ia.get(t)||null,ht:()=>e.datastore.serializer.databaseId}),rh(e).start(),e.Ra.ua()}function Fu(e){return Uu(e)&&!rh(e).x_()&&e.Ia.size>0}function Uu(e){return 0===ia(e).Ea.size}function ju(e){e.Va=void 0}async function Vu(e){e.Ra.set("Online")}async function zu(e){e.Ia.forEach((t,n)=>{Du(e,t)})}async function Bu(e,t){ju(e),Fu(e)?(e.Ra.ha(t),Mu(e)):e.Ra.set("Unknown")}async function Hu(e,t,n){if(e.Ra.set("Online"),t instanceof Al&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.Ia.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.Ia.delete(r),e.Va.removeTarget(r))}(e,t)}catch(n){Jr(Iu,"Failed to remove targets %s: %s ",t.targetIds.join(","),n),await Wu(e,n)}else if(t instanceof Cl?e.Va.Ze(t):t instanceof Il?e.Va.st(t):e.Va.tt(t),!n.isEqual(Ba.min()))try{const t=await Jc(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.Va.Tt(t);return n.targetChanges.forEach((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const a=e.Ia.get(r);a&&e.Ia.set(r,a.withResumeToken(n.resumeToken,t))}}),n.targetMismatches.forEach((t,n)=>{const r=e.Ia.get(t);if(!r)return;e.Ia.set(t,r.withResumeToken(Hi.EMPTY_BYTE_STRING,r.snapshotVersion)),Lu(e,t);const a=new fc(r.target,t,n,r.sequenceNumber);Du(e,a)}),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){Jr(Iu,"Failed to raise snapshot:",t),await Wu(e,t)}}async function Wu(e,t,n){if(!ei(t))throw t;e.Ea.add(1),await Ru(e),e.Ra.set("Offline"),n||(n=()=>Jc(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{Jr(Iu,"Retrying IndexedDB access"),await n(),e.Ea.delete(1),await Nu(e)})}function Gu(e,t){return t().catch(n=>Wu(e,n,t))}async function Ku(e){const t=ia(e),n=ah(t);let r=t.Ta.length>0?t.Ta[t.Ta.length-1].batchId:ni;for(;qu(t);)try{const e=await eu(t.localStore,r);if(null===e){0===t.Ta.length&&n.L_();break}r=e.batchId,$u(t,e)}catch(e){await Wu(t,e)}Xu(t)&&Yu(t)}function qu(e){return Uu(e)&&e.Ta.length<10}function $u(e,t){e.Ta.push(t);const n=ah(e);n.O_()&&n.X_&&n.ea(t.mutations)}function Xu(e){return Uu(e)&&!ah(e).x_()&&e.Ta.length>0}function Yu(e){ah(e).start()}async function Qu(e){ah(e).ra()}async function Ju(e){const t=ah(e);for(const n of e.Ta)t.ea(n.mutations)}async function Zu(e,t,n){const r=e.Ta.shift(),a=hl.from(r,t,n);await Gu(e,()=>e.remoteSyncer.applySuccessfulWrite(a)),await Ku(e)}async function eh(e,t){t&&ah(e).X_&&await async function(e,t){if(function(e){return gl(e)&&e!==sa.ABORTED}(t.code)){const n=e.Ta.shift();ah(e).B_(),await Gu(e,()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t)),await Ku(e)}}(e,t),Xu(e)&&Yu(e)}async function th(e,t){const n=ia(e);n.asyncQueue.verifyOperationInProgress(),Jr(Iu,"RemoteStore received new credentials");const r=Uu(n);n.Ea.add(3),await Ru(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.Ea.delete(3),await Nu(n)}async function nh(e,t){const n=ia(e);t?(n.Ea.delete(2),await Nu(n)):t||(n.Ea.add(2),await Ru(n),n.Ra.set("Unknown"))}function rh(e){return e.ma||(e.ma=function(e,t,n){const r=ia(e);return r.sa(),new Eu(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Xo:Vu.bind(null,e),t_:zu.bind(null,e),r_:Bu.bind(null,e),H_:Hu.bind(null,e)}),e.da.push(async t=>{t?(e.ma.B_(),Fu(e)?Mu(e):e.Ra.set("Unknown")):(await e.ma.stop(),ju(e))})),e.ma}function ah(e){return e.fa||(e.fa=function(e,t,n){const r=ia(e);return r.sa(),new ku(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Xo:()=>Promise.resolve(),t_:Qu.bind(null,e),r_:eh.bind(null,e),ta:Ju.bind(null,e),na:Zu.bind(null,e)}),e.da.push(async t=>{t?(e.fa.B_(),await Ku(e)):(await e.fa.stop(),e.Ta.length>0&&(Jr(Iu,"Stopping write stream with ".concat(e.Ta.length," pending writes")),e.Ta=[]))})),e.fa}class ih{constructor(e,t,n,r,a){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=a,this.deferred=new la,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(e=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,a){const i=Date.now()+n,s=new ih(e,t,i,r,a);return s.start(n),s}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new oa(sa.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function sh(e,t){if(Zr("AsyncQueue","".concat(t,": ").concat(e)),ei(e))return new oa(sa.UNAVAILABLE,"".concat(t,": ").concat(e));throw e}class oh{static emptySet(e){return new oh(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||Na.comparator(t.key,n.key):(e,t)=>Na.comparator(e.key,t.key),this.keyedMap=Eo(),this.sortedSet=new Mi(this.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof oh))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new oh;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class lh{constructor(){this.ga=new Mi(Na.comparator)}track(e){const t=e.doc.key,n=this.ga.get(t);n?0!==e.type&&3===n.type?this.ga=this.ga.insert(t,e):3===e.type&&1!==n.type?this.ga=this.ga.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.ga=this.ga.remove(t):1===e.type&&2===n.type?this.ga=this.ga.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):na(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal((t,n)=>{e.push(n)}),e}}class ch{constructor(e,t,n,r,a,i,s,o,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=a,this.fromCache=i,this.syncStateChanged=s,this.excludesMetadataChanges=o,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,r,a){const i=[];return t.forEach(e=>{i.push({type:0,doc:e})}),new ch(e,t,oh.emptySet(t),i,n,r,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&ho(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}class uh{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class hh{constructor(){this.queries=fh(),this.onlineState="Unknown",this.Ca=new Set}terminate(){!function(e,t){const n=ia(e),r=n.queries;n.queries=fh(),r.forEach((e,n)=>{for(const r of n.Sa)r.onError(t)})}(this,new oa(sa.ABORTED,"Firestore shutting down"))}}function fh(){return new bo(e=>fo(e),ho)}async function dh(e,t){const n=ia(e);let r=3;const a=t.query;let i=n.queries.get(a);i?!i.ba()&&t.Da()&&(r=2):(i=new uh,r=t.Da()?0:1);try{switch(r){case 0:i.wa=await n.onListen(a,!0);break;case 1:i.wa=await n.onListen(a,!1);break;case 2:await n.onFirstRemoteStoreListen(a)}}catch(e){const n=sh(e,"Initialization of query '".concat(po(t.query),"' failed"));return void t.onError(n)}n.queries.set(a,i),i.Sa.push(t),t.va(n.onlineState),i.wa&&t.Fa(i.wa)&&vh(n)}async function ph(e,t){const n=ia(e),r=t.query;let a=3;const i=n.queries.get(r);if(i){const e=i.Sa.indexOf(t);e>=0&&(i.Sa.splice(e,1),0===i.Sa.length?a=t.Da()?0:1:!i.ba()&&t.Da()&&(a=2))}switch(a){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function mh(e,t){const n=ia(e);let r=!1;for(const a of t){const e=a.query,t=n.queries.get(e);if(t){for(const e of t.Sa)e.Fa(a)&&(r=!0);t.wa=a}}r&&vh(n)}function gh(e,t,n){const r=ia(e),a=r.queries.get(t);if(a)for(const i of a.Sa)i.onError(n);r.queries.delete(t)}function vh(e){e.Ca.forEach(e=>{e.next()})}var yh,bh;(bh=yh||(yh={})).Ma="default",bh.Cache="cache";class wh{constructor(e,t,n){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new ch(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache)return!0;if(!this.Da())return!0;const n="Offline"!==t;return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}ka(e){e=ch.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==yh.Cache}}class Th{constructor(e){this.key=e}}class Sh{constructor(e){this.key=e}}class Eh{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=No(),this.mutatedKeys=No(),this.eu=vo(e),this.tu=new oh(this.eu)}get nu(){return this.Ya}ru(e,t){const n=t?t.iu:new lh,r=t?t.tu:this.tu;let a=t?t.mutatedKeys:this.mutatedKeys,i=r,s=!1;const o="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,l="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((e,t)=>{const c=r.get(e),u=mo(this.query,t)?t:null,h=!!c&&this.mutatedKeys.has(c.key),f=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations);let d=!1;c&&u?c.data.isEqual(u.data)?h!==f&&(n.track({type:3,doc:u}),d=!0):this.su(c,u)||(n.track({type:2,doc:u}),d=!0,(o&&this.eu(u,o)>0||l&&this.eu(u,l)<0)&&(s=!0)):!c&&u?(n.track({type:0,doc:u}),d=!0):c&&!u&&(n.track({type:1,doc:c}),d=!0,(o||l)&&(s=!0)),d&&(u?(i=i.add(u),a=f?a.add(e):a.delete(e)):(i=i.delete(e),a=a.delete(e)))}),null!==this.query.limit)for(;i.size>this.query.limit;){const e="F"===this.query.limitType?i.last():i.first();i=i.delete(e.key),a=a.delete(e.key),n.track({type:1,doc:e})}return{tu:i,iu:n,Cs:s,mutatedKeys:a}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){const a=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const i=e.iu.ya();i.sort((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return na(20277,{Rt:e})}};return n(e)-n(t)}(e.type,t.type)||this.eu(e.doc,t.doc)),this.ou(n),r=null!==r&&void 0!==r&&r;const s=t&&!r?this._u():[],o=0===this.Xa.size&&this.current&&!r?1:0,l=o!==this.Za;return this.Za=o,0!==i.length||l?{snapshot:new ch(this.query,e.tu,a,i,e.mutatedKeys,0===o,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:s}:{au:s}}va(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({tu:this.tu,iu:new lh,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(e=>this.Ya=this.Ya.add(e)),e.modifiedDocuments.forEach(e=>{}),e.removedDocuments.forEach(e=>this.Ya=this.Ya.delete(e)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=No(),this.tu.forEach(e=>{this.uu(e.key)&&(this.Xa=this.Xa.add(e.key))});const t=[];return e.forEach(e=>{this.Xa.has(e)||t.push(new Sh(e))}),this.Xa.forEach(n=>{e.has(n)||t.push(new Th(n))}),t}cu(e){this.Ya=e.Qs,this.Xa=No();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return ch.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,0===this.Za,this.hasCachedResults)}}const kh="SyncEngine";class _h{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class xh{constructor(e){this.key=e,this.hu=!1}}class Ch{constructor(e,t,n,r,a,i){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=a,this.maxConcurrentLimboResolutions=i,this.Pu={},this.Tu=new bo(e=>fo(e),ho),this.Iu=new Map,this.Eu=new Set,this.du=new Mi(Na.comparator),this.Au=new Map,this.Ru=new Lc,this.Vu={},this.mu=new Map,this.fu=Tc.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return!0===this.gu}}async function Ih(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=Xh(e);let a;const i=r.Tu.get(t);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),a=i.view.lu()):a=await Nh(r,t,n,!0),a}async function Ah(e,t){const n=Xh(e);await Nh(n,t,!0,!1)}async function Nh(e,t,n,r){const a=await tu(e.localStore,lo(t)),i=a.targetId,s=e.sharedClientState.addLocalQueryTarget(i,n);let o;return r&&(o=await Rh(e,t,i,"current"===s,a.resumeToken)),e.isPrimaryClient&&n&&Ou(e.remoteStore,a),o}async function Rh(e,t,n,r,a){e.pu=(t,n,r)=>async function(e,t,n,r){let a=t.view.ru(n);a.Cs&&(a=await ru(e.localStore,t.query,!1).then(e=>{let{documents:n}=e;return t.view.ru(n,a)}));const i=r&&r.targetChanges.get(t.targetId),s=r&&null!=r.targetMismatches.get(t.targetId),o=t.view.applyChanges(a,e.isPrimaryClient,i,s);return Hh(e,t.targetId,o.au),o.snapshot}(e,t,n,r);const i=await ru(e.localStore,t,!0),s=new Eh(t,i.Qs),o=s.ru(i.documents),l=xl.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,a),c=s.applyChanges(o,e.isPrimaryClient,l);Hh(e,n,c.au);const u=new _h(t,n,s);return e.Tu.set(t,u),e.Iu.has(n)?e.Iu.get(n).push(t):e.Iu.set(n,[t]),c.snapshot}async function Oh(e,t,n){const r=ia(e),a=r.Tu.get(t),i=r.Iu.get(a.targetId);if(i.length>1)return r.Iu.set(a.targetId,i.filter(e=>!ho(e,t))),void r.Tu.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(a.targetId),r.sharedClientState.isActiveQueryTarget(a.targetId)||await nu(r.localStore,a.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(a.targetId),n&&Pu(r.remoteStore,a.targetId),zh(r,a.targetId)}).catch(Qa)):(zh(r,a.targetId),await nu(r.localStore,a.targetId,!0))}async function Ph(e,t){const n=ia(e),r=n.Tu.get(t),a=n.Iu.get(r.targetId);n.isPrimaryClient&&1===a.length&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Pu(n.remoteStore,r.targetId))}async function Dh(e,t){const n=ia(e);try{const e=await function(e,t){const n=ia(e),r=t.snapshotVersion;let a=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",e=>{const i=n.Ns.newChangeBuffer({trackRemovals:!0});a=n.Ms;const s=[];t.targetChanges.forEach((i,o)=>{const l=a.get(o);if(!l)return;s.push(n.Pi.removeMatchingKeys(e,i.removedDocuments,o).next(()=>n.Pi.addMatchingKeys(e,i.addedDocuments,o)));let c=l.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(o)?c=c.withResumeToken(Hi.EMPTY_BYTE_STRING,Ba.min()).withLastLimboFreeSnapshotVersion(Ba.min()):i.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(i.resumeToken,r)),a=a.insert(o,c),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||(t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0)}(l,c,i)&&s.push(n.Pi.updateTargetData(e,c))});let o=To(),l=No();if(t.documentUpdates.forEach(r=>{t.resolvedLimboDocuments.has(r)&&s.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))}),s.push(Zc(e,i,t.documentUpdates).next(e=>{o=e.ks,l=e.qs})),!r.isEqual(Ba.min())){const t=n.Pi.getLastRemoteSnapshotVersion(e).next(t=>n.Pi.setTargetsMetadata(e,e.currentSequenceNumber,r));s.push(t)}return Ja.waitFor(s).next(()=>i.apply(e)).next(()=>n.localDocuments.getLocalViewOfDocuments(e,o,l)).next(()=>o)}).then(e=>(n.Ms=a,e))}(n.localStore,t);t.targetChanges.forEach((e,t)=>{const r=n.Au.get(t);r&&(aa(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1,22616),e.addedDocuments.size>0?r.hu=!0:e.modifiedDocuments.size>0?aa(r.hu,14607):e.removedDocuments.size>0&&(aa(r.hu,42227),r.hu=!1))}),await Kh(n,e,t)}catch(e){await Qa(e)}}function Lh(e,t,n){const r=ia(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.Tu.forEach((n,r)=>{const a=r.view.va(t);a.snapshot&&e.push(a.snapshot)}),function(e,t){const n=ia(e);n.onlineState=t;let r=!1;n.queries.forEach((e,n)=>{for(const a of n.Sa)a.va(t)&&(r=!0)}),r&&vh(n)}(r.eventManager,t),e.length&&r.Pu.H_(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function Mh(e,t,n){const r=ia(e);r.sharedClientState.updateQueryState(t,"rejected",n);const a=r.Au.get(t),i=a&&a.key;if(i){let e=new Mi(Na.comparator);e=e.insert(i,Is.newNoDocument(i,Ba.min()));const n=No().add(i),a=new _l(Ba.min(),new Map,new Mi(ba),e,n);await Dh(r,a),r.du=r.du.remove(i),r.Au.delete(t),Gh(r)}else await nu(r.localStore,t,!1).then(()=>zh(r,t,n)).catch(Qa)}async function Fh(e,t){const n=ia(e),r=t.batch.batchId;try{const e=await function(e,t){const n=ia(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",e=>{const r=t.batch.keys(),a=n.Ns.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const a=n.batch,i=a.keys();let s=Ja.resolve();return i.forEach(e=>{s=s.next(()=>r.getEntry(t,e)).next(t=>{const i=n.docVersions.get(e);aa(null!==i,48541),t.version.compareTo(i)<0&&(a.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))})}),s.next(()=>e.mutationQueue.removeMutationBatch(t,a))}(n,e,t,a).next(()=>a.apply(e)).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=No();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t))).next(()=>n.localDocuments.getDocuments(e,r))})}(n.localStore,t);Vh(n,r,null),jh(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Kh(n,e)}catch(e){await Qa(e)}}async function Uh(e,t,n){const r=ia(e);try{const e=await function(e,t){const n=ia(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next(t=>(aa(null!==t,37113),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t))).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r)).next(()=>n.localDocuments.getDocuments(e,r))})}(r.localStore,t);Vh(r,t,n),jh(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await Kh(r,e)}catch(n){await Qa(n)}}function jh(e,t){(e.mu.get(t)||[]).forEach(e=>{e.resolve()}),e.mu.delete(t)}function Vh(e,t,n){const r=ia(e);let a=r.Vu[r.currentUser.toKey()];if(a){const e=a.get(t);e&&(n?e.reject(n):e.resolve(),a=a.remove(t)),r.Vu[r.currentUser.toKey()]=a}}function zh(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.Iu.get(t))e.Tu.delete(r),n&&e.Pu.yu(r,n);e.Iu.delete(t),e.isPrimaryClient&&e.Ru.jr(t).forEach(t=>{e.Ru.containsKey(t)||Bh(e,t)})}function Bh(e,t){e.Eu.delete(t.path.canonicalString());const n=e.du.get(t);null!==n&&(Pu(e.remoteStore,n),e.du=e.du.remove(t),e.Au.delete(n),Gh(e))}function Hh(e,t,n){for(const r of n)r instanceof Th?(e.Ru.addReference(r.key,t),Wh(e,r)):r instanceof Sh?(Jr(kh,"Document no longer in limbo: "+r.key),e.Ru.removeReference(r.key,t),e.Ru.containsKey(r.key)||Bh(e,r.key)):na(19791,{wu:r})}function Wh(e,t){const n=t.key,r=n.path.canonicalString();e.du.get(n)||e.Eu.has(r)||(Jr(kh,"New document in limbo: "+n),e.Eu.add(r),Gh(e))}function Gh(e){for(;e.Eu.size>0&&e.du.size<e.maxConcurrentLimboResolutions;){const t=e.Eu.values().next().value;e.Eu.delete(t);const n=new Na(Ca.fromString(t)),r=e.fu.next();e.Au.set(r,new xh(n)),e.du=e.du.insert(n,r),Ou(e.remoteStore,new fc(lo(ao(n.path)),r,"TargetPurposeLimboResolution",ti.ce))}}async function Kh(e,t,n){const r=ia(e),a=[],i=[],s=[];r.Tu.isEmpty()||(r.Tu.forEach((e,o)=>{s.push(r.pu(o,t,n).then(e=>{if((e||n)&&r.isPrimaryClient){var t;const a=e?!e.fromCache:null===n||void 0===n||null===(t=n.targetChanges.get(o.targetId))||void 0===t?void 0:t.current;r.sharedClientState.updateQueryState(o.targetId,a?"current":"not-current")}if(e){a.push(e);const t=Gc.As(o.targetId,e);i.push(t)}}))}),await Promise.all(s),r.Pu.H_(a),await async function(e,t){const n=ia(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",e=>Ja.forEach(t,t=>Ja.forEach(t.Es,r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r)).next(()=>Ja.forEach(t.ds,r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))}catch(e){if(!ei(e))throw e;Jr($c,"Failed to update sequence numbers: "+e)}for(const r of t){const e=r.targetId;if(!r.fromCache){const t=n.Ms.get(e),r=t.snapshotVersion,a=t.withLastLimboFreeSnapshotVersion(r);n.Ms=n.Ms.insert(e,a)}}}(r.localStore,i))}async function qh(e,t){const n=ia(e);if(!n.currentUser.isEqual(t)){Jr(kh,"User change. New user:",t.toKey());const e=await Qc(n.localStore,t);n.currentUser=t,function(e,t){e.mu.forEach(e=>{e.forEach(e=>{e.reject(new oa(sa.CANCELLED,t))})}),e.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await Kh(n,e.Ls)}}function $h(e,t){const n=ia(e),r=n.Au.get(t);if(r&&r.hu)return No().add(r.key);{let e=No();const r=n.Iu.get(t);if(!r)return e;for(const t of r){const r=n.Tu.get(t);e=e.unionWith(r.view.nu)}return e}}function Xh(e){const t=ia(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=Dh.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=$h.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Mh.bind(null,t),t.Pu.H_=mh.bind(null,t.eventManager),t.Pu.yu=gh.bind(null,t.eventManager),t}function Yh(e){const t=ia(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Fh.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Uh.bind(null,t),t}class Qh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=bu(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return Yc(this.persistence,new qc,e.initialUser,this.serializer)}Cu(e){return new zc(Hc.mi,this.serializer)}Du(e){return new su}async terminate(){var e,t;null!==(e=this.gcScheduler)&&void 0!==e&&e.stop(),null!==(t=this.indexBackfillerScheduler)&&void 0!==t&&t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Qh.provider={build:()=>new Qh};class Jh extends Qh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){aa(this.persistence.referenceDelegate instanceof Wc,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new xc(n,e.asyncQueue,t)}Cu(e){const t=void 0!==this.cacheSizeBytes?wc.withCacheSize(this.cacheSizeBytes):wc.DEFAULT;return new zc(e=>Wc.mi(e,t),this.serializer)}}class Zh{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>Lh(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=qh.bind(null,this.syncEngine),await nh(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new hh}createDatastore(e){const t=bu(e.databaseInfo.databaseId),n=function(e){return new vu(e)}(e.databaseInfo);return function(e,t,n,r){return new xu(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,r,a){return new Au(e,t,n,r,a)}(this.localStore,this.datastore,e.asyncQueue,e=>Lh(this.syncEngine,e,0),cu.v()?new cu:new ou)}createSyncEngine(e,t){return function(e,t,n,r,a,i,s){const o=new Ch(e,t,n,r,a,i);return s&&(o.gu=!0),o}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(e){const t=ia(e);Jr(Iu,"RemoteStore shutting down."),t.Ea.add(5),await Ru(t),t.Aa.shutdown(),t.Ra.set("Unknown")}(this.remoteStore),null!==(e=this.datastore)&&void 0!==e&&e.terminate(),null===(t=this.eventManager)||void 0===t||t.terminate()}}Zh.provider={build:()=>new Zh};class ef{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Zr("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout(()=>{this.muted||e(t)},0)}}const tf="FirestoreClient";class nf{constructor(e,t,n,r,a){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=$r.UNAUTHENTICATED,this.clientId=ya.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(n,async e=>{Jr(tf,"Received user=",e.uid),await this.authCredentialListener(e),this.user=e}),this.appCheckCredentials.start(n,e=>(Jr(tf,"Received new app check token=",e),this.appCheckCredentialListener(e,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new la;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=sh(t,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function rf(e,t){e.asyncQueue.verifyOperationInProgress(),Jr(tf,"Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener(async e=>{r.isEqual(e)||(await Qc(t.localStore,e),r=e)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function af(e,t){e.asyncQueue.verifyOperationInProgress();const n=await sf(e);Jr(tf,"Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener(e=>th(t.remoteStore,e)),e.setAppCheckTokenChangeListener((e,n)=>th(t.remoteStore,n)),e._onlineComponents=t}async function sf(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){Jr(tf,"Using user provided OfflineComponentProvider");try{await rf(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!function(e){return"FirebaseError"===e.name?e.code===sa.FAILED_PRECONDITION||e.code===sa.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}(n))throw n;ea("Error using user provided cache. Falling back to memory cache: "+n),await rf(e,new Qh)}}else Jr(tf,"Using default OfflineComponentProvider"),await rf(e,new Jh(void 0));return e._offlineComponents}async function of(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(Jr(tf,"Using user provided OnlineComponentProvider"),await af(e,e._uninitializedComponentsProvider._online)):(Jr(tf,"Using default OnlineComponentProvider"),await af(e,new Zh))),e._onlineComponents}function lf(e){return of(e).then(e=>e.syncEngine)}async function cf(e){const t=await of(e),n=t.eventManager;return n.onListen=Ih.bind(null,t.syncEngine),n.onUnlisten=Oh.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=Ah.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=Ph.bind(null,t.syncEngine),n}function uf(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new la;return e.asyncQueue.enqueueAndForget(async()=>function(e,t,n,r,a){const i=new ef({next:o=>{i.Nu(),t.enqueueAndForget(()=>ph(e,s));const l=o.docs.has(n);!l&&o.fromCache?a.reject(new oa(sa.UNAVAILABLE,"Failed to get document because the client is offline.")):l&&o.fromCache&&r&&"server"===r.source?a.reject(new oa(sa.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):a.resolve(o)},error:e=>a.reject(e)}),s=new wh(ao(n.path),i,{includeMetadataChanges:!0,qa:!0});return dh(e,s)}(await cf(e),e.asyncQueue,t,n,r)),r.promise}function hf(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new la;return e.asyncQueue.enqueueAndForget(async()=>function(e,t,n,r,a){const i=new ef({next:n=>{i.Nu(),t.enqueueAndForget(()=>ph(e,s)),n.fromCache&&"server"===r.source?a.reject(new oa(sa.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):a.resolve(n)},error:e=>a.reject(e)}),s=new wh(n,i,{includeMetadataChanges:!0,qa:!0});return dh(e,s)}(await cf(e),e.asyncQueue,t,n,r)),r.promise}function ff(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const df=new Map,pf="firestore.googleapis.com",mf=!0;class gf{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new oa(sa.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=pf,this.ssl=mf}else this.host=e.host,this.ssl=null!==(t=e.ssl)&&void 0!==t?t:mf;if(this.isUsingEmulator=void 0!==e.emulatorOptions,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=bc;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<Ec)throw new oa(sa.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,n,r){if(!0===t&&!0===r)throw new oa(sa.INVALID_ARGUMENT,"".concat(e," and ").concat(n," cannot be used together."))})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=ff(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new oa(sa.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (must not be NaN)"));if(e.timeoutSeconds<5)throw new oa(sa.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (minimum allowed value is 5)"));if(e.timeoutSeconds>30)throw new oa(sa.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (maximum allowed value is 30)"))}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class vf{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new gf({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new oa(sa.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new oa(sa.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new gf(e),this._emulatorOptions=e.emulatorOptions||{},void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new ua;switch(e.type){case"firstParty":return new pa(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new oa(sa.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=df.get(e);t&&(Jr("ComponentProvider","Removing Datastore"),df.delete(e),t.terminate())}(this),Promise.resolve()}}function yf(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e=Ma(e,vf);const a=Pt(t),i=e._getSettings(),s=l(l({},i),{},{emulatorOptions:e._getEmulatorOptions()}),o="".concat(t,":").concat(n);a&&(Dt("https://".concat(o)),Ft("Firestore",!0)),i.host!==pf&&i.host!==o&&ea("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c=l(l({},i),{},{host:o,ssl:a,emulatorOptions:r});if(!qt(c,s)&&(e._setSettings(c),r.mockUserToken)){let t,n;if("string"==typeof r.mockUserToken)t=r.mockUserToken,n=$r.MOCK_USER;else{var u;t=function(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",r=e.iat||0,a=e.sub||e.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const i=l({iss:"https://securetoken.google.com/".concat(n),aud:n,iat:r,exp:r+3600,auth_time:r,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}}},e);return[_t(JSON.stringify({alg:"none",type:"JWT"})),_t(JSON.stringify(i)),""].join(".")}(r.mockUserToken,null===(u=e._app)||void 0===u?void 0:u.options.projectId);const a=r.mockUserToken.sub||r.mockUserToken.user_id;if(!a)throw new oa(sa.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new $r(a)}e._authCredentials=new ha(new ca(t,n))}}class bf{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new bf(this.firestore,e,this._query)}}class wf{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Tf(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new wf(this.firestore,e,this._key)}toJSON(){return{type:wf._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,n){if(Ua(t,wf._jsonSchema))return new wf(e,n||null,new Na(Ca.fromString(t.referencePath)))}}wf._jsonSchemaVersion="firestore/documentReference/1.0",wf._jsonSchema={type:Fa("string",wf._jsonSchemaVersion),referencePath:Fa("string")};class Tf extends bf{constructor(e,t,n){super(e,t,ao(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new wf(this.firestore,null,new Na(e))}withConverter(e){return new Tf(this.firestore,e,this._path)}}function Sf(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];if(e=tn(e),Ra("collection","path",t),e instanceof vf){const n=Ca.fromString(t,...r);return Pa(n),new Tf(e,null,n)}{if(!(e instanceof wf||e instanceof Tf))throw new oa(sa.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(Ca.fromString(t,...r));return Pa(n),new Tf(e.firestore,null,n)}}function Ef(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];if(e=tn(e),1===arguments.length&&(t=ya.newId()),Ra("doc","path",t),e instanceof vf){const n=Ca.fromString(t,...r);return Oa(n),new wf(e,null,new Na(n))}{if(!(e instanceof wf||e instanceof Tf))throw new oa(sa.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(Ca.fromString(t,...r));return Oa(n),new wf(e.firestore,e instanceof Tf?e.converter:null,new Na(n))}}const kf="AsyncQueue";class _f{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Promise.resolve();this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new wu(this,"async_queue_retry"),this._c=()=>{const e=yu();e&&Jr(kf,"Visibility state changed to "+e.visibilityState),this.M_.w_()},this.ac=e;const t=yu();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=yu();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const t=new la;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(0!==this.Xu.length){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(AR){if(!ei(AR))throw AR;Jr(kf,"Operation failed with retryable error: "+AR)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const t=this.ac.then(()=>(this.rc=!0,e().catch(e=>{throw this.nc=e,this.rc=!1,Zr("INTERNAL UNHANDLED ERROR: ",xf(e)),e}).then(e=>(this.rc=!1,e))));return this.ac=t,t}enqueueAfterDelay(e,t,n){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const r=ih.createAndSchedule(this,e,t,n,e=>this.hc(e));return this.tc.push(r),r}uc(){this.nc&&na(47125,{Pc:xf(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do{e=this.ac,await e}while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((e,t)=>e.targetTimeMs-t.targetTimeMs);for(const t of this.tc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function xf(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}class Cf extends vf{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new _f,this._persistenceKey=(null===r||void 0===r?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new _f(e),this._firestoreClient=void 0,await e}}}function If(e){if(e._terminated)throw new oa(sa.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||Af(e),e._firestoreClient}function Af(e){var t,n,r;const a=e._freezeSettings(),i=function(e,t,n,r){return new ts(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,ff(r.experimentalLongPollingOptions),r.useFetchStreams,r.isUsingEmulator)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,a);e._componentsProvider||null!==(n=a.localCache)&&void 0!==n&&n._offlineComponentProvider&&null!==(r=a.localCache)&&void 0!==r&&r._onlineComponentProvider&&(e._componentsProvider={_offline:a.localCache._offlineComponentProvider,_online:a.localCache._onlineComponentProvider}),e._firestoreClient=new nf(e._authCredentials,e._appCheckCredentials,e._queue,i,e._componentsProvider&&function(e){const t=null===e||void 0===e?void 0:e._online.build();return{_offline:null===e||void 0===e?void 0:e._offline.build(t),_online:t}}(e._componentsProvider))}class Nf{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Nf(Hi.fromBase64String(e))}catch(e){throw new oa(sa.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new Nf(Hi.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Nf._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Ua(e,Nf._jsonSchema))return Nf.fromBase64String(e.bytes)}}Nf._jsonSchemaVersion="firestore/bytes/1.0",Nf._jsonSchema={type:Fa("string",Nf._jsonSchemaVersion),bytes:Fa("string")};class Rf{constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let r=0;r<t.length;++r)if(0===t[r].length)throw new oa(sa.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Aa(t)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Of{constructor(e){this._methodName=e}}class Pf{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new oa(sa.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new oa(sa.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return ba(this._lat,e._lat)||ba(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Pf._jsonSchemaVersion}}static fromJSON(e){if(Ua(e,Pf._jsonSchema))return new Pf(e.latitude,e.longitude)}}Pf._jsonSchemaVersion="firestore/geoPoint/1.0",Pf._jsonSchema={type:Fa("string",Pf._jsonSchemaVersion),latitude:Fa("number"),longitude:Fa("number")};class Df{constructor(e){this._values=(e||[]).map(e=>e)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Df._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Ua(e,Df._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(e=>"number"==typeof e))return new Df(e.vectorValues);throw new oa(sa.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Df._jsonSchemaVersion="firestore/vectorValue/1.0",Df._jsonSchema={type:Fa("string",Df._jsonSchemaVersion),vectorValues:Fa("object")};const Lf=/^__.*__$/;class Mf{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new al(e,this.data,this.fieldMask,t,this.fieldTransforms):new rl(e,this.data,t,this.fieldTransforms)}}class Ff{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new al(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Uf(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw na(40011,{Ac:e})}}class jf{constructor(e,t,n,r,a,i){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===a&&this.Rc(),this.fieldTransforms=a||[],this.fieldMask=i||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new jf(l(l({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Zf(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(0===e.length)throw this.Sc("Document fields must not be empty");if(Uf(this.Ac)&&Lf.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class Vf{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||bu(e)}Cc(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new jf({Ac:e,methodName:t,Dc:n,path:Aa.emptyPath(),fc:!1,bc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function zf(e){const t=e._freezeSettings(),n=bu(e._databaseId);return new Vf(e._databaseId,!!t.ignoreUndefinedProperties,n)}function Bf(e,t,n,r,a){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const s=e.Cc(i.merge||i.mergeFields?2:0,t,n,a);Xf("Data must be an object, but it was:",s,r);const o=qf(r,s);let l,c;if(i.merge)l=new zi(s.fieldMask),c=s.fieldTransforms;else if(i.mergeFields){const e=[];for(const r of i.mergeFields){const a=Yf(t,r,n);if(!s.contains(a))throw new oa(sa.INVALID_ARGUMENT,"Field '".concat(a,"' is specified in your field mask but missing from your input data."));ed(e,a)||e.push(a)}l=new zi(e),c=s.fieldTransforms.filter(e=>l.covers(e.field))}else l=null,c=s.fieldTransforms;return new Mf(new xs(o),l,c)}class Hf extends Of{_toFieldTransform(e){if(2!==e.Ac)throw 1===e.Ac?e.Sc("".concat(this._methodName,"() can only appear at the top level of your update data")):e.Sc("".concat(this._methodName,"() cannot be used with set() unless you pass {merge:true}"));return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Hf}}function Wf(e,t,n,r){const a=e.Cc(1,t,n);Xf("Data must be an object, but it was:",a,r);const i=[],s=xs.empty();Di(r,(e,r)=>{const o=Jf(t,e,n);r=tn(r);const l=a.yc(o);if(r instanceof Hf)i.push(o);else{const e=Kf(r,l);null!=e&&(i.push(o),s.set(o,e))}});const o=new zi(i);return new Ff(s,o,a.fieldTransforms)}function Gf(e,t,n,r,a,i){const s=e.Cc(1,t,n),o=[Yf(t,r,n)],l=[a];if(i.length%2!=0)throw new oa(sa.INVALID_ARGUMENT,"Function ".concat(t,"() needs to be called with an even number of arguments that alternate between field names and values."));for(let f=0;f<i.length;f+=2)o.push(Yf(t,i[f])),l.push(i[f+1]);const c=[],u=xs.empty();for(let f=o.length-1;f>=0;--f)if(!ed(c,o[f])){const e=o[f];let t=l[f];t=tn(t);const n=s.yc(e);if(t instanceof Hf)c.push(e);else{const r=Kf(t,n);null!=r&&(c.push(e),u.set(e,r))}}const h=new zi(c);return new Ff(u,h,s.fieldTransforms)}function Kf(e,t){if($f(e=tn(e)))return Xf("Unsupported field value:",t,e),qf(e,t);if(e instanceof Of)return function(e,t){if(!Uf(t.Ac))throw t.Sc("".concat(e._methodName,"() can only be used with update() and set()"));if(!t.path)throw t.Sc("".concat(e._methodName,"() is not currently supported inside arrays"));const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.fc&&4!==t.Ac)throw t.Sc("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const a of e){let e=Kf(a,t.wc(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=tn(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return Lo(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=za.fromDate(e);return{timestampValue:jl(t.serializer,n)}}if(e instanceof za){const n=new za(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:jl(t.serializer,n)}}if(e instanceof Pf)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof Nf)return{bytesValue:Vl(t.serializer,e._byteString)};if(e instanceof wf){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.Sc("Document reference is for database ".concat(r.projectId,"/").concat(r.database," but should be for database ").concat(n.projectId,"/").concat(n.database));return{referenceValue:Hl(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof Df)return function(e,t){return{mapValue:{fields:{[as]:{stringValue:os},[ls]:{arrayValue:{values:e.toArray().map(e=>{if("number"!=typeof e)throw t.Sc("VectorValues must only contain numeric values.");return Po(t.serializer,e)})}}}}}}(e,t);throw t.Sc("Unsupported field value: ".concat(La(e)))}(e,t)}function qf(e,t){const n={};return Li(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Di(e,(e,r)=>{const a=Kf(r,t.mc(e));null!=a&&(n[e]=a)}),{mapValue:{fields:n}}}function $f(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof za||e instanceof Pf||e instanceof Nf||e instanceof wf||e instanceof Of||e instanceof Df)}function Xf(e,t,n){if(!$f(n)||!Da(n)){const r=La(n);throw"an object"===r?t.Sc(e+" a custom object"):t.Sc(e+" "+r)}}function Yf(e,t,n){if((t=tn(t))instanceof Rf)return t._internalPath;if("string"==typeof t)return Jf(e,t);throw Zf("Field path arguments must be of type string or ",e,!1,void 0,n)}const Qf=new RegExp("[~\\*/\\[\\]]");function Jf(e,t,n){if(t.search(Qf)>=0)throw Zf("Invalid field path (".concat(t,"). Paths must not contain '~', '*', '/', '[', or ']'"),e,!1,void 0,n);try{return new Rf(...t.split("."))._internalPath}catch(r){throw Zf("Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),e,!1,void 0,n)}}function Zf(e,t,n,r,a){const i=r&&!r.isEmpty(),s=void 0!==a;let o="Function ".concat(t,"() called with invalid data");n&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(i||s)&&(l+=" (found",i&&(l+=" in field ".concat(r)),s&&(l+=" in document ".concat(a)),l+=")"),new oa(sa.INVALID_ARGUMENT,o+e+l)}function ed(e,t){return e.some(e=>e.isEqual(t))}class td{constructor(e,t,n,r,a){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new wf(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new nd(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(rd("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class nd extends td{data(){return super.data()}}function rd(e,t){return"string"==typeof t?Jf(e,t):t instanceof Rf?t._internalPath:t._delegate._internalPath}function ad(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new oa(sa.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class id{convertValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(cs(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ki(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(qi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw na(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";const n={};return Di(e,(e,r)=>{n[e]=this.convertValue(r,t)}),n}convertVectorValue(e){var t;const n=null===(t=e.fields)||void 0===t||null===(t=t[ls].arrayValue)||void 0===t||null===(t=t.values)||void 0===t?void 0:t.map(e=>Ki(e.doubleValue));return new Df(n)}convertGeoPoint(e){return new Pf(Ki(e.latitude),Ki(e.longitude))}convertArray(e,t){return(e.values||[]).map(e=>this.convertValue(e,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Zi(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(es(e));default:return null}}convertTimestamp(e){const t=Gi(e);return new za(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=Ca.fromString(e);aa(hc(n),9688,{name:e});const r=new rs(n.get(1),n.get(3)),a=new Na(n.popFirst(5));return r.isEqual(t)||Zr("Document ".concat(a," contains a document reference within a different database (").concat(r.projectId,"/").concat(r.database,") which is not supported. It will be treated as a reference in the current database (").concat(t.projectId,"/").concat(t.database,") instead.")),a}}function sd(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}class od{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ld extends td{constructor(e,t,n,r,a,i){super(e,t,n,r,i),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){const t=new cd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){const n=this._document.data.field(rd("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new oa(sa.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=ld._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),e&&e.isValidDocument()&&e.isFoundDocument()?(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t):t}}ld._jsonSchemaVersion="firestore/documentSnapshot/1.0",ld._jsonSchema={type:Fa("string",ld._jsonSchemaVersion),bundleSource:Fa("string","DocumentSnapshot"),bundleName:Fa("string"),bundle:Fa("string")};class cd extends ld{data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return super.data(e)}}class ud{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new od(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new cd(this._firestore,this._userDataWriter,n.key,n,new od(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(){const e=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new oa(sa.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map(n=>{const r=new cd(e._firestore,e._userDataWriter,n.doc.key,n.doc,new od(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}})}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(e=>t||3!==e.type).map(t=>{const r=new cd(e._firestore,e._userDataWriter,t.doc.key,t.doc,new od(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let a=-1,i=-1;return 0!==t.type&&(a=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),i=n.indexOf(t.doc.key)),{type:hd(t.type),doc:r,oldIndex:a,newIndex:i}})}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new oa(sa.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=ud._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=ya.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],n=[],r=[];return this.docs.forEach(e=>{null!==e._document&&(t.push(e._document),n.push(this._userDataWriter.convertObjectMap(e._document.data.value.mapValue.fields,"previous")),r.push(e.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function hd(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return na(61501,{type:e})}}function fd(e){e=Ma(e,wf);const t=Ma(e.firestore,Cf);return uf(If(t),e._key).then(n=>wd(t,e,n))}ud._jsonSchemaVersion="firestore/querySnapshot/1.0",ud._jsonSchema={type:Fa("string",ud._jsonSchemaVersion),bundleSource:Fa("string","QuerySnapshot"),bundleName:Fa("string"),bundle:Fa("string")};class dd extends id{constructor(e){super(),this.firestore=e}convertBytes(e){return new Nf(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new wf(this.firestore,null,t)}}function pd(e){e=Ma(e,bf);const t=Ma(e.firestore,Cf),n=If(t),r=new dd(t);return ad(e._query),hf(n,e._query).then(n=>new ud(t,r,e,n))}function md(e,t,n){e=Ma(e,wf);const r=Ma(e.firestore,Cf),a=sd(e.converter,t,n);return bd(r,[Bf(zf(r),"setDoc",e._key,a,null!==e.converter,n).toMutation(e._key,Xo.none())])}function gd(e,t,n){e=Ma(e,wf);const r=Ma(e.firestore,Cf),a=zf(r);let i;for(var s=arguments.length,o=new Array(s>3?s-3:0),l=3;l<s;l++)o[l-3]=arguments[l];return i="string"==typeof(t=tn(t))||t instanceof Rf?Gf(a,"updateDoc",e._key,t,n,o):Wf(a,"updateDoc",e._key,t),bd(r,[i.toMutation(e._key,Xo.exists(!0))])}function vd(e){return bd(Ma(e.firestore,Cf),[new ll(e._key,Xo.none())])}function yd(e,t){const n=Ma(e.firestore,Cf),r=Ef(e),a=sd(e.converter,t);return bd(n,[Bf(zf(e.firestore),"addDoc",r._key,a,null!==e.converter,{}).toMutation(r._key,Xo.exists(!1))]).then(()=>r)}function bd(e,t){return function(e,t){const n=new la;return e.asyncQueue.enqueueAndForget(async()=>async function(e,t,n){const r=Yh(e);try{const e=await function(e,t){const n=ia(e),r=za.now(),a=t.reduce((e,t)=>e.add(t.key),No());let i,s;return n.persistence.runTransaction("Locally write mutations","readwrite",e=>{let o=To(),l=No();return n.Ns.getEntries(e,a).next(e=>{o=e,o.forEach((e,t)=>{t.isValidDocument()||(l=l.add(e))})}).next(()=>n.localDocuments.getOverlayedDocuments(e,o)).next(a=>{i=a;const s=[];for(const e of t){const t=tl(e,i.get(e.key).overlayedDocument);null!=t&&s.push(new al(e.key,t,Cs(t.value.mapValue),Xo.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,s,t)}).next(t=>{s=t;const r=t.applyToLocalDocumentSet(i,l);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)})}).then(()=>({batchId:s.batchId,changes:ko(i)}))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.Vu[e.currentUser.toKey()];r||(r=new Mi(ba)),r=r.insert(t,n),e.Vu[e.currentUser.toKey()]=r}(r,e.batchId,n),await Kh(r,e.changes),await Ku(r.remoteStore)}catch(e){const t=sh(e,"Failed to persist write");n.reject(t)}}(await lf(e),t,n)),n.promise}(If(e),t)}function wd(e,t,n){const r=n.docs.get(t._key),a=new dd(e);return new ld(e,a,t._key,r,new od(n.hasPendingWrites,n.fromCache),t.converter)}new WeakMap;!function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){Xr=e}(yr),dr(new nn("firestore",(e,n)=>{let{instanceIdentifier:r,options:a}=n;const i=e.getProvider("app").getImmediate(),s=new Cf(new fa(e.getProvider("auth-internal")),new ga(i,e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new oa(sa.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new rs(e.options.projectId,t)}(i,r),i);return a=l({useFetchStreams:t},a),s._setSettings(a),s},"PUBLIC").setMultipleInstances(!0)),Tr(Kr,qr,e),Tr(Kr,qr,"esm2020")}();const Td=["providerId"],Sd=["uid","auth","stsTokenManager"],Ed=["providerId","signInMethod"];function kd(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const _d=kd,xd=new Gt("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Cd=new dn("@firebase/auth");function Id(e){if(Cd.logLevel<=ln.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];Cd.error("Auth (".concat(yr,"): ").concat(e),...n)}}function Ad(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw Pd(e,...n)}function Nd(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Pd(e,...n)}function Rd(e,t,n){const r=l(l({},_d()),{},{[t]:n});return new Gt("auth","Firebase",r).create(t,{appName:e.name})}function Od(e){return Rd(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Pd(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if("string"!==typeof e){const t=n[0],r=[...n.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(t,...r)}return xd.create(e,...n)}function Dd(e,t){if(!e){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];throw Pd(t,...r)}}function Ld(e){const t="INTERNAL ASSERTION FAILED: "+e;throw Id(t),new Error(t)}function Md(e,t){e||Ld(t)}function Fd(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function Ud(){return"http:"===jd()||"https:"===jd()}function jd(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}class Vd{constructor(e,t){this.shortDelay=e,this.longDelay=t,Md(t>e,"Short delay should be less than long delay!"),this.isMobile="undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ut())||"object"===typeof navigator&&"ReactNative"===navigator.product}get(){return"undefined"!==typeof navigator&&navigator&&"onLine"in navigator&&"boolean"===typeof navigator.onLine&&(Ud()||Vt()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function zd(e,t){Md(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?"".concat(n).concat(t.startsWith("/")?t.slice(1):t):n}class Bd{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!==typeof self&&"fetch"in self?self.fetch:"undefined"!==typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!==typeof fetch?fetch:void Ld("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!==typeof self&&"Headers"in self?self.Headers:"undefined"!==typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!==typeof Headers?Headers:void Ld("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!==typeof self&&"Response"in self?self.Response:"undefined"!==typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!==typeof Response?Response:void Ld("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Hd={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},Wd=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Gd=new Vd(3e4,6e4);function Kd(e,t){return e.tenantId&&!t.tenantId?l(l({},t),{},{tenantId:e.tenantId}):t}async function qd(e,t,n,r){return $d(e,arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},async()=>{let a={},i={};r&&("GET"===t?i=r:a={body:JSON.stringify(r)});const s=Xt(l({key:e.config.apiKey},i)).slice(1),o=await e._getAdditionalHeaders();o["Content-Type"]="application/json",e.languageCode&&(o["X-Firebase-Locale"]=e.languageCode);const c=l({method:t,headers:o},a);return"undefined"!==typeof navigator&&"Cloudflare-Workers"===navigator.userAgent||(c.referrerPolicy="no-referrer"),e.emulatorConfig&&Pt(e.emulatorConfig.host)&&(c.credentials="include"),Bd.fetch()(await Yd(e,e.config.apiHost,n,s),c)})}async function $d(e,t,n){e._canInitEmulator=!1;const r=l(l({},Hd),t);try{const t=new Jd(e),a=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const i=await a.json();if("needConfirmation"in i)throw Zd(e,"account-exists-with-different-credential",i);if(a.ok&&!("errorMessage"in i))return i;{const t=a.ok?i.errorMessage:i.error.message,[n,s]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw Zd(e,"credential-already-in-use",i);if("EMAIL_EXISTS"===n)throw Zd(e,"email-already-in-use",i);if("USER_DISABLED"===n)throw Zd(e,"user-disabled",i);const o=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(s)throw Rd(e,o,s);Ad(e,o)}}catch(AR){if(AR instanceof Wt)throw AR;Ad(e,"network-request-failed",{message:String(AR)})}}async function Xd(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const i=await qd(e,t,n,r,a);return"mfaPendingCredential"in i&&Ad(e,"multi-factor-auth-required",{_serverResponse:i}),i}async function Yd(e,t,n,r){const a="".concat(t).concat(n,"?").concat(r),i=e,s=i.config.emulator?zd(e.config,a):"".concat(e.config.apiScheme,"://").concat(a);if(Wd.includes(n)&&(await i._persistenceManagerAvailable,"COOKIE"===i._getPersistenceType())){return i._getPersistence()._getFinalTarget(s).toString()}return s}function Qd(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Jd{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((e,t)=>{this.timer=setTimeout(()=>t(Nd(this.auth,"network-request-failed")),Gd.get())})}}function Zd(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const a=Nd(e,t,r);return a.customData._tokenResponse=n,a}function ep(e){return void 0!==e&&void 0!==e.enterprise}class tp{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return Qd(t.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function np(e,t){return qd(e,"GET","/v2/recaptchaConfig",Kd(e,t))}async function rp(e,t){return qd(e,"POST","/v1/accounts:lookup",t)}function ap(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(AR){}}function ip(e){return 1e3*Number(e)}function sp(e){const[t,n,r]=e.split(".");if(void 0===t||void 0===n||void 0===r)return Id("JWT malformed, contained fewer than 3 sections"),null;try{const e=xt(n);return e?JSON.parse(e):(Id("Failed to decode base64 JWT payload"),null)}catch(AR){return Id("Caught error parsing JWT payload as JSON",null===AR||void 0===AR?void 0:AR.toString()),null}}function op(e){const t=sp(e);return Dd(t,"internal-error"),Dd("undefined"!==typeof t.exp,"internal-error"),Dd("undefined"!==typeof t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function lp(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2])return t;try{return await t}catch(AR){throw AR instanceof Wt&&function(e){let{code:t}=e;return t==="auth/".concat("user-disabled")||t==="auth/".concat("user-token-expired")}(AR)&&e.auth.currentUser===e&&await e.auth.signOut(),AR}}class cp{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{var t;this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(AR){return void((null===AR||void 0===AR?void 0:AR.code)==="auth/".concat("network-request-failed")&&this.schedule(!0))}this.schedule()}}class up{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=ap(this.lastLoginAt),this.creationTime=ap(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function hp(e){var t;const n=e.auth,r=await e.getIdToken(),a=await lp(e,rp(n,{idToken:r}));Dd(null===a||void 0===a?void 0:a.users.length,n,"internal-error");const i=a.users[0];e._notifyReloadListener(i);const s=null!==(t=i.providerUserInfo)&&void 0!==t&&t.length?fp(i.providerUserInfo):[],o=(l=e.providerData,c=s,[...l.filter(e=>!c.some(t=>t.providerId===e.providerId)),...c]);var l,c;const u=e.isAnonymous,h=!(e.email&&i.passwordHash)&&!(null!==o&&void 0!==o&&o.length),f=!!u&&h,d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new up(i.createdAt,i.lastLoginAt),isAnonymous:f};Object.assign(e,d)}function fp(e){return e.map(e=>{let{providerId:t}=e,n=r(e,Td);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}class dp{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Dd(e.idToken,"internal-error"),Dd("undefined"!==typeof e.idToken,"internal-error"),Dd("undefined"!==typeof e.refreshToken,"internal-error");const t="expiresIn"in e&&"undefined"!==typeof e.expiresIn?Number(e.expiresIn):op(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Dd(0!==e.length,"internal-error");const t=op(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]||!this.accessToken||this.isExpired?(Dd(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:a}=await async function(e,t){const n=await $d(e,{},async()=>{const n=Xt({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:a}=e.config,i=await Yd(e,r,"/v1/token","key=".concat(a)),s=await e._getAdditionalHeaders();s["Content-Type"]="application/x-www-form-urlencoded";const o={method:"POST",headers:s,body:n};return e.emulatorConfig&&Pt(e.emulatorConfig.host)&&(o.credentials="include"),Bd.fetch()(i,o)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,r,Number(a))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:a}=t,i=new dp;return n&&(Dd("string"===typeof n,"internal-error",{appName:e}),i.refreshToken=n),r&&(Dd("string"===typeof r,"internal-error",{appName:e}),i.accessToken=r),a&&(Dd("number"===typeof a,"internal-error",{appName:e}),i.expirationTime=a),i}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new dp,this.toJSON())}_performRefresh(){return Ld("not implemented")}}function pp(e,t){Dd("string"===typeof e||"undefined"===typeof e,"internal-error",{appName:t})}class mp{constructor(e){let{uid:t,auth:n,stsTokenManager:a}=e,i=r(e,Sd);this.providerId="firebase",this.proactiveRefresh=new cp(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=a,this.accessToken=a.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new up(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await lp(this,this.stsTokenManager.getToken(this.auth,e));return Dd(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=tn(e),r=await n.getIdToken(t),a=sp(r);Dd(a&&a.exp&&a.auth_time&&a.iat,n.auth,"internal-error");const i="object"===typeof a.firebase?a.firebase:void 0,s=null===i||void 0===i?void 0:i.sign_in_provider;return{claims:a,token:r,authTime:ap(ip(a.auth_time)),issuedAtTime:ap(ip(a.iat)),expirationTime:ap(ip(a.exp)),signInProvider:s||null,signInSecondFactor:(null===i||void 0===i?void 0:i.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=tn(e);await hp(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(Dd(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(e=>l({},e)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new mp(l(l({},this),{},{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Dd(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await hp(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(mr(this.auth.app))return Promise.reject(Od(this.auth));const e=await this.getIdToken();return await lp(this,async function(e,t){return qd(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return l(l({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>l({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{},{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,a,i,s,o,c,u;const h=null!==(n=t.displayName)&&void 0!==n?n:void 0,f=null!==(r=t.email)&&void 0!==r?r:void 0,d=null!==(a=t.phoneNumber)&&void 0!==a?a:void 0,p=null!==(i=t.photoURL)&&void 0!==i?i:void 0,m=null!==(s=t.tenantId)&&void 0!==s?s:void 0,g=null!==(o=t._redirectEventId)&&void 0!==o?o:void 0,v=null!==(c=t.createdAt)&&void 0!==c?c:void 0,y=null!==(u=t.lastLoginAt)&&void 0!==u?u:void 0,{uid:b,emailVerified:w,isAnonymous:T,providerData:S,stsTokenManager:E}=t;Dd(b&&E,e,"internal-error");const k=dp.fromJSON(this.name,E);Dd("string"===typeof b,e,"internal-error"),pp(h,e.name),pp(f,e.name),Dd("boolean"===typeof w,e,"internal-error"),Dd("boolean"===typeof T,e,"internal-error"),pp(d,e.name),pp(p,e.name),pp(m,e.name),pp(g,e.name),pp(v,e.name),pp(y,e.name);const _=new mp({uid:b,auth:e,email:f,emailVerified:w,displayName:h,isAnonymous:T,photoURL:p,phoneNumber:d,tenantId:m,stsTokenManager:k,createdAt:v,lastLoginAt:y});return S&&Array.isArray(S)&&(_.providerData=S.map(e=>l({},e))),g&&(_._redirectEventId=g),_}static async _fromIdTokenResponse(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=new dp;r.updateFromServerResponse(t);const a=new mp({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await hp(a),a}static async _fromGetAccountInfoResponse(e,t,n){const r=t.users[0];Dd(void 0!==r.localId,"internal-error");const a=void 0!==r.providerUserInfo?fp(r.providerUserInfo):[],i=!(r.email&&r.passwordHash)&&!(null!==a&&void 0!==a&&a.length),s=new dp;s.updateFromIdToken(n);const o=new mp({uid:r.localId,auth:e,stsTokenManager:s,isAnonymous:i}),l={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:a,metadata:new up(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(null!==a&&void 0!==a&&a.length)};return Object.assign(o,l),o}}const gp=new Map;function vp(e){Md(e instanceof Function,"Expected a class definition");let t=gp.get(e);return t?(Md(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,gp.set(e,t),t)}class yp{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}yp.type="NONE";const bp=yp;function wp(e,t,n){return"firebase".concat(":",e,":").concat(t,":").concat(n)}class Tp{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:a}=this.auth;this.fullUserKey=wp(this.userKey,r.apiKey,a),this.fullPersistenceKey=wp("persistence",r.apiKey,a),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if("string"===typeof e){const t=await rp(this.auth,{idToken:e}).catch(()=>{});return t?mp._fromGetAccountInfoResponse(this.auth,t,e):null}return mp._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"authUser";if(!t.length)return new Tp(vp(bp),e,n);const r=(await Promise.all(t.map(async e=>{if(await e._isAvailable())return e}))).filter(e=>e);let a=r[0]||vp(bp);const i=wp(n,e.config.apiKey,e.name);let s=null;for(const c of t)try{const t=await c._get(i);if(t){let n;if("string"===typeof t){const r=await rp(e,{idToken:t}).catch(()=>{});if(!r)break;n=await mp._fromGetAccountInfoResponse(e,r,t)}else n=mp._fromJSON(e,t);c!==a&&(s=n),a=c;break}}catch(l){}const o=r.filter(e=>e._shouldAllowMigration);return a._shouldAllowMigration&&o.length?(a=o[0],s&&await a._set(i,s.toJSON()),await Promise.all(t.map(async e=>{if(e!==a)try{await e._remove(i)}catch(t){}})),new Tp(a,e,n)):new Tp(a,e,n)}}function Sp(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(xp(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(Ep(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(Ip(t))return"Blackberry";if(Ap(t))return"Webos";if(kp(t))return"Safari";if((t.includes("chrome/")||_p(t))&&!t.includes("edge/"))return"Chrome";if(Cp(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null===n||void 0===n?void 0:n.length))return n[1]}return"Other"}function Ep(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ut();return/firefox\//i.test(e)}function kp(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ut()).toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function _p(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ut();return/crios\//i.test(e)}function xp(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ut();return/iemobile/i.test(e)}function Cp(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ut();return/android/i.test(e)}function Ip(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ut();return/blackberry/i.test(e)}function Ap(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ut();return/webos/i.test(e)}function Np(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ut();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function Rp(){return function(){const e=Ut();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()&&10===document.documentMode}function Op(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ut();return Np(e)||Cp(e)||Ap(e)||Ip(e)||/windows phone/i.test(e)||xp(e)}function Pp(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=Sp(Ut());break;case"Worker":t="".concat(Sp(Ut()),"-").concat(e);break;default:t=e}const r=n.length?n.join(","):"FirebaseCore-web";return"".concat(t,"/","JsCore","/").concat(yr,"/").concat(r)}class Dp{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise((n,r)=>{try{n(e(t))}catch(AR){r(AR)}});n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(AR){t.reverse();for(const r of t)try{r()}catch(n){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null===AR||void 0===AR?void 0:AR.message})}}}class Lp{constructor(e){var t,n,r,a;const i=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(t=i.minPasswordLength)&&void 0!==t?t:6,i.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=i.maxPasswordLength),void 0!==i.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=i.containsLowercaseCharacter),void 0!==i.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=i.containsUppercaseCharacter),void 0!==i.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=i.containsNumericCharacter),void 0!==i.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=i.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(n=null===(r=e.allowedNonAlphanumericCharacters)||void 0===r?void 0:r.join(""))&&void 0!==n?n:"",this.forceUpgradeOnSignin=null!==(a=e.forceUpgradeOnSignin)&&void 0!==a&&a,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,r,a,i,s;const o={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,o),this.validatePasswordCharacterOptions(e,o),o.isValid&&(o.isValid=null===(t=o.meetsMinPasswordLength)||void 0===t||t),o.isValid&&(o.isValid=null===(n=o.meetsMaxPasswordLength)||void 0===n||n),o.isValid&&(o.isValid=null===(r=o.containsLowercaseLetter)||void 0===r||r),o.isValid&&(o.isValid=null===(a=o.containsUppercaseLetter)||void 0===a||a),o.isValid&&(o.isValid=null===(i=o.containsNumericCharacter)||void 0===i||i),o.isValid&&(o.isValid=null===(s=o.containsNonAlphanumericCharacter)||void 0===s||s),o}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let r=0;r<e.length;r++)n=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,r,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}class Mp{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Up(this),this.idTokenSubscription=new Up(this),this.beforeStateQueue=new Dp(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=xd,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(e=>this._resolvePersistenceManagerAvailable=e)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=vp(t)),this._initializationPromise=this.queue(async()=>{var n,r,a;if(!this._deleted&&(this.persistenceManager=await Tp.create(this,e),null===(n=this._resolvePersistenceManagerAvailable)||void 0===n||n.call(this),!this._deleted)){if(null!==(r=this._popupRedirectResolver)&&void 0!==r&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(AR){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(a=this.currentUser)||void 0===a?void 0:a.uid)||null,this._deleted||(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUserFromIdToken(e){try{const t=await rp(this,{idToken:e}),n=await mp._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(mr(this.app)){const e=this.app.settings.authIdToken;return e?new Promise(t=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(e).then(t,t))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let n=t,r=!1;if(e&&this.config.authDomain){var a,i;await this.getOrInitRedirectPersistenceManager();const t=null===(a=this.redirectUser)||void 0===a?void 0:a._redirectEventId,s=null===(i=n)||void 0===i?void 0:i._redirectEventId,o=await this.tryRedirectSignIn(e);t&&t!==s||null===o||void 0===o||!o.user||(n=o.user,r=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(n)}catch(AR){n=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(AR))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return Dd(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(AR){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await hp(e)}catch(AR){if((null===AR||void 0===AR?void 0:AR.code)!=="auth/".concat("network-request-failed"))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"===typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(mr(this.app))return Promise.reject(Od(this));const t=e?tn(e):null;return t&&Dd(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this._deleted)return e&&Dd(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return mr(this.app)?Promise.reject(Od(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return mr(this.app)?Promise.reject(Od(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(vp(e))})}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await async function(e){return qd(e,"GET","/v2/passwordPolicy",Kd(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}(this),t=new Lp(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Gt("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await async function(e,t){return qd(e,"POST","/v2/accounts:revokeToken",Kd(e,t))}(this,t)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&vp(e)||this._popupRedirectResolver;Dd(t,this,"argument-error"),this.redirectPersistenceManager=await Tp.create(this,[vp(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue(async()=>{}),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return"".concat(this.config.authDomain,":").concat(this.config.apiKey,":").concat(this.name)}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(e=null===(t=this.currentUser)||void 0===t?void 0:t.uid)&&void 0!==e?e:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const a="function"===typeof t?t:t.next.bind(t);let i=!1;const s=this._isInitialized?Promise.resolve():this._initializationPromise;if(Dd(s,this,"internal-error"),s.then(()=>{i||a(this.currentUser)}),"function"===typeof t){const a=e.addObserver(t,n,r);return()=>{i=!0,a()}}{const n=e.addObserver(t);return()=>{i=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Dd(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Pp(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){var e;if(mr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return null!==t&&void 0!==t&&t.error&&function(e){if(Cd.logLevel<=ln.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];Cd.warn("Auth (".concat(yr,"): ").concat(e),...n)}}("Error while retrieving App Check token: ".concat(t.error)),null===t||void 0===t?void 0:t.token}}function Fp(e){return tn(e)}class Up{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){const n=new Jt(e,t);return n.subscribe.bind(n)}(e=>this.observer=e)}get next(){return Dd(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let jp={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Vp(e){return jp.loadJS(e)}function zp(e){return"__".concat(e).concat(Math.floor(1e6*Math.random()))}class Bp{constructor(){this.enterprise=new Hp}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class Hp{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const Wp="NO_RECAPTCHA";class Gp{constructor(e){this.type="recaptcha-enterprise",this.auth=Fp(e)}async verify(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"verify",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];function n(t,n,r){const a=window.grecaptcha;ep(a)?a.enterprise.ready(()=>{a.enterprise.execute(t,{action:e}).then(e=>{n(e)}).catch(()=>{n(Wp)})}):r(Error("No reCAPTCHA enterprise script loaded."))}if(this.auth.settings.appVerificationDisabledForTesting){return(new Bp).execute("siteKey",{action:"verify"})}return new Promise((e,r)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise(async(t,n)=>{np(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(r=>{if(void 0!==r.recaptchaKey){const n=new tp(r);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))}).catch(e=>{n(e)})})})(this.auth).then(a=>{if(!t&&ep(window.grecaptcha))n(a,e,r);else{if("undefined"===typeof window)return void r(new Error("RecaptchaVerifier is only supported in browser"));let t=jp.recaptchaEnterpriseScript;0!==t.length&&(t+=a),Vp(t).then(()=>{n(a,e,r)}).catch(e=>{r(e)})}}).catch(e=>{r(e)})})}}async function Kp(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const i=new Gp(e);let s;if(a)s=Wp;else try{s=await i.verify(n)}catch(c){s=await i.verify(n,!0)}const o=l({},t);if("mfaSmsEnrollment"===n||"mfaSmsSignIn"===n){if("phoneEnrollmentInfo"in o){const e=o.phoneEnrollmentInfo.phoneNumber,t=o.phoneEnrollmentInfo.recaptchaToken;Object.assign(o,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:t,captchaResponse:s,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in o){const e=o.phoneSignInInfo.recaptchaToken;Object.assign(o,{phoneSignInInfo:{recaptchaToken:e,captchaResponse:s,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return o}return r?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function qp(e,t,n,r,a){if("EMAIL_PASSWORD_PROVIDER"===a){var i;if(null!==(i=e._getRecaptchaConfig())&&void 0!==i&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await Kp(e,t,n,"getOobCode"===n);return r(e,a)}return r(e,t).catch(async a=>{if(a.code==="auth/".concat("missing-recaptcha-token")){console.log("".concat(n," is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow."));const a=await Kp(e,t,n,"getOobCode"===n);return r(e,a)}return Promise.reject(a)})}if("PHONE_PROVIDER"===a){var s;if(null!==(s=e._getRecaptchaConfig())&&void 0!==s&&s.isProviderEnabled("PHONE_PROVIDER")){const a=await Kp(e,t,n);return r(e,a).catch(async a=>{var i;if("AUDIT"===(null===(i=e._getRecaptchaConfig())||void 0===i?void 0:i.getProviderEnforcementState("PHONE_PROVIDER"))&&(a.code==="auth/".concat("missing-recaptcha-token")||a.code==="auth/".concat("invalid-app-credential"))){console.log("Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ".concat(n," flow."));const a=await Kp(e,t,n,!1,!0);return r(e,a)}return Promise.reject(a)})}{const a=await Kp(e,t,n,!1,!0);return r(e,a)}}return Promise.reject(a+" provider is not supported.")}async function $p(e){const t=Fp(e),n=await np(t,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),r=new tp(n);if(null==t.tenantId?t._agentRecaptchaConfig=r:t._tenantRecaptchaConfigs[t.tenantId]=r,r.isAnyProviderEnabled()){new Gp(t).verify()}}function Xp(e,t,n){const r=Fp(e);Dd(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const a=!(null===n||void 0===n||!n.disableWarnings),i=Yp(t),{host:s,port:o}=function(e){const t=Yp(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(r);if(a){const e=a[1];return{host:e,port:Qp(r.substr(e.length+1))}}{const[e,t]=r.split(":");return{host:e,port:Qp(t)}}}(t),l=null===o?"":":".concat(o),c={url:"".concat(i,"//").concat(s).concat(l,"/")},u=Object.freeze({host:s,port:o,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!r._canInitEmulator)return Dd(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),void Dd(qt(c,r.config.emulator)&&qt(u,r.emulatorConfig),r,"emulator-config-failed");r.config.emulator=c,r.emulatorConfig=u,r.settings.appVerificationDisabledForTesting=!0,Pt(s)?(Dt("".concat(i,"//").concat(s).concat(l)),Ft("Auth",!0)):a||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!==typeof window&&"undefined"!==typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function Yp(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function Qp(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class Jp{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Ld("not implemented")}_getIdTokenResponse(e){return Ld("not implemented")}_linkToIdToken(e,t){return Ld("not implemented")}_getReauthenticationResolver(e){return Ld("not implemented")}}async function Zp(e,t){return qd(e,"POST","/v1/accounts:signUp",t)}async function em(e,t){return Xd(e,"POST","/v1/accounts:signInWithPassword",Kd(e,t))}class tm extends Jp{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new tm(e,t,"password")}static _fromEmailAndCode(e,t){return new tm(e,t,"emailLink",arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e;if(null!==t&&void 0!==t&&t.email&&null!==t&&void 0!==t&&t.password){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return qp(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",em,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(e,t){return Xd(e,"POST","/v1/accounts:signInWithEmailLink",Kd(e,t))}(e,{email:this._email,oobCode:this._password});default:Ad(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return qp(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Zp,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(e,t){return Xd(e,"POST","/v1/accounts:signInWithEmailLink",Kd(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:Ad(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function nm(e,t){return Xd(e,"POST","/v1/accounts:signInWithIdp",Kd(e,t))}class rm extends Jp{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new rm(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Ad("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e,{providerId:n,signInMethod:a}=t,i=r(t,Ed);if(!n||!a)return null;const s=new rm(n,a);return s.idToken=i.idToken||void 0,s.accessToken=i.accessToken||void 0,s.secret=i.secret,s.nonce=i.nonce,s.pendingToken=i.pendingToken||null,s}_getIdTokenResponse(e){return nm(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,nm(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,nm(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Xt(t)}return e}}async function am(e,t){return qd(e,"POST","/v1/accounts:sendVerificationCode",Kd(e,t))}const im={USER_NOT_FOUND:"user-not-found"};class sm extends Jp{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new sm({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new sm({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return Xd(e,"POST","/v1/accounts:signInWithPhoneNumber",Kd(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await Xd(e,"POST","/v1/accounts:signInWithPhoneNumber",Kd(e,t));if(n.temporaryProof)throw Zd(e,"account-exists-with-different-credential",n);return n}(e,l({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return Xd(e,"POST","/v1/accounts:signInWithPhoneNumber",Kd(e,l(l({},t),{},{operation:"REAUTH"})),im)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"===typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:a}=e;return n||t||r||a?new sm({verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:a}):null}}class om{constructor(e){var t,n,r,a,i,s;const o=Yt(Qt(e)),l=null!==(t=o.apiKey)&&void 0!==t?t:null,c=null!==(n=o.oobCode)&&void 0!==n?n:null,u=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(r=o.mode)&&void 0!==r?r:null);Dd(l&&c&&u,"argument-error"),this.apiKey=l,this.operation=u,this.code=c,this.continueUrl=null!==(a=o.continueUrl)&&void 0!==a?a:null,this.languageCode=null!==(i=o.lang)&&void 0!==i?i:null,this.tenantId=null!==(s=o.tenantId)&&void 0!==s?s:null}static parseLink(e){const t=function(e){const t=Yt(Qt(e)).link,n=t?Yt(Qt(t)).deep_link_id:null,r=Yt(Qt(e)).deep_link_id;return(r?Yt(Qt(r)).link:null)||r||n||t||e}(e);try{return new om(t)}catch(n){return null}}}class lm{constructor(){this.providerId=lm.PROVIDER_ID}static credential(e,t){return tm._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=om.parseLink(t);return Dd(n,"argument-error"),tm._fromEmailAndCode(e,n.code,n.tenantId)}}lm.PROVIDER_ID="password",lm.EMAIL_PASSWORD_SIGN_IN_METHOD="password",lm.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class cm{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class um extends cm{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class hm extends um{constructor(){super("facebook.com")}static credential(e){return rm._fromParams({providerId:hm.PROVIDER_ID,signInMethod:hm.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return hm.credentialFromTaggedObject(e)}static credentialFromError(e){return hm.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return hm.credential(t.oauthAccessToken)}catch(n){return null}}}hm.FACEBOOK_SIGN_IN_METHOD="facebook.com",hm.PROVIDER_ID="facebook.com";class fm extends um{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return rm._fromParams({providerId:fm.PROVIDER_ID,signInMethod:fm.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return fm.credentialFromTaggedObject(e)}static credentialFromError(e){return fm.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthIdToken:n,oauthAccessToken:r}=t;if(!n&&!r)return null;try{return fm.credential(n,r)}catch(a){return null}}}fm.GOOGLE_SIGN_IN_METHOD="google.com",fm.PROVIDER_ID="google.com";class dm extends um{constructor(){super("github.com")}static credential(e){return rm._fromParams({providerId:dm.PROVIDER_ID,signInMethod:dm.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return dm.credentialFromTaggedObject(e)}static credentialFromError(e){return dm.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return dm.credential(t.oauthAccessToken)}catch(n){return null}}}dm.GITHUB_SIGN_IN_METHOD="github.com",dm.PROVIDER_ID="github.com";class pm extends um{constructor(){super("twitter.com")}static credential(e,t){return rm._fromParams({providerId:pm.PROVIDER_ID,signInMethod:pm.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return pm.credentialFromTaggedObject(e)}static credentialFromError(e){return pm.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=t;if(!n||!r)return null;try{return pm.credential(n,r)}catch(a){return null}}}async function mm(e,t){return Xd(e,"POST","/v1/accounts:signUp",Kd(e,t))}pm.TWITTER_SIGN_IN_METHOD="twitter.com",pm.PROVIDER_ID="twitter.com";class gm{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a=await mp._fromIdTokenResponse(e,n,r),i=vm(n);return new gm({user:a,providerId:i,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=vm(n);return new gm({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function vm(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class ym extends Wt{constructor(e,t,n,r){var a;super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,ym.prototype),this.customData={appName:e.name,tenantId:null!==(a=e.tenantId)&&void 0!==a?a:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new ym(e,t,n,r)}}function bm(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch(n=>{if(n.code==="auth/".concat("multi-factor-auth-required"))throw ym._fromErrorAndOperation(e,n,t,r);throw n})}async function wm(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=await lp(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return gm._forOperation(e,"link",r)}async function Tm(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{auth:r}=e;if(mr(r.app))return Promise.reject(Od(r));const a="reauthenticate";try{const i=await lp(e,bm(r,a,t,e),n);Dd(i.idToken,r,"internal-error");const s=sp(i.idToken);Dd(s,r,"internal-error");const{sub:o}=s;return Dd(e.uid===o,r,"user-mismatch"),gm._forOperation(e,a,i)}catch(AR){throw(null===AR||void 0===AR?void 0:AR.code)==="auth/".concat("user-not-found")&&Ad(r,"user-mismatch"),AR}}async function Sm(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(mr(e.app))return Promise.reject(Od(e));const r="signIn",a=await bm(e,r,t),i=await gm._fromIdTokenResponse(e,r,a);return n||await e._updateCurrentUser(i.user),i}async function Em(e,t){return Sm(Fp(e),t)}async function km(e){const t=Fp(e);t._getPasswordPolicyInternal()&&await t._updatePasswordPolicy()}function _m(e,t,n,r){return tn(e).onAuthStateChanged(t,n,r)}function xm(e){return tn(e).signOut()}function Cm(e,t){return qd(e,"POST","/v2/accounts/mfaEnrollment:start",Kd(e,t))}new WeakMap;const Im="__sak";class Am{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Im,"1"),this.storage.removeItem(Im),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class Nm extends Am{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Op(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e.key)return void this.forAllChangedKeys((e,t,n)=>{this.notifyListeners(e,n)});const n=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},a=this.storage.getItem(n);Rp()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,10):r()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Nm.type="LOCAL";const Rm=Nm;function Om(e){var t,n;const r=e.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),a=RegExp("".concat(r,"=([^;]+)"));return null!==(t=null===(n=document.cookie.match(a))||void 0===n?void 0:n[1])&&void 0!==t?t:null}function Pm(e){const t="http:"===window.location.protocol;return"".concat(t?"__dev_":"__HOST-","FIREBASE_").concat(e.split(":")[3])}class Dm{constructor(){this.type="COOKIE",this.listenerUnsubscribes=new Map}_getFinalTarget(e){if(void 0===typeof window)return e;const t=new URL("".concat(window.location.origin,"/__cookies__"));return t.searchParams.set("finalTarget",e),t}async _isAvailable(){var e;return!("boolean"===typeof isSecureContext&&!isSecureContext)&&("undefined"!==typeof navigator&&"undefined"!==typeof document&&(null===(e=navigator.cookieEnabled)||void 0===e||e))}async _set(e,t){}async _get(e){if(!this._isAvailable())return null;const t=Pm(e);if(window.cookieStore){const e=await window.cookieStore.get(t);return null===e||void 0===e?void 0:e.value}return Om(t)}async _remove(e){if(!this._isAvailable())return;if(!await this._get(e))return;const t=Pm(e);document.cookie="".concat(t,"=;Max-Age=34560000;Partitioned;Secure;SameSite=Strict;Path=/;Priority=High"),await fetch("/__cookies__",{method:"DELETE"}).catch(()=>{})}_addListener(e,t){if(!this._isAvailable())return;const n=Pm(e);if(window.cookieStore){const e=e=>{const r=e.changed.find(e=>e.name===n);r&&t(r.value);e.deleted.find(e=>e.name===n)&&t(null)},r=()=>window.cookieStore.removeEventListener("change",e);return this.listenerUnsubscribes.set(t,r),window.cookieStore.addEventListener("change",e)}let r=Om(n);const a=setInterval(()=>{const e=Om(n);e!==r&&(t(e),r=e)},1e3);this.listenerUnsubscribes.set(t,()=>clearInterval(a))}_removeListener(e,t){const n=this.listenerUnsubscribes.get(t);n&&(n(),this.listenerUnsubscribes.delete(t))}}Dm.type="COOKIE";class Lm extends Am{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Lm.type="SESSION";const Mm=Lm;class Fm{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(t=>t.isListeningto(e));if(t)return t;const n=new Fm(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:a}=t.data,i=this.handlersMap[r];if(null===i||void 0===i||!i.size)return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const s=Array.from(i).map(async e=>e(t.origin,a)),o=await function(e){return Promise.all(e.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}(s);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:o})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function Um(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="";for(let r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}Fm.receivers=[];class jm{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50;const r="undefined"!==typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let a,i;return new Promise((s,o)=>{const l=Um("",20);r.port1.start();const c=setTimeout(()=>{o(new Error("unsupported_event"))},n);i={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===l)switch(t.data.status){case"ack":clearTimeout(c),a=setTimeout(()=>{o(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),s(t.data.response);break;default:clearTimeout(c),clearTimeout(a),o(new Error("invalid_response"))}}},this.handlers.add(i),r.port1.addEventListener("message",i.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[r.port2])}).finally(()=>{i&&this.removeMessageHandler(i)})}}function Vm(){return window}function zm(){return"undefined"!==typeof Vm().WorkerGlobalScope&&"function"===typeof Vm().importScripts}const Bm="firebaseLocalStorageDb",Hm="firebaseLocalStorage",Wm="fbase_key";class Gm{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Km(e,t){return e.transaction([Hm],t?"readwrite":"readonly").objectStore(Hm)}function qm(){const e=indexedDB.open(Bm,1);return new Promise((t,n)=>{e.addEventListener("error",()=>{n(e.error)}),e.addEventListener("upgradeneeded",()=>{const t=e.result;try{t.createObjectStore(Hm,{keyPath:Wm})}catch(AR){n(AR)}}),e.addEventListener("success",async()=>{const n=e.result;n.objectStoreNames.contains(Hm)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(Bm);return new Gm(e).toPromise()}(),t(await qm()))})})}async function $m(e,t,n){const r=Km(e,!0).put({[Wm]:t,value:n});return new Gm(r).toPromise()}function Xm(e,t){const n=Km(e,!0).delete(t);return new Gm(n).toPromise()}class Ym{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db||(this.db=await qm()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(AR){if(t++>3)throw AR;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return zm()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Fm._getInstance(zm()?self:null),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){var e;if(null===(e=navigator)||void 0===e||!e.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch(t){return null}}(),!this.activeServiceWorker)return;this.sender=new jm(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&null!==(e=n[0])&&void 0!==e&&e.fulfilled&&null!==(t=n[0])&&void 0!==t&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&function(){var e;return(null===(e=navigator)||void 0===e||null===(e=e.serviceWorker)||void 0===e?void 0:e.controller)||null}()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await qm();return await $m(e,Im,"1"),await Xm(e,Im),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>$m(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(t=>async function(e,t){const n=Km(e,!1).get(t),r=await new Gm(n).toPromise();return void 0===r?null:r.value}(t,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Xm(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(e=>{const t=Km(e,!1).getAll();return new Gm(t).toPromise()});if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;if(0!==e.length)for(const{fbase_key:r,value:a}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(a)&&(this.notifyListeners(r,a),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!n.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}Ym.type="LOCAL";const Qm=Ym;function Jm(e,t){return qd(e,"POST","/v2/accounts/mfaSignIn:start",Kd(e,t))}zp("rcb"),new Vd(3e4,6e4);const Zm="recaptcha";async function eg(e,t,n){if(!e._getRecaptchaConfig())try{await $p(e)}catch(a){console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let a;if(a="string"===typeof t?{phoneNumber:t}:t,"session"in a){const t=a.session;if("phoneNumber"in a){Dd("enroll"===t.type,e,"internal-error");const r={idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:a.phoneNumber,clientType:"CLIENT_TYPE_WEB"}},i=qp(e,r,"mfaSmsEnrollment",async(e,t)=>{if(t.phoneEnrollmentInfo.captchaResponse===Wp){Dd((null===n||void 0===n?void 0:n.type)===Zm,e,"argument-error");return Cm(e,await tg(e,t,n))}return Cm(e,t)},"PHONE_PROVIDER");return(await i.catch(e=>Promise.reject(e))).phoneSessionInfo.sessionInfo}{var r;Dd("signin"===t.type,e,"internal-error");const i=(null===(r=a.multiFactorHint)||void 0===r?void 0:r.uid)||a.multiFactorUid;Dd(i,e,"missing-multi-factor-info");const s={mfaPendingCredential:t.credential,mfaEnrollmentId:i,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}},o=qp(e,s,"mfaSmsSignIn",async(e,t)=>{if(t.phoneSignInInfo.captchaResponse===Wp){Dd((null===n||void 0===n?void 0:n.type)===Zm,e,"argument-error");return Jm(e,await tg(e,t,n))}return Jm(e,t)},"PHONE_PROVIDER");return(await o.catch(e=>Promise.reject(e))).phoneResponseInfo.sessionInfo}}{const t={phoneNumber:a.phoneNumber,clientType:"CLIENT_TYPE_WEB"},r=qp(e,t,"sendVerificationCode",async(e,t)=>{if(t.captchaResponse===Wp){Dd((null===n||void 0===n?void 0:n.type)===Zm,e,"argument-error");return am(e,await tg(e,t,n))}return am(e,t)},"PHONE_PROVIDER");return(await r.catch(e=>Promise.reject(e))).sessionInfo}}finally{null===n||void 0===n||n._reset()}}async function tg(e,t,n){Dd(n.type===Zm,e,"argument-error");const r=await n.verify();Dd("string"===typeof r,e,"argument-error");const a=l({},t);if("phoneEnrollmentInfo"in a){const e=a.phoneEnrollmentInfo.phoneNumber,t=a.phoneEnrollmentInfo.captchaResponse,n=a.phoneEnrollmentInfo.clientType,i=a.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:r,captchaResponse:t,clientType:n,recaptchaVersion:i}}),a}if("phoneSignInInfo"in a){const e=a.phoneSignInInfo.captchaResponse,t=a.phoneSignInInfo.clientType,n=a.phoneSignInInfo.recaptchaVersion;return Object.assign(a,{phoneSignInInfo:{recaptchaToken:r,captchaResponse:e,clientType:t,recaptchaVersion:n}}),a}return Object.assign(a,{recaptchaToken:r}),a}class ng{constructor(e){this.providerId=ng.PROVIDER_ID,this.auth=Fp(e)}verifyPhoneNumber(e,t){return eg(this.auth,e,tn(t))}static credential(e,t){return sm._fromVerification(e,t)}static credentialFromResult(e){const t=e;return ng.credentialFromTaggedObject(t)}static credentialFromError(e){return ng.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{phoneNumber:n,temporaryProof:r}=t;return n&&r?sm._fromTokenResponse(n,r):null}}function rg(e,t){return t?vp(t):(Dd(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}ng.PROVIDER_ID="phone",ng.PHONE_SIGN_IN_METHOD="phone";class ag extends Jp{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return nm(e,this._buildIdpRequest())}_linkToIdToken(e,t){return nm(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return nm(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function ig(e){return Sm(e.auth,new ag(e),e.bypassAuthState)}function sg(e){const{auth:t,user:n}=e;return Dd(n,t,"internal-error"),Tm(n,new ag(e),e.bypassAuthState)}async function og(e){const{auth:t,user:n}=e;return Dd(n,t,"internal-error"),wm(n,new ag(e),e.bypassAuthState)}class lg{constructor(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(AR){this.reject(AR)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:a,error:i,type:s}=e;if(i)return void this.reject(i);const o={auth:this.auth,requestUri:t,sessionId:n,tenantId:a||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(s)(o))}catch(AR){this.reject(AR)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return ig;case"linkViaPopup":case"linkViaRedirect":return og;case"reauthViaPopup":case"reauthViaRedirect":return sg;default:Ad(this.auth,"internal-error")}}resolve(e){Md(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Md(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const cg=new Vd(2e3,1e4);class ug extends lg{constructor(e,t,n,r,a){super(e,t,r,a),this.provider=n,this.authWindow=null,this.pollId=null,ug.currentPopupAction&&ug.currentPopupAction.cancel(),ug.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Dd(e,this.auth,"internal-error"),e}async onExecution(){Md(1===this.filter.length,"Popup operations only handle one event");const e=Um();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(Nd(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(Nd(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ug.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t;null!==(t=this.authWindow)&&void 0!==t&&null!==(t=t.window)&&void 0!==t&&t.closed?this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Nd(this.auth,"popup-closed-by-user"))},8e3):this.pollId=window.setTimeout(e,cg.get())};e()}}ug.currentPopupAction=null;const hg=new Map;class fg extends lg{constructor(e,t){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,arguments.length>2&&void 0!==arguments[2]&&arguments[2]),this.eventId=null}async execute(){let e=hg.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=mg(t),r=pg(e);if(!await r._isAvailable())return!1;const a="true"===await r._get(n);return await r._remove(n),a}(this.resolver,this.auth),n=t?await super.execute():null;e=()=>Promise.resolve(n)}catch(AR){e=()=>Promise.reject(AR)}hg.set(this.auth._key(),e)}return this.bypassAuthState||hg.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function dg(e,t){hg.set(e._key(),t)}function pg(e){return vp(e._redirectPersistence)}function mg(e){return wp("pendingRedirect",e.config.apiKey,e.name)}async function gg(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(mr(e.app))return Promise.reject(Od(e));const r=Fp(e),a=rg(r,t),i=new fg(r,a,n),s=await i.execute();return s&&!n&&(delete s.user._redirectEventId,await r._persistUserIfCurrent(s.user),await r._setRedirectUser(null,t)),s}class vg{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return bg(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!bg(e)){var n;const r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(Nd(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(yg(e))}saveEventToCache(e){this.cachedEventUids.add(yg(e)),this.lastProcessedEventTime=Date.now()}}function yg(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(e=>e).join("-")}function bg(e){let{type:t,error:n}=e;return"unknown"===t&&(null===n||void 0===n?void 0:n.code)==="auth/".concat("no-auth-event")}const wg=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Tg=/^https?/;async function Sg(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e){return qd(e,"GET","/v1/projects",arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}(e);for(const r of t)try{if(Eg(r))return}catch(n){}Ad(e,"unauthorized-domain")}function Eg(e){const t=Fd(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const a=new URL(e);return""===a.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&a.hostname===r}if(!Tg.test(n))return!1;if(wg.test(e))return r===e;const a=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(r)}const kg=new Vd(3e4,6e4);function _g(){const e=Vm().___jsl;if(null!==e&&void 0!==e&&e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}function xg(e){return new Promise((t,n)=>{var r,a;function i(){_g(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{_g(),n(Nd(e,"network-request-failed"))},timeout:kg.get()})}if(null!==(r=Vm().gapi)&&void 0!==r&&null!==(r=r.iframes)&&void 0!==r&&r.Iframe)t(gapi.iframes.getContext());else{if(null===(a=Vm().gapi)||void 0===a||!a.load){const t=zp("iframefcb");return Vm()[t]=()=>{gapi.load?i():n(Nd(e,"network-request-failed"))},Vp("".concat(jp.gapiScript,"?onload=").concat(t)).catch(e=>n(e))}i()}}).catch(e=>{throw Cg=null,e})}let Cg=null;const Ig=new Vd(5e3,15e3),Ag={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Ng=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Rg(e){const t=e.config;Dd(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?zd(t,"emulator/auth/iframe"):"https://".concat(e.config.authDomain,"/").concat("__/auth/iframe"),r={apiKey:t.apiKey,appName:e.name,v:yr},a=Ng.get(e.config.apiHost);a&&(r.eid=a);const i=e._getFrameworks();return i.length&&(r.fw=i.join(",")),"".concat(n,"?").concat(Xt(r).slice(1))}async function Og(e){const t=await function(e){return Cg=Cg||xg(e),Cg}(e),n=Vm().gapi;return Dd(n,e,"internal-error"),t.open({where:document.body,url:Rg(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Ag,dontclear:!0},t=>new Promise(async(n,r)=>{await t.restyle({setHideOnLeave:!1});const a=Nd(e,"network-request-failed"),i=Vm().setTimeout(()=>{r(a)},Ig.get());function s(){Vm().clearTimeout(i),n(t)}t.ping(s).then(s,()=>{r(a)})}))}const Pg={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Dg{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(AR){}}}function Lg(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600;const i=Math.max((window.screen.availHeight-a)/2,0).toString(),s=Math.max((window.screen.availWidth-r)/2,0).toString();let o="";const c=l(l({},Pg),{},{width:r.toString(),height:a.toString(),top:i,left:s}),u=Ut().toLowerCase();n&&(o=_p(u)?"_blank":n),Ep(u)&&(t=t||"http://localhost",c.scrollbars="yes");const h=Object.entries(c).reduce((e,t)=>{let[n,r]=t;return"".concat(e).concat(n,"=").concat(r,",")},"");if(function(){var e;return Np(arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ut())&&!(null===(e=window.navigator)||void 0===e||!e.standalone)}(u)&&"_self"!==o)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",o),new Dg(null);const f=window.open(t||"",o,h);Dd(f,e,"popup-blocked");try{f.focus()}catch(AR){}return new Dg(f)}const Mg="__/auth/handler",Fg="emulator/auth/handler",Ug=encodeURIComponent("fac");async function jg(e,t,n,r,a,i){Dd(e.config.authDomain,e,"auth-domain-config-required"),Dd(e.config.apiKey,e,"invalid-api-key");const s={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:yr,eventId:a};if(t instanceof cm){t.setDefaultLanguage(e.languageCode),s.providerId=t.providerId||"",function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())||(s.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(i||{}))s[e]=t}if(t instanceof um){const e=t.getScopes().filter(e=>""!==e);e.length>0&&(s.scopes=e.join(","))}e.tenantId&&(s.tid=e.tenantId);const o=s;for(const u of Object.keys(o))void 0===o[u]&&delete o[u];const l=await e._getAppCheckToken(),c=l?"#".concat(Ug,"=").concat(encodeURIComponent(l)):"";return"".concat(function(e){let{config:t}=e;if(!t.emulator)return"https://".concat(t.authDomain,"/").concat(Mg);return zd(t,Fg)}(e),"?").concat(Xt(o).slice(1)).concat(c)}const Vg="webStorageSupport";const zg=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Mm,this._completeRedirectFn=gg,this._overrideRedirectResult=dg}async _openPopup(e,t,n,r){var a;Md(null===(a=this.eventManagers[e._key()])||void 0===a?void 0:a.manager,"_initialize() not called before _openPopup()");return Lg(e,await jg(e,t,n,Fd(),r),Um())}async _openRedirect(e,t,n,r){await this._originValidation(e);return function(e){Vm().location.href=e}(await jg(e,t,n,Fd(),r)),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(Md(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){const t=await Og(e),n=new vg(e);return t.register("authEvent",t=>{Dd(null===t||void 0===t?void 0:t.authEvent,e,"invalid-auth-event");return{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Vg,{type:Vg},n=>{var r;const a=null===n||void 0===n||null===(r=n[0])||void 0===r?void 0:r[Vg];void 0!==a&&t(!!a),Ad(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Sg(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Op()||kp()||Np()}};var Bg="@firebase/auth",Hg="1.12.0";class Wg{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(t=>{e((null===t||void 0===t?void 0:t.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Dd(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const Gg=Rt("authIdTokenMaxAge")||300;let Kg=null;var qg;jp={loadJS:e=>new Promise((t,n)=>{const r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=e=>{const t=Nd("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",function(){var e,t;return null!==(e=null===(t=document.getElementsByTagName("head"))||void 0===t?void 0:t[0])&&void 0!==e?e:document}().appendChild(r)}),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},qg="Browser",dr(new nn("auth",(e,t)=>{let{options:n}=t;const r=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:s,authDomain:o}=r.options;Dd(s&&!s.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:s,authDomain:o,clientPlatform:qg,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Pp(qg)},c=new Mp(r,a,i,l);return function(e,t){const n=(null===t||void 0===t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(vp);null!==t&&void 0!==t&&t.errorMap&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null===t||void 0===t?void 0:t.popupRedirectResolver)}(c,n),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),dr(new nn("auth-internal",e=>(e=>new Wg(e))(Fp(e.getProvider("auth").getImmediate())),"PRIVATE").setInstantiationMode("EXPLICIT")),Tr(Bg,Hg,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(qg)),Tr(Bg,Hg,"esm2020");const $g="@firebase/installations",Xg="0.6.19",Yg=1e4,Qg="w:".concat(Xg),Jg="FIS_v2",Zg=36e5,ev=new Gt("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function tv(e){return e instanceof Wt&&e.code.includes("request-failed")}function nv(e){let{projectId:t}=e;return"".concat("https://firebaseinstallations.googleapis.com/v1","/projects/").concat(t,"/installations")}function rv(e){return{token:e.token,requestStatus:2,expiresIn:(t=e.expiresIn,Number(t.replace("s","000"))),creationTime:Date.now()};var t}async function av(e,t){const n=(await t.json()).error;return ev.create("request-failed",{requestName:e,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function iv(e){let{apiKey:t}=e;return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function sv(e,t){let{refreshToken:n}=t;const r=iv(e);return r.append("Authorization",function(e){return"".concat(Jg," ").concat(e)}(n)),r}async function ov(e){const t=await e();return t.status>=500&&t.status<600?e():t}function lv(e){return new Promise(t=>{setTimeout(t,e)})}const cv=/^[cdef][\w-]{21}$/;function uv(){try{const e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;const t=function(e){const t=(n=e,btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_"));var n;return t.substr(0,22)}(e);return cv.test(t)?t:""}catch(e){return""}}function hv(e){return"".concat(e.appName,"!").concat(e.appId)}const fv=new Map;function dv(e,t){const n=hv(e);pv(n,t),function(e,t){const n=gv();n&&n.postMessage({key:e,fid:t});vv()}(n,t)}function pv(e,t){const n=fv.get(e);if(n)for(const r of n)r(t)}let mv=null;function gv(){return!mv&&"BroadcastChannel"in self&&(mv=new BroadcastChannel("[Firebase] FID Change"),mv.onmessage=e=>{pv(e.data.key,e.data.fid)}),mv}function vv(){0===fv.size&&mv&&(mv.close(),mv=null)}const yv="firebase-installations-store";let bv=null;function wv(){return bv||(bv=xn("firebase-installations-database",1,{upgrade:(e,t)=>{if(0===t)e.createObjectStore(yv)}})),bv}async function Tv(e,t){const n=hv(e),r=(await wv()).transaction(yv,"readwrite"),a=r.objectStore(yv),i=await a.get(n);return await a.put(t,n),await r.done,i&&i.fid===t.fid||dv(e,t.fid),t}async function Sv(e){const t=hv(e),n=(await wv()).transaction(yv,"readwrite");await n.objectStore(yv).delete(t),await n.done}async function Ev(e,t){const n=hv(e),r=(await wv()).transaction(yv,"readwrite"),a=r.objectStore(yv),i=await a.get(n),s=t(i);return void 0===s?await a.delete(n):await a.put(s,n),await r.done,!s||i&&i.fid===s.fid||dv(e,s.fid),s}async function kv(e){let t;const n=await Ev(e.appConfig,n=>{const r=function(e){const t=e||{fid:uv(),registrationStatus:0};return Cv(t)}(n),a=function(e,t){if(0===t.registrationStatus){if(!navigator.onLine){return{installationEntry:t,registrationPromise:Promise.reject(ev.create("app-offline"))}}const n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},r=async function(e,t){try{const n=await async function(e,t){let{appConfig:n,heartbeatServiceProvider:r}=e,{fid:a}=t;const i=nv(n),s=iv(n),o=r.getImmediate({optional:!0});if(o){const e=await o.getHeartbeatsHeader();e&&s.append("x-firebase-client",e)}const l={fid:a,authVersion:Jg,appId:n.appId,sdkVersion:Qg},c={method:"POST",headers:s,body:JSON.stringify(l)},u=await ov(()=>fetch(i,c));if(u.ok){const e=await u.json();return{fid:e.fid||a,registrationStatus:2,refreshToken:e.refreshToken,authToken:rv(e.authToken)}}throw await av("Create Installation",u)}(e,t);return Tv(e.appConfig,n)}catch(AR){throw tv(AR)&&409===AR.customData.serverCode?await Sv(e.appConfig):await Tv(e.appConfig,{fid:t.fid,registrationStatus:0}),AR}}(e,n);return{installationEntry:n,registrationPromise:r}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:_v(e)}:{installationEntry:t}}(e,r);return t=a.registrationPromise,a.installationEntry});return""===n.fid?{installationEntry:await t}:{installationEntry:n,registrationPromise:t}}async function _v(e){let t=await xv(e.appConfig);for(;1===t.registrationStatus;)await lv(100),t=await xv(e.appConfig);if(0===t.registrationStatus){const{installationEntry:t,registrationPromise:n}=await kv(e);return n||t}return t}function xv(e){return Ev(e,e=>{if(!e)throw ev.create("installation-not-found");return Cv(e)})}function Cv(e){return 1===(t=e).registrationStatus&&t.registrationTime+Yg<Date.now()?{fid:e.fid,registrationStatus:0}:e;var t}async function Iv(e,t){let{appConfig:n,heartbeatServiceProvider:r}=e;const a=function(e,t){let{fid:n}=t;return"".concat(nv(e),"/").concat(n,"/authTokens:generate")}(n,t),i=sv(n,t),s=r.getImmediate({optional:!0});if(s){const e=await s.getHeartbeatsHeader();e&&i.append("x-firebase-client",e)}const o={installation:{sdkVersion:Qg,appId:n.appId}},l={method:"POST",headers:i,body:JSON.stringify(o)},c=await ov(()=>fetch(a,l));if(c.ok){return rv(await c.json())}throw await av("Generate Auth Token",c)}async function Av(e){let t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=await Ev(e.appConfig,r=>{if(!Rv(r))throw ev.create("not-registered");const a=r.authToken;if(!n&&function(e){return 2===e.requestStatus&&!function(e){const t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+Zg}(e)}(a))return r;if(1===a.requestStatus)return t=async function(e,t){let n=await Nv(e.appConfig);for(;1===n.authToken.requestStatus;)await lv(100),n=await Nv(e.appConfig);const r=n.authToken;return 0===r.requestStatus?Av(e,t):r}(e,n),r;{if(!navigator.onLine)throw ev.create("app-offline");const n=function(e){const t={requestStatus:1,requestTime:Date.now()};return l(l({},e),{},{authToken:t})}(r);return t=async function(e,t){try{const n=await Iv(e,t),r=l(l({},t),{},{authToken:n});return await Tv(e.appConfig,r),n}catch(AR){if(!tv(AR)||401!==AR.customData.serverCode&&404!==AR.customData.serverCode){const n=l(l({},t),{},{authToken:{requestStatus:0}});await Tv(e.appConfig,n)}else await Sv(e.appConfig);throw AR}}(e,n),n}});return t?await t:r.authToken}function Nv(e){return Ev(e,e=>{if(!Rv(e))throw ev.create("not-registered");const t=e.authToken;return 1===(n=t).requestStatus&&n.requestTime+Yg<Date.now()?l(l({},e),{},{authToken:{requestStatus:0}}):e;var n})}function Rv(e){return void 0!==e&&2===e.registrationStatus}async function Ov(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=e;await async function(e){const{registrationPromise:t}=await kv(e);t&&await t}(n);return(await Av(n,t)).token}function Pv(e){return ev.create("missing-app-config-values",{valueName:e})}const Dv="installations",Lv=e=>{const t=e.getProvider("app").getImmediate(),n=function(e){if(!e||!e.options)throw Pv("App Configuration");if(!e.name)throw Pv("App Name");const t=["projectId","apiKey","appId"];for(const n of t)if(!e.options[n])throw Pv(n);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t);return{app:t,appConfig:n,heartbeatServiceProvider:pr(t,"heartbeat"),_delete:()=>Promise.resolve()}},Mv=e=>{const t=pr(e.getProvider("app").getImmediate(),Dv).getImmediate();return{getId:()=>async function(e){const t=e,{installationEntry:n,registrationPromise:r}=await kv(t);return r?r.catch(console.error):Av(t).catch(console.error),n.fid}(t),getToken:e=>Ov(t,e)}};dr(new nn(Dv,Lv,"PUBLIC")),dr(new nn("installations-internal",Mv,"PRIVATE")),Tr($g,Xg),Tr($g,Xg,"esm2020");const Fv="analytics",Uv="https://www.googletagmanager.com/gtag/js",jv=new dn("@firebase/analytics"),Vv=new Gt("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."});function zv(e){if(!e.startsWith(Uv)){const t=Vv.create("invalid-gtag-resource",{gtagURL:e});return jv.warn(t.message),""}return e}function Bv(e){return Promise.all(e.map(e=>e.catch(e=>e)))}function Hv(e,t){const n=function(e,t){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy(e,t)),n}("firebase-js-sdk-policy",{createScriptURL:zv}),r=document.createElement("script"),a="".concat(Uv,"?l=").concat(e,"&id=").concat(t);r.src=n?null===n||void 0===n?void 0:n.createScriptURL(a):a,r.async=!0,document.head.appendChild(r)}function Wv(e,t,n,r){return async function(a){try{for(var i=arguments.length,s=new Array(i>1?i-1:0),o=1;o<i;o++)s[o-1]=arguments[o];if("event"===a){const[r,a]=s;await async function(e,t,n,r,a){try{let i=[];if(a&&a.send_to){let e=a.send_to;Array.isArray(e)||(e=[e]);const r=await Bv(n);for(const n of e){const e=r.find(e=>e.measurementId===n),a=e&&t[e.appId];if(!a){i=[];break}i.push(a)}}0===i.length&&(i=Object.values(t)),await Promise.all(i),e("event",r,a||{})}catch(AR){jv.error(AR)}}(e,t,n,r,a)}else if("config"===a){const[a,i]=s;await async function(e,t,n,r,a,i){const s=r[a];try{if(s)await t[s];else{const e=(await Bv(n)).find(e=>e.measurementId===a);e&&await t[e.appId]}}catch(AR){jv.error(AR)}e("config",a,i)}(e,t,n,r,a,i)}else if("consent"===a){const[t,n]=s;e("consent",t,n)}else if("get"===a){const[t,n,r]=s;e("get",t,n,r)}else if("set"===a){const[t]=s;e("set",t)}else e(a,...s)}catch(AR){jv.error(AR)}}}const Gv=new class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}};function Kv(e){return new Headers({Accept:"application/json","x-goog-api-key":e})}async function qv(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Gv,n=arguments.length>2?arguments[2]:void 0;const{appId:r,apiKey:a,measurementId:i}=e.options;if(!r)throw Vv.create("no-app-id");if(!a){if(i)return{measurementId:i,appId:r};throw Vv.create("no-api-key")}const s=t.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},o=new Xv;return setTimeout(async()=>{o.abort()},void 0!==n?n:6e4),$v({appId:r,apiKey:a,measurementId:i},s,o,t)}async function $v(e,t,n){let{throttleEndTimeMillis:r,backoffCount:a}=t,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Gv;const{appId:s,measurementId:o}=e;try{await function(e,t){return new Promise((n,r)=>{const a=Math.max(t-Date.now(),0),i=setTimeout(n,a);e.addEventListener(()=>{clearTimeout(i),r(Vv.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}(n,r)}catch(AR){if(o)return jv.warn("Timed out fetching this Firebase app's measurement ID from the server."+" Falling back to the measurement ID ".concat(o)+' provided in the "measurementId" field in the local Firebase config. ['.concat(null===AR||void 0===AR?void 0:AR.message,"]")),{appId:s,measurementId:o};throw AR}try{const t=await async function(e){const{appId:t,apiKey:n}=e,r={method:"GET",headers:Kv(n)},a="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig".replace("{app-id}",t),i=await fetch(a,r);if(200!==i.status&&304!==i.status){let e="";try{var s;const t=await i.json();null!==(s=t.error)&&void 0!==s&&s.message&&(e=t.error.message)}catch(o){}throw Vv.create("config-fetch-failed",{httpStatus:i.status,responseMessage:e})}return i.json()}(e);return i.deleteThrottleMetadata(s),t}catch(AR){var l;const r=AR;if(!function(e){if(!(e instanceof Wt)||!e.customData)return!1;const t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}(r)){if(i.deleteThrottleMetadata(s),o)return jv.warn("Failed to fetch this Firebase app's measurement ID from the server."+" Falling back to the measurement ID ".concat(o)+' provided in the "measurementId" field in the local Firebase config. ['.concat(null===r||void 0===r?void 0:r.message,"]")),{appId:s,measurementId:o};throw AR}const c=503===Number(null===r||void 0===r||null===(l=r.customData)||void 0===l?void 0:l.httpStatus)?en(a,i.intervalMillis,30):en(a,i.intervalMillis),u={throttleEndTimeMillis:Date.now()+c,backoffCount:a+1};return i.setThrottleMetadata(s,u),jv.debug("Calling attemptFetch again in ".concat(c," millis")),$v(e,u,n,i)}}class Xv{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}let Yv,Qv;function Jv(e){Qv=e}function Zv(e){Yv=e}async function ey(e,t,n,r,a,i,s){var o;const l=qv(e);l.then(t=>{n[t.measurementId]=t.appId,e.options.measurementId&&t.measurementId!==e.options.measurementId&&jv.warn("The measurement ID in the local Firebase config (".concat(e.options.measurementId,")")+" does not match the measurement ID fetched from the server (".concat(t.measurementId,").")+" To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.")}).catch(e=>jv.error(e)),t.push(l);const c=async function(){if(!Bt())return jv.warn(Vv.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{await Ht()}catch(AR){return jv.warn(Vv.create("indexeddb-unavailable",{errorInfo:null===AR||void 0===AR?void 0:AR.toString()}).message),!1}return!0}().then(e=>e?r.getId():void 0),[u,h]=await Promise.all([l,c]);(function(e){const t=window.document.getElementsByTagName("script");for(const n of Object.values(t))if(n.src&&n.src.includes(Uv)&&n.src.includes(e))return n;return null})(i)||Hv(i,u.measurementId),Qv&&(a("consent","default",Qv),Jv(void 0)),a("js",new Date);const f=null!==(o=null===s||void 0===s?void 0:s.config)&&void 0!==o?o:{};return f.origin="firebase",f.update=!0,null!=h&&(f.firebase_id=h),a("config",u.measurementId,f),Yv&&(a("set",Yv),Zv(void 0)),u.measurementId}class ty{constructor(e){this.app=e}_delete(){return delete ny[this.app.options.appId],Promise.resolve()}}let ny={},ry=[];const ay={};let iy,sy,oy="dataLayer",ly="gtag",cy=!1;function uy(){const e=[];if(Vt()&&e.push("This is a browser extension environment."),"undefined"!==typeof navigator&&navigator.cookieEnabled||e.push("Cookies are not available."),e.length>0){const t=e.map((e,t)=>"(".concat(t+1,") ").concat(e)).join(" "),n=Vv.create("invalid-analytics-context",{errorInfo:t});jv.warn(n.message)}}function hy(e,t,n){uy();const r=e.options.appId;if(!r)throw Vv.create("no-app-id");if(!e.options.apiKey){if(!e.options.measurementId)throw Vv.create("no-api-key");jv.warn('The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest'+" measurement ID for this Firebase app. Falling back to the measurement ID ".concat(e.options.measurementId)+' provided in the "measurementId" field in the local Firebase config.')}if(null!=ny[r])throw Vv.create("already-exists",{id:r});if(!cy){!function(e){let t=[];Array.isArray(window[e])?t=window[e]:window[e]=t}(oy);const{wrappedGtag:e,gtagCore:t}=function(e,t,n,r,a){let i=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];window[r].push(arguments)};return window[a]&&"function"===typeof window[a]&&(i=window[a]),window[a]=Wv(i,e,t,n),{gtagCore:i,wrappedGtag:window[a]}}(ny,ry,ay,oy,ly);sy=e,iy=t,cy=!0}ny[r]=ey(e,ry,ay,t,iy,oy,n);return new ty(e)}function fy(e,t,n){e=tn(e),async function(e,t,n,r){if(r&&r.global){const t={};for(const e of Object.keys(n))t["user_properties.".concat(e)]=n[e];return e("set",t),Promise.resolve()}e("config",await t,{update:!0,user_properties:n})}(sy,ny[e.app.options.appId],t,n).catch(e=>jv.error(e))}function dy(e,t,n,r){e=tn(e),async function(e,t,n,r,a){if(a&&a.global)e("event",n,r);else{const a=await t;e("event",n,l(l({},r),{},{send_to:a}))}}(sy,ny[e.app.options.appId],t,n,r).catch(e=>jv.error(e))}const py="@firebase/analytics",my="0.10.19";dr(new nn(Fv,(e,t)=>{let{options:n}=t;return hy(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),n)},"PUBLIC")),dr(new nn("analytics-internal",function(e){try{const t=e.getProvider(Fv).getImmediate();return{logEvent:(e,n,r)=>dy(t,e,n,r),setUserProperties:(e,n)=>fy(t,e,n)}}catch(AR){throw Vv.create("interop-component-reg-failed",{reason:AR})}},"PRIVATE")),Tr(py,my),Tr(py,my,"esm2020");const gy=new class{constructor(){this.toasts=[],this.container=null,this.init()}init(){document.getElementById("toast-container")?this.container=document.getElementById("toast-container"):(this.container=document.createElement("div"),this.container.id="toast-container",this.container.style.cssText="\n        position: fixed;\n        top: 20px;\n        right: 20px;\n        z-index: 10000;\n        display: flex;\n        flex-direction: column;\n        gap: 10px;\n        pointer-events: none;\n      ",document.body.appendChild(this.container))}show(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3e3;const r=document.createElement("div"),a=Date.now()+Math.random(),i={success:{background:"linear-gradient(135deg, #10b981 0%, #059669 100%)",borderLeft:"4px solid #047857"},error:{background:"linear-gradient(135deg, #ef4444 0%, #dc2626 100%)",borderLeft:"4px solid #b91c1c"},warning:{background:"linear-gradient(135deg, #f59e0b 0%, #d97706 100%)",borderLeft:"4px solid #b45309"},info:{background:"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)",borderLeft:"4px solid #1d4ed8"}};Object.assign(r.style,{padding:"12px 16px",borderRadius:"8px",color:"white",fontSize:"14px",fontWeight:"500",maxWidth:"300px",wordWrap:"break-word",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)",transform:"translateX(100%)",transition:"all 0.3s ease",pointerEvents:"auto",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px"},i[t]||i.info);const s={success:"\u2705",error:"\u274c",warning:"\u26a0\ufe0f",info:"\u2139\ufe0f"};return r.innerHTML='\n      <span style="font-size: 16px;">'.concat(s[t]||s.info,'</span>\n      <span style="flex: 1;">').concat(e,'</span>\n      <span style="font-size: 18px; cursor: pointer; opacity: 0.7;" onclick="this.parentElement.remove()">\xd7</span>\n    '),this.container.appendChild(r),setTimeout(()=>{r.style.transform="translateX(0)"},10),setTimeout(()=>{this.remove(r)},n),r.addEventListener("click",()=>{this.remove(r)}),a}remove(e){e&&e.parentNode&&(e.style.transform="translateX(100%)",e.style.opacity="0",setTimeout(()=>{e.parentNode&&e.parentNode.removeChild(e)},300))}success(e,t){return this.show(e,"success",t)}error(e,t){return this.show(e,"error",t)}warning(e,t){return this.show(e,"warning",t)}info(e,t){return this.show(e,"info",t)}},vy={apiKey:"AIzaSyAsXppxDg_gcAJJdK08KFyooW0TSxwaQa8",authDomain:"nglieu-67e5b.firebaseapp.com",projectId:"nglieu-67e5b",storageBucket:"nglieu-67e5b.firebasestorage.app",messagingSenderId:"937625471592",appId:"1:937625471592:web:20de36d7463fa0558c09dd",measurementId:"G-QCL0KWRTTG"},yy=br(vy);if("undefined"!==typeof window&&vy.measurementId)try{!function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:wr();e=tn(e);const t=pr(e,Fv);t.isInitialized()?t.getImmediate():function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=pr(e,Fv);if(n.isInitialized()){const e=n.getImmediate();if(qt(t,n.getOptions()))return e;throw Vv.create("already-initialized")}n.initialize({options:t})}(e)}(yy)}catch(AR){}const by=function(e,t){const n="object"==typeof e?e:wr(),r="string"==typeof e?e:t||ns,a=pr(n,"firestore").getImmediate({identifier:r});if(!a._initialized){const e=(e=>{const t=At(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error("Invalid host ".concat(t," with no separate hostname and port!"));const r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]})("firestore");e&&yf(a,...e)}return a}(yy),wy=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:wr();const t=pr(e,"auth");if(t.isInitialized())return t.getImmediate();const n=function(e,t){const n=pr(e,"auth");if(n.isInitialized()){const e=n.getImmediate();if(qt(n.getOptions(),null!==t&&void 0!==t?t:{}))return e;Ad(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:zg,persistence:[Qm,Rm,Mm]}),r=Rt("authTokenSyncURL");if(r&&"boolean"===typeof isSecureContext&&isSecureContext){const e=new URL(r,location.origin);if(location.origin===e.origin){const t=(a=e.toString(),async e=>{const t=e&&await e.getIdTokenResult(),n=t&&((new Date).getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>Gg)return;const r=null===t||void 0===t?void 0:t.token;Kg!==r&&(Kg=r,await fetch(a,{method:r?"POST":"DELETE",headers:r?{Authorization:"Bearer ".concat(r)}:{}}))});!function(e,t,n){tn(e).beforeAuthStateChanged(t,n)}(n,t,()=>t(n.currentUser)),function(e,t,n,r){tn(e).onIdTokenChanged(t,n,r)}(n,e=>t(e))}}var a;const i=At("auth");return i&&Xp(n,"http://".concat(i)),n}(yy);const Ty=new class{constructor(){this.db=by,this.auth=wy,this.useFirebase=!0}async getAllIngredients(){try{return(await pd(Sf(this.db,"ingredients"))).docs.map(e=>l({id:e.id},e.data()))}catch(e){throw console.error("Error getting ingredients:",e),gy.error("Kh\xf4ng th\u1ec3 t\u1ea3i danh s\xe1ch nguy\xean li\u1ec7u"),e}}async createIngredient(e){try{const t=await yd(Sf(this.db,"ingredients"),e),n=l(l({},e),{},{id:t.id});return await gd(Ef(this.db,"ingredients",t.id),{id:t.id}),n}catch(t){throw console.error("Error creating ingredient:",t),gy.error("Kh\xf4ng th\u1ec3 t\u1ea1o nguy\xean li\u1ec7u m\u1edbi"),t}}async updateIngredient(e,t){try{return await gd(Ef(this.db,"ingredients",String(e)),t),!0}catch(n){throw console.error("Error updating ingredient:",n),gy.error("Kh\xf4ng th\u1ec3 c\u1eadp nh\u1eadt nguy\xean li\u1ec7u"),n}}async deleteIngredient(e){try{return await vd(Ef(this.db,"ingredients",String(e))),!0}catch(t){throw console.error("Error deleting ingredient:",t),gy.error("Kh\xf4ng th\u1ec3 x\xf3a nguy\xean li\u1ec7u"),t}}async checkIngredientExists(e){try{return(await fd(Ef(this.db,"ingredients",String(e)))).exists()}catch(t){return!1}}async getAllRecipes(){try{return(await pd(Sf(this.db,"recipes"))).docs.map(e=>l({id:e.id},e.data()))}catch(e){throw console.error("Error getting recipes:",e),gy.error("Kh\xf4ng th\u1ec3 t\u1ea3i danh s\xe1ch c\xf4ng th\u1ee9c"),e}}async createRecipe(e){try{if(void 0!==(null===e||void 0===e?void 0:e.id)&&null!==(null===e||void 0===e?void 0:e.id)){const t=String(e.id);return await md(Ef(this.db,"recipes",t),l(l({},e),{},{id:t}),{merge:!0}),l(l({},e),{},{id:t})}const t=await yd(Sf(this.db,"recipes"),e),n=l(l({},e),{},{id:t.id});return await gd(Ef(this.db,"recipes",t.id),{id:t.id}),n}catch(t){throw console.error("Error creating recipe:",t),gy.error("Kh\xf4ng th\u1ec3 t\u1ea1o c\xf4ng th\u1ee9c m\u1edbi"),t}}async updateRecipe(e,t){try{const n=String(e);return await md(Ef(this.db,"recipes",n),l(l({},t),{},{id:n}),{merge:!0}),!0}catch(n){throw console.error("Error updating recipe:",n),gy.error("Kh\xf4ng th\u1ec3 c\u1eadp nh\u1eadt c\xf4ng th\u1ee9c"),n}}async deleteRecipe(e){try{return await vd(Ef(this.db,"recipes",String(e))),!0}catch(t){throw console.error("Error deleting recipe:",t),gy.error("Kh\xf4ng th\u1ec3 x\xf3a c\xf4ng th\u1ee9c"),t}}async checkRecipeExists(e){try{return(await fd(Ef(this.db,"recipes",String(e)))).exists()}catch(t){return!1}}async getAllMenuItems(){try{return(await this.getAllRecipes()).map(e=>({id:e.id,name:e.name,price:e.price,category:e.category}))}catch(e){return console.error("Error getting menu items:",e),[]}}async getAllAccounts(){try{return(await pd(Sf(this.db,"accounts"))).docs.map(e=>l({id:e.id},e.data()))}catch(e){throw console.error("Error getting accounts:",e),e}}async createAccount(e){try{if(null!==e&&void 0!==e&&e.uid){const t=String(e.uid);return await md(Ef(this.db,"accounts",t),l(l({},e),{},{id:t}),{merge:!0}),l(l({},e),{},{id:t})}const t=await yd(Sf(this.db,"accounts"),e),n=l(l({},e),{},{id:t.id});return await gd(Ef(this.db,"accounts",t.id),{id:t.id}),n}catch(t){throw console.error("Error creating account:",t),t}}async signIn(e,t){try{const n=await function(e,t,n){return mr(e.app)?Promise.reject(Od(e)):Em(tn(e),lm.credential(t,n)).catch(async t=>{throw t.code==="auth/".concat("password-does-not-meet-requirements")&&km(e),t})}(this.auth,e,t),r=n.user,a=(await this.getAllAccounts()).find(t=>t.email===e);if(!a||!a.status||!a.isApprove)throw await xm(this.auth),new Error("T\xe0i kho\u1ea3n kh\xf4ng t\u1ed3n t\u1ea1i ho\u1eb7c ch\u01b0a \u0111\u01b0\u1ee3c ph\xea duy\u1ec7t");return{success:!0,user:{id:r.uid,email:r.email,username:a.username,fullname:a.fullname,role:a.role,avatar:a.avatar}}}catch(n){return{success:!1,error:n.message,message:"\u0110\u0103ng nh\u1eadp th\u1ea5t b\u1ea1i!"}}}async signUp(e,t,n){try{const r=await async function(e,t,n){if(mr(e.app))return Promise.reject(Od(e));const r=Fp(e),a=qp(r,{returnSecureToken:!0,email:t,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",mm,"EMAIL_PASSWORD_PROVIDER"),i=await a.catch(t=>{throw t.code==="auth/".concat("password-does-not-meet-requirements")&&km(e),t}),s=await gm._fromIdTokenResponse(r,"signIn",i);return await r._updateCurrentUser(s.user),s}(this.auth,e,t),a=r.user,i={uid:a.uid,email:a.email,username:n.username,fullname:n.fullname,role:n.role||"USER",avatar:n.avatar||"",status:!1,isApprove:!1,createdAt:(new Date).toISOString()};return await this.createAccount(i),{success:!0,message:"\u0110\u0103ng k\xfd th\xe0nh c\xf4ng! Vui l\xf2ng ch\u1edd admin ph\xea duy\u1ec7t."}}catch(r){return{success:!1,error:r.message,message:"\u0110\u0103ng k\xfd th\u1ea5t b\u1ea1i!"}}}async signOut(){try{return await xm(this.auth),!0}catch(e){return console.error("Error signing out:",e),!1}}getCurrentUser(){return new Promise(e=>{const t=_m(this.auth,n=>{t(),e(n)})})}onAuthStateChanged(e){return _m(this.auth,e)}async getSalesByDate(e){try{const t=await fd(Ef(this.db,"sales",String(e)));return t.exists()?t.data():{}}catch(t){return console.error("Error getting sales:",t),{}}}async updateSales(e,t){try{return await md(Ef(this.db,"sales",String(e)),t,{merge:!0}),!0}catch(n){return console.error("Error updating sales:",n),!1}}convertFromMockAPIFormat(e){const t={};return e.forEach(e=>{t[e.id]=e.ingredients||{}}),t}convertToMockAPIFormat(e,t,n,r){return{id:e,name:(null===n||void 0===n?void 0:n.name)||"M\xf3n ".concat(e),ingredients:t,price:(null===n||void 0===n?void 0:n.price)||0,category:(null===n||void 0===n?void 0:n.category)||""}}toggleFirebaseMode(){return this.useFirebase=!this.useFirebase,this.useFirebase}isFirebaseEnabled(){return this.useFirebase}},Sy=Ty;const Ey=new class{constructor(){this.menuItems=[],this.ingredients=[],this.recipes={},this.sales={},this.useFirebase=!0,this.isInitialized=!1}getMenuItems(){return this.menuItems}getIngredients(){return this.ingredients}getRecipe(e){return this.recipes[e]||{}}getAllRecipes(){return this.recipes}async updateRecipe(e,t){if(this.recipes[e]=t,!this.useFirebase)throw new Error("Firebase kh\xf4ng \u0111\u01b0\u1ee3c b\u1eadt");try{const n=this.menuItems.find(t=>t.id===e),r=Sy.convertToMockAPIFormat(e,t,n,this.ingredients);await Sy.checkRecipeExists(e)?await Sy.updateRecipe(e,r):await Sy.createRecipe(r)}catch(n){throw gy.error("L\u1ed7i khi c\u1eadp nh\u1eadt c\xf4ng th\u1ee9c trong Firebase"),n}}async addMenuItem(e){const t=Math.max(...this.menuItems.map(e=>e.id),0)+1,n=l(l({},e),{},{id:t});if(this.menuItems.push(n),!this.useFirebase)throw new Error("Firebase kh\xf4ng \u0111\u01b0\u1ee3c b\u1eadt");try{const r=Sy.convertToMockAPIFormat(t,e.ingredients||{},n,this.ingredients);console.log("\ud83d\udd0d [DataService] Creating new recipe in Firebase:",r),await Sy.createRecipe(r),console.log("[DataService] Recipe created successfully in Firebase")}catch(r){throw console.error("\u274c [DataService] Error creating recipe in Firebase:",r),gy.error("L\u1ed7i khi t\u1ea1o c\xf4ng th\u1ee9c trong Firebase"),r}return n}async updateMenuItem(e,t){const n=this.menuItems.findIndex(t=>t.id===e);if(-1!==n){if(this.menuItems[n]=l(l({},this.menuItems[n]),t),!this.useFirebase)throw new Error("Firebase kh\xf4ng \u0111\u01b0\u1ee3c b\u1eadt");try{const r=Sy.convertToMockAPIFormat(e,t.ingredients||this.menuItems[n].ingredients||{},this.menuItems[n],this.ingredients);console.log("\ud83d\udd0d [DataService] Updating recipe in Firebase:",r),await Sy.updateRecipe(e,r),console.log("\u2705 [DataService] Recipe updated successfully in Firebase")}catch(r){throw console.error("\u274c [DataService] Error updating recipe in Firebase:",r),gy.error("L\u1ed7i khi c\u1eadp nh\u1eadt c\xf4ng th\u1ee9c trong Firebase"),r}}}async deleteMenuItem(e){if(console.log("\ud83d\udd0d [DataService] deleteMenuItem - Starting..."),console.log("\ud83d\udd0d [DataService] Item ID:",e),this.menuItems=this.menuItems.filter(t=>t.id!==e),delete this.recipes[e],!this.useFirebase)throw new Error("Firebase kh\xf4ng \u0111\u01b0\u1ee3c b\u1eadt");try{console.log("\ud83d\udd0d [DataService] Deleting recipe from Firebase..."),await Sy.deleteRecipe(e),console.log("\u2705 [DataService] Recipe deleted successfully from Firebase")}catch(t){throw console.error("\u274c [DataService] Error deleting recipe from Firebase:",t),gy.error("L\u1ed7i khi x\xf3a c\xf4ng th\u1ee9c kh\u1ecfi Firebase"),t}}async addIngredient(e){if(console.log("\ud83d\udd0d [DataService] addIngredient - Starting..."),console.log("\ud83d\udd0d [DataService] Ingredient data:",e),!this.useFirebase)throw new Error("Firebase kh\xf4ng \u0111\u01b0\u1ee3c b\u1eadt");try{console.log("\ud83d\udd0d [DataService] Creating ingredient in Firebase...");const t=await Sy.createIngredient(e);return this.ingredients.push(t),console.log("\u2705 [DataService] Ingredient created successfully in Firebase"),t}catch(t){throw console.error("\u274c [DataService] Error creating ingredient in Firebase:",t),gy.error("L\u1ed7i khi t\u1ea1o nguy\xean li\u1ec7u trong Firebase"),t}}async updateIngredient(e,t){console.log("\ud83d\udd0d [DataService] updateIngredient - Starting..."),console.log("\ud83d\udd0d [DataService] Ingredient ID:",e),console.log("\ud83d\udd0d [DataService] Updates:",t);const n=this.ingredients.findIndex(t=>t.id===e);if(-1!==n){if(this.ingredients[n]=l(l({},this.ingredients[n]),t),!this.useFirebase)throw new Error("Firebase kh\xf4ng \u0111\u01b0\u1ee3c b\u1eadt");try{console.log("\ud83d\udd0d [DataService] Checking if ingredient exists in Firebase...");await Sy.checkIngredientExists(e)?(console.log("\ud83d\udd0d [DataService] Ingredient exists, updating in Firebase..."),await Sy.updateIngredient(e,this.ingredients[n]),console.log("\u2705 [DataService] Ingredient updated successfully in Firebase")):(console.log("\ud83d\udd0d [DataService] Ingredient does not exist, creating in Firebase..."),await Sy.createIngredient(this.ingredients[n]),console.log("\u2705 [DataService] Ingredient created successfully in Firebase"))}catch(r){throw console.error("\u274c [DataService] Error updating ingredient in Firebase:",r),gy.error("L\u1ed7i khi c\u1eadp nh\u1eadt nguy\xean li\u1ec7u trong Firebase"),r}}}async deleteIngredient(e){console.log("\ud83d\udd0d [DataService] deleteIngredient - Starting..."),console.log("\ud83d\udd0d [DataService] Ingredient ID:",e);const t=this.ingredients.find(t=>t.id===e);t?console.log("\ud83d\udd0d [DataService] Found ingredient to delete:",t):console.log("\ud83d\udd0d [DataService] Ingredient not found in local data"),this.ingredients=this.ingredients.filter(t=>t.id!==e);const n={};if(Object.keys(this.recipes).forEach(t=>{const r=l({},this.recipes[t]);delete r[e],n[t]=r}),this.recipes=n,!this.useFirebase)throw new Error("Firebase kh\xf4ng \u0111\u01b0\u1ee3c b\u1eadt");try{console.log("\ud83d\udd0d [DataService] Deleting ingredient from Firebase..."),await Sy.deleteIngredient(e),console.log("\u2705 [DataService] Ingredient deleted successfully from Firebase");const t=Object.keys(this.recipes).map(e=>this.updateRecipe(e,this.recipes[e]));await Promise.all(t)}catch(r){throw gy.error("L\u1ed7i khi x\xf3a nguy\xean li\u1ec7u trong Firebase"),r}}async addRecipe(e,t){if(this.recipes[e]=t,!this.useFirebase)throw new Error("Firebase kh\xf4ng \u0111\u01b0\u1ee3c b\u1eadt");try{const n=this.menuItems.find(t=>t.id===e),r=Sy.convertToMockAPIFormat(e,t,n,this.ingredients);await Sy.createRecipe(r)}catch(n){throw gy.error("L\u1ed7i khi t\u1ea1o c\xf4ng th\u1ee9c trong Firebase"),n}}async deleteRecipe(e){if(delete this.recipes[e],!this.useFirebase)throw new Error("Firebase kh\xf4ng \u0111\u01b0\u1ee3c b\u1eadt");try{await Sy.deleteRecipe(e)}catch(t){throw gy.error("L\u1ed7i khi x\xf3a c\xf4ng th\u1ee9c trong Firebase"),t}}toggleFirebaseMode(){return this.useFirebase=!this.useFirebase,this.useFirebase}isFirebaseEnabled(){return this.useFirebase}checkFirebaseStatus(){return{firebase:{enabled:this.useFirebase,ingredients:this.ingredients.length,recipes:Object.keys(this.recipes).length,menuItems:this.menuItems.length}}}getDefaultMenuItems(){return[{id:1,name:"C\xe0 ph\xea \u0111en"},{id:2,name:"C\xe0 ph\xea s\u1eefa"},{id:3,name:"Sinh t\u1ed1 b\u01a1"},{id:4,name:"Cacao s\u1eefa"},{id:5,name:"B\u1ea1c xiu"},{id:6,name:"Americano"},{id:7,name:"S\u1eefa t\u01b0\u01a1i cafe"},{id:8,name:"Cafe mu\u1ed1i"},{id:9,name:"Cacao mu\u1ed1i"},{id:10,name:"Cacao \u0111\xe1 xay"},{id:11,name:"C\xe0 ph\xea \u0111\xe1 xay"},{id:12,name:"\xc9p t\xe1o"},{id:13,name:"\xc9p cam"},{id:14,name:"\xc9p th\u01a1m"},{id:15,name:"D\u1eeba t\u01b0\u01a1i"},{id:16,name:"Sinh t\u1ed1 d\u1eeba"},{id:17,name:"Matcha s\u1eefa y\u1ebfn m\u1ea1ch"},{id:18,name:"S\u1eefa chua \u0111\xe1"},{id:19,name:"S\u1eefa chua vi\u1ec7t qu\u1ea5t"},{id:20,name:"Tr\xe0 g\u1eebng"},{id:21,name:"N\u01b0\u1edbc s\u1ea5u"}]}async syncToFirebase(){if(this.useFirebase)try{for(const t of this.ingredients)try{await Sy.createIngredient(t)}catch(e){}for(const[t,n]of Object.entries(this.recipes))try{await this.updateRecipe(t,n)}catch(e){}}catch(e){}}getSalesByDate(e){return this.sales[e]||{}}updateSales(e,t){this.sales[e]=t,this.saveSalesToLocalStorage()}async loadDataFromAPI(){if(!this.useFirebase)throw new Error("Firebase kh\xf4ng \u0111\u01b0\u1ee3c b\u1eadt");try{this.ingredients=await Sy.getAllIngredients();const e=await Sy.getAllRecipes();this.recipes=Sy.convertFromMockAPIFormat(e),this.menuItems=this.getDefaultMenuItems(),this.loadSalesFromLocalStorage()}catch(e){throw gy.error("Kh\xf4ng th\u1ec3 k\u1ebft n\u1ed1i \u0111\u1ebfn Firebase. Vui l\xf2ng ki\u1ec3m tra c\u1ea5u h\xecnh."),e}}saveSalesToLocalStorage(){try{localStorage.setItem("ingredientsTool_sales",JSON.stringify(this.sales))}catch(e){}}loadSalesFromLocalStorage(){try{const e=localStorage.getItem("ingredientsTool_sales");e&&(this.sales=JSON.parse(e))}catch(e){}}async init(){if(!this.isInitialized){if(!this.useFirebase)throw gy.error("Firebase ph\u1ea3i \u0111\u01b0\u1ee3c b\u1eadt \u0111\u1ec3 s\u1eed d\u1ee5ng \u1ee9ng d\u1ee5ng"),new Error("Firebase ph\u1ea3i \u0111\u01b0\u1ee3c b\u1eadt");try{await this.loadDataFromAPI()}catch(e){throw gy.error("Kh\xf4ng th\u1ec3 k\u1ebft n\u1ed1i \u0111\u1ebfn Firebase. Vui l\xf2ng ki\u1ec3m tra c\u1ea5u h\xecnh."),e}this.isInitialized=!0}}};var ky=n(579);const _y=(0,e.createContext)(),xy=()=>{const t=(0,e.useContext)(_y);if(!t)throw new Error("useData must be used within a DataProvider");return t},Cy=t=>{let{children:n}=t;const[r,a]=(0,e.useState)([]),[i,s]=(0,e.useState)([]),[o,l]=(0,e.useState)({}),[c,u]=(0,e.useState)(!1);(0,e.useEffect)(()=>{(async()=>{try{Ey.isInitialized||await Ey.init();const e=Ey.getMenuItems(),t=Ey.getIngredients(),n=Ey.getAllRecipes();a(e),s(t),l(n)}catch(e){}})()},[]);const h={menuItems:r,ingredients:i,recipes:o,isLoading:c,refreshData:async()=>{u(!0);try{a(Ey.getMenuItems()),s(Ey.getIngredients()),l(Ey.getAllRecipes())}catch(e){}finally{u(!1)}},updateMenuItems:()=>{a(Ey.getMenuItems())},updateIngredients:()=>{s(Ey.getIngredients())},updateRecipes:()=>{l(Ey.getAllRecipes())},updateAllData:()=>{a(Ey.getMenuItems()),s(Ey.getIngredients()),l(Ey.getAllRecipes())}};return(0,ky.jsx)(_y.Provider,{value:h,children:n})};var Iy=n(736);const Ay=new class{constructor(){this.currentUser=null,this.useFirebase=!0,this.usePinLogin=!1,this.pinCode="9320"}async login(e,t){try{if(this.usePinLogin){return String(void 0===t?e:t)!==this.pinCode?{success:!1,error:"Sai m\xe3 PIN",message:"M\u1eadt kh\u1ea9u kh\xf4ng \u0111\xfang"}:(this.currentUser={id:"local-admin",username:"admin",fullname:"Admin",role:"ADMIN",avatar:""},localStorage.setItem("currentUser",JSON.stringify(this.currentUser)),{success:!0,user:this.currentUser,message:"\u0110\u0103ng nh\u1eadp th\xe0nh c\xf4ng!"})}if(this.useFirebase){let n=e;if("string"===typeof e&&!e.includes("@")){const t=(await Sy.getAllAccounts()).find(t=>t.username===e);if(null===t||void 0===t||!t.email)return{success:!1,error:"Kh\xf4ng t\xecm th\u1ea5y email cho username n\xe0y",message:"T\xe0i kho\u1ea3n kh\xf4ng t\u1ed3n t\u1ea1i ho\u1eb7c ch\u01b0a \u0111\u01b0\u1ee3c ph\xea duy\u1ec7t"};n=t.email}const r=await Sy.signIn(n,t);return r.success?(this.currentUser=r.user,localStorage.setItem("currentUser",JSON.stringify(this.currentUser)),{success:!0,user:this.currentUser,message:"\u0110\u0103ng nh\u1eadp th\xe0nh c\xf4ng!"}):r}{const n=await fetch(this.apiUrl);if(!n.ok)throw new Error("Kh\xf4ng th\u1ec3 k\u1ebft n\u1ed1i \u0111\u1ebfn server");const r=(await n.json()).find(t=>t.username===e&&!0===t.status&&!0===t.isApprove);if(!r)throw new Error("T\xe0i kho\u1ea3n kh\xf4ng t\u1ed3n t\u1ea1i ho\u1eb7c ch\u01b0a \u0111\u01b0\u1ee3c ph\xea duy\u1ec7t");if(!await Iy.default.compare(t,r.password))throw new Error("M\u1eadt kh\u1ea9u kh\xf4ng \u0111\xfang");return this.currentUser={id:r.id,username:r.username,fullname:r.fullname,role:r.role,avatar:r.avatar},localStorage.setItem("currentUser",JSON.stringify(this.currentUser)),{success:!0,user:this.currentUser,message:"\u0110\u0103ng nh\u1eadp th\xe0nh c\xf4ng!"}}}catch(n){return{success:!1,error:n.message,message:"\u0110\u0103ng nh\u1eadp th\u1ea5t b\u1ea1i!"}}}async logout(){try{this.useFirebase&&await Sy.signOut(),this.currentUser=null,localStorage.removeItem("currentUser")}catch(e){console.error("Logout error:",e),this.currentUser=null,localStorage.removeItem("currentUser")}}getCurrentUser(){if(this.currentUser)return this.currentUser;const e=localStorage.getItem("currentUser");return e?(this.currentUser=JSON.parse(e),this.currentUser):null}isAuthenticated(){return null!==this.getCurrentUser()}isAdmin(){const e=this.getCurrentUser();return e&&"ADMIN"===e.role}toggleAuthMode(){return this.useFirebase=!this.useFirebase,this.useFirebase}setPinLoginEnabled(e){return this.usePinLogin=!!e,this.usePinLogin}isUsingFirebase(){return this.useFirebase}async hashPassword(e){const t=await Promise.resolve().then(n.bind(n,736));return await t.hash(e,6)}},Ny=()=>{const t=he(),n=pe(),r=Ay.getCurrentUser(),[a,i]=(0,e.useState)(!1),s=(0,e.useRef)(null),o=e=>t.pathname===e;return(0,e.useEffect)(()=>{const e=e=>{s.current&&!s.current.contains(e.target)&&i(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]),(0,ky.jsxs)("nav",{style:{position:"fixed",top:0,left:0,right:0,zIndex:1e3,background:"white",boxShadow:"0 2px 10px rgba(0,0,0,0.1)",height:"60px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0 2rem"},children:[(0,ky.jsx)(mt,{to:"/",style:{textDecoration:"none",color:"#2c3e50",fontSize:"1.5rem",fontWeight:"bold",display:"flex",alignItems:"center",gap:"0.5rem"},children:"Logo"}),(0,ky.jsxs)("div",{style:{display:"flex",gap:"2rem",alignItems:"center"},children:[(0,ky.jsx)(mt,{to:"/",style:{textDecoration:"none",color:o("/")?"#3498db":"#2c3e50",fontWeight:o("/")?"600":"400",fontSize:"1rem",padding:"0.5rem 1rem",borderRadius:"6px",transition:"all 0.3s ease",backgroundColor:o("/")?"rgba(52, 152, 219, 0.1)":"transparent"},children:"Trang Ch\u1ee7"}),(0,ky.jsx)(mt,{to:"/inventory",style:{textDecoration:"none",color:o("/inventory")?"#3498db":"#2c3e50",fontWeight:o("/inventory")?"600":"400",fontSize:"1rem",padding:"0.5rem 1rem",borderRadius:"6px",transition:"all 0.3s ease",backgroundColor:o("/inventory")?"rgba(52, 152, 219, 0.1)":"transparent"},children:"Ki\u1ec3m K\xea"}),(0,ky.jsx)(mt,{to:"/recipes",style:{textDecoration:"none",color:o("/recipes")?"#3498db":"#2c3e50",fontWeight:o("/recipes")?"600":"400",fontSize:"1rem",padding:"0.5rem 1rem",borderRadius:"6px",transition:"all 0.3s ease",backgroundColor:o("/recipes")?"rgba(52, 152, 219, 0.1)":"transparent"},children:"C\xf4ng Th\u1ee9c"}),(0,ky.jsx)(mt,{to:"/ingredients",style:{textDecoration:"none",color:o("/ingredients")?"#3498db":"#2c3e50",fontWeight:o("/ingredients")?"600":"400",fontSize:"1rem",padding:"0.5rem 1rem",borderRadius:"6px",transition:"all 0.3s ease",backgroundColor:o("/ingredients")?"rgba(52, 152, 219, 0.1)":"transparent"},children:"Nguy\xean Li\u1ec7u"})]}),(0,ky.jsxs)("div",{ref:s,style:{position:"relative"},children:[(0,ky.jsxs)("button",{onClick:()=>i(!a),style:{display:"flex",alignItems:"center",gap:"0.75rem",background:"rgba(52, 152, 219, 0.1)",border:"1px solid rgba(52, 152, 219, 0.3)",borderRadius:"25px",padding:"0.5rem 1rem",cursor:"pointer",transition:"all 0.3s ease",fontSize:"0.9rem",color:"#2c3e50"},onMouseOver:e=>{e.currentTarget.style.background="rgba(52, 152, 219, 0.2)"},onMouseOut:e=>{e.currentTarget.style.background="rgba(52, 152, 219, 0.1)"},children:[(0,ky.jsx)("div",{style:{width:"32px",height:"32px",borderRadius:"50%",backgroundImage:null!==r&&void 0!==r&&r.avatar?"url(https://res.cloudinary.com/dqa9zqx8d/image/upload/w_64,h_64,c_fill,f_auto,q_auto/".concat(r.avatar,")"):"none",backgroundColor:null!==r&&void 0!==r&&r.avatar?"transparent":"rgba(52, 152, 219, 0.8)",backgroundSize:"cover",backgroundPosition:"center",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1rem",color:"white",border:"2px solid rgba(52, 152, 219, 0.3)"},children:!(null!==r&&void 0!==r&&r.avatar)&&"\ud83d\udc64"}),(0,ky.jsx)("div",{style:{fontWeight:"500",fontSize:"0.9rem"},children:(null===r||void 0===r?void 0:r.fullname)||"User"}),(0,ky.jsx)("div",{style:{fontSize:"0.7rem",color:"#666",transition:"transform 0.3s ease",transform:a?"rotate(180deg)":"rotate(0deg)"},children:"\u25bc"})]}),a&&(0,ky.jsxs)("div",{style:{position:"absolute",top:"100%",right:"0",background:"white",borderRadius:"12px",padding:"0.5rem",boxShadow:"0 8px 32px rgba(0,0,0,0.15)",border:"1px solid rgba(0,0,0,0.1)",minWidth:"220px",marginTop:"0.5rem",zIndex:1001},children:[(0,ky.jsxs)("div",{style:{padding:"0.75rem",borderBottom:"1px solid rgba(0,0,0,0.1)",marginBottom:"0.5rem"},children:[(0,ky.jsx)("div",{style:{fontSize:"1rem",fontWeight:"600",color:"#2c3e50",marginBottom:"0.25rem"},children:(null===r||void 0===r?void 0:r.fullname)||"User"}),(0,ky.jsx)("div",{style:{fontSize:"0.8rem",color:"#666"},children:"ADMIN"===(null===r||void 0===r?void 0:r.role)?"Qu\u1ea3n tr\u1ecb vi\xean":"Ng\u01b0\u1eddi d\xf9ng"})]}),(0,ky.jsx)("button",{onClick:()=>{Ay.logout(),gy.success("\u0110\u0103ng xu\u1ea5t th\xe0nh c\xf4ng!"),n("/login"),i(!1)},style:{width:"100%",background:"linear-gradient(135deg, #e74c3c, #c0392b)",color:"white",border:"none",padding:"0.75rem 1rem",borderRadius:"8px",cursor:"pointer",fontSize:"0.9rem",fontWeight:"500",transition:"all 0.3s ease",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem"},onMouseOver:e=>{e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 4px 15px rgba(231, 76, 60, 0.4)"},onMouseOut:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="none"},children:"\ud83d\udeaa \u0110\u0103ng xu\u1ea5t"})]})]})]})},Ry=()=>{const t=pe(),[n,r]=(0,e.useState)({password:""}),[a,i]=(0,e.useState)(!1),[s,o]=(0,e.useState)(!1);(0,e.useEffect)(()=>{Ay.setPinLoginEnabled(!0),Ay.isAuthenticated()&&t("/")},[t]);return(0,ky.jsxs)("div",{className:"login-container",style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:"1rem",position:"relative",overflow:"hidden"},children:[(0,ky.jsx)("div",{style:{position:"absolute",top:"-50%",right:"-50%",width:"200%",height:"200%",background:"radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%)",animation:"float 6s ease-in-out infinite"}}),(0,ky.jsx)("div",{className:"login-card",style:{backgroundColor:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(10px)",borderRadius:"20px",boxShadow:"0 25px 50px rgba(0,0,0,0.15)",padding:"2.5rem",width:"100%",maxWidth:"420px",position:"relative",overflow:"hidden",border:"1px solid rgba(255,255,255,0.2)"},children:(0,ky.jsxs)("div",{style:{position:"relative",zIndex:1},children:[(0,ky.jsxs)("div",{className:"text-center",style:{marginBottom:"2.5rem"},children:[(0,ky.jsx)("div",{style:{width:"80px",height:"80px",margin:"0 auto 1.5rem",background:"linear-gradient(135deg, #667eea, #764ba2)",borderRadius:"20px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"2.5rem",boxShadow:"0 10px 30px rgba(102, 126, 234, 0.3)"},children:"\ud83c\udf79"}),(0,ky.jsx)("h1",{style:{fontSize:"2rem",fontWeight:"700",color:"#2c3e50",marginBottom:"0.5rem",letterSpacing:"-0.5px"},children:"Ki\u1ec3m Kho"}),(0,ky.jsx)("p",{style:{color:"#6c757d",fontSize:"1rem",fontWeight:"400"},children:"\u0110\u0103ng nh\u1eadp \u0111\u1ec3 ti\u1ebfp t\u1ee5c"})]}),(0,ky.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),n.password.trim()){i(!0);try{const e=await Ay.login(n.password);e.success?(gy.success("Ch\xe0o m\u1eebng ".concat(e.user.fullname,"!")),t("/")):gy.error(e.message)}catch(r){gy.error("C\xf3 l\u1ed7i x\u1ea3y ra khi \u0111\u0103ng nh\u1eadp!")}finally{i(!1)}}else gy.error("Vui l\xf2ng nh\u1eadp \u0111\u1ea7y \u0111\u1ee7 th\xf4ng tin!")},children:[(0,ky.jsxs)("div",{style:{marginBottom:"2rem"},children:[(0,ky.jsx)("label",{style:{display:"block",marginBottom:"0.75rem",color:"#2c3e50",fontWeight:"600",fontSize:"0.95rem"},children:"M\u1eadt kh\u1ea9u"}),(0,ky.jsxs)("div",{style:{position:"relative"},children:[(0,ky.jsx)("input",{type:s?"text":"password",name:"password",value:n.password,onChange:e=>{const{name:t,value:n}=e.target;r(e=>l(l({},e),{},{[t]:n}))},placeholder:"Nh\u1eadp m\xe3 PIN",style:{width:"100%",padding:"1rem 1.25rem",paddingRight:"3rem",border:"2px solid #e9ecef",borderRadius:"12px",fontSize:"1rem",transition:"all 0.3s ease",outline:"none",boxSizing:"border-box",backgroundColor:"#fafbfc"},onFocus:e=>{e.target.style.borderColor="#667eea",e.target.style.boxShadow="0 0 0 4px rgba(102, 126, 234, 0.1)",e.target.style.backgroundColor="white"},onBlur:e=>{e.target.style.borderColor="#e9ecef",e.target.style.boxShadow="none",e.target.style.backgroundColor="#fafbfc"}}),(0,ky.jsx)("button",{type:"button",onClick:()=>o(!s),style:{position:"absolute",right:"1.25rem",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",color:"#6c757d",cursor:"pointer",fontSize:"1.2rem",padding:"0.25rem",borderRadius:"4px",transition:"all 0.2s ease"},onMouseOver:e=>{e.target.style.backgroundColor="rgba(102, 126, 234, 0.1)"},onMouseOut:e=>{e.target.style.backgroundColor="transparent"},children:s?"\ud83d\ude48":"\ud83d\udc41\ufe0f"})]})]}),(0,ky.jsx)("button",{type:"submit",disabled:a,style:{width:"100%",padding:"1rem 1.5rem",background:a?"#bdc3c7":"linear-gradient(135deg, #667eea, #764ba2)",color:"white",border:"none",borderRadius:"12px",fontSize:"1.1rem",fontWeight:"700",cursor:a?"not-allowed":"pointer",transition:"all 0.3s ease",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.75rem",marginBottom:"1rem",boxShadow:a?"none":"0 8px 25px rgba(102, 126, 234, 0.3)",letterSpacing:"0.5px"},onMouseOver:e=>{a||(e.target.style.transform="translateY(-3px)",e.target.style.boxShadow="0 12px 35px rgba(102, 126, 234, 0.4)")},onMouseOut:e=>{a||(e.target.style.transform="translateY(0)",e.target.style.boxShadow="0 8px 25px rgba(102, 126, 234, 0.3)")},children:a?(0,ky.jsxs)(ky.Fragment,{children:[(0,ky.jsx)("div",{style:{width:"20px",height:"20px",border:"3px solid transparent",borderTop:"3px solid white",borderRadius:"50%",animation:"spin 1s linear infinite"}}),"\u0110ang \u0111\u0103ng nh\u1eadp..."]}):(0,ky.jsx)(ky.Fragment,{children:"\u0110\u0103ng nh\u1eadp"})})]})]})}),(0,ky.jsx)("style",{jsx:!0,children:"\n        @keyframes spin {\n          0% { transform: rotate(0deg); }\n          100% { transform: rotate(360deg); }\n        }\n        \n        @keyframes float {\n          0%, 100% { transform: translateY(0px) rotate(0deg); }\n          50% { transform: translateY(-20px) rotate(180deg); }\n        }\n      "})]})},Oy=t=>{let{children:n}=t;return(0,e.useEffect)(()=>{Ay.isAuthenticated()||gy.warning("Vui l\xf2ng \u0111\u0103ng nh\u1eadp \u0111\u1ec3 truy c\u1eadp trang n\xe0y!")},[]),Ay.isAuthenticated()?n:(0,ky.jsx)(Re,{to:"/login",replace:!0})},Py=()=>(0,ky.jsxs)("div",{className:"container",style:{paddingTop:"2rem",paddingBottom:"2rem"},children:[(0,ky.jsx)("div",{className:"card text-center fade-in",style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",border:"none",marginBottom:"3rem"},children:(0,ky.jsxs)("div",{style:{padding:"3rem 2rem"},children:[(0,ky.jsx)("h1",{className:"text-xl",style:{marginBottom:"1rem",fontSize:"3rem",fontWeight:"bold"},children:"Ki\u1ec3m Nguy\xean Li\u1ec7u"}),(0,ky.jsx)("p",{className:"text-lg",style:{marginBottom:"2rem",opacity:.9,maxWidth:"600px",margin:"0 auto 2rem auto"},children:"C\xf4ng c\u1ee5 qu\u1ea3n l\xfd nguy\xean li\u1ec7u v\xe0 c\xf4ng th\u1ee9c chuy\xean nghi\u1ec7p cho qu\xe1n cafe"}),(0,ky.jsxs)("div",{className:"flex flex-center gap-2",style:{flexWrap:"wrap"},children:[(0,ky.jsx)(mt,{to:"/inventory",className:"btn btn-primary btn-lg",children:"\ud83d\udcca Ki\u1ec3m K\xea Nguy\xean Li\u1ec7u"}),(0,ky.jsx)(mt,{to:"/recipes",className:"btn btn-success btn-lg",children:"\ud83d\udcdd Qu\u1ea3n L\xfd C\xf4ng Th\u1ee9c"}),(0,ky.jsx)(mt,{to:"/ingredients",className:"btn btn-warning btn-lg",children:"\ud83e\udd64 Qu\u1ea3n L\xfd Nguy\xean Li\u1ec7u"})]})]})}),(0,ky.jsxs)("div",{className:"grid grid-3",style:{marginBottom:"3rem"},children:[(0,ky.jsxs)("div",{className:"card text-center fade-in",children:[(0,ky.jsx)("div",{style:{fontSize:"3rem",marginBottom:"1rem"},children:"\ud83d\udcca"}),(0,ky.jsx)("h3",{className:"text-lg font-bold mb-2",children:"Ki\u1ec3m K\xea Th\xf4ng Minh"}),(0,ky.jsx)("p",{className:"text-muted",children:"Theo d\xf5i s\u1ed1 l\u01b0\u1ee3ng b\xe1n h\xe0ng v\xe0 t\xednh to\xe1n nguy\xean li\u1ec7u \u0111\xe3 s\u1eed d\u1ee5ng m\u1ed9t c\xe1ch ch\xednh x\xe1c"})]}),(0,ky.jsxs)("div",{className:"card text-center fade-in",children:[(0,ky.jsx)("div",{style:{fontSize:"3rem",marginBottom:"1rem"},children:"\ud83d\udcdd"}),(0,ky.jsx)("h3",{className:"text-lg font-bold mb-2",children:"Qu\u1ea3n L\xfd C\xf4ng Th\u1ee9c"}),(0,ky.jsx)("p",{className:"text-muted",children:"T\u1ea1o v\xe0 ch\u1ec9nh s\u1eeda c\xf4ng th\u1ee9c cho t\u1eebng m\xf3n v\u1edbi giao di\u1ec7n tr\u1ef1c quan, d\u1ec5 s\u1eed d\u1ee5ng"})]}),(0,ky.jsxs)("div",{className:"card text-center fade-in",children:[(0,ky.jsx)("div",{style:{fontSize:"3rem",marginBottom:"1rem"},children:"\ud83d\udcb0"}),(0,ky.jsx)("h3",{className:"text-lg font-bold mb-2",children:"T\xednh To\xe1n Doanh Thu"}),(0,ky.jsx)("p",{className:"text-muted",children:"T\u1ef1 \u0111\u1ed9ng t\xednh to\xe1n t\u1ed5ng doanh thu v\xe0 chi ph\xed nguy\xean li\u1ec7u theo t\u1eebng ng\xe0y"})]})]}),(0,ky.jsxs)("div",{className:"card fade-in",style:{background:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)",color:"white",border:"none"},children:[(0,ky.jsx)("div",{className:"text-center mb-3",children:(0,ky.jsx)("h2",{className:"text-xl font-bold",children:"Th\u1ed1ng K\xea H\u1ec7 Th\u1ed1ng"})}),(0,ky.jsxs)("div",{className:"grid grid-4 text-center",children:[(0,ky.jsxs)("div",{children:[(0,ky.jsx)("div",{className:"text-lg font-bold",children:"25"}),(0,ky.jsx)("div",{className:"text-sm",style:{opacity:.9},children:"M\xf3n \u0110\u1ed3 U\u1ed1ng"})]}),(0,ky.jsxs)("div",{children:[(0,ky.jsx)("div",{className:"text-lg font-bold",children:"26"}),(0,ky.jsx)("div",{className:"text-sm",style:{opacity:.9},children:"Nguy\xean Li\u1ec7u"})]}),(0,ky.jsxs)("div",{children:[(0,ky.jsx)("div",{className:"text-lg font-bold",children:"25"}),(0,ky.jsx)("div",{className:"text-sm",style:{opacity:.9},children:"C\xf4ng Th\u1ee9c"})]}),(0,ky.jsxs)("div",{children:[(0,ky.jsx)("div",{className:"text-lg font-bold",children:"100%"}),(0,ky.jsx)("div",{className:"text-sm",style:{opacity:.9},children:"T\u1ef1 \u0110\u1ed9ng H\xf3a"})]})]})]}),(0,ky.jsxs)("div",{className:"card fade-in",children:[(0,ky.jsx)("h3",{className:"text-lg font-bold mb-3 text-center",children:"Thao T\xe1c Nhanh"}),(0,ky.jsxs)("div",{className:"grid grid-3 gap-2",children:[(0,ky.jsx)(mt,{to:"/inventory",className:"btn btn-primary",children:"\ud83d\udcca Xem Ki\u1ec3m K\xea H\xf4m Nay"}),(0,ky.jsx)(mt,{to:"/recipes",className:"btn btn-success",children:"\ud83d\udcdd Ch\u1ec9nh S\u1eeda C\xf4ng Th\u1ee9c"}),(0,ky.jsx)(mt,{to:"/ingredients",className:"btn btn-warning",children:"\ud83e\udd64 Qu\u1ea3n L\xfd Nguy\xean Li\u1ec7u"})]})]})]});var Dy={version:"0.18.5"},Ly=1200,My=1252,Fy=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Uy={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},jy=function(e){-1!=Fy.indexOf(e)&&(My=Uy[0]=e)};var Vy=function(e){Ly=e,jy(e)};function zy(){Vy(1200),jy(1252)}function By(e){for(var t=[],n=0,r=e.length;n<r;++n)t[n]=e.charCodeAt(n);return t}function Hy(e){for(var t=[],n=0;n<e.length>>1;++n)t[n]=String.fromCharCode(e.charCodeAt(2*n+1)+(e.charCodeAt(2*n)<<8));return t.join("")}var Wy,Gy=function(e){var t=e.charCodeAt(0),n=e.charCodeAt(1);return 255==t&&254==n?function(e){for(var t=[],n=0;n<e.length>>1;++n)t[n]=String.fromCharCode(e.charCodeAt(2*n)+(e.charCodeAt(2*n+1)<<8));return t.join("")}(e.slice(2)):254==t&&255==n?Hy(e.slice(2)):65279==t?e.slice(1):e},Ky=function(e){return String.fromCharCode(e)},qy=function(e){return String.fromCharCode(e)};var $y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Xy(e){for(var t="",n=0,r=0,a=0,i=0,s=0,o=0,l=0,c=0;c<e.length;)i=(n=e.charCodeAt(c++))>>2,s=(3&n)<<4|(r=e.charCodeAt(c++))>>4,o=(15&r)<<2|(a=e.charCodeAt(c++))>>6,l=63&a,isNaN(r)?o=l=64:isNaN(a)&&(l=64),t+=$y.charAt(i)+$y.charAt(s)+$y.charAt(o)+$y.charAt(l);return t}function Yy(e){var t="",n=0,r=0,a=0,i=0,s=0,o=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<e.length;)n=$y.indexOf(e.charAt(l++))<<2|(i=$y.indexOf(e.charAt(l++)))>>4,t+=String.fromCharCode(n),r=(15&i)<<4|(s=$y.indexOf(e.charAt(l++)))>>2,64!==s&&(t+=String.fromCharCode(r)),a=(3&s)<<6|(o=$y.indexOf(e.charAt(l++))),64!==o&&(t+=String.fromCharCode(a));return t}var Qy=function(){return"undefined"!==typeof Buffer&&"undefined"!==typeof process&&"undefined"!==typeof process.versions&&!!process.versions.node}(),Jy=function(){if("undefined"!==typeof Buffer){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch(AR){e=!0}return e?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Zy(e){return Qy?Buffer.alloc?Buffer.alloc(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}function eb(e){return Qy?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}var tb=function(e){return Qy?Jy(e,"binary"):e.split("").map(function(e){return 255&e.charCodeAt(0)})};function nb(e){if("undefined"===typeof ArrayBuffer)return tb(e);for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r!=e.length;++r)n[r]=255&e.charCodeAt(r);return t}function rb(e){if(Array.isArray(e))return e.map(function(e){return String.fromCharCode(e)}).join("");for(var t=[],n=0;n<e.length;++n)t[n]=String.fromCharCode(e[n]);return t.join("")}function ab(e){if("undefined"==typeof ArrayBuffer)throw new Error("Unsupported");if(e instanceof ArrayBuffer)return ab(new Uint8Array(e));for(var t=new Array(e.length),n=0;n<e.length;++n)t[n]=e[n];return t}var ib=Qy?function(e){return Buffer.concat(e.map(function(e){return Buffer.isBuffer(e)?e:Jy(e)}))}:function(e){if("undefined"!==typeof Uint8Array){var t=0,n=0;for(t=0;t<e.length;++t)n+=e[t].length;var r=new Uint8Array(n),a=0;for(t=0,n=0;t<e.length;n+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)r.set(e[t],n);else{if("string"==typeof e[t])throw"wtf";r.set(new Uint8Array(e[t]),n)}return r}return[].concat.apply([],e.map(function(e){return Array.isArray(e)?e:[].slice.call(e)}))};var sb=/\u0000/g,ob=/[\u0001-\u0006]/g;function lb(e){for(var t="",n=e.length-1;n>=0;)t+=e.charAt(n--);return t}function cb(e,t){var n=""+e;return n.length>=t?n:Ew("0",t-n.length)+n}function ub(e,t){var n=""+e;return n.length>=t?n:Ew(" ",t-n.length)+n}function hb(e,t){var n=""+e;return n.length>=t?n:n+Ew(" ",t-n.length)}var fb=Math.pow(2,32);function db(e,t){return e>fb||e<-fb?function(e,t){var n=""+Math.round(e);return n.length>=t?n:Ew("0",t-n.length)+n}(e,t):function(e,t){var n=""+e;return n.length>=t?n:Ew("0",t-n.length)+n}(Math.round(e),t)}function pb(e,t){return t=t||0,e.length>=7+t&&103===(32|e.charCodeAt(t))&&101===(32|e.charCodeAt(t+1))&&110===(32|e.charCodeAt(t+2))&&101===(32|e.charCodeAt(t+3))&&114===(32|e.charCodeAt(t+4))&&97===(32|e.charCodeAt(t+5))&&108===(32|e.charCodeAt(t+6))}var mb=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],gb=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];var vb={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "'},yb={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},bb={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function wb(e,t,n){for(var r=e<0?-1:1,a=e*r,i=0,s=1,o=0,l=1,c=0,u=0,h=Math.floor(a);c<t&&(o=(h=Math.floor(a))*s+i,u=h*c+l,!(a-h<5e-8));)a=1/(a-h),i=s,s=o,l=c,c=u;if(u>t&&(c>t?(u=l,o=i):(u=c,o=s)),!n)return[0,r*o,u];var f=Math.floor(r*o/u);return[f,r*o-f*u,u]}function Tb(e,t,n){if(e>2958465||e<0)return null;var r=0|e,a=Math.floor(86400*(e-r)),i=0,s=[],o={D:r,T:a,u:86400*(e-r)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(r+=1462),o.u>.9999&&(o.u=0,86400==++a&&(o.T=a=0,++r,++o.D)),60===r)s=n?[1317,10,29]:[1900,2,29],i=3;else if(0===r)s=n?[1317,8,29]:[1900,1,0],i=6;else{r>60&&--r;var l=new Date(1900,0,1);l.setDate(l.getDate()+r-1),s=[l.getFullYear(),l.getMonth()+1,l.getDate()],i=l.getDay(),r<60&&(i=(i+6)%7),n&&(i=function(e,t){t[0]-=581;var n=e.getDay();e<60&&(n=(n+6)%7);return n}(l,s))}return o.y=s[0],o.m=s[1],o.d=s[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=i,o}var Sb=new Date(1899,11,31,0,0,0),Eb=Sb.getTime(),kb=new Date(1900,2,1,0,0,0);function _b(e,t){var n=e.getTime();return t?n-=1262304e5:e>=kb&&(n+=864e5),(n-(Eb+6e4*(e.getTimezoneOffset()-Sb.getTimezoneOffset())))/864e5}function xb(e){return-1==e.indexOf(".")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Cb(e){var t,n=Math.floor(Math.log(Math.abs(e))*Math.LOG10E);return t=n>=-4&&n<=-1?e.toPrecision(10+n):Math.abs(n)<=9?function(e){var t=e<0?12:11,n=xb(e.toFixed(12));return n.length<=t||(n=e.toPrecision(10)).length<=t?n:e.toExponential(5)}(e):10===n?e.toFixed(10).substr(0,12):function(e){var t=xb(e.toFixed(11));return t.length>(e<0?12:11)||"0"===t||"-0"===t?e.toPrecision(6):t}(e),xb(function(e){return-1==e.indexOf("E")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}(t.toUpperCase()))}function Ib(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(0|e)===e?e.toString(10):Cb(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return Xb(14,_b(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Ab(e,t,n,r){var a,i="",s=0,o=0,l=n.y,c=0;switch(e){case 98:l=n.y+543;case 121:switch(t.length){case 1:case 2:a=l%100,c=2;break;default:a=l%1e4,c=4}break;case 109:switch(t.length){case 1:case 2:a=n.m,c=t.length;break;case 3:return gb[n.m-1][1];case 5:return gb[n.m-1][0];default:return gb[n.m-1][2]}break;case 100:switch(t.length){case 1:case 2:a=n.d,c=t.length;break;case 3:return mb[n.q][0];default:return mb[n.q][1]}break;case 104:switch(t.length){case 1:case 2:a=1+(n.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:a=n.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:a=n.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if("s"!=t&&"ss"!=t&&".0"!=t&&".00"!=t&&".000"!=t)throw"bad second format: "+t;return 0!==n.u||"s"!=t&&"ss"!=t?(o=r>=2?3===r?1e3:100:1===r?10:1,(s=Math.round(o*(n.S+n.u)))>=60*o&&(s=0),"s"===t?0===s?"0":""+s/o:(i=cb(s,2+r),"ss"===t?i.substr(0,2):"."+i.substr(2,t.length-1))):cb(n.S,t.length);case 90:switch(t){case"[h]":case"[hh]":a=24*n.D+n.H;break;case"[m]":case"[mm]":a=60*(24*n.D+n.H)+n.M;break;case"[s]":case"[ss]":a=60*(60*(24*n.D+n.H)+n.M)+Math.round(n.S+n.u);break;default:throw"bad abstime format: "+t}c=3===t.length?1:2;break;case 101:a=l,c=1}return c>0?cb(a,c):""}function Nb(e){if(e.length<=3)return e;for(var t=e.length%3,n=e.substr(0,t);t!=e.length;t+=3)n+=(n.length>0?",":"")+e.substr(t,3);return n}var Rb=/%/g;function Ob(e,t){var n,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+Ob(e,-t);var a=e.indexOf(".");-1===a&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),-1===(n=(t/Math.pow(10,i)).toPrecision(r+1+(a+i)%a)).indexOf("e")){var s=Math.floor(Math.log(t)*Math.LOG10E);for(-1===n.indexOf(".")?n=n.charAt(0)+"."+n.substr(1)+"E+"+(s-n.length+i):n+="E+"+(s-i);"0."===n.substr(0,2);)n=(n=n.charAt(0)+n.substr(2,a)+"."+n.substr(2+a)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,n,r){return t+n+r.substr(0,(a+i)%a)+"."+r.substr(i)+"E"})}else n=t.toExponential(r);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}var Pb=/# (\?+)( ?)\/( ?)(\d+)/;var Db=/^#*0*\.([0#]+)/,Lb=/\).*[0#]/,Mb=/\(###\) ###\\?-####/;function Fb(e){for(var t,n="",r=0;r!=e.length;++r)switch(t=e.charCodeAt(r)){case 35:break;case 63:n+=" ";break;case 48:n+="0";break;default:n+=String.fromCharCode(t)}return n}function Ub(e,t){var n=Math.pow(10,t);return""+Math.round(e*n)/n}function jb(e,t){var n=e-Math.floor(e),r=Math.pow(10,t);return t<(""+Math.round(n*r)).length?0:Math.round(n*r)}function Vb(e,t,n){if(40===e.charCodeAt(0)&&!t.match(Lb)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?Vb("n",r,n):"("+Vb("n",r,-n)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,n){for(var r=t.length-1;44===t.charCodeAt(r-1);)--r;return Hb(e,t.substr(0,r),n/Math.pow(10,3*(t.length-r)))}(e,t,n);if(-1!==t.indexOf("%"))return function(e,t,n){var r=t.replace(Rb,""),a=t.length-r.length;return Hb(e,r,n*Math.pow(10,2*a))+Ew("%",a)}(e,t,n);if(-1!==t.indexOf("E"))return Ob(t,n);if(36===t.charCodeAt(0))return"$"+Vb(e,t.substr(" "==t.charAt(1)?2:1),n);var a,i,s,o,l=Math.abs(n),c=n<0?"-":"";if(t.match(/^00+$/))return c+db(l,t.length);if(t.match(/^[#?]+$/))return"0"===(a=db(n,0))&&(a=""),a.length>t.length?a:Fb(t.substr(0,t.length-a.length))+a;if(i=t.match(Pb))return function(e,t,n){var r=parseInt(e[4],10),a=Math.round(t*r),i=Math.floor(a/r),s=a-i*r,o=r;return n+(0===i?"":""+i)+" "+(0===s?Ew(" ",e[1].length+1+e[4].length):ub(s,e[1].length)+e[2]+"/"+e[3]+cb(o,e[4].length))}(i,l,c);if(t.match(/^#+0+$/))return c+db(l,t.length-t.indexOf("0"));if(i=t.match(Db))return a=Ub(n,i[1].length).replace(/^([^\.]+)$/,"$1."+Fb(i[1])).replace(/\.$/,"."+Fb(i[1])).replace(/\.(\d*)$/,function(e,t){return"."+t+Ew("0",Fb(i[1]).length-t.length)}),-1!==t.indexOf("0.")?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return c+Ub(l,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return c+Nb(db(l,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+Vb(e,t,-n):Nb(""+(Math.floor(n)+function(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}(n,i[1].length)))+"."+cb(jb(n,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return Vb(e,t.replace(/^#,#*,/,""),n);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=lb(Vb(e,t.replace(/[\\-]/g,""),n)),s=0,lb(lb(t.replace(/\\/g,"")).replace(/[0#]/g,function(e){return s<a.length?a.charAt(s++):"0"===e?"0":""}));if(t.match(Mb))return"("+(a=Vb(e,"##########",n)).substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=wb(l,Math.pow(10,s)-1,!1),a=""+c," "==(u=Hb("n",i[1],o[1])).charAt(u.length-1)&&(u=u.substr(0,u.length-1)+"0"),a+=u+i[2]+"/"+i[3],(u=hb(o[2],s)).length<i[4].length&&(u=Fb(i[4].substr(i[4].length-u.length))+u),a+=u;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),c+((o=wb(l,Math.pow(10,s)-1,!0))[0]||(o[1]?"":"0"))+" "+(o[1]?ub(o[1],s)+i[2]+"/"+i[3]+hb(o[2],s):Ew(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=db(n,0),t.length<=a.length?a:Fb(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+n.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var h=t.indexOf(".")-s,f=t.length-a.length-h;return Fb(t.substr(0,h)+a+t.substr(t.length-f))}if(i=t.match(/^00,000\.([#0]*0)$/))return s=jb(n,i[1].length),n<0?"-"+Vb(e,t,-n):Nb(function(e){return e<2147483647&&e>-2147483648?""+(e>=0?0|e:e-1|0):""+Math.floor(e)}(n)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?cb(0,3-e.length):"")+e})+"."+cb(s,i[1].length);switch(t){case"###,##0.00":return Vb(e,"#,##0.00",n);case"###,###":case"##,###":case"#,###":var d=Nb(db(l,0));return"0"!==d?c+d:"";case"###,###.00":return Vb(e,"###,##0.00",n).replace(/^0\./,".");case"#,###.00":return Vb(e,"#,##0.00",n).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function zb(e,t){var n,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+zb(e,-t);var a=e.indexOf(".");-1===a&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),!(n=(t/Math.pow(10,i)).toPrecision(r+1+(a+i)%a)).match(/[Ee]/)){var s=Math.floor(Math.log(t)*Math.LOG10E);-1===n.indexOf(".")?n=n.charAt(0)+"."+n.substr(1)+"E+"+(s-n.length+i):n+="E+"+(s-i),n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,n,r){return t+n+r.substr(0,(a+i)%a)+"."+r.substr(i)+"E"})}else n=t.toExponential(r);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}function Bb(e,t,n){if(40===e.charCodeAt(0)&&!t.match(Lb)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?Bb("n",r,n):"("+Bb("n",r,-n)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,n){for(var r=t.length-1;44===t.charCodeAt(r-1);)--r;return Hb(e,t.substr(0,r),n/Math.pow(10,3*(t.length-r)))}(e,t,n);if(-1!==t.indexOf("%"))return function(e,t,n){var r=t.replace(Rb,""),a=t.length-r.length;return Hb(e,r,n*Math.pow(10,2*a))+Ew("%",a)}(e,t,n);if(-1!==t.indexOf("E"))return zb(t,n);if(36===t.charCodeAt(0))return"$"+Bb(e,t.substr(" "==t.charAt(1)?2:1),n);var a,i,s,o,l=Math.abs(n),c=n<0?"-":"";if(t.match(/^00+$/))return c+cb(l,t.length);if(t.match(/^[#?]+$/))return a=""+n,0===n&&(a=""),a.length>t.length?a:Fb(t.substr(0,t.length-a.length))+a;if(i=t.match(Pb))return function(e,t,n){return n+(0===t?"":""+t)+Ew(" ",e[1].length+2+e[4].length)}(i,l,c);if(t.match(/^#+0+$/))return c+cb(l,t.length-t.indexOf("0"));if(i=t.match(Db))return a=(a=(""+n).replace(/^([^\.]+)$/,"$1."+Fb(i[1])).replace(/\.$/,"."+Fb(i[1]))).replace(/\.(\d*)$/,function(e,t){return"."+t+Ew("0",Fb(i[1]).length-t.length)}),-1!==t.indexOf("0.")?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return c+Nb(""+l);if(i=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+Bb(e,t,-n):Nb(""+n)+"."+Ew("0",i[1].length);if(i=t.match(/^#,#*,#0/))return Bb(e,t.replace(/^#,#*,/,""),n);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=lb(Bb(e,t.replace(/[\\-]/g,""),n)),s=0,lb(lb(t.replace(/\\/g,"")).replace(/[0#]/g,function(e){return s<a.length?a.charAt(s++):"0"===e?"0":""}));if(t.match(Mb))return"("+(a=Bb(e,"##########",n)).substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=wb(l,Math.pow(10,s)-1,!1),a=""+c," "==(u=Hb("n",i[1],o[1])).charAt(u.length-1)&&(u=u.substr(0,u.length-1)+"0"),a+=u+i[2]+"/"+i[3],(u=hb(o[2],s)).length<i[4].length&&(u=Fb(i[4].substr(i[4].length-u.length))+u),a+=u;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),c+((o=wb(l,Math.pow(10,s)-1,!0))[0]||(o[1]?"":"0"))+" "+(o[1]?ub(o[1],s)+i[2]+"/"+i[3]+hb(o[2],s):Ew(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=""+n,t.length<=a.length?a:Fb(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0]+)\.([#0]+)$/)){a=""+n.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var h=t.indexOf(".")-s,f=t.length-a.length-h;return Fb(t.substr(0,h)+a+t.substr(t.length-f))}if(i=t.match(/^00,000\.([#0]*0)$/))return n<0?"-"+Bb(e,t,-n):Nb(""+n).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?cb(0,3-e.length):"")+e})+"."+cb(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var d=Nb(""+l);return"0"!==d?c+d:"";default:if(t.match(/\.[0#?]*$/))return Bb(e,t.slice(0,t.lastIndexOf(".")),n)+Fb(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Hb(e,t,n){return(0|n)===n?Bb(e,t,n):Vb(e,t,n)}var Wb=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Gb(e){for(var t=0,n="",r="";t<e.length;)switch(n=e.charAt(t)){case"G":pb(e,t)&&(t+=6),t++;break;case'"':for(;34!==e.charCodeAt(++t)&&t<e.length;);++t;break;case"\\":case"_":t+=2;break;case"@":++t;break;case"B":case"b":if("1"===e.charAt(t+1)||"2"===e.charAt(t+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4e0a":if("A/P"===e.substr(t,3).toUpperCase())return!0;if("AM/PM"===e.substr(t,5).toUpperCase())return!0;if("\u4e0a\u5348/\u4e0b\u5348"===e.substr(t,5).toUpperCase())return!0;++t;break;case"[":for(r=n;"]"!==e.charAt(t++)&&t<e.length;)r+=e.charAt(t);if(r.match(Wb))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(n=e.charAt(++t))>-1||"\\"==n&&"-"==e.charAt(t+1)&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===n;);break;case"*":++t," "!=e.charAt(t)&&"*"!=e.charAt(t)||++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;default:++t}return!1}var Kb=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function qb(e,t){if(null==t)return!1;var n=parseFloat(t[2]);switch(t[1]){case"=":if(e==n)return!0;break;case">":if(e>n)return!0;break;case"<":if(e<n)return!0;break;case"<>":if(e!=n)return!0;break;case">=":if(e>=n)return!0;break;case"<=":if(e<=n)return!0}return!1}function $b(e,t){var n=function(e){for(var t=[],n=!1,r=0,a=0;r<e.length;++r)switch(e.charCodeAt(r)){case 34:n=!n;break;case 95:case 42:case 92:++r;break;case 59:t[t.length]=e.substr(a,r-a),a=r+1}if(t[t.length]=e.substr(a),!0===n)throw new Error("Format |"+e+"| unterminated string ");return t}(e),r=n.length,a=n[r-1].indexOf("@");if(r<4&&a>-1&&--r,n.length>4)throw new Error("cannot find right format for |"+n.join("|")+"|");if("number"!==typeof t)return[4,4===n.length||a>-1?n[n.length-1]:"@"];switch(n.length){case 1:n=a>-1?["General","General","General",n[0]]:[n[0],n[0],n[0],"@"];break;case 2:n=a>-1?[n[0],n[0],n[0],n[1]]:[n[0],n[1],n[0],"@"];break;case 3:n=a>-1?[n[0],n[1],n[0],n[2]]:[n[0],n[1],n[2],"@"]}var i=t>0?n[0]:t<0?n[1]:n[2];if(-1===n[0].indexOf("[")&&-1===n[1].indexOf("["))return[r,i];if(null!=n[0].match(/\[[=<>]/)||null!=n[1].match(/\[[=<>]/)){var s=n[0].match(Kb),o=n[1].match(Kb);return qb(t,s)?[r,n[0]]:qb(t,o)?[r,n[1]]:[r,n[null!=s&&null!=o?2:1]]}return[r,i]}function Xb(e,t,n){null==n&&(n={});var r="";switch(typeof e){case"string":r="m/d/yy"==e&&n.dateNF?n.dateNF:e;break;case"number":null==(r=14==e&&n.dateNF?n.dateNF:(null!=n.table?n.table:vb)[e])&&(r=n.table&&n.table[yb[e]]||vb[yb[e]]),null==r&&(r=bb[e]||"General")}if(pb(r,0))return Ib(t,n);t instanceof Date&&(t=_b(t,n.date1904));var a=$b(r,t);if(pb(a[1]))return Ib(t,n);if(!0===t)t="TRUE";else if(!1===t)t="FALSE";else if(""===t||null==t)return"";return function(e,t,n,r){for(var a,i,s,o=[],l="",c=0,u="",h="t",f="H";c<e.length;)switch(u=e.charAt(c)){case"G":if(!pb(e,c))throw new Error("unrecognized character "+u+" in "+e);o[o.length]={t:"G",v:"General"},c+=7;break;case'"':for(l="";34!==(s=e.charCodeAt(++c))&&c<e.length;)l+=String.fromCharCode(s);o[o.length]={t:"t",v:l},++c;break;case"\\":var d=e.charAt(++c),p="("===d||")"===d?d:"t";o[o.length]={t:p,v:d},++c;break;case"_":o[o.length]={t:"t",v:" "},c+=2;break;case"@":o[o.length]={t:"T",v:t},++c;break;case"B":case"b":if("1"===e.charAt(c+1)||"2"===e.charAt(c+1)){if(null==a&&null==(a=Tb(t,n,"2"===e.charAt(c+1))))return"";o[o.length]={t:"X",v:e.substr(c,2)},h=u,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0)return"";if(null==a&&null==(a=Tb(t,n)))return"";for(l=u;++c<e.length&&e.charAt(c).toLowerCase()===u;)l+=u;"m"===u&&"h"===h.toLowerCase()&&(u="M"),"h"===u&&(u=f),o[o.length]={t:u,v:l},h=u;break;case"A":case"a":case"\u4e0a":var m={t:u,v:u};if(null==a&&(a=Tb(t,n)),"A/P"===e.substr(c,3).toUpperCase()?(null!=a&&(m.v=a.H>=12?"P":"A"),m.t="T",f="h",c+=3):"AM/PM"===e.substr(c,5).toUpperCase()?(null!=a&&(m.v=a.H>=12?"PM":"AM"),m.t="T",c+=5,f="h"):"\u4e0a\u5348/\u4e0b\u5348"===e.substr(c,5).toUpperCase()?(null!=a&&(m.v=a.H>=12?"\u4e0b\u5348":"\u4e0a\u5348"),m.t="T",c+=5,f="h"):(m.t="t",++c),null==a&&"T"===m.t)return"";o[o.length]=m,h=u;break;case"[":for(l=u;"]"!==e.charAt(c++)&&c<e.length;)l+=e.charAt(c);if("]"!==l.slice(-1))throw'unterminated "[" block: |'+l+"|";if(l.match(Wb)){if(null==a&&null==(a=Tb(t,n)))return"";o[o.length]={t:"Z",v:l.toLowerCase()},h=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",Gb(e)||(o[o.length]={t:"t",v:l}));break;case".":if(null!=a){for(l=u;++c<e.length&&"0"===(u=e.charAt(c));)l+=u;o[o.length]={t:"s",v:l};break}case"0":case"#":for(l=u;++c<e.length&&"0#?.,E+-%".indexOf(u=e.charAt(c))>-1;)l+=u;o[o.length]={t:"n",v:l};break;case"?":for(l=u;e.charAt(++c)===u;)l+=u;o[o.length]={t:u,v:l},h=u;break;case"*":++c," "!=e.charAt(c)&&"*"!=e.charAt(c)||++c;break;case"(":case")":o[o.length]={t:1===r?"t":u,v:u},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=u;c<e.length&&"0123456789".indexOf(e.charAt(++c))>-1;)l+=e.charAt(c);o[o.length]={t:"D",v:l};break;case" ":o[o.length]={t:u,v:u},++c;break;case"$":o[o.length]={t:"t",v:"$"},++c;break;default:if(-1===",$-+/():!^&'~{}<>=\u20acacfijklopqrtuvwxzP".indexOf(u))throw new Error("unrecognized character "+u+" in "+e);o[o.length]={t:"t",v:u},++c}var g,v=0,y=0;for(c=o.length-1,h="t";c>=0;--c)switch(o[c].t){case"h":case"H":o[c].t=f,h="h",v<1&&(v=1);break;case"s":(g=o[c].v.match(/\.0+$/))&&(y=Math.max(y,g[0].length-1)),v<3&&(v=3);case"d":case"y":case"M":case"e":h=o[c].t;break;case"m":"s"===h&&(o[c].t="M",v<2&&(v=2));break;case"X":break;case"Z":v<1&&o[c].v.match(/[Hh]/)&&(v=1),v<2&&o[c].v.match(/[Mm]/)&&(v=2),v<3&&o[c].v.match(/[Ss]/)&&(v=3)}switch(v){case 0:break;case 1:a.u>=.5&&(a.u=0,++a.S),a.S>=60&&(a.S=0,++a.M),a.M>=60&&(a.M=0,++a.H);break;case 2:a.u>=.5&&(a.u=0,++a.S),a.S>=60&&(a.S=0,++a.M)}var b,w="";for(c=0;c<o.length;++c)switch(o[c].t){case"t":case"T":case" ":case"D":break;case"X":o[c].v="",o[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":o[c].v=Ab(o[c].t.charCodeAt(0),o[c].v,a,y),o[c].t="t";break;case"n":case"?":for(b=c+1;null!=o[b]&&("?"===(u=o[b].t)||"D"===u||(" "===u||"t"===u)&&null!=o[b+1]&&("?"===o[b+1].t||"t"===o[b+1].t&&"/"===o[b+1].v)||"("===o[c].t&&(" "===u||"n"===u||")"===u)||"t"===u&&("/"===o[b].v||" "===o[b].v&&null!=o[b+1]&&"?"==o[b+1].t));)o[c].v+=o[b].v,o[b]={v:"",t:";"},++b;w+=o[c].v,c=b-1;break;case"G":o[c].t="t",o[c].v=Ib(t,n)}var T,S,E="";if(w.length>0){40==w.charCodeAt(0)?(T=t<0&&45===w.charCodeAt(0)?-t:t,S=Hb("n",w,T)):(S=Hb("n",w,T=t<0&&r>1?-t:t),T<0&&o[0]&&"t"==o[0].t&&(S=S.substr(1),o[0].v="-"+o[0].v)),b=S.length-1;var k=o.length;for(c=0;c<o.length;++c)if(null!=o[c]&&"t"!=o[c].t&&o[c].v.indexOf(".")>-1){k=c;break}var _=o.length;if(k===o.length&&-1===S.indexOf("E")){for(c=o.length-1;c>=0;--c)null!=o[c]&&-1!=="n?".indexOf(o[c].t)&&(b>=o[c].v.length-1?(b-=o[c].v.length,o[c].v=S.substr(b+1,o[c].v.length)):b<0?o[c].v="":(o[c].v=S.substr(0,b+1),b=-1),o[c].t="t",_=c);b>=0&&_<o.length&&(o[_].v=S.substr(0,b+1)+o[_].v)}else if(k!==o.length&&-1===S.indexOf("E")){for(b=S.indexOf(".")-1,c=k;c>=0;--c)if(null!=o[c]&&-1!=="n?".indexOf(o[c].t)){for(i=o[c].v.indexOf(".")>-1&&c===k?o[c].v.indexOf(".")-1:o[c].v.length-1,E=o[c].v.substr(i+1);i>=0;--i)b>=0&&("0"===o[c].v.charAt(i)||"#"===o[c].v.charAt(i))&&(E=S.charAt(b--)+E);o[c].v=E,o[c].t="t",_=c}for(b>=0&&_<o.length&&(o[_].v=S.substr(0,b+1)+o[_].v),b=S.indexOf(".")+1,c=k;c<o.length;++c)if(null!=o[c]&&(-1!=="n?(".indexOf(o[c].t)||c===k)){for(i=o[c].v.indexOf(".")>-1&&c===k?o[c].v.indexOf(".")+1:0,E=o[c].v.substr(0,i);i<o[c].v.length;++i)b<S.length&&(E+=S.charAt(b++));o[c].v=E,o[c].t="t",_=c}}}for(c=0;c<o.length;++c)null!=o[c]&&"n?".indexOf(o[c].t)>-1&&(T=r>1&&t<0&&c>0&&"-"===o[c-1].v?-t:t,o[c].v=Hb(o[c].t,o[c].v,T),o[c].t="t");var x="";for(c=0;c!==o.length;++c)null!=o[c]&&(x+=o[c].v);return x}(a[1],t,n,a[0])}function Yb(e,t){if("number"!=typeof t){t=+t||-1;for(var n=0;n<392;++n)if(void 0!=vb[n]){if(vb[n]==e){t=n;break}}else t<0&&(t=n);t<0&&(t=391)}return vb[t]=e,t}function Qb(e){for(var t=0;392!=t;++t)void 0!==e[t]&&Yb(e[t],t)}function Jb(){var e;e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "',vb=e}var Zb={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},ew=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;var tw=function(){var e={};e.version="1.2.0";var t=function(){for(var e=0,t=new Array(256),n=0;256!=n;++n)e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=n)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1,t[n]=e;return"undefined"!==typeof Int32Array?new Int32Array(t):t}();var n=function(e){var t=0,n=0,r=0,a="undefined"!==typeof Int32Array?new Int32Array(4096):new Array(4096);for(r=0;256!=r;++r)a[r]=e[r];for(r=0;256!=r;++r)for(n=e[r],t=256+r;t<4096;t+=256)n=a[t]=n>>>8^e[255&n];var i=[];for(r=1;16!=r;++r)i[r-1]="undefined"!==typeof Int32Array?a.subarray(256*r,256*r+256):a.slice(256*r,256*r+256);return i}(t),r=n[0],a=n[1],i=n[2],s=n[3],o=n[4],l=n[5],c=n[6],u=n[7],h=n[8],f=n[9],d=n[10],p=n[11],m=n[12],g=n[13],v=n[14];return e.table=t,e.bstr=function(e,n){for(var r=-1^n,a=0,i=e.length;a<i;)r=r>>>8^t[255&(r^e.charCodeAt(a++))];return~r},e.buf=function(e,n){for(var y=-1^n,b=e.length-15,w=0;w<b;)y=v[e[w++]^255&y]^g[e[w++]^y>>8&255]^m[e[w++]^y>>16&255]^p[e[w++]^y>>>24]^d[e[w++]]^f[e[w++]]^h[e[w++]]^u[e[w++]]^c[e[w++]]^l[e[w++]]^o[e[w++]]^s[e[w++]]^i[e[w++]]^a[e[w++]]^r[e[w++]]^t[e[w++]];for(b+=15;w<b;)y=y>>>8^t[255&(y^e[w++])];return~y},e.str=function(e,n){for(var r=-1^n,a=0,i=e.length,s=0,o=0;a<i;)(s=e.charCodeAt(a++))<128?r=r>>>8^t[255&(r^s)]:s<2048?r=(r=r>>>8^t[255&(r^(192|s>>6&31))])>>>8^t[255&(r^(128|63&s))]:s>=55296&&s<57344?(s=64+(1023&s),o=1023&e.charCodeAt(a++),r=(r=(r=(r=r>>>8^t[255&(r^(240|s>>8&7))])>>>8^t[255&(r^(128|s>>2&63))])>>>8^t[255&(r^(128|o>>6&15|(3&s)<<4))])>>>8^t[255&(r^(128|63&o))]):r=(r=(r=r>>>8^t[255&(r^(224|s>>12&15))])>>>8^t[255&(r^(128|s>>6&63))])>>>8^t[255&(r^(128|63&s))];return~r},e}(),nw=function(){var e,t={};function n(e){if("/"==e.charAt(e.length-1))return-1===e.slice(0,-1).indexOf("/")?e:n(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(0,t+1)}function r(e){if("/"==e.charAt(e.length-1))return r(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(t+1)}function a(e,t){"string"===typeof t&&(t=new Date(t));var n=t.getHours();n=(n=n<<6|t.getMinutes())<<5|t.getSeconds()>>>1,e.write_shift(2,n);var r=t.getFullYear()-1980;r=(r=r<<4|t.getMonth()+1)<<5|t.getDate(),e.write_shift(2,r)}function i(e){_S(e,0);for(var t={},n=0;e.l<=e.length-4;){var r=e.read_shift(2),a=e.read_shift(2),i=e.l+a,s={};if(21589===r)1&(n=e.read_shift(1))&&(s.mtime=e.read_shift(4)),a>5&&(2&n&&(s.atime=e.read_shift(4)),4&n&&(s.ctime=e.read_shift(4))),s.mtime&&(s.mt=new Date(1e3*s.mtime));e.l=i,t[r]=s}return t}function s(){return e||(e={})}function o(e,t){if(80==e[0]&&75==e[1])return re(e,t);if(109==(32|e[0])&&105==(32|e[1]))return function(e,t){if("mime-version:"!=S(e.slice(0,13)).toLowerCase())throw new Error("Unsupported MAD header");var n=t&&t.root||"",r=(Qy&&Buffer.isBuffer(e)?e.toString("binary"):S(e)).split("\r\n"),a=0,i="";for(a=0;a<r.length;++a)if(i=r[a],/^Content-Location:/i.test(i)&&(i=i.slice(i.indexOf("file")),n||(n=i.slice(0,i.lastIndexOf("/")+1)),i.slice(0,n.length)!=n))for(;n.length>0&&(n=(n=n.slice(0,n.length-1)).slice(0,n.lastIndexOf("/")+1),i.slice(0,n.length)!=n););var s=(r[1]||"").match(/boundary="(.*?)"/);if(!s)throw new Error("MAD cannot find boundary");var o="--"+(s[1]||""),l=[],c=[],u={FileIndex:l,FullPaths:c};f(u);var h,d=0;for(a=0;a<r.length;++a){var p=r[a];p!==o&&p!==o+"--"||(d++&&ce(u,r.slice(h,a),n),h=a)}return u}(e,t);if(e.length<512)throw new Error("CFB file size "+e.length+" < 512");var n,r,a,i,s,o,d=512,p=[],m=e.slice(0,512);_S(m,0);var g=function(e){if(80==e[e.l]&&75==e[e.l+1])return[0,0];e.chk(y,"Header Signature: "),e.l+=16;var t=e.read_shift(2,"u");return[e.read_shift(2,"u"),t]}(m);switch(n=g[0]){case 3:d=512;break;case 4:d=4096;break;case 0:if(0==g[1])return re(e,t);default:throw new Error("Major Version: Expected 3 or 4 saw "+n)}512!==d&&_S(m=e.slice(0,d),28);var b=e.slice(0,d);!function(e,t){var n=9;switch(e.l+=2,n=e.read_shift(2)){case 9:if(3!=t)throw new Error("Sector Shift: Expected 9 saw "+n);break;case 12:if(4!=t)throw new Error("Sector Shift: Expected 12 saw "+n);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+n)}e.chk("0600","Mini Sector Shift: "),e.chk("000000000000","Reserved: ")}(m,n);var w=m.read_shift(4,"i");if(3===n&&0!==w)throw new Error("# Directory Sectors: Expected 0 saw "+w);m.l+=4,i=m.read_shift(4,"i"),m.l+=4,m.chk("00100000","Mini Stream Cutoff Size: "),s=m.read_shift(4,"i"),r=m.read_shift(4,"i"),o=m.read_shift(4,"i"),a=m.read_shift(4,"i");for(var T=-1,E=0;E<109&&!((T=m.read_shift(4,"i"))<0);++E)p[E]=T;var k=function(e,t){for(var n=Math.ceil(e.length/t)-1,r=[],a=1;a<n;++a)r[a-1]=e.slice(a*t,(a+1)*t);return r[n-1]=e.slice(n*t),r}(e,d);c(o,a,k,d,p);var _=function(e,t,n,r){var a=e.length,i=[],s=[],o=[],l=[],c=r-1,u=0,h=0,f=0,d=0;for(u=0;u<a;++u)if(o=[],(f=u+t)>=a&&(f-=a),!s[f]){l=[];var p=[];for(h=f;h>=0;){p[h]=!0,s[h]=!0,o[o.length]=h,l.push(e[h]);var m=n[Math.floor(4*h/r)];if(r<4+(d=4*h&c))throw new Error("FAT boundary crossed: "+h+" 4 "+r);if(!e[m])break;if(p[h=vS(e[m],d)])break}i[f]={nodes:o,data:KT([l])}}return i}(k,i,p,d);_[i].name="!Directory",r>0&&s!==v&&(_[s].name="!MiniFAT"),_[p[0]].name="!FAT",_.fat_addrs=p,_.ssz=d;var x=[],C=[],I=[];!function(e,t,n,r,a,i,s,o){for(var c,f=0,d=r.length?2:0,p=t[e].data,m=0,g=0;m<p.length;m+=128){var y=p.slice(m,m+128);_S(y,64),g=y.read_shift(2),c=$T(y,0,g-d),r.push(c);var b={name:c,type:y.read_shift(1),color:y.read_shift(1),L:y.read_shift(4,"i"),R:y.read_shift(4,"i"),C:y.read_shift(4,"i"),clsid:y.read_shift(16),state:y.read_shift(4,"i"),start:0,size:0};0!==y.read_shift(2)+y.read_shift(2)+y.read_shift(2)+y.read_shift(2)&&(b.ct=h(y,y.l-8)),0!==y.read_shift(2)+y.read_shift(2)+y.read_shift(2)+y.read_shift(2)&&(b.mt=h(y,y.l-8)),b.start=y.read_shift(4,"i"),b.size=y.read_shift(4,"i"),b.size<0&&b.start<0&&(b.size=b.type=0,b.start=v,b.name=""),5===b.type?(f=b.start,a>0&&f!==v&&(t[f].name="!StreamData")):b.size>=4096?(b.storage="fat",void 0===t[b.start]&&(t[b.start]=u(n,b.start,t.fat_addrs,t.ssz)),t[b.start].name=b.name,b.content=t[b.start].data.slice(0,b.size)):(b.storage="minifat",b.size<0?b.size=0:f!==v&&b.start!==v&&t[f]&&(b.content=l(b,t[f].data,(t[o]||{}).data))),b.content&&_S(b.content,0),i[c]=b,s.push(b)}}(i,_,k,x,r,{},C,s),function(e,t,n){for(var r=0,a=0,i=0,s=0,o=0,l=n.length,c=[],u=[];r<l;++r)c[r]=u[r]=r,t[r]=n[r];for(;o<u.length;++o)a=e[r=u[o]].L,i=e[r].R,s=e[r].C,c[r]===r&&(-1!==a&&c[a]!==a&&(c[r]=c[a]),-1!==i&&c[i]!==i&&(c[r]=c[i])),-1!==s&&(c[s]=r),-1!==a&&r!=c[r]&&(c[a]=c[r],u.lastIndexOf(a)<o&&u.push(a)),-1!==i&&r!=c[r]&&(c[i]=c[r],u.lastIndexOf(i)<o&&u.push(i));for(r=1;r<l;++r)c[r]===r&&(-1!==i&&c[i]!==i?c[r]=c[i]:-1!==a&&c[a]!==a&&(c[r]=c[a]));for(r=1;r<l;++r)if(0!==e[r].type){if((o=r)!=c[o])do{o=c[o],t[r]=t[o]+"/"+t[r]}while(0!==o&&-1!==c[o]&&o!=c[o]);c[r]=-1}for(t[0]+="/",r=1;r<l;++r)2!==e[r].type&&(t[r]+="/")}(C,I,x),x.shift();var A={FileIndex:C,FullPaths:I};return t&&t.raw&&(A.raw={header:b,sectors:k}),A}function l(e,t,n){for(var r=e.start,a=e.size,i=[],s=r;n&&a>0&&s>=0;)i.push(t.slice(s*g,s*g+g)),a-=g,s=vS(n,4*s);return 0===i.length?CS(0):ib(i).slice(0,e.size)}function c(e,t,n,r,a){var i=v;if(e===v){if(0!==t)throw new Error("DIFAT chain shorter than expected")}else if(-1!==e){var s=n[e],o=(r>>>2)-1;if(!s)return;for(var l=0;l<o&&(i=vS(s,4*l))!==v;++l)a.push(i);c(vS(s,r-4),t-1,n,r,a)}}function u(e,t,n,r,a){var i=[],s=[];a||(a=[]);var o=r-1,l=0,c=0;for(l=t;l>=0;){a[l]=!0,i[i.length]=l,s.push(e[l]);var u=n[Math.floor(4*l/r)];if(r<4+(c=4*l&o))throw new Error("FAT boundary crossed: "+l+" 4 "+r);if(!e[u])break;l=vS(e[u],c)}return{nodes:i,data:KT([s])}}function h(e,t){return new Date(1e3*(gS(e,t+4)/1e7*Math.pow(2,32)+gS(e,t)/1e7-11644473600))}function f(e,t){var n=t||{},r=n.root||"Root Entry";if(e.FullPaths||(e.FullPaths=[]),e.FileIndex||(e.FileIndex=[]),e.FullPaths.length!==e.FileIndex.length)throw new Error("inconsistent CFB structure");0===e.FullPaths.length&&(e.FullPaths[0]=r+"/",e.FileIndex[0]={name:r,type:5}),n.CLSID&&(e.FileIndex[0].clsid=n.CLSID),function(e){var t="\x01Sh33tJ5";if(nw.find(e,"/"+t))return;var n=CS(4);n[0]=55,n[1]=n[3]=50,n[2]=54,e.FileIndex.push({name:t,type:2,content:n,size:4,L:69,R:69,C:69}),e.FullPaths.push(e.FullPaths[0]+t),d(e)}(e)}function d(e,t){f(e);for(var a=!1,i=!1,s=e.FullPaths.length-1;s>=0;--s){var o=e.FileIndex[s];switch(o.type){case 0:i?a=!0:(e.FileIndex.pop(),e.FullPaths.pop());break;case 1:case 2:case 5:i=!0,isNaN(o.R*o.L*o.C)&&(a=!0),o.R>-1&&o.L>-1&&o.R==o.L&&(a=!0);break;default:a=!0}}if(a||t){var l=new Date(1987,1,19),c=0,u=Object.create?Object.create(null):{},h=[];for(s=0;s<e.FullPaths.length;++s)u[e.FullPaths[s]]=!0,0!==e.FileIndex[s].type&&h.push([e.FullPaths[s],e.FileIndex[s]]);for(s=0;s<h.length;++s){var d=n(h[s][0]);(i=u[d])||(h.push([d,{name:r(d).replace("/",""),type:1,clsid:w,ct:l,mt:l,content:null}]),u[d]=!0)}for(h.sort(function(e,t){return function(e,t){for(var n=e.split("/"),r=t.split("/"),a=0,i=0,s=Math.min(n.length,r.length);a<s;++a){if(i=n[a].length-r[a].length)return i;if(n[a]!=r[a])return n[a]<r[a]?-1:1}return n.length-r.length}(e[0],t[0])}),e.FullPaths=[],e.FileIndex=[],s=0;s<h.length;++s)e.FullPaths[s]=h[s][0],e.FileIndex[s]=h[s][1];for(s=0;s<h.length;++s){var p=e.FileIndex[s],m=e.FullPaths[s];if(p.name=r(m).replace("/",""),p.L=p.R=p.C=-(p.color=1),p.size=p.content?p.content.length:0,p.start=0,p.clsid=p.clsid||w,0===s)p.C=h.length>1?1:-1,p.size=0,p.type=5;else if("/"==m.slice(-1)){for(c=s+1;c<h.length&&n(e.FullPaths[c])!=m;++c);for(p.C=c>=h.length?-1:c,c=s+1;c<h.length&&n(e.FullPaths[c])!=n(m);++c);p.R=c>=h.length?-1:c,p.type=1}else n(e.FullPaths[s+1]||"")==n(m)&&(p.R=s+1),p.type=2}}}function p(e,t){var n=t||{};if("mad"==n.fileType)return function(e,t){for(var n=t||{},r=n.boundary||"SheetJS",a=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(r="------="+r).slice(2)+'"',"","",""],i=e.FullPaths[0],s=i,o=e.FileIndex[0],l=1;l<e.FullPaths.length;++l)if(s=e.FullPaths[l].slice(i.length),(o=e.FileIndex[l]).size&&o.content&&"\x01Sh33tJ5"!=s){s=s.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(e){return"_x"+e.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(e){return"_u"+e.charCodeAt(0).toString(16)+"_"});for(var c=o.content,u=Qy&&Buffer.isBuffer(c)?c.toString("binary"):S(c),h=0,f=Math.min(1024,u.length),d=0,p=0;p<=f;++p)(d=u.charCodeAt(p))>=32&&d<128&&++h;var m=h>=4*f/5;a.push(r),a.push("Content-Location: "+(n.root||"file:///C:/SheetJS/")+s),a.push("Content-Transfer-Encoding: "+(m?"quoted-printable":"base64")),a.push("Content-Type: "+se(o,s)),a.push(""),a.push(m?le(u):oe(u))}return a.push(r+"--\r\n"),a.join("\r\n")}(e,n);if(d(e),"zip"===n.fileType)return function(e,t){var n=t||{},r=[],i=[],s=CS(1),o=n.compression?8:0,l=0;0;var c=0,u=0,h=0,f=0,d=e.FullPaths[0],p=d,m=e.FileIndex[0],g=[],v=0;for(c=1;c<e.FullPaths.length;++c)if(p=e.FullPaths[c].slice(d.length),(m=e.FileIndex[c]).size&&m.content&&"\x01Sh33tJ5"!=p){var y=h,b=CS(p.length);for(u=0;u<p.length;++u)b.write_shift(1,127&p.charCodeAt(u));b=b.slice(0,b.l),g[f]=tw.buf(m.content,0);var w=m.content;8==o&&(w=E(w)),(s=CS(30)).write_shift(4,67324752),s.write_shift(2,20),s.write_shift(2,l),s.write_shift(2,o),m.mt?a(s,m.mt):s.write_shift(4,0),s.write_shift(-4,8&l?0:g[f]),s.write_shift(4,8&l?0:w.length),s.write_shift(4,8&l?0:m.content.length),s.write_shift(2,b.length),s.write_shift(2,0),h+=s.length,r.push(s),h+=b.length,r.push(b),h+=w.length,r.push(w),8&l&&((s=CS(12)).write_shift(-4,g[f]),s.write_shift(4,w.length),s.write_shift(4,m.content.length),h+=s.l,r.push(s)),(s=CS(46)).write_shift(4,33639248),s.write_shift(2,0),s.write_shift(2,20),s.write_shift(2,l),s.write_shift(2,o),s.write_shift(4,0),s.write_shift(-4,g[f]),s.write_shift(4,w.length),s.write_shift(4,m.content.length),s.write_shift(2,b.length),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(4,0),s.write_shift(4,y),v+=s.l,i.push(s),v+=b.length,i.push(b),++f}return s=CS(22),s.write_shift(4,101010256),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(2,f),s.write_shift(2,f),s.write_shift(4,v),s.write_shift(4,h),s.write_shift(2,0),ib([ib(r),ib(i),s])}(e,n);var r=function(e){for(var t=0,n=0,r=0;r<e.FileIndex.length;++r){var a=e.FileIndex[r];if(a.content){var i=a.content.length;i>0&&(i<4096?t+=i+63>>6:n+=i+511>>9)}}for(var s=e.FullPaths.length+3>>2,o=t+127>>7,l=(t+7>>3)+n+s+o,c=l+127>>7,u=c<=109?0:Math.ceil((c-109)/127);l+c+u+127>>7>c;)u=++c<=109?0:Math.ceil((c-109)/127);var h=[1,u,c,o,s,n,t,0];return e.FileIndex[0].size=t<<6,h[7]=(e.FileIndex[0].start=h[0]+h[1]+h[2]+h[3]+h[4]+h[5])+(h[6]+7>>3),h}(e),i=CS(r[7]<<9),s=0,o=0;for(s=0;s<8;++s)i.write_shift(1,b[s]);for(s=0;s<8;++s)i.write_shift(2,0);for(i.write_shift(2,62),i.write_shift(2,3),i.write_shift(2,65534),i.write_shift(2,9),i.write_shift(2,6),s=0;s<3;++s)i.write_shift(2,0);for(i.write_shift(4,0),i.write_shift(4,r[2]),i.write_shift(4,r[0]+r[1]+r[2]+r[3]-1),i.write_shift(4,0),i.write_shift(4,4096),i.write_shift(4,r[3]?r[0]+r[1]+r[2]-1:v),i.write_shift(4,r[3]),i.write_shift(-4,r[1]?r[0]-1:v),i.write_shift(4,r[1]),s=0;s<109;++s)i.write_shift(-4,s<r[2]?r[1]+s:-1);if(r[1])for(o=0;o<r[1];++o){for(;s<236+127*o;++s)i.write_shift(-4,s<r[2]?r[1]+s:-1);i.write_shift(-4,o===r[1]-1?v:o+1)}var l=function(e){for(o+=e;s<o-1;++s)i.write_shift(-4,s+1);e&&(++s,i.write_shift(-4,v))};for(o=s=0,o+=r[1];s<o;++s)i.write_shift(-4,T.DIFSECT);for(o+=r[2];s<o;++s)i.write_shift(-4,T.FATSECT);l(r[3]),l(r[4]);for(var c=0,u=0,h=e.FileIndex[0];c<e.FileIndex.length;++c)(h=e.FileIndex[c]).content&&((u=h.content.length)<4096||(h.start=o,l(u+511>>9)));for(l(r[6]+7>>3);511&i.l;)i.write_shift(-4,T.ENDOFCHAIN);for(o=s=0,c=0;c<e.FileIndex.length;++c)(h=e.FileIndex[c]).content&&(!(u=h.content.length)||u>=4096||(h.start=o,l(u+63>>6)));for(;511&i.l;)i.write_shift(-4,T.ENDOFCHAIN);for(s=0;s<r[4]<<2;++s){var f=e.FullPaths[s];if(f&&0!==f.length){h=e.FileIndex[s],0===s&&(h.start=h.size?h.start-1:v);var p=0===s&&n.root||h.name;if(u=2*(p.length+1),i.write_shift(64,p,"utf16le"),i.write_shift(2,u),i.write_shift(1,h.type),i.write_shift(1,h.color),i.write_shift(-4,h.L),i.write_shift(-4,h.R),i.write_shift(-4,h.C),h.clsid)i.write_shift(16,h.clsid,"hex");else for(c=0;c<4;++c)i.write_shift(4,0);i.write_shift(4,h.state||0),i.write_shift(4,0),i.write_shift(4,0),i.write_shift(4,0),i.write_shift(4,0),i.write_shift(4,h.start),i.write_shift(4,h.size),i.write_shift(4,0)}else{for(c=0;c<17;++c)i.write_shift(4,0);for(c=0;c<3;++c)i.write_shift(4,-1);for(c=0;c<12;++c)i.write_shift(4,0)}}for(s=1;s<e.FileIndex.length;++s)if((h=e.FileIndex[s]).size>=4096)if(i.l=h.start+1<<9,Qy&&Buffer.isBuffer(h.content))h.content.copy(i,i.l,0,h.size),i.l+=h.size+511&-512;else{for(c=0;c<h.size;++c)i.write_shift(1,h.content[c]);for(;511&c;++c)i.write_shift(1,0)}for(s=1;s<e.FileIndex.length;++s)if((h=e.FileIndex[s]).size>0&&h.size<4096)if(Qy&&Buffer.isBuffer(h.content))h.content.copy(i,i.l,0,h.size),i.l+=h.size+63&-64;else{for(c=0;c<h.size;++c)i.write_shift(1,h.content[c]);for(;63&c;++c)i.write_shift(1,0)}if(Qy)i.l=i.length;else for(;i.l<i.length;)i.write_shift(1,0);return i}t.version="1.2.1";var m,g=64,v=-2,y="d0cf11e0a1b11ae1",b=[208,207,17,224,161,177,26,225],w="00000000000000000000000000000000",T={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:v,FREESECT:-1,HEADER_SIGNATURE:y,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:w,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function S(e){for(var t=new Array(e.length),n=0;n<e.length;++n)t[n]=String.fromCharCode(e[n]);return t.join("")}function E(e){return m?m.deflateRawSync(e):$(e)}var k=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],_=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],x=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function C(e){var t=139536&(e<<1|e<<11)|558144&(e<<5|e<<15);return 255&(t>>16|t>>8|t)}for(var I="undefined"!==typeof Uint8Array,A=I?new Uint8Array(256):[],N=0;N<256;++N)A[N]=C(N);function R(e,t){var n=A[255&e];return t<=8?n>>>8-t:(n=n<<8|A[e>>8&255],t<=16?n>>>16-t:(n=n<<8|A[e>>16&255])>>>24-t)}function O(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=6?0:e[r+1]<<8))>>>n&3}function P(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=5?0:e[r+1]<<8))>>>n&7}function D(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=3?0:e[r+1]<<8))>>>n&31}function L(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=1?0:e[r+1]<<8))>>>n&127}function M(e,t,n){var r=7&t,a=t>>>3,i=(1<<n)-1,s=e[a]>>>r;return n<8-r?s&i:(s|=e[a+1]<<8-r,n<16-r?s&i:(s|=e[a+2]<<16-r,n<24-r?s&i:(s|=e[a+3]<<24-r)&i))}function F(e,t,n){var r=7&t,a=t>>>3;return r<=5?e[a]|=(7&n)<<r:(e[a]|=n<<r&255,e[a+1]=(7&n)>>8-r),t+3}function U(e,t,n){return n=(1&n)<<(7&t),e[t>>>3]|=n,t+1}function j(e,t,n){var r=t>>>3;return n<<=7&t,e[r]|=255&n,n>>>=8,e[r+1]=n,t+8}function V(e,t,n){var r=t>>>3;return n<<=7&t,e[r]|=255&n,n>>>=8,e[r+1]=255&n,e[r+2]=n>>>8,t+16}function z(e,t){var n=e.length,r=2*n>t?2*n:t+5,a=0;if(n>=t)return e;if(Qy){var i=eb(r);if(e.copy)e.copy(i);else for(;a<e.length;++a)i[a]=e[a];return i}if(I){var s=new Uint8Array(r);if(s.set)s.set(e);else for(;a<n;++a)s[a]=e[a];return s}return e.length=r,e}function B(e){for(var t=new Array(e),n=0;n<e;++n)t[n]=0;return t}function H(e,t,n){var r=1,a=0,i=0,s=0,o=0,l=e.length,c=I?new Uint16Array(32):B(32);for(i=0;i<32;++i)c[i]=0;for(i=l;i<n;++i)e[i]=0;l=e.length;var u=I?new Uint16Array(l):B(l);for(i=0;i<l;++i)c[a=e[i]]++,r<a&&(r=a),u[i]=0;for(c[0]=0,i=1;i<=r;++i)c[i+16]=o=o+c[i-1]<<1;for(i=0;i<l;++i)0!=(o=e[i])&&(u[i]=c[o+16]++);var h=0;for(i=0;i<l;++i)if(0!=(h=e[i]))for(o=R(u[i],r)>>r-h,s=(1<<r+4-h)-1;s>=0;--s)t[o|s<<h]=15&h|i<<4;return r}var W=I?new Uint16Array(512):B(512),G=I?new Uint16Array(32):B(32);if(!I){for(var K=0;K<512;++K)W[K]=0;for(K=0;K<32;++K)G[K]=0}!function(){for(var e=[],t=0;t<32;t++)e.push(5);H(e,G,32);var n=[];for(t=0;t<=143;t++)n.push(8);for(;t<=255;t++)n.push(9);for(;t<=279;t++)n.push(7);for(;t<=287;t++)n.push(8);H(n,W,288)}();var q=function(){for(var e=I?new Uint8Array(32768):[],t=0,n=0;t<x.length-1;++t)for(;n<x[t+1];++n)e[n]=t;for(;n<32768;++n)e[n]=29;var r=I?new Uint8Array(259):[];for(t=0,n=0;t<_.length-1;++t)for(;n<_[t+1];++n)r[n]=t;return function(t,n){return t.length<8?function(e,t){for(var n=0;n<e.length;){var r=Math.min(65535,e.length-n),a=n+r==e.length;for(t.write_shift(1,+a),t.write_shift(2,r),t.write_shift(2,65535&~r);r-- >0;)t[t.l++]=e[n++]}return t.l}(t,n):function(t,n){for(var a=0,i=0,s=I?new Uint16Array(32768):[];i<t.length;){var o=Math.min(65535,t.length-i);if(o<10){for(7&(a=F(n,a,+!(i+o!=t.length)))&&(a+=8-(7&a)),n.l=a/8|0,n.write_shift(2,o),n.write_shift(2,65535&~o);o-- >0;)n[n.l++]=t[i++];a=8*n.l}else{a=F(n,a,+!(i+o!=t.length)+2);for(var l=0;o-- >0;){var c=t[i],u=-1,h=0;if((u=s[l=32767&(l<<5^c)])&&((u|=-32768&i)>i&&(u-=32768),u<i))for(;t[u+h]==t[i+h]&&h<250;)++h;if(h>2){(c=r[h])<=22?a=j(n,a,A[c+1]>>1)-1:(j(n,a,3),j(n,a+=5,A[c-23]>>5),a+=3);var f=c<8?0:c-4>>2;f>0&&(V(n,a,h-_[c]),a+=f),c=e[i-u],a=j(n,a,A[c]>>3),a-=3;var d=c<4?0:c-2>>1;d>0&&(V(n,a,i-u-x[c]),a+=d);for(var p=0;p<h;++p)s[l]=32767&i,l=32767&(l<<5^t[i]),++i;o-=h-1}else c<=143?c+=48:a=U(n,a,1),a=j(n,a,A[c]),s[l]=32767&i,++i}a=j(n,a,0)-1}}return n.l=(a+7)/8|0,n.l}(t,n)}}();function $(e){var t=CS(50+Math.floor(1.1*e.length)),n=q(e,t);return t.slice(0,n)}var X=I?new Uint16Array(32768):B(32768),Y=I?new Uint16Array(32768):B(32768),Q=I?new Uint16Array(128):B(128),J=1,Z=1;function ee(e,t){var n=D(e,t)+257,r=D(e,t+=5)+1,a=function(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=4?0:e[r+1]<<8))>>>n&15}(e,t+=5)+4;t+=4;for(var i=0,s=I?new Uint8Array(19):B(19),o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],l=1,c=I?new Uint8Array(8):B(8),u=I?new Uint8Array(8):B(8),h=s.length,f=0;f<a;++f)s[k[f]]=i=P(e,t),l<i&&(l=i),c[i]++,t+=3;var d=0;for(c[0]=0,f=1;f<=l;++f)u[f]=d=d+c[f-1]<<1;for(f=0;f<h;++f)0!=(d=s[f])&&(o[f]=u[d]++);var p=0;for(f=0;f<h;++f)if(0!=(p=s[f])){d=A[o[f]]>>8-p;for(var m=(1<<7-p)-1;m>=0;--m)Q[d|m<<p]=7&p|f<<3}var g=[];for(l=1;g.length<n+r;)switch(t+=7&(d=Q[L(e,t)]),d>>>=3){case 16:for(i=3+O(e,t),t+=2,d=g[g.length-1];i-- >0;)g.push(d);break;case 17:for(i=3+P(e,t),t+=3;i-- >0;)g.push(0);break;case 18:for(i=11+L(e,t),t+=7;i-- >0;)g.push(0);break;default:g.push(d),l<d&&(l=d)}var v=g.slice(0,n),y=g.slice(n);for(f=n;f<286;++f)v[f]=0;for(f=r;f<30;++f)y[f]=0;return J=H(v,X,286),Z=H(y,Y,30),t}function te(e,t){var n=function(e,t){if(3==e[0]&&!(3&e[1]))return[Zy(t),2];for(var n=0,r=0,a=eb(t||1<<18),i=0,s=a.length>>>0,o=0,l=0;0==(1&r);)if(r=P(e,n),n+=3,r>>>1!=0)for(r>>1==1?(o=9,l=5):(n=ee(e,n),o=J,l=Z);;){!t&&s<i+32767&&(s=(a=z(a,i+32767)).length);var c=M(e,n,o),u=r>>>1==1?W[c]:X[c];if(n+=15&u,0===((u>>>=4)>>>8&255))a[i++]=u;else{if(256==u)break;var h=(u-=257)<8?0:u-4>>2;h>5&&(h=0);var f=i+_[u];h>0&&(f+=M(e,n,h),n+=h),c=M(e,n,l),n+=15&(u=r>>>1==1?G[c]:Y[c]);var d=(u>>>=4)<4?0:u-2>>1,p=x[u];for(d>0&&(p+=M(e,n,d),n+=d),!t&&s<f&&(s=(a=z(a,f+100)).length);i<f;)a[i]=a[i-p],++i}}else{7&n&&(n+=8-(7&n));var m=e[n>>>3]|e[(n>>>3)+1]<<8;if(n+=32,m>0)for(!t&&s<i+m&&(s=(a=z(a,i+m)).length);m-- >0;)a[i++]=e[n>>>3],n+=8}return t?[a,n+7>>>3]:[a.slice(0,i),n+7>>>3]}(e.slice(e.l||0),t);return e.l+=n[1],n[0]}function ne(e,t){if(!e)throw new Error(t);"undefined"!==typeof console&&console.error(t)}function re(e,t){var n=e;_S(n,0);var r={FileIndex:[],FullPaths:[]};f(r,{root:t.root});for(var a=n.length-4;(80!=n[a]||75!=n[a+1]||5!=n[a+2]||6!=n[a+3])&&a>=0;)--a;n.l=a+4,n.l+=4;var s=n.read_shift(2);n.l+=6;var o=n.read_shift(4);for(n.l=o,a=0;a<s;++a){n.l+=20;var l=n.read_shift(4),c=n.read_shift(4),u=n.read_shift(2),h=n.read_shift(2),d=n.read_shift(2);n.l+=8;var p=n.read_shift(4),m=i(n.slice(n.l+u,n.l+u+h));n.l+=u+h+d;var g=n.l;n.l=p+4,ae(n,l,c,r,m),n.l=g}return r}function ae(e,t,n,r,a){e.l+=2;var s=e.read_shift(2),o=e.read_shift(2),l=function(e){var t=65535&e.read_shift(2),n=65535&e.read_shift(2),r=new Date,a=31&n,i=15&(n>>>=5);n>>>=4,r.setMilliseconds(0),r.setFullYear(n+1980),r.setMonth(i-1),r.setDate(a);var s=31&t,o=63&(t>>>=5);return t>>>=6,r.setHours(t),r.setMinutes(o),r.setSeconds(s<<1),r}(e);if(8257&s)throw new Error("Unsupported ZIP encryption");e.read_shift(4);for(var c=e.read_shift(4),u=e.read_shift(4),h=e.read_shift(2),f=e.read_shift(2),d="",p=0;p<h;++p)d+=String.fromCharCode(e[e.l++]);if(f){var g=i(e.slice(e.l,e.l+f));(g[21589]||{}).mt&&(l=g[21589].mt),((a||{})[21589]||{}).mt&&(l=a[21589].mt)}e.l+=f;var v=e.slice(e.l,e.l+c);switch(o){case 8:v=function(e,t){if(!m)return te(e,t);var n=new(0,m.InflateRaw),r=n._processChunk(e.slice(e.l),n._finishFlushFlag);return e.l+=n.bytesRead,r}(e,u);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+o)}var y=!1;8&s&&(134695760==e.read_shift(4)&&(e.read_shift(4),y=!0),c=e.read_shift(4),u=e.read_shift(4)),c!=t&&ne(y,"Bad compressed size: "+t+" != "+c),u!=n&&ne(y,"Bad uncompressed size: "+n+" != "+u),ue(r,d,v,{unsafe:!0,mt:l})}var ie={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function se(e,t){if(e.ctype)return e.ctype;var n=e.name||"",r=n.match(/\.([^\.]+)$/);return r&&ie[r[1]]||t&&(r=(n=t).match(/[\.\\]([^\.\\])+$/))&&ie[r[1]]?ie[r[1]]:"application/octet-stream"}function oe(e){for(var t=Xy(e),n=[],r=0;r<t.length;r+=76)n.push(t.slice(r,r+76));return n.join("\r\n")+"\r\n"}function le(e){var t=e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(e){var t=e.charCodeAt(0).toString(16).toUpperCase();return"="+(1==t.length?"0"+t:t)});"\n"==(t=t.replace(/ $/gm,"=20").replace(/\t$/gm,"=09")).charAt(0)&&(t="=0D"+t.slice(1));for(var n=[],r=(t=t.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,"\n=0A").replace(/([^\r\n])\n/gm,"$1=0A")).split("\r\n"),a=0;a<r.length;++a){var i=r[a];if(0!=i.length)for(var s=0;s<i.length;){var o=76,l=i.slice(s,s+o);"="==l.charAt(o-1)?o--:"="==l.charAt(o-2)?o-=2:"="==l.charAt(o-3)&&(o-=3),l=i.slice(s,s+o),(s+=o)<i.length&&(l+="="),n.push(l)}else n.push("")}return n.join("\r\n")}function ce(e,t,n){for(var r,a="",i="",s="",o=0;o<10;++o){var l=t[o];if(!l||l.match(/^\s*$/))break;var c=l.match(/^(.*?):\s*([^\s].*)$/);if(c)switch(c[1].toLowerCase()){case"content-location":a=c[2].trim();break;case"content-type":s=c[2].trim();break;case"content-transfer-encoding":i=c[2].trim()}}switch(++o,i.toLowerCase()){case"base64":r=tb(Yy(t.slice(o).join("")));break;case"quoted-printable":r=function(e){for(var t=[],n=0;n<e.length;++n){for(var r=e[n];n<=e.length&&"="==r.charAt(r.length-1);)r=r.slice(0,r.length-1)+e[++n];t.push(r)}for(var a=0;a<t.length;++a)t[a]=t[a].replace(/[=][0-9A-Fa-f]{2}/g,function(e){return String.fromCharCode(parseInt(e.slice(1),16))});return tb(t.join("\r\n"))}(t.slice(o));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+i)}var u=ue(e,a.slice(n.length),r,{unsafe:!0});s&&(u.ctype=s)}function ue(e,t,n,a){var i=a&&a.unsafe;i||f(e);var s=!i&&nw.find(e,t);if(!s){var o=e.FullPaths[0];t.slice(0,o.length)==o?o=t:("/"!=o.slice(-1)&&(o+="/"),o=(o+t).replace("//","/")),s={name:r(t),type:2},e.FileIndex.push(s),e.FullPaths.push(o),i||nw.utils.cfb_gc(e)}return s.content=n,s.size=n?n.length:0,a&&(a.CLSID&&(s.clsid=a.CLSID),a.mt&&(s.mt=a.mt),a.ct&&(s.ct=a.ct)),s}return t.find=function(e,t){var n=e.FullPaths.map(function(e){return e.toUpperCase()}),r=n.map(function(e){var t=e.split("/");return t[t.length-("/"==e.slice(-1)?2:1)]}),a=!1;47===t.charCodeAt(0)?(a=!0,t=n[0].slice(0,-1)+t):a=-1!==t.indexOf("/");var i=t.toUpperCase(),s=!0===a?n.indexOf(i):r.indexOf(i);if(-1!==s)return e.FileIndex[s];var o=!i.match(ob);for(i=i.replace(sb,""),o&&(i=i.replace(ob,"!")),s=0;s<n.length;++s){if((o?n[s].replace(ob,"!"):n[s]).replace(sb,"")==i)return e.FileIndex[s];if((o?r[s].replace(ob,"!"):r[s]).replace(sb,"")==i)return e.FileIndex[s]}return null},t.read=function(t,n){var r=n&&n.type;switch(r||Qy&&Buffer.isBuffer(t)&&(r="buffer"),r||"base64"){case"file":return function(t,n){return s(),o(e.readFileSync(t),n)}(t,n);case"base64":return o(tb(Yy(t)),n);case"binary":return o(tb(t),n)}return o(t,n)},t.parse=o,t.write=function(t,n){var r=p(t,n);switch(n&&n.type||"buffer"){case"file":return s(),e.writeFileSync(n.filename,r),r;case"binary":return"string"==typeof r?r:S(r);case"base64":return Xy("string"==typeof r?r:S(r));case"buffer":if(Qy)return Buffer.isBuffer(r)?r:Jy(r);case"array":return"string"==typeof r?tb(r):r}return r},t.writeFile=function(t,n,r){s();var a=p(t,r);e.writeFileSync(n,a)},t.utils={cfb_new:function(e){var t={};return f(t,e),t},cfb_add:ue,cfb_del:function(e,t){f(e);var n=nw.find(e,t);if(n)for(var r=0;r<e.FileIndex.length;++r)if(e.FileIndex[r]==n)return e.FileIndex.splice(r,1),e.FullPaths.splice(r,1),!0;return!1},cfb_mov:function(e,t,n){f(e);var a=nw.find(e,t);if(a)for(var i=0;i<e.FileIndex.length;++i)if(e.FileIndex[i]==a)return e.FileIndex[i].name=r(n),e.FullPaths[i]=n,!0;return!1},cfb_gc:function(e){d(e,!0)},ReadShift:bS,CheckField:kS,prep_blob:_S,bconcat:ib,use_zlib:function(e){try{var t=new(0,e.InflateRaw);if(t._processChunk(new Uint8Array([3,0]),t._finishFlushFlag),!t.bytesRead)throw new Error("zlib does not expose bytesRead");m=e}catch(AR){console.error("cannot use native zlib: "+(AR.message||AR))}},_deflateRaw:$,_inflateRaw:te,consts:T},t}();let rw;function aw(e){return"string"===typeof e?nb(e):Array.isArray(e)?function(e){if("undefined"===typeof Uint8Array)throw new Error("Unsupported");return new Uint8Array(e)}(e):e}function iw(e,t,n){if("undefined"!==typeof rw&&rw.writeFileSync)return n?rw.writeFileSync(e,t,n):rw.writeFileSync(e,t);if("undefined"!==typeof Deno){if(n&&"string"==typeof t)switch(n){case"utf8":t=new TextEncoder(n).encode(t);break;case"binary":t=nb(t);break;default:throw new Error("Unsupported encoding "+n)}return Deno.writeFileSync(e,t)}var r="utf8"==n?uT(t):t;if("undefined"!==typeof IE_SaveFile)return IE_SaveFile(r,e);if("undefined"!==typeof Blob){var a=new Blob([aw(r)],{type:"application/octet-stream"});if("undefined"!==typeof navigator&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if("undefined"!==typeof saveAs)return saveAs(a,e);if("undefined"!==typeof URL&&"undefined"!==typeof document&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(a);if("object"===typeof chrome&&"function"==typeof(chrome.downloads||{}).download)return URL.revokeObjectURL&&"undefined"!==typeof setTimeout&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var s=document.createElement("a");if(null!=s.download)return s.download=e,s.href=i,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL&&"undefined"!==typeof setTimeout&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if("undefined"!==typeof $&&"undefined"!==typeof File&&"undefined"!==typeof Folder)try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=rb(t)),o.write(t),o.close(),t}catch(AR){if(!AR.message||!AR.message.match(/onstruct/))throw AR}throw new Error("cannot save file "+e)}function sw(e){for(var t=Object.keys(e),n=[],r=0;r<t.length;++r)Object.prototype.hasOwnProperty.call(e,t[r])&&n.push(t[r]);return n}function ow(e,t){for(var n=[],r=sw(e),a=0;a!==r.length;++a)null==n[e[r[a]][t]]&&(n[e[r[a]][t]]=r[a]);return n}function lw(e){for(var t=[],n=sw(e),r=0;r!==n.length;++r)t[e[n[r]]]=n[r];return t}function cw(e){for(var t=[],n=sw(e),r=0;r!==n.length;++r)t[e[n[r]]]=parseInt(n[r],10);return t}var uw=new Date(1899,11,30,0,0,0);function hw(e,t){var n=e.getTime();return t&&(n-=1263168e5),(n-(uw.getTime()+6e4*(e.getTimezoneOffset()-uw.getTimezoneOffset())))/864e5}var fw=new Date,dw=uw.getTime()+6e4*(fw.getTimezoneOffset()-uw.getTimezoneOffset()),pw=fw.getTimezoneOffset();function mw(e){var t=new Date;return t.setTime(24*e*60*60*1e3+dw),t.getTimezoneOffset()!==pw&&t.setTime(t.getTime()+6e4*(t.getTimezoneOffset()-pw)),t}function gw(e){var t=0,n=0,r=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=a.length;++i)if(a[i]){switch(n=1,i>3&&(r=!0),a[i].slice(a[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[i].slice(a[i].length-1));case"D":n*=24;case"H":n*=60;case"M":if(!r)throw new Error("Unsupported ISO Duration Field: M");n*=60}t+=n*parseInt(a[i],10)}return t}var vw=new Date("2017-02-19T19:06:09.000Z"),yw=isNaN(vw.getFullYear())?new Date("2/19/17"):vw,bw=2017==yw.getFullYear();function ww(e,t){var n=new Date(e);if(bw)return t>0?n.setTime(n.getTime()+60*n.getTimezoneOffset()*1e3):t<0&&n.setTime(n.getTime()-60*n.getTimezoneOffset()*1e3),n;if(e instanceof Date)return e;if(1917==yw.getFullYear()&&!isNaN(n.getFullYear())){var r=n.getFullYear();return e.indexOf(""+r)>-1||n.setFullYear(n.getFullYear()+100),n}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-60*i.getTimezoneOffset()*1e3)),i}function Tw(e,t){if(Qy&&Buffer.isBuffer(e)){if(t){if(255==e[0]&&254==e[1])return uT(e.slice(2).toString("utf16le"));if(254==e[1]&&255==e[2])return uT(Hy(e.slice(2).toString("binary")))}return e.toString("binary")}if("undefined"!==typeof TextDecoder)try{if(t){if(255==e[0]&&254==e[1])return uT(new TextDecoder("utf-16le").decode(e.slice(2)));if(254==e[0]&&255==e[1])return uT(new TextDecoder("utf-16be").decode(e.slice(2)))}var n={"\u20ac":"\x80","\u201a":"\x82","\u0192":"\x83","\u201e":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02c6":"\x88","\u2030":"\x89","\u0160":"\x8a","\u2039":"\x8b","\u0152":"\x8c","\u017d":"\x8e","\u2018":"\x91","\u2019":"\x92","\u201c":"\x93","\u201d":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02dc":"\x98","\u2122":"\x99","\u0161":"\x9a","\u203a":"\x9b","\u0153":"\x9c","\u017e":"\x9e","\u0178":"\x9f"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[\u20ac\u201a\u0192\u201e\u2026\u2020\u2021\u02c6\u2030\u0160\u2039\u0152\u017d\u2018\u2019\u201c\u201d\u2022\u2013\u2014\u02dc\u2122\u0161\u203a\u0153\u017e\u0178]/g,function(e){return n[e]||e})}catch(AR){}for(var r=[],a=0;a!=e.length;++a)r.push(String.fromCharCode(e[a]));return r.join("")}function Sw(e){if("undefined"!=typeof JSON&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if("object"!=typeof e||null==e)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=Sw(e[n]));return t}function Ew(e,t){for(var n="";n.length<t;)n+=e;return n}function kw(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var n=1,r=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return n*=100,""});return isNaN(t=Number(r))?(r=r.replace(/[(](.*)[)]/,function(e,t){return n=-n,t}),isNaN(t=Number(r))?t:t/n):t/n}var _w=["january","february","march","april","may","june","july","august","september","october","november","december"];function xw(e){var t=new Date(e),n=new Date(NaN),r=t.getYear(),a=t.getMonth(),i=t.getDate();if(isNaN(i))return n;var s=e.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if((s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length>3&&-1==_w.indexOf(s))return n}else if(s.match(/[a-z]/))return n;return r<0||r>8099?n:(a>0||i>1)&&101!=r?t:e.match(/[^-0-9:,\/\\]/)?n:t}var Cw=function(){var e=5=="abacaba".split(/(:?b)/i).length;return function(t,n,r){if(e||"string"==typeof n)return t.split(n);for(var a=t.split(n),i=[a[0]],s=1;s<a.length;++s)i.push(r),i.push(a[s]);return i}}();function Iw(e){return e?e.content&&e.type?Tw(e.content,!0):e.data?Gy(e.data):e.asNodeBuffer&&Qy?Gy(e.asNodeBuffer().toString("binary")):e.asBinary?Gy(e.asBinary()):e._data&&e._data.getContent?Gy(Tw(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function Aw(e){if(!e)return null;if(e.data)return By(e.data);if(e.asNodeBuffer&&Qy)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return"string"==typeof t?By(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function Nw(e,t){for(var n=e.FullPaths||sw(e.files),r=t.toLowerCase().replace(/[\/]/g,"\\"),a=r.replace(/\\/g,"/"),i=0;i<n.length;++i){var s=n[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(r==s||a==s)return e.files?e.files[n[i]]:e.FileIndex[i]}return null}function Rw(e,t){var n=Nw(e,t);if(null==n)throw new Error("Cannot find file "+t+" in zip");return n}function Ow(e,t,n){if(!n)return function(e){return e&&".bin"===e.name.slice(-4)?Aw(e):Iw(e)}(Rw(e,t));if(!t)return null;try{return Ow(e,t)}catch(AR){return null}}function Pw(e,t,n){if(!n)return Iw(Rw(e,t));if(!t)return null;try{return Pw(e,t)}catch(AR){return null}}function Dw(e,t,n){if(!n)return Aw(Rw(e,t));if(!t)return null;try{return Dw(e,t)}catch(AR){return null}}function Lw(e){for(var t=e.FullPaths||sw(e.files),n=[],r=0;r<t.length;++r)"/"!=t[r].slice(-1)&&n.push(t[r].replace(/^Root Entry[\/]/,""));return n.sort()}function Mw(e,t,n){if(e.FullPaths){var r;if("string"==typeof n)return r=Qy?Jy(n):function(e){for(var t=[],n=0,r=e.length+250,a=Zy(e.length+255),i=0;i<e.length;++i){var s=e.charCodeAt(i);if(s<128)a[n++]=s;else if(s<2048)a[n++]=192|s>>6&31,a[n++]=128|63&s;else if(s>=55296&&s<57344){s=64+(1023&s);var o=1023&e.charCodeAt(++i);a[n++]=240|s>>8&7,a[n++]=128|s>>2&63,a[n++]=128|o>>6&15|(3&s)<<4,a[n++]=128|63&o}else a[n++]=224|s>>12&15,a[n++]=128|s>>6&63,a[n++]=128|63&s;n>r&&(t.push(a.slice(0,n)),n=0,a=Zy(65535),r=65530)}return t.push(a.slice(0,n)),ib(t)}(n),nw.utils.cfb_add(e,t,r);nw.utils.cfb_add(e,t,n)}else e.file(t,n)}function Fw(){return nw.utils.cfb_new()}function Uw(e,t){switch(t.type){case"base64":return nw.read(e,{type:"base64"});case"binary":return nw.read(e,{type:"binary"});case"buffer":case"array":return nw.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function jw(e,t){if("/"==e.charAt(0))return e.slice(1);var n=t.split("/");"/"!=t.slice(-1)&&n.pop();for(var r=e.split("/");0!==r.length;){var a=r.shift();".."===a?n.pop():"."!==a&&n.push(a)}return n.join("/")}var Vw='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n',zw=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Bw=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/gm,Hw=Vw.match(Bw)?Bw:/<[^>]*>/g,Ww=/<\w*:/,Gw=/<(\/?)\w+:/;function Kw(e,t,n){for(var r={},a=0,i=0;a!==e.length&&(32!==(i=e.charCodeAt(a))&&10!==i&&13!==i);++a);if(t||(r[0]=e.slice(0,a)),a===e.length)return r;var s=e.match(zw),o=0,l="",c=0,u="",h="",f=1;if(s)for(c=0;c!=s.length;++c){for(h=s[c],i=0;i!=h.length&&61!==h.charCodeAt(i);++i);for(u=h.slice(0,i).trim();32==h.charCodeAt(i+1);)++i;for(f=34==(a=h.charCodeAt(i+1))||39==a?1:0,l=h.slice(i+1+f,h.length-f),o=0;o!=u.length&&58!==u.charCodeAt(o);++o);if(o===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),r[u]=l,n||(r[u.toLowerCase()]=l);else{var d=(5===o&&"xmlns"===u.slice(0,5)?"xmlns":"")+u.slice(o+1);if(r[d]&&"ext"==u.slice(o-3,o))continue;r[d]=l,n||(r[d.toLowerCase()]=l)}}return r}function qw(e){return e.replace(Gw,"<$1")}var $w={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Xw=lw($w),Yw=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/gi,t=/_x([\da-fA-F]{4})_/gi;return function n(r){var a=r+"",i=a.indexOf("<![CDATA[");if(-1==i)return a.replace(e,function(e,t){return $w[e]||String.fromCharCode(parseInt(t,e.indexOf("x")>-1?16:10))||e}).replace(t,function(e,t){return String.fromCharCode(parseInt(t,16))});var s=a.indexOf("]]>");return n(a.slice(0,i))+a.slice(i+9,s)+n(a.slice(s+3))}}(),Qw=/[&<>'"]/g,Jw=/[\u0000-\u0008\u000b-\u001f]/g;function Zw(e){return(e+"").replace(Qw,function(e){return Xw[e]}).replace(Jw,function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+"_"})}function eT(e){return Zw(e).replace(/ /g,"_x0020_")}var tT=/[\u0000-\u001f]/g;function nT(e){return(e+"").replace(Qw,function(e){return Xw[e]}).replace(/\n/g,"<br/>").replace(tT,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}var rT=function(){var e=/&#(\d+);/g;function t(e,t){return String.fromCharCode(parseInt(t,10))}return function(n){return n.replace(e,t)}}();function aT(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function iT(e){for(var t="",n=0,r=0,a=0,i=0,s=0,o=0;n<e.length;)(r=e.charCodeAt(n++))<128?t+=String.fromCharCode(r):(a=e.charCodeAt(n++),r>191&&r<224?(s=(31&r)<<6,s|=63&a,t+=String.fromCharCode(s)):(i=e.charCodeAt(n++),r<240?t+=String.fromCharCode((15&r)<<12|(63&a)<<6|63&i):(o=((7&r)<<18|(63&a)<<12|(63&i)<<6|63&(s=e.charCodeAt(n++)))-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(1023&o)))));return t}function sT(e){var t,n,r,a=Zy(2*e.length),i=1,s=0,o=0;for(n=0;n<e.length;n+=i)i=1,(r=e.charCodeAt(n))<128?t=r:r<224?(t=64*(31&r)+(63&e.charCodeAt(n+1)),i=2):r<240?(t=4096*(15&r)+64*(63&e.charCodeAt(n+1))+(63&e.charCodeAt(n+2)),i=3):(i=4,t=262144*(7&r)+4096*(63&e.charCodeAt(n+1))+64*(63&e.charCodeAt(n+2))+(63&e.charCodeAt(n+3)),o=55296+((t-=65536)>>>10&1023),t=56320+(1023&t)),0!==o&&(a[s++]=255&o,a[s++]=o>>>8,o=0),a[s++]=t%256,a[s++]=t>>>8;return a.slice(0,s).toString("ucs2")}function oT(e){return Jy(e,"binary").toString("utf8")}var lT="foo bar baz\xe2\x98\x83\xf0\x9f\x8d\xa3",cT=Qy&&(oT(lT)==iT(lT)&&oT||sT(lT)==iT(lT)&&sT)||iT,uT=Qy?function(e){return Jy(e,"utf8").toString("binary")}:function(e){for(var t=[],n=0,r=0,a=0;n<e.length;)switch(r=e.charCodeAt(n++),!0){case r<128:t.push(String.fromCharCode(r));break;case r<2048:t.push(String.fromCharCode(192+(r>>6))),t.push(String.fromCharCode(128+(63&r)));break;case r>=55296&&r<57344:r-=55296,a=e.charCodeAt(n++)-56320+(r<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(63&a)));break;default:t.push(String.fromCharCode(224+(r>>12))),t.push(String.fromCharCode(128+(r>>6&63))),t.push(String.fromCharCode(128+(63&r)))}return t.join("")},hT=function(){var e={};return function(t,n){var r=t+"|"+(n||"");return e[r]?e[r]:e[r]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",n||"")}}(),fT=function(){var e=[["nbsp"," "],["middot","\xb7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var n=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),r=0;r<e.length;++r)n=n.replace(e[r][0],e[r][1]);return n}}(),dT=function(){var e={};return function(t){return void 0!==e[t]?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}}(),pT=/<\/?(?:vt:)?variant>/g,mT=/<(?:vt:)([^>]*)>([\s\S]*)</;function gT(e,t){var n=Kw(e),r=e.match(dT(n.baseType))||[],a=[];if(r.length!=n.size){if(t.WTF)throw new Error("unexpected vector length "+r.length+" != "+n.size);return a}return r.forEach(function(e){var t=e.replace(pT,"").match(mT);t&&a.push({v:cT(t[2]),t:t[1]})}),a}var vT=/(^\s|\s$|\n)/;function yT(e,t){return"<"+e+(t.match(vT)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function bT(e){return sw(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function wT(e,t,n){return"<"+e+(null!=n?bT(n):"")+(null!=t?(t.match(vT)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function TT(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(AR){if(t)throw AR}return""}function ST(e){if(Qy&&Buffer.isBuffer(e))return e.toString("utf8");if("string"===typeof e)return e;if("undefined"!==typeof Uint8Array&&e instanceof Uint8Array)return cT(rb(ab(e)));throw new Error("Bad input format: expected Buffer or string")}var ET=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/gm,kT="http://schemas.openxmlformats.org/package/2006/metadata/core-properties",_T="http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",xT="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT="http://schemas.openxmlformats.org/package/2006/content-types",IT="http://schemas.openxmlformats.org/package/2006/relationships",AT="http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",NT="http://purl.org/dc/elements/1.1/",RT="http://purl.org/dc/terms/",OT="http://purl.org/dc/dcmitype/",PT="http://schemas.openxmlformats.org/officeDocument/2006/relationships",DT="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",LT="http://www.w3.org/2001/XMLSchema-instance",MT="http://www.w3.org/2001/XMLSchema",FT=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],UT="urn:schemas-microsoft-com:office:office",jT="urn:schemas-microsoft-com:office:excel",VT="urn:schemas-microsoft-com:office:spreadsheet",zT="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",BT="http://macVmlSchemaUri",HT="urn:schemas-microsoft-com:vml",WT="http://www.w3.org/TR/REC-html40";var GT=function(e){for(var t=[],n=0;n<e[0].length;++n)if(e[0][n])for(var r=0,a=e[0][n].length;r<a;r+=10240)t.push.apply(t,e[0][n].slice(r,r+10240));return t},KT=Qy?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(e){return Buffer.isBuffer(e)?e:Jy(e)})):GT(e)}:GT,qT=function(e,t,n){for(var r=[],a=t;a<n;a+=2)r.push(String.fromCharCode(pS(e,a)));return r.join("").replace(sb,"")},$T=Qy?function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf16le",t,n).replace(sb,""):qT(e,t,n)}:qT,XT=function(e,t,n){for(var r=[],a=t;a<t+n;++a)r.push(("0"+e[a].toString(16)).slice(-2));return r.join("")},YT=Qy?function(e,t,n){return Buffer.isBuffer(e)?e.toString("hex",t,t+n):XT(e,t,n)}:XT,QT=function(e,t,n){for(var r=[],a=t;a<n;a++)r.push(String.fromCharCode(dS(e,a)));return r.join("")},JT=Qy?function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf8",t,n):QT(e,t,n)}:QT,ZT=function(e,t){var n=gS(e,t);return n>0?JT(e,t+4,t+4+n-1):""},eS=ZT,tS=function(e,t){var n=gS(e,t);return n>0?JT(e,t+4,t+4+n-1):""},nS=tS,rS=function(e,t){var n=2*gS(e,t);return n>0?JT(e,t+4,t+4+n-1):""},aS=rS,iS=function(e,t){var n=gS(e,t);return n>0?$T(e,t+4,t+4+n):""},sS=iS,oS=function(e,t){var n=gS(e,t);return n>0?JT(e,t+4,t+4+n):""},lS=oS,cS=function(e,t){return function(e,t){for(var n=1-2*(e[t+7]>>>7),r=((127&e[t+7])<<4)+(e[t+6]>>>4&15),a=15&e[t+6],i=5;i>=0;--i)a=256*a+e[t+i];return 2047==r?0==a?n*(1/0):NaN:(0==r?r=-1022:(r-=1023,a+=Math.pow(2,52)),n*Math.pow(2,r-52)*a)}(e,t)},uS=cS,hS=function(e){return Array.isArray(e)||"undefined"!==typeof Uint8Array&&e instanceof Uint8Array};function fS(){$T=function(e,t,n){return Wy.utils.decode(1200,e.slice(t,n)).replace(sb,"")},JT=function(e,t,n){return Wy.utils.decode(65001,e.slice(t,n))},eS=function(e,t){var n=gS(e,t);return n>0?Wy.utils.decode(My,e.slice(t+4,t+4+n-1)):""},nS=function(e,t){var n=gS(e,t);return n>0?Wy.utils.decode(Ly,e.slice(t+4,t+4+n-1)):""},aS=function(e,t){var n=2*gS(e,t);return n>0?Wy.utils.decode(1200,e.slice(t+4,t+4+n-1)):""},sS=function(e,t){var n=gS(e,t);return n>0?Wy.utils.decode(1200,e.slice(t+4,t+4+n)):""},lS=function(e,t){var n=gS(e,t);return n>0?Wy.utils.decode(65001,e.slice(t+4,t+4+n)):""}}Qy&&(eS=function(e,t){if(!Buffer.isBuffer(e))return ZT(e,t);var n=e.readUInt32LE(t);return n>0?e.toString("utf8",t+4,t+4+n-1):""},nS=function(e,t){if(!Buffer.isBuffer(e))return tS(e,t);var n=e.readUInt32LE(t);return n>0?e.toString("utf8",t+4,t+4+n-1):""},aS=function(e,t){if(!Buffer.isBuffer(e))return rS(e,t);var n=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n-1)},sS=function(e,t){if(!Buffer.isBuffer(e))return iS(e,t);var n=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n)},lS=function(e,t){if(!Buffer.isBuffer(e))return oS(e,t);var n=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+n)},uS=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):cS(e,t)},hS=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||"undefined"!==typeof Uint8Array&&e instanceof Uint8Array}),"undefined"!==typeof Wy&&fS();var dS=function(e,t){return e[t]},pS=function(e,t){return 256*e[t+1]+e[t]},mS=function(e,t){var n=256*e[t+1]+e[t];return n<32768?n:-1*(65535-n+1)},gS=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},vS=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},yS=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function bS(e,t){var n,r,a,i,s,o,l="",c=[];switch(t){case"dbcs":if(o=this.l,Qy&&Buffer.isBuffer(this))l=this.slice(this.l,this.l+2*e).toString("utf16le");else for(s=0;s<e;++s)l+=String.fromCharCode(pS(this,o)),o+=2;e*=2;break;case"utf8":l=JT(this,this.l,this.l+e);break;case"utf16le":e*=2,l=$T(this,this.l,this.l+e);break;case"wstr":if("undefined"===typeof Wy)return bS.call(this,e,"dbcs");l=Wy.utils.decode(Ly,this.slice(this.l,this.l+2*e)),e*=2;break;case"lpstr-ansi":l=eS(this,this.l),e=4+gS(this,this.l);break;case"lpstr-cp":l=nS(this,this.l),e=4+gS(this,this.l);break;case"lpwstr":l=aS(this,this.l),e=4+2*gS(this,this.l);break;case"lpp4":e=4+gS(this,this.l),l=sS(this,this.l),2&e&&(e+=2);break;case"8lpp4":e=4+gS(this,this.l),l=lS(this,this.l),3&e&&(e+=4-(3&e));break;case"cstr":for(e=0,l="";0!==(a=dS(this,this.l+e++));)c.push(Ky(a));l=c.join("");break;case"_wstr":for(e=0,l="";0!==(a=pS(this,this.l+e));)c.push(Ky(a)),e+=2;e+=2,l=c.join("");break;case"dbcs-cont":for(l="",o=this.l,s=0;s<e;++s){if(this.lens&&-1!==this.lens.indexOf(o))return a=dS(this,o),this.l=o+1,i=bS.call(this,e-s,a?"dbcs-cont":"sbcs-cont"),c.join("")+i;c.push(Ky(pS(this,o))),o+=2}l=c.join(""),e*=2;break;case"cpstr":if("undefined"!==typeof Wy){l=Wy.utils.decode(Ly,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(l="",o=this.l,s=0;s!=e;++s){if(this.lens&&-1!==this.lens.indexOf(o))return a=dS(this,o),this.l=o+1,i=bS.call(this,e-s,a?"dbcs-cont":"sbcs-cont"),c.join("")+i;c.push(Ky(dS(this,o))),o+=1}l=c.join("");break;default:switch(e){case 1:return n=dS(this,this.l),this.l++,n;case 2:return n=("i"===t?mS:pS)(this,this.l),this.l+=2,n;case 4:case-4:return"i"===t||0===(128&this[this.l+3])?(n=(e>0?vS:yS)(this,this.l),this.l+=4,n):(r=gS(this,this.l),this.l+=4,r);case 8:case-8:if("f"===t)return r=8==e?uS(this,this.l):uS([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,r;e=8;case 16:l=YT(this,this.l,e)}}return this.l+=e,l}var wS=function(e,t,n){e[n]=255&t,e[n+1]=t>>>8&255,e[n+2]=t>>>16&255,e[n+3]=t>>>24&255},TS=function(e,t,n){e[n]=255&t,e[n+1]=t>>8&255,e[n+2]=t>>16&255,e[n+3]=t>>24&255},SS=function(e,t,n){e[n]=255&t,e[n+1]=t>>>8&255};function ES(e,t,n){var r=0,a=0;if("dbcs"===n){for(a=0;a!=t.length;++a)SS(this,t.charCodeAt(a),this.l+2*a);r=2*t.length}else if("sbcs"===n){if("undefined"!==typeof Wy&&874==My)for(a=0;a!=t.length;++a){var i=Wy.utils.encode(My,t.charAt(a));this[this.l+a]=i[0]}else for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=255&t.charCodeAt(a);r=t.length}else{if("hex"===n){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}if("utf16le"===n){var s=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var o=t.charCodeAt(a);this[this.l++]=255&o,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}switch(e){case 1:r=1,this[this.l]=255&t;break;case 2:r=2,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t;break;case 3:r=3,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t,t>>>=8,this[this.l+2]=255&t;break;case 4:r=4,wS(this,t,this.l);break;case 8:if(r=8,"f"===n){!function(e,t,n){var r=(t<0||1/t==-1/0?1:0)<<7,a=0,i=0,s=r?-t:t;isFinite(s)?0==s?a=i=0:(a=Math.floor(Math.log(s)/Math.LN2),i=s*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(t)?26985:0);for(var o=0;o<=5;++o,i/=256)e[n+o]=255&i;e[n+6]=(15&a)<<4|15&i,e[n+7]=a>>4|r}(this,t,this.l);break}case 16:break;case-4:r=4,TS(this,t,this.l)}}return this.l+=r,this}function kS(e,t){var n=YT(this,this.l,e.length>>1);if(n!==e)throw new Error(t+"Expected "+e+" saw "+n);this.l+=e.length>>1}function _S(e,t){e.l=t,e.read_shift=bS,e.chk=kS,e.write_shift=ES}function xS(e,t){e.l+=t}function CS(e){var t=Zy(e);return _S(t,0),t}function IS(e,t,n){if(e){var r,a,i;_S(e,e.l||0);for(var s=e.length,o=0,l=0;e.l<s;){128&(o=e.read_shift(1))&&(o=(127&o)+((127&e.read_shift(1))<<7));var c=MA[o]||MA[65535];for(i=127&(r=e.read_shift(1)),a=1;a<4&&128&r;++a)i+=(127&(r=e.read_shift(1)))<<7*a;l=e.l+i;var u=c.f&&c.f(e,i,n);if(e.l=l,t(u,c,o))return}}}function AS(){var e=[],t=Qy?256:2048,n=function(e){var t=CS(e);return _S(t,0),t},r=n(t),a=function(){r&&(r.length>r.l&&((r=r.slice(0,r.l)).l=r.length),r.length>0&&e.push(r),r=null)},i=function(e){return r&&e<r.length-r.l?r:(a(),r=n(Math.max(e+1,t)))};return{next:i,push:function(e){a(),null==(r=e).l&&(r.l=r.length),i(t)},end:function(){return a(),ib(e)},_bufs:e}}function NS(e,t,n,r){var a,i=+t;if(!isNaN(i)){r||(r=MA[i].p||(n||[]).length||0),a=1+(i>=128?1:0)+1,r>=128&&++a,r>=16384&&++a,r>=2097152&&++a;var s=e.next(a);i<=127?s.write_shift(1,i):(s.write_shift(1,128+(127&i)),s.write_shift(1,i>>7));for(var o=0;4!=o;++o){if(!(r>=128)){s.write_shift(1,r);break}s.write_shift(1,128+(127&r)),r>>=7}r>0&&hS(n)&&e.push(n)}}function RS(e,t,n){var r=Sw(e);if(t.s?(r.cRel&&(r.c+=t.s.c),r.rRel&&(r.r+=t.s.r)):(r.cRel&&(r.c+=t.c),r.rRel&&(r.r+=t.r)),!n||n.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function OS(e,t,n){var r=Sw(e);return r.s=RS(r.s,t.s,n),r.e=RS(r.e,t.s,n),r}function PS(e,t){if(e.cRel&&e.c<0)for(e=Sw(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Sw(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var n=VS(e);return e.cRel||null==e.cRel||(n=n.replace(/^([A-Z])/,"$$$1")),e.rRel||null==e.rRel||(n=function(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}(n)),n}function DS(e,t){return 0!=e.s.r||e.s.rRel||e.e.r!=(t.biff>=12?1048575:t.biff>=8?65536:16384)||e.e.rRel?0!=e.s.c||e.s.cRel||e.e.c!=(t.biff>=12?16383:255)||e.e.cRel?PS(e.s,t.biff)+":"+PS(e.e,t.biff):(e.s.rRel?"":"$")+MS(e.s.r)+":"+(e.e.rRel?"":"$")+MS(e.e.r):(e.s.cRel?"":"$")+US(e.s.c)+":"+(e.e.cRel?"":"$")+US(e.e.c)}function LS(e){return parseInt(e.replace(/\$(\d+)$/,"$1"),10)-1}function MS(e){return""+(e+1)}function FS(e){for(var t=e.replace(/^\$([A-Z])/,"$1"),n=0,r=0;r!==t.length;++r)n=26*n+t.charCodeAt(r)-64;return n-1}function US(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function jS(e){for(var t=0,n=0,r=0;r<e.length;++r){var a=e.charCodeAt(r);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(n=26*n+(a-64))}return{c:n-1,r:t-1}}function VS(e){for(var t=e.c+1,n="";t;t=(t-1)/26|0)n=String.fromCharCode((t-1)%26+65)+n;return n+(e.r+1)}function zS(e){var t=e.indexOf(":");return-1==t?{s:jS(e),e:jS(e)}:{s:jS(e.slice(0,t)),e:jS(e.slice(t+1))}}function BS(e,t){return"undefined"===typeof t||"number"===typeof t?BS(e.s,e.e):("string"!==typeof e&&(e=VS(e)),"string"!==typeof t&&(t=VS(t)),e==t?e:e+":"+t)}function HS(e){var t={s:{c:0,r:0},e:{c:0,r:0}},n=0,r=0,a=0,i=e.length;for(n=0;r<i&&!((a=e.charCodeAt(r)-64)<1||a>26);++r)n=26*n+a;for(t.s.c=--n,n=0;r<i&&!((a=e.charCodeAt(r)-48)<0||a>9);++r)n=10*n+a;if(t.s.r=--n,r===i||10!=a)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++r,n=0;r!=i&&!((a=e.charCodeAt(r)-64)<1||a>26);++r)n=26*n+a;for(t.e.c=--n,n=0;r!=i&&!((a=e.charCodeAt(r)-48)<0||a>9);++r)n=10*n+a;return t.e.r=--n,t}function WS(e,t){var n="d"==e.t&&t instanceof Date;if(null!=e.z)try{return e.w=Xb(e.z,n?hw(t):t)}catch(AR){}try{return e.w=Xb((e.XF||{}).numFmtId||(n?14:0),n?hw(t):t)}catch(AR){return""+t}}function GS(e,t,n){return null==e||null==e.t||"z"==e.t?"":void 0!==e.w?e.w:("d"==e.t&&!e.z&&n&&n.dateNF&&(e.z=n.dateNF),"e"==e.t?NE[e.v]||e.v:WS(e,void 0==t?e.v:t))}function KS(e,t){var n=t&&t.sheet?t.sheet:"Sheet1",r={};return r[n]=e,{SheetNames:[n],Sheets:r}}function qS(e,t,n){var r=n||{},a=e?Array.isArray(e):r.dense;var i=e||(a?[]:{}),s=0,o=0;if(i&&null!=r.origin){if("number"==typeof r.origin)s=r.origin;else{var l="string"==typeof r.origin?jS(r.origin):r.origin;s=l.r,o=l.c}i["!ref"]||(i["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var u=HS(i["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),-1==s&&(c.e.r=s=u.e.r+1)}for(var h=0;h!=t.length;++h)if(t[h]){if(!Array.isArray(t[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var f=0;f!=t[h].length;++f)if("undefined"!==typeof t[h][f]){var d={v:t[h][f]},p=s+h,m=o+f;if(c.s.r>p&&(c.s.r=p),c.s.c>m&&(c.s.c=m),c.e.r<p&&(c.e.r=p),c.e.c<m&&(c.e.c=m),!t[h][f]||"object"!==typeof t[h][f]||Array.isArray(t[h][f])||t[h][f]instanceof Date)if(Array.isArray(d.v)&&(d.f=t[h][f][1],d.v=d.v[0]),null===d.v)if(d.f)d.t="n";else if(r.nullError)d.t="e",d.v=0;else{if(!r.sheetStubs)continue;d.t="z"}else"number"===typeof d.v?d.t="n":"boolean"===typeof d.v?d.t="b":d.v instanceof Date?(d.z=r.dateNF||vb[14],r.cellDates?(d.t="d",d.w=Xb(d.z,hw(d.v))):(d.t="n",d.v=hw(d.v),d.w=Xb(d.z,d.v))):d.t="s";else d=t[h][f];if(a)i[p]||(i[p]=[]),i[p][m]&&i[p][m].z&&(d.z=i[p][m].z),i[p][m]=d;else{var g=VS({c:m,r:p});i[g]&&i[g].z&&(d.z=i[g].z),i[g]=d}}}return c.s.c<1e7&&(i["!ref"]=BS(c)),i}function $S(e,t){return qS(null,e,t)}function XS(e,t){return t||(t=CS(4)),t.write_shift(4,e),t}function YS(e){var t=e.read_shift(4);return 0===t?"":e.read_shift(t,"dbcs")}function QS(e,t){var n=!1;return null==t&&(n=!0,t=CS(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),n?t.slice(0,t.l):t}function JS(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function ZS(e,t){var n=e.l,r=e.read_shift(1),a=YS(e),i=[],s={t:a,h:a};if(0!==(1&r)){for(var o=e.read_shift(4),l=0;l!=o;++l)i.push(JS(e));s.r=i}else s.r=[{ich:0,ifnt:0}];return e.l=n+t,s}var eE=ZS;function tE(e,t){var n=!1;return null==t&&(n=!0,t=CS(23+4*e.t.length)),t.write_shift(1,1),QS(e.t,t),t.write_shift(4,1),function(e,t){t||(t=CS(4)),t.write_shift(2,e.ich||0),t.write_shift(2,e.ifnt||0)}({ich:0,ifnt:0},t),n?t.slice(0,t.l):t}function nE(e){var t=e.read_shift(4),n=e.read_shift(2);return n+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:n}}function rE(e,t){return null==t&&(t=CS(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function aE(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function iE(e,t){return null==t&&(t=CS(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var sE=YS,oE=QS;function lE(e){var t=e.read_shift(4);return 0===t||4294967295===t?"":e.read_shift(t,"dbcs")}function cE(e,t){var n=!1;return null==t&&(n=!0,t=CS(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),n?t.slice(0,t.l):t}var uE=YS,hE=lE,fE=cE;function dE(e){var t=e.slice(e.l,e.l+4),n=1&t[0],r=2&t[0];e.l+=4;var a=0===r?uS([0,0,0,0,252&t[0],t[1],t[2],t[3]],0):vS(t,0)>>2;return n?a/100:a}function pE(e,t){null==t&&(t=CS(4));var n=0,r=0,a=100*e;if(e==(0|e)&&e>=-(1<<29)&&e<1<<29?r=1:a==(0|a)&&a>=-(1<<29)&&a<1<<29&&(r=1,n=1),!r)throw new Error("unsupported RkNumber "+e);t.write_shift(-4,((n?a:e)<<2)+(n+2))}function mE(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var gE=mE,vE=function(e,t){return t||(t=CS(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t};function yE(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function bE(e,t){return(t||CS(8)).write_shift(8,e,"f")}function wE(e,t){if(t||(t=CS(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;null!=e.index?(t.write_shift(1,2),t.write_shift(1,e.index)):null!=e.theme?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var n=e.tint||0;if(n>0?n*=32767:n<0&&(n*=32768),t.write_shift(2,n),e.rgb&&null==e.theme){var r=e.rgb||"FFFFFF";"number"==typeof r&&(r=("000000"+r.toString(16)).slice(-6)),t.write_shift(1,parseInt(r.slice(0,2),16)),t.write_shift(1,parseInt(r.slice(2,4),16)),t.write_shift(1,parseInt(r.slice(4,6),16)),t.write_shift(1,255)}else t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);return t}function TE(e,t){var n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return{2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"}[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,1==t?"lpstr":"lpwstr")}var SE=80,EE=[SE,81],kE={1:{n:"CodePage",t:2},2:{n:"Category",t:SE},3:{n:"PresentationFormat",t:SE},4:{n:"ByteCount",t:3},5:{n:"LineCount",t:3},6:{n:"ParagraphCount",t:3},7:{n:"SlideCount",t:3},8:{n:"NoteCount",t:3},9:{n:"HiddenCount",t:3},10:{n:"MultimediaClipCount",t:3},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:SE},15:{n:"Company",t:SE},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:3},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:3,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:SE},27:{n:"ContentStatus",t:SE},28:{n:"Language",t:SE},29:{n:"Version",t:SE},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},_E={1:{n:"CodePage",t:2},2:{n:"Title",t:SE},3:{n:"Subject",t:SE},4:{n:"Author",t:SE},5:{n:"Keywords",t:SE},6:{n:"Comments",t:SE},7:{n:"Template",t:SE},8:{n:"LastAuthor",t:SE},9:{n:"RevNumber",t:SE},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:3},15:{n:"WordCount",t:3},16:{n:"CharCount",t:3},17:{n:"Thumbnail",t:71},18:{n:"Application",t:SE},19:{n:"DocSecurity",t:3},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},xE={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},CE=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function IE(e){return e.map(function(e){return[e>>16&255,e>>8&255,255&e]})}var AE=Sw(IE([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),NE={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},RE={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},OE={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},PE={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function DE(e,t){var n,r=function(e){for(var t=[],n=sw(e),r=0;r!==n.length;++r)null==t[e[n[r]]]&&(t[e[n[r]]]=[]),t[e[n[r]]].push(n[r]);return t}(OE),a=[];a[a.length]=Vw,a[a.length]=wT("Types",null,{xmlns:CT,"xmlns:xsd":MT,"xmlns:xsi":LT}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(e){return wT("Default",null,{Extension:e[0],ContentType:e[1]})}));var i=function(r){e[r]&&e[r].length>0&&(n=e[r][0],a[a.length]=wT("Override",null,{PartName:("/"==n[0]?"":"/")+n,ContentType:PE[r][t.bookType]||PE[r].xlsx}))},s=function(n){(e[n]||[]).forEach(function(e){a[a.length]=wT("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:PE[n][t.bookType]||PE[n].xlsx})})},o=function(t){(e[t]||[]).forEach(function(e){a[a.length]=wT("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:r[t][0]})})};return i("workbooks"),s("sheets"),s("charts"),o("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),s("metadata"),o("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var LE={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function ME(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function FE(e,t){var n={"!id":{}};if(!e)return n;"/"!==t.charAt(0)&&(t="/"+t);var r={};return(e.match(Hw)||[]).forEach(function(e){var a=Kw(e);if("<Relationship"===a[0]){var i={};i.Type=a.Type,i.Target=a.Target,i.Id=a.Id,a.TargetMode&&(i.TargetMode=a.TargetMode);var s="External"===a.TargetMode?a.Target:jw(a.Target,t);n[s]=i,r[a.Id]=i}}),n["!id"]=r,n}function UE(e){var t=[Vw,wT("Relationships",null,{xmlns:IT})];return sw(e["!id"]).forEach(function(n){t[t.length]=wT("Relationship",null,e["!id"][n])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function jE(e,t,n,r,a,i){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=r,a.Target=n,i?a.TargetMode=i:[LE.HLINK,LE.XPATH,LE.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}function VE(e,t,n){return['  <rdf:Description rdf:about="'+e+'">\n','    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(n||"odf")+"#"+t+'"/>\n',"  </rdf:Description>\n"].join("")}function zE(e,t){return['  <rdf:Description rdf:about="'+e+'">\n','    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+'"/>\n',"  </rdf:Description>\n"].join("")}function BE(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Dy.version+"</meta:generator></office:meta></office:document-meta>"}var HE=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],WE=function(){for(var e=new Array(HE.length),t=0;t<HE.length;++t){var n=HE[t],r="(?:"+n[0].slice(0,n[0].indexOf(":"))+":)"+n[0].slice(n[0].indexOf(":")+1);e[t]=new RegExp("<"+r+"[^>]*>([\\s\\S]*?)</"+r+">")}return e}();function GE(e){var t={};e=cT(e);for(var n=0;n<HE.length;++n){var r=HE[n],a=e.match(WE[n]);null!=a&&a.length>0&&(t[r[1]]=Yw(a[1])),"date"===r[2]&&t[r[1]]&&(t[r[1]]=ww(t[r[1]]))}return t}function KE(e,t,n,r,a){null==a[e]&&null!=t&&""!==t&&(a[e]=t,t=Zw(t),r[r.length]=n?wT(e,t,n):yT(e,t))}function qE(e,t){var n=t||{},r=[Vw,wT("cp:coreProperties",null,{"xmlns:cp":kT,"xmlns:dc":NT,"xmlns:dcterms":RT,"xmlns:dcmitype":OT,"xmlns:xsi":LT})],a={};if(!e&&!n.Props)return r.join("");e&&(null!=e.CreatedDate&&KE("dcterms:created","string"===typeof e.CreatedDate?e.CreatedDate:TT(e.CreatedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,a),null!=e.ModifiedDate&&KE("dcterms:modified","string"===typeof e.ModifiedDate?e.ModifiedDate:TT(e.ModifiedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,a));for(var i=0;i!=HE.length;++i){var s=HE[i],o=n.Props&&null!=n.Props[s[1]]?n.Props[s[1]]:e?e[s[1]]:null;!0===o?o="1":!1===o?o="0":"number"==typeof o&&(o=String(o)),null!=o&&KE(s[0],o,null,r,a)}return r.length>2&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">")),r.join("")}var $E=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],XE=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function YE(e,t,n,r){var a=[];if("string"==typeof e)a=gT(e,r);else for(var i=0;i<e.length;++i)a=a.concat(e[i].map(function(e){return{v:e}}));var s="string"==typeof t?gT(t,r).map(function(e){return e.v}):t,o=0,l=0;if(s.length>0)for(var c=0;c!==a.length;c+=2){switch(l=+a[c+1].v,a[c].v){case"Worksheets":case"\u5de5\u4f5c\u8868":case"\u041b\u0438\u0441\u0442\u044b":case"\u0623\u0648\u0631\u0627\u0642 \u0627\u0644\u0639\u0645\u0644":case"\u30ef\u30fc\u30af\u30b7\u30fc\u30c8":case"\u05d2\u05dc\u05d9\u05d5\u05e0\u05d5\u05ea \u05e2\u05d1\u05d5\u05d3\u05d4":case"Arbeitsbl\xe4tter":case"\xc7al\u0131\u015fma Sayfalar\u0131":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de c\xe1lculo":case"Planilhas":case"Regneark":case"Hojas de c\xe1lculo":case"Werkbladen":n.Worksheets=l,n.SheetNames=s.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"\u540d\u524d\u4ed8\u304d\u4e00\u89a7":case"Benannte Bereiche":case"Navngivne omr\xe5der":n.NamedRanges=l,n.DefinedNames=s.slice(o,o+l);break;case"Charts":case"Diagramme":n.Chartsheets=l,n.ChartNames=s.slice(o,o+l)}o+=l}}function QE(e){var t=[],n=wT;return e||(e={}),e.Application="SheetJS",t[t.length]=Vw,t[t.length]=wT("Properties",null,{xmlns:xT,"xmlns:vt":DT}),$E.forEach(function(r){if(void 0!==e[r[1]]){var a;switch(r[2]){case"string":a=Zw(String(e[r[1]]));break;case"bool":a=e[r[1]]?"true":"false"}void 0!==a&&(t[t.length]=n(r[0],a))}}),t[t.length]=n("HeadingPairs",n("vt:vector",n("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+n("vt:variant",n("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=n("TitlesOfParts",n("vt:vector",e.SheetNames.map(function(e){return"<vt:lpstr>"+Zw(e)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var JE=/<[^>]+>[^<]*/g;function ZE(e){var t=[Vw,wT("Properties",null,{xmlns:_T,"xmlns:vt":DT})];if(!e)return t.join("");var n=1;return sw(e).forEach(function(r){++n,t[t.length]=wT("property",function(e,t){switch(typeof e){case"string":var n=wT("vt:lpwstr",Zw(e));return t&&(n=n.replace(/&quot;/g,"_x0022_")),n;case"number":return wT((0|e)==e?"vt:i4":"vt:r8",Zw(String(e)));case"boolean":return wT("vt:bool",e?"true":"false")}if(e instanceof Date)return wT("vt:filetime",TT(e));throw new Error("Unable to serialize "+e)}(e[r],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:n,name:Zw(r)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var ek,tk={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function nk(e,t,n){ek||(ek=lw(tk)),e[t=ek[t]||t]=n}function rk(e){var t=e.read_shift(4),n=e.read_shift(4);return new Date(1e3*(n/1e7*Math.pow(2,32)+t/1e7-11644473600)).toISOString().replace(/\.000/,"")}function ak(e,t,n){var r=e.l,a=e.read_shift(0,"lpstr-cp");if(n)for(;e.l-r&3;)++e.l;return a}function ik(e,t,n){var r=e.read_shift(0,"lpwstr");return n&&(e.l+=4-(r.length+1&3)&3),r}function sk(e,t,n){return 31===t?ik(e):ak(e,0,n)}function ok(e,t,n){return sk(e,t,!1===n?0:4)}function lk(e){var t=e.l,n=hk(e,81);return 0==e[e.l]&&0==e[e.l+1]&&e.l-t&2&&(e.l+=2),[n,hk(e,3)]}function ck(e,t){for(var n=e.read_shift(4),r={},a=0;a!=n;++a){var i=e.read_shift(4),s=e.read_shift(4);r[i]=e.read_shift(s,1200===t?"utf16le":"utf8").replace(sb,"").replace(ob,"!"),1200===t&&s%2&&(e.l+=2)}return 3&e.l&&(e.l=e.l>>3<<2),r}function uk(e){var t=e.read_shift(4),n=e.slice(e.l,e.l+t);return e.l+=t,(3&t)>0&&(e.l+=4-(3&t)&3),n}function hk(e,t,n){var r,a=e.read_shift(2),i=n||{};if(e.l+=2,12!==t&&a!==t&&-1===EE.indexOf(t)&&(4126!=(65534&t)||4126!=(65534&a)))throw new Error("Expected type "+t+" saw "+a);switch(12===t?a:t){case 2:return r=e.read_shift(2,"i"),i.raw||(e.l+=2),r;case 3:return r=e.read_shift(4,"i");case 11:return 0!==e.read_shift(4);case 19:return r=e.read_shift(4);case 30:return ak(e,0,4).replace(sb,"");case 31:return ik(e);case 64:return rk(e);case 65:return uk(e);case 71:return function(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}(e);case 80:return ok(e,a,!i.raw).replace(sb,"");case 81:return function(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return sk(e,t,0)}(e,a).replace(sb,"");case 4108:return function(e){for(var t=e.read_shift(4),n=[],r=0;r<t/2;++r)n.push(lk(e));return n}(e);case 4126:case 4127:return 4127==a?function(e){for(var t=e.read_shift(4),n=[],r=0;r!=t;++r){var a=e.l;n[r]=e.read_shift(0,"lpwstr").replace(sb,""),e.l-a&2&&(e.l+=2)}return n}(e):function(e){for(var t=e.read_shift(4),n=[],r=0;r!=t;++r)n[r]=e.read_shift(0,"lpstr-cp").replace(sb,"");return n}(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+a)}}function fk(e,t){var n=CS(4),r=CS(4);switch(n.write_shift(4,80==e?31:e),e){case 3:r.write_shift(-4,t);break;case 5:(r=CS(8)).write_shift(8,t,"f");break;case 11:r.write_shift(4,t?1:0);break;case 64:r=function(e){var t=("string"==typeof e?new Date(Date.parse(e)):e).getTime()/1e3+11644473600,n=t%Math.pow(2,32),r=(t-n)/Math.pow(2,32);r*=1e7;var a=(n*=1e7)/Math.pow(2,32)|0;a>0&&(n%=Math.pow(2,32),r+=a);var i=CS(8);return i.write_shift(4,n),i.write_shift(4,r),i}(t);break;case 31:case 80:for((r=CS(4+2*(t.length+1)+(t.length%2?0:2))).write_shift(4,t.length+1),r.write_shift(0,t,"dbcs");r.l!=r.length;)r.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return ib([n,r])}function dk(e,t){var n=e.l,r=e.read_shift(4),a=e.read_shift(4),i=[],s=0,o=0,l=-1,c={};for(s=0;s!=a;++s){var u=e.read_shift(4),h=e.read_shift(4);i[s]=[u,h+n]}i.sort(function(e,t){return e[1]-t[1]});var f={};for(s=0;s!=a;++s){if(e.l!==i[s][1]){var d=!0;if(s>0&&t)switch(t[i[s-1][0]].t){case 2:e.l+2===i[s][1]&&(e.l+=2,d=!1);break;case 80:case 4108:e.l<=i[s][1]&&(e.l=i[s][1],d=!1)}if((!t||0==s)&&e.l<=i[s][1]&&(d=!1,e.l=i[s][1]),d)throw new Error("Read Error: Expected address "+i[s][1]+" at "+e.l+" :"+s)}if(t){var p=t[i[s][0]];if(f[p.n]=hk(e,p.t,{raw:!0}),"version"===p.p&&(f[p.n]=String(f[p.n]>>16)+"."+("0000"+String(65535&f[p.n])).slice(-4)),"CodePage"==p.n)switch(f[p.n]){case 0:f[p.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Vy(o=f[p.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+f[p.n])}}else if(1===i[s][0]){if(o=f.CodePage=hk(e,2),Vy(o),-1!==l){var m=e.l;e.l=i[l][1],c=ck(e,o),e.l=m}}else if(0===i[s][0]){if(0===o){l=s,e.l=i[s+1][1];continue}c=ck(e,o)}else{var g,v=c[i[s][0]];switch(e[e.l]){case 65:e.l+=4,g=uk(e);break;case 30:case 31:e.l+=4,g=ok(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,g=e.read_shift(4,"i");break;case 19:e.l+=4,g=e.read_shift(4);break;case 5:e.l+=4,g=e.read_shift(8,"f");break;case 11:e.l+=4,g=wk(e,4);break;case 64:e.l+=4,g=ww(rk(e));break;default:throw new Error("unparsed value: "+e[e.l])}f[v]=g}}return e.l=n+r,f}var pk=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function mk(e){switch(typeof e){case"boolean":return 11;case"number":return(0|e)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64}return-1}function gk(e,t,n){var r=CS(8),a=[],i=[],s=8,o=0,l=CS(8),c=CS(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),i.push(l),a.push(c),s+=8+l.length,!t){(c=CS(8)).write_shift(4,0),a.unshift(c);var u=[CS(4)];for(u[0].write_shift(4,e.length),o=0;o<e.length;++o){var h=e[o][0];for((l=CS(8+2*(h.length+1)+(h.length%2?0:2))).write_shift(4,o+2),l.write_shift(4,h.length+1),l.write_shift(0,h,"dbcs");l.l!=l.length;)l.write_shift(1,0);u.push(l)}l=ib(u),i.unshift(l),s+=8+l.length}for(o=0;o<e.length;++o)if((!t||t[e[o][0]])&&!(pk.indexOf(e[o][0])>-1||XE.indexOf(e[o][0])>-1)&&null!=e[o][1]){var f=e[o][1],d=0;if(t){var p=n[d=+t[e[o][0]]];if("version"==p.p&&"string"==typeof f){var m=f.split(".");f=(+m[0]<<16)+(+m[1]||0)}l=fk(p.t,f)}else{var g=mk(f);-1==g&&(g=31,f=String(f)),l=fk(g,f)}i.push(l),(c=CS(8)).write_shift(4,t?d:2+o),a.push(c),s+=8+l.length}var v=8*(i.length+1);for(o=0;o<i.length;++o)a[o].write_shift(4,v),v+=i[o].length;return r.write_shift(4,s),r.write_shift(4,i.length),ib([r].concat(a).concat(i))}function vk(e,t,n){var r=e.content;if(!r)return{};_S(r,0);var a,i,s,o,l=0;r.chk("feff","Byte Order: "),r.read_shift(2);var c=r.read_shift(4),u=r.read_shift(16);if(u!==nw.utils.consts.HEADER_CLSID&&u!==n)throw new Error("Bad PropertySet CLSID "+u);if(1!==(a=r.read_shift(4))&&2!==a)throw new Error("Unrecognized #Sets: "+a);if(i=r.read_shift(16),o=r.read_shift(4),1===a&&o!==r.l)throw new Error("Length mismatch: "+o+" !== "+r.l);2===a&&(s=r.read_shift(16),l=r.read_shift(4));var h,f=dk(r,t),d={SystemIdentifier:c};for(var p in f)d[p]=f[p];if(d.FMTID=i,1===a)return d;if(l-r.l==2&&(r.l+=2),r.l!==l)throw new Error("Length mismatch 2: "+r.l+" !== "+l);try{h=dk(r,null)}catch(AR){}for(p in h)d[p]=h[p];return d.FMTID=[i,s],d}function yk(e,t,n,r,a,i){var s=CS(a?68:48),o=[s];s.write_shift(2,65534),s.write_shift(2,0),s.write_shift(4,842412599),s.write_shift(16,nw.utils.consts.HEADER_CLSID,"hex"),s.write_shift(4,a?2:1),s.write_shift(16,t,"hex"),s.write_shift(4,a?68:48);var l=gk(e,n,r);if(o.push(l),a){var c=gk(a,null,null);s.write_shift(16,i,"hex"),s.write_shift(4,68+l.length),o.push(c)}return ib(o)}function bk(e,t){return e.read_shift(t),null}function wk(e,t){return 1===e.read_shift(t)}function Tk(e,t){return t||(t=CS(2)),t.write_shift(2,+!!e),t}function Sk(e){return e.read_shift(2,"u")}function Ek(e,t){return t||(t=CS(2)),t.write_shift(2,e),t}function kk(e,t){return function(e,t,n){for(var r=[],a=e.l+t;e.l<a;)r.push(n(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return r}(e,t,Sk)}function _k(e,t,n){return n||(n=CS(2)),n.write_shift(1,"e"==t?+e:+!!e),n.write_shift(1,"e"==t?1:0),n}function xk(e,t,n){var r=e.read_shift(n&&n.biff>=12?2:1),a="sbcs-cont",i=Ly;(n&&n.biff>=8&&(Ly=1200),n&&8!=n.biff)?12==n.biff&&(a="wstr"):e.read_shift(1)&&(a="dbcs-cont");n.biff>=2&&n.biff<=5&&(a="cpstr");var s=r?e.read_shift(r,a):"";return Ly=i,s}function Ck(e){var t=Ly;Ly=1200;var n,r=e.read_shift(2),a=e.read_shift(1),i=4&a,s=8&a,o=1+(1&a),l=0,c={};s&&(l=e.read_shift(2)),i&&(n=e.read_shift(4));var u=2==o?"dbcs-cont":"sbcs-cont",h=0===r?"":e.read_shift(r,u);return s&&(e.l+=4*l),i&&(e.l+=n),c.t=h,s||(c.raw="<t>"+c.t+"</t>",c.r=c.t),Ly=t,c}function Ik(e){var t=e.t||"",n=CS(3);n.write_shift(2,t.length),n.write_shift(1,1);var r=CS(2*t.length);return r.write_shift(2*t.length,t,"utf16le"),ib([n,r])}function Ak(e,t,n){if(n){if(n.biff>=2&&n.biff<=5)return e.read_shift(t,"cpstr");if(n.biff>=12)return e.read_shift(t,"dbcs-cont")}return 0===e.read_shift(1)?e.read_shift(t,"sbcs-cont"):e.read_shift(t,"dbcs-cont")}function Nk(e,t,n){var r=e.read_shift(n&&2==n.biff?1:2);return 0===r?(e.l++,""):Ak(e,r,n)}function Rk(e,t,n){if(n.biff>5)return Nk(e,0,n);var r=e.read_shift(1);return 0===r?(e.l++,""):e.read_shift(r,n.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Ok(e,t,n){return n||(n=CS(3+2*e.length)),n.write_shift(2,e.length),n.write_shift(1,1),n.write_shift(31,e,"utf16le"),n}function Pk(e,t){var n=e.read_shift(16);switch(n){case"e0c9ea79f9bace118c8200aa004ba90b":return function(e){var t=e.read_shift(4),n=e.l,r=!1;t>24&&(e.l+=t-24,"795881f43b1d7f48af2c825dc4852763"===e.read_shift(16)&&(r=!0),e.l=n);var a=e.read_shift((r?t-24:t)>>1,"utf16le").replace(sb,"");return r&&(e.l+=24),a}(e);case"0303000000000000c000000000000046":return function(e){for(var t=e.read_shift(2),n="";t-- >0;)n+="../";var r=e.read_shift(0,"lpstr-ansi");if(e.l+=2,57005!=e.read_shift(2))throw new Error("Bad FileMoniker");if(0===e.read_shift(4))return n+r.replace(/\\/g,"/");var a=e.read_shift(4);if(3!=e.read_shift(2))throw new Error("Bad FileMoniker");return n+e.read_shift(a>>1,"utf16le").replace(sb,"")}(e);default:throw new Error("Unsupported Moniker "+n)}}function Dk(e){var t=e.read_shift(4);return t>0?e.read_shift(t,"utf16le").replace(sb,""):""}function Lk(e,t){t||(t=CS(6+2*e.length)),t.write_shift(4,1+e.length);for(var n=0;n<e.length;++n)t.write_shift(2,e.charCodeAt(n));return t.write_shift(2,0),t}function Mk(e){var t=CS(512),n=0,r=e.Target;"file://"==r.slice(0,7)&&(r=r.slice(7));var a=r.indexOf("#"),i=a>-1?31:23;switch(r.charAt(0)){case"#":i=28;break;case".":i&=-3}t.write_shift(4,2),t.write_shift(4,i);var s=[8,6815827,6619237,4849780,83];for(n=0;n<s.length;++n)t.write_shift(4,s[n]);if(28==i)Lk(r=r.slice(1),t);else if(2&i){for(s="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<s.length;++n)t.write_shift(1,parseInt(s[n],16));var o=a>-1?r.slice(0,a):r;for(t.write_shift(4,2*(o.length+1)),n=0;n<o.length;++n)t.write_shift(2,o.charCodeAt(n));t.write_shift(2,0),8&i&&Lk(a>-1?r.slice(a+1):"",t)}else{for(s="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),n=0;n<s.length;++n)t.write_shift(1,parseInt(s[n],16));for(var l=0;"../"==r.slice(3*l,3*l+3)||"..\\"==r.slice(3*l,3*l+3);)++l;for(t.write_shift(2,l),t.write_shift(4,r.length-3*l+1),n=0;n<r.length-3*l;++n)t.write_shift(1,255&r.charCodeAt(n+3*l));for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),n=0;n<6;++n)t.write_shift(4,0)}return t.slice(0,t.l)}function Fk(e){return[e.read_shift(1),e.read_shift(1),e.read_shift(1),e.read_shift(1)]}function Uk(e,t){var n=Fk(e);return n[3]=0,n}function jk(e){return{r:e.read_shift(2),c:e.read_shift(2),ixfe:e.read_shift(2)}}function Vk(e,t,n,r){return r||(r=CS(6)),r.write_shift(2,e),r.write_shift(2,t),r.write_shift(2,n||0),r}function zk(e,t,n){var r=n.biff>8?4:2;return[e.read_shift(r),e.read_shift(r,"i"),e.read_shift(r,"i")]}function Bk(e){return[e.read_shift(2),dE(e)]}function Hk(e){var t=e.read_shift(2),n=e.read_shift(2);return{s:{c:e.read_shift(2),r:t},e:{c:e.read_shift(2),r:n}}}function Wk(e,t){return t||(t=CS(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function Gk(e){var t=e.read_shift(2),n=e.read_shift(2);return{s:{c:e.read_shift(1),r:t},e:{c:e.read_shift(1),r:n}}}var Kk=Gk;function qk(e){e.l+=4;var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(2);return e.l+=12,[n,t,r]}function $k(e){e.l+=2,e.l+=e.read_shift(2)}var Xk={0:$k,4:$k,5:$k,6:$k,7:function(e){return e.l+=4,e.cf=e.read_shift(2),{}},8:$k,9:$k,10:$k,11:$k,12:$k,13:function(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t},14:$k,15:$k,16:$k,17:$k,18:$k,19:$k,20:$k,21:qk};function Yk(e,t){var n={BIFFVer:0,dt:0};switch(n.BIFFVer=e.read_shift(2),(t-=2)>=2&&(n.dt=e.read_shift(2),e.l-=2),n.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+n.BIFFVer)}return e.read_shift(t),n}function Qk(e,t,n){var r=1536,a=16;switch(n.bookType){case"biff8":case"xla":break;case"biff5":r=1280,a=8;break;case"biff4":r=4,a=6;break;case"biff3":r=3,a=6;break;case"biff2":r=2,a=4;break;default:throw new Error("unsupported BIFF version")}var i=CS(a);return i.write_shift(2,r),i.write_shift(2,t),a>4&&i.write_shift(2,29282),a>6&&i.write_shift(2,1997),a>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function Jk(e,t){var n=!t||t.biff>=8?2:1,r=CS(8+n*e.name.length);r.write_shift(4,e.pos),r.write_shift(1,e.hs||0),r.write_shift(1,e.dt),r.write_shift(1,e.name.length),t.biff>=8&&r.write_shift(1,1),r.write_shift(n*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=r.slice(0,r.l);return a.l=r.l,a}function Zk(e,t,n){var r=0;n&&2==n.biff||(r=e.read_shift(2));var a=e.read_shift(2);return n&&2==n.biff&&(r=1-(a>>15),a&=32767),[{Unsynced:1&r,DyZero:(2&r)>>1,ExAsc:(4&r)>>2,ExDsc:(8&r)>>3},a]}function e_(e,t,n,r){var a=n&&5==n.biff;r||(r=CS(a?3+t.length:5+2*t.length)),r.write_shift(2,e),r.write_shift(a?1:2,t.length),a||r.write_shift(1,1),r.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var i=r.length>r.l?r.slice(0,r.l):r;return null==i.l&&(i.l=i.length),i}var t_=Rk;function n_(e,t,n){var r=e.l+t,a=8!=n.biff&&n.biff?2:4,i=e.read_shift(a),s=e.read_shift(a),o=e.read_shift(2),l=e.read_shift(2);return e.l=r,{s:{r:i,c:o},e:{r:s,c:l}}}function r_(e,t,n,r){var a=n&&5==n.biff;r||(r=CS(a?16:20)),r.write_shift(2,0),e.style?(r.write_shift(2,e.numFmtId||0),r.write_shift(2,65524)):(r.write_shift(2,e.numFmtId||0),r.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&a&&(i|=1024),r.write_shift(4,i),r.write_shift(4,0),a||r.write_shift(4,0),r.write_shift(2,0),r}function a_(e,t,n){var r=jk(e);2!=n.biff&&9!=t||++e.l;var a=function(e){var t=e.read_shift(1);return 1===e.read_shift(1)?t:1===t}(e);return r.val=a,r.t=!0===a||!1===a?"b":"e",r}var i_=function(e,t,n){return 0===t?"":Rk(e,0,n)};function s_(e,t,n){var r,a=e.read_shift(2),i={fBuiltIn:1&a,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return 14849===n.sbcch&&(r=function(e,t,n){e.l+=4,t-=4;var r=e.l+t,a=xk(e,0,n),i=e.read_shift(2);if(i!==(r-=e.l))throw new Error("Malformed AddinUdf: padding = "+r+" != "+i);return e.l+=i,a}(e,t-2,n)),i.body=r||e.read_shift(t-2),"string"===typeof r&&(i.Name=r),i}var o_=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function l_(e,t,n){var r=e.l+t,a=e.read_shift(2),i=e.read_shift(1),s=e.read_shift(1),o=e.read_shift(n&&2==n.biff?1:2),l=0;(!n||n.biff>=5)&&(5!=n.biff&&(e.l+=2),l=e.read_shift(2),5==n.biff&&(e.l+=2),e.l+=4);var c=Ak(e,s,n);32&a&&(c=o_[c.charCodeAt(0)]);var u=r-e.l;n&&2==n.biff&&--u;var h=r!=e.l&&0!==o&&u>0?function(e,t,n,r){var a,i=e.l+t,s=EC(e,r,n);i!==e.l&&(a=SC(e,i-e.l,s,n));return[s,a]}(e,u,n,o):[];return{chKey:i,Name:c,itab:l,rgce:h}}function c_(e,t,n){if(n.biff<8)return function(e,t,n){3==e[e.l+1]&&e[e.l]++;var r=xk(e,0,n);return 3==r.charCodeAt(0)?r.slice(1):r}(e,0,n);for(var r=[],a=e.l+t,i=e.read_shift(n.biff>8?4:2);0!==i--;)r.push(zk(e,n.biff,n));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return r}function u_(e,t,n){var r=Kk(e,6);switch(n.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[r,AC(e,t,n)]}var h_={8:function(e,t){var n=e.l+t;e.l+=10;var r=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=n,{fmt:r}}};function f_(e){var t=CS(24),n=jS(e[0]);t.write_shift(2,n.r),t.write_shift(2,n.r),t.write_shift(2,n.c),t.write_shift(2,n.c);for(var r="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(r[a],16));return ib([t,Mk(e[1])])}function d_(e){var t=e[1].Tooltip,n=CS(10+2*(t.length+1));n.write_shift(2,2048);var r=jS(e[0]);n.write_shift(2,r.r),n.write_shift(2,r.r),n.write_shift(2,r.c),n.write_shift(2,r.c);for(var a=0;a<t.length;++a)n.write_shift(2,t.charCodeAt(a));return n.write_shift(2,0),n}function p_(e,t,n){if(!n.cellStyles)return xS(e,t);var r=n&&n.biff>=12?4:2,a=e.read_shift(r),i=e.read_shift(r),s=e.read_shift(r),o=e.read_shift(r),l=e.read_shift(2);2==r&&(e.l+=2);var c={s:a,e:i,w:s,ixfe:o,flags:l};return(n.biff>=5||!n.biff)&&(c.level=l>>8&7),c}var m_=jk,g_=kk,v_=Nk;var y_=[2,3,48,49,131,139,140,245],b_=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=lw({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function n(t,n){var r=n||{};r.dateNF||(r.dateNF="yyyymmdd");var a=$S(function(t,n){var r=[],a=Zy(1);switch(n.type){case"base64":a=tb(Yy(t));break;case"binary":a=tb(t);break;case"buffer":case"array":a=t}_S(a,0);var i=a.read_shift(1),s=!!(136&i),o=!1,l=!1;switch(i){case 2:case 3:case 131:case 139:case 245:break;case 48:case 49:o=!0,s=!0;break;case 140:l=!0;break;default:throw new Error("DBF Unsupported Version: "+i.toString(16))}var c=0,u=521;2==i&&(c=a.read_shift(2)),a.l+=3,2!=i&&(c=a.read_shift(4)),c>1048576&&(c=1e6),2!=i&&(u=a.read_shift(2));var h=a.read_shift(2),f=n.codepage||1252;2!=i&&(a.l+=16,a.read_shift(1),0!==a[a.l]&&(f=e[a[a.l]]),a.l+=1,a.l+=2),l&&(a.l+=36);for(var d=[],p={},m=Math.min(a.length,2==i?521:u-10-(o?264:0)),g=l?32:11;a.l<m&&13!=a[a.l];)switch((p={}).name=Wy.utils.decode(f,a.slice(a.l,a.l+g)).replace(/[\u0000\r\n].*$/g,""),a.l+=g,p.type=String.fromCharCode(a.read_shift(1)),2==i||l||(p.offset=a.read_shift(4)),p.len=a.read_shift(1),2==i&&(p.offset=a.read_shift(2)),p.dec=a.read_shift(1),p.name.length&&d.push(p),2!=i&&(a.l+=l?13:14),p.type){case"B":o&&8==p.len||!n.WTF||console.log("Skipping "+p.name+":"+p.type);break;case"G":case"P":n.WTF&&console.log("Skipping "+p.name+":"+p.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+p.type)}if(13!==a[a.l]&&(a.l=u-1),13!==a.read_shift(1))throw new Error("DBF Terminator not found "+a.l+" "+a[a.l]);a.l=u;var v=0,y=0;for(r[0]=[],y=0;y!=d.length;++y)r[0][y]=d[y].name;for(;c-- >0;)if(42!==a[a.l])for(++a.l,r[++v]=[],y=0,y=0;y!=d.length;++y){var b=a.slice(a.l,a.l+d[y].len);a.l+=d[y].len,_S(b,0);var w=Wy.utils.decode(f,b);switch(d[y].type){case"C":w.trim().length&&(r[v][y]=w.replace(/\s+$/,""));break;case"D":8===w.length?r[v][y]=new Date(+w.slice(0,4),+w.slice(4,6)-1,+w.slice(6,8)):r[v][y]=w;break;case"F":r[v][y]=parseFloat(w.trim());break;case"+":case"I":r[v][y]=l?2147483648^b.read_shift(-4,"i"):b.read_shift(4,"i");break;case"L":switch(w.trim().toUpperCase()){case"Y":case"T":r[v][y]=!0;break;case"N":case"F":r[v][y]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+w+"|")}break;case"M":if(!s)throw new Error("DBF Unexpected MEMO for type "+i.toString(16));r[v][y]="##MEMO##"+(l?parseInt(w.trim(),10):b.read_shift(4));break;case"N":(w=w.replace(/\u0000/g,"").trim())&&"."!=w&&(r[v][y]=+w||0);break;case"@":r[v][y]=new Date(b.read_shift(-8,"f")-621356832e5);break;case"T":r[v][y]=new Date(864e5*(b.read_shift(4)-2440588)+b.read_shift(4));break;case"Y":r[v][y]=b.read_shift(4,"i")/1e4+b.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":r[v][y]=-b.read_shift(-8,"f");break;case"B":if(o&&8==d[y].len){r[v][y]=b.read_shift(8,"f");break}case"G":case"P":b.l+=d[y].len;break;case"0":if("_NullFlags"===d[y].name)break;default:throw new Error("DBF Unsupported data type "+d[y].type)}}else a.l+=h;if(2!=i&&a.l<a.length&&26!=a[a.l++])throw new Error("DBF EOF Marker missing "+(a.l-1)+" of "+a.length+" "+a[a.l-1].toString(16));return n&&n.sheetRows&&(r=r.slice(0,n.sheetRows)),n.DBF=d,r}(t,r),r);return a["!cols"]=r.DBF.map(function(e){return{wch:e.len,DBF:e}}),delete r.DBF,a}var r={B:8,C:250,L:1,D:8,"?":0,"":0};return{to_workbook:function(e,t){try{return KS(n(e,t),t)}catch(AR){if(t&&t.WTF)throw AR}return{SheetNames:[],Sheets:{}}},to_sheet:n,from_sheet:function(e,n){var a=n||{};if(+a.codepage>=0&&Vy(+a.codepage),"string"==a.type)throw new Error("Cannot write DBF to JS string");var i=AS(),s=iR(e,{header:1,raw:!0,cellDates:!0}),o=s[0],l=s.slice(1),c=e["!cols"]||[],u=0,h=0,f=0,d=1;for(u=0;u<o.length;++u)if(((c[u]||{}).DBF||{}).name)o[u]=c[u].DBF.name,++f;else if(null!=o[u]){if(++f,"number"===typeof o[u]&&(o[u]=o[u].toString(10)),"string"!==typeof o[u])throw new Error("DBF Invalid column name "+o[u]+" |"+typeof o[u]+"|");if(o.indexOf(o[u])!==u)for(h=0;h<1024;++h)if(-1==o.indexOf(o[u]+"_"+h)){o[u]+="_"+h;break}}var p=HS(e["!ref"]),m=[],g=[],v=[];for(u=0;u<=p.e.c-p.s.c;++u){var y="",b="",w=0,T=[];for(h=0;h<l.length;++h)null!=l[h][u]&&T.push(l[h][u]);if(0!=T.length&&null!=o[u]){for(h=0;h<T.length;++h){switch(typeof T[h]){case"number":b="B";break;case"string":default:b="C";break;case"boolean":b="L";break;case"object":b=T[h]instanceof Date?"D":"C"}w=Math.max(w,String(T[h]).length),y=y&&y!=b?"C":b}w>250&&(w=250),"C"==(b=((c[u]||{}).DBF||{}).type)&&c[u].DBF.len>w&&(w=c[u].DBF.len),"B"==y&&"N"==b&&(y="N",v[u]=c[u].DBF.dec,w=c[u].DBF.len),g[u]="C"==y||"N"==b?w:r[y]||0,d+=g[u],m[u]=y}else m[u]="?"}var S=i.next(32);for(S.write_shift(4,318902576),S.write_shift(4,l.length),S.write_shift(2,296+32*f),S.write_shift(2,d),u=0;u<4;++u)S.write_shift(4,0);for(S.write_shift(4,(+t[My]||3)<<8),u=0,h=0;u<o.length;++u)if(null!=o[u]){var E=i.next(32),k=(o[u].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);E.write_shift(1,k,"sbcs"),E.write_shift(1,"?"==m[u]?"C":m[u],"sbcs"),E.write_shift(4,h),E.write_shift(1,g[u]||r[m[u]]||0),E.write_shift(1,v[u]||0),E.write_shift(1,2),E.write_shift(4,0),E.write_shift(1,0),E.write_shift(4,0),E.write_shift(4,0),h+=g[u]||r[m[u]]||0}var _=i.next(264);for(_.write_shift(4,13),u=0;u<65;++u)_.write_shift(4,0);for(u=0;u<l.length;++u){var x=i.next(d);for(x.write_shift(1,0),h=0;h<o.length;++h)if(null!=o[h])switch(m[h]){case"L":x.write_shift(1,null==l[u][h]?63:l[u][h]?84:70);break;case"B":x.write_shift(8,l[u][h]||0,"f");break;case"N":var C="0";for("number"==typeof l[u][h]&&(C=l[u][h].toFixed(v[h]||0)),f=0;f<g[h]-C.length;++f)x.write_shift(1,32);x.write_shift(1,C,"sbcs");break;case"D":l[u][h]?(x.write_shift(4,("0000"+l[u][h].getFullYear()).slice(-4),"sbcs"),x.write_shift(2,("00"+(l[u][h].getMonth()+1)).slice(-2),"sbcs"),x.write_shift(2,("00"+l[u][h].getDate()).slice(-2),"sbcs")):x.write_shift(8,"00000000","sbcs");break;case"C":var I=String(null!=l[u][h]?l[u][h]:"").slice(0,g[h]);for(x.write_shift(1,I,"sbcs"),f=0;f<g[h]-I.length;++f)x.write_shift(1,32)}}return i.next(1).write_shift(1,26),i.end()}}}(),w_=function(){var e={AA:"\xc0",BA:"\xc1",CA:"\xc2",DA:195,HA:"\xc4",JA:197,AE:"\xc8",BE:"\xc9",CE:"\xca",HE:"\xcb",AI:"\xcc",BI:"\xcd",CI:"\xce",HI:"\xcf",AO:"\xd2",BO:"\xd3",CO:"\xd4",DO:213,HO:"\xd6",AU:"\xd9",BU:"\xda",CU:"\xdb",HU:"\xdc",Aa:"\xe0",Ba:"\xe1",Ca:"\xe2",Da:227,Ha:"\xe4",Ja:229,Ae:"\xe8",Be:"\xe9",Ce:"\xea",He:"\xeb",Ai:"\xec",Bi:"\xed",Ci:"\xee",Hi:"\xef",Ao:"\xf2",Bo:"\xf3",Co:"\xf4",Do:245,Ho:"\xf6",Au:"\xf9",Bu:"\xfa",Cu:"\xfb",Hu:"\xfc",KC:"\xc7",Kc:"\xe7",q:"\xe6",z:"\u0153",a:"\xc6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1bN("+sw(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),n=function(t,n){var r=e[n];return"number"==typeof r?qy(r):r},r=function(e,t,n){var r=t.charCodeAt(0)-32<<4|n.charCodeAt(0)-48;return 59==r?e:qy(r)};function a(e,a){var i,s=e.split(/[\n\r]+/),o=-1,l=-1,c=0,u=0,h=[],f=[],d=null,p={},m=[],g=[],v=[],y=0;for(+a.codepage>=0&&Vy(+a.codepage);c!==s.length;++c){y=0;var b,w=s[c].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(t,n),T=w.replace(/;;/g,"\0").split(";").map(function(e){return e.replace(/\u0000/g,";")}),S=T[0];if(w.length>0)switch(S){case"ID":case"E":case"B":case"O":case"W":break;case"P":"P"==T[1].charAt(0)&&f.push(w.slice(3).replace(/;;/g,";"));break;case"C":var E=!1,k=!1,_=!1,x=!1,C=-1,I=-1;for(u=1;u<T.length;++u)switch(T[u].charAt(0)){case"A":case"G":break;case"X":l=parseInt(T[u].slice(1))-1,k=!0;break;case"Y":for(o=parseInt(T[u].slice(1))-1,k||(l=0),i=h.length;i<=o;++i)h[i]=[];break;case"K":'"'===(b=T[u].slice(1)).charAt(0)?b=b.slice(1,b.length-1):"TRUE"===b?b=!0:"FALSE"===b?b=!1:isNaN(kw(b))?isNaN(xw(b).getDate())||(b=ww(b)):(b=kw(b),null!==d&&Gb(d)&&(b=mw(b))),"undefined"!==typeof Wy&&"string"==typeof b&&"string"!=(a||{}).type&&(a||{}).codepage&&(b=Wy.utils.decode(a.codepage,b)),E=!0;break;case"E":x=!0;var A=Qx(T[u].slice(1),{r:o,c:l});h[o][l]=[h[o][l],A];break;case"S":_=!0,h[o][l]=[h[o][l],"S5S"];break;case"R":C=parseInt(T[u].slice(1))-1;break;case"C":I=parseInt(T[u].slice(1))-1;break;default:if(a&&a.WTF)throw new Error("SYLK bad record "+w)}if(E&&(h[o][l]&&2==h[o][l].length?h[o][l][0]=b:h[o][l]=b,d=null),_){if(x)throw new Error("SYLK shared formula cannot have own formula");var N=C>-1&&h[C][I];if(!N||!N[1])throw new Error("SYLK shared formula cannot find base");h[o][l][1]=eC(N[1],{r:o-C,c:l-I})}break;case"F":var R=0;for(u=1;u<T.length;++u)switch(T[u].charAt(0)){case"X":l=parseInt(T[u].slice(1))-1,++R;break;case"Y":for(o=parseInt(T[u].slice(1))-1,i=h.length;i<=o;++i)h[i]=[];break;case"M":y=parseInt(T[u].slice(1))/20;break;case"F":case"G":case"S":case"D":case"N":break;case"P":d=f[parseInt(T[u].slice(1))];break;case"W":for(v=T[u].slice(1).split(" "),i=parseInt(v[0],10);i<=parseInt(v[1],10);++i)y=parseInt(v[2],10),g[i-1]=0===y?{hidden:!0}:{wch:y},sx(g[i-1]);break;case"C":g[l=parseInt(T[u].slice(1))-1]||(g[l]={});break;case"R":m[o=parseInt(T[u].slice(1))-1]||(m[o]={}),y>0?(m[o].hpt=y,m[o].hpx=cx(y)):0===y&&(m[o].hidden=!0);break;default:if(a&&a.WTF)throw new Error("SYLK bad record "+w)}R<1&&(d=null);break;default:if(a&&a.WTF)throw new Error("SYLK bad record "+w)}}return m.length>0&&(p["!rows"]=m),g.length>0&&(p["!cols"]=g),a&&a.sheetRows&&(h=h.slice(0,a.sheetRows)),[h,p]}function i(e,t){var n=function(e,t){switch(t.type){case"base64":return a(Yy(e),t);case"binary":return a(e,t);case"buffer":return a(Qy&&Buffer.isBuffer(e)?e.toString("binary"):rb(e),t);case"array":return a(Tw(e),t)}throw new Error("Unrecognized type "+t.type)}(e,t),r=n[0],i=n[1],s=$S(r,t);return sw(i).forEach(function(e){s[e]=i[e]}),s}function s(e,t,n,r){var a="C;Y"+(n+1)+";X"+(r+1)+";K";switch(e.t){case"n":a+=e.v||0,e.f&&!e.F&&(a+=";E"+Zx(e.f,{r:n,c:r}));break;case"b":a+=e.v?"TRUE":"FALSE";break;case"e":a+=e.w||e.v;break;case"d":a+='"'+(e.w||e.v)+'"';break;case"s":a+='"'+e.v.replace(/"/g,"").replace(/;/g,";;")+'"'}return a}return e["|"]=254,{to_workbook:function(e,t){return KS(i(e,t),t)},to_sheet:i,from_sheet:function(e,t){var n,r,a=["ID;PWXL;N;E"],i=[],o=HS(e["!ref"]),l=Array.isArray(e),c="\r\n";a.push("P;PGeneral"),a.push("F;P0;DG0G8;M255"),e["!cols"]&&(r=a,e["!cols"].forEach(function(e,t){var n="F;W"+(t+1)+" "+(t+1)+" ";e.hidden?n+="0":("number"!=typeof e.width||e.wpx||(e.wpx=tx(e.width)),"number"!=typeof e.wpx||e.wch||(e.wch=nx(e.wpx)),"number"==typeof e.wch&&(n+=Math.round(e.wch)))," "!=n.charAt(n.length-1)&&r.push(n)})),e["!rows"]&&function(e,t){t.forEach(function(t,n){var r="F;";t.hidden?r+="M0;":t.hpt?r+="M"+20*t.hpt+";":t.hpx&&(r+="M"+20*lx(t.hpx)+";"),r.length>2&&e.push(r+"R"+(n+1))})}(a,e["!rows"]),a.push("B;Y"+(o.e.r-o.s.r+1)+";X"+(o.e.c-o.s.c+1)+";D"+[o.s.c,o.s.r,o.e.c,o.e.r].join(" "));for(var u=o.s.r;u<=o.e.r;++u)for(var h=o.s.c;h<=o.e.c;++h){var f=VS({r:u,c:h});(n=l?(e[u]||[])[h]:e[f])&&(null!=n.v||n.f&&!n.F)&&i.push(s(n,0,u,h))}return a.join(c)+c+i.join(c)+c+"E"+c}}}(),T_=function(){function e(e,t){for(var n=e.split("\n"),r=-1,a=-1,i=0,s=[];i!==n.length;++i)if("BOT"!==n[i].trim()){if(!(r<0)){for(var o=n[i].trim().split(","),l=o[0],c=o[1],u=n[++i]||"";1&(u.match(/["]/g)||[]).length&&i<n.length-1;)u+="\n"+n[++i];switch(u=u.trim(),+l){case-1:if("BOT"===u){s[++r]=[],a=0;continue}if("EOD"!==u)throw new Error("Unrecognized DIF special command "+u);break;case 0:"TRUE"===u?s[r][a]=!0:"FALSE"===u?s[r][a]=!1:isNaN(kw(c))?isNaN(xw(c).getDate())?s[r][a]=c:s[r][a]=ww(c):s[r][a]=kw(c),++a;break;case 1:(u=(u=u.slice(1,u.length-1)).replace(/""/g,'"'))&&u.match(/^=".*"$/)&&(u=u.slice(2,-1)),s[r][a++]=""!==u?u:null}if("EOD"===u)break}}else s[++r]=[],a=0;return t&&t.sheetRows&&(s=s.slice(0,t.sheetRows)),s}function t(t,n){return $S(function(t,n){switch(n.type){case"base64":return e(Yy(t),n);case"binary":return e(t,n);case"buffer":return e(Qy&&Buffer.isBuffer(t)?t.toString("binary"):rb(t),n);case"array":return e(Tw(t),n)}throw new Error("Unrecognized type "+n.type)}(t,n),n)}return{to_workbook:function(e,n){return KS(t(e,n),n)},to_sheet:t,from_sheet:function(){var e=function(e,t,n,r,a){e.push(t),e.push(n+","+r),e.push('"'+a.replace(/"/g,'""')+'"')},t=function(e,t,n,r){e.push(t+","+n),e.push(1==t?'"'+r.replace(/"/g,'""')+'"':r)};return function(n){var r,a=[],i=HS(n["!ref"]),s=Array.isArray(n);e(a,"TABLE",0,1,"sheetjs"),e(a,"VECTORS",0,i.e.r-i.s.r+1,""),e(a,"TUPLES",0,i.e.c-i.s.c+1,""),e(a,"DATA",0,0,"");for(var o=i.s.r;o<=i.e.r;++o){t(a,-1,0,"BOT");for(var l=i.s.c;l<=i.e.c;++l){var c=VS({r:o,c:l});if(r=s?(n[o]||[])[l]:n[c])switch(r.t){case"n":var u=r.w;u||null==r.v||(u=r.v),null==u?r.f&&!r.F?t(a,1,0,"="+r.f):t(a,1,0,""):t(a,0,u,"V");break;case"b":t(a,0,r.v?1:0,r.v?"TRUE":"FALSE");break;case"s":t(a,1,0,isNaN(r.v)?r.v:'="'+r.v+'"');break;case"d":r.w||(r.w=Xb(r.z||vb[14],hw(ww(r.v)))),t(a,0,r.w,"V");break;default:t(a,1,0,"")}else t(a,1,0,"")}}t(a,-1,0,"EOD");return a.join("\r\n")}}()}}(),S_=function(){function e(e){return e.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n")}function t(e){return e.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function n(t,n){return $S(function(t,n){for(var r=t.split("\n"),a=-1,i=-1,s=0,o=[];s!==r.length;++s){var l=r[s].trim().split(":");if("cell"===l[0]){var c=jS(l[1]);if(o.length<=c.r)for(a=o.length;a<=c.r;++a)o[a]||(o[a]=[]);switch(a=c.r,i=c.c,l[2]){case"t":o[a][i]=e(l[3]);break;case"v":o[a][i]=+l[3];break;case"vtf":var u=l[l.length-1];case"vtc":"nl"===l[3]?o[a][i]=!!+l[4]:o[a][i]=+l[4],"vtf"==l[2]&&(o[a][i]=[o[a][i],u])}}}return n&&n.sheetRows&&(o=o.slice(0,n.sheetRows)),o}(t,n),n)}var r=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n"),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join("\n")+"\n",i=["# SocialCalc Spreadsheet Control Save","part:sheet"].join("\n"),s="--SocialCalcSpreadsheetControlSave--";function o(e){if(!e||!e["!ref"])return"";for(var n,r=[],a=[],i="",s=zS(e["!ref"]),o=Array.isArray(e),l=s.s.r;l<=s.e.r;++l)for(var c=s.s.c;c<=s.e.c;++c)if(i=VS({r:l,c:c}),(n=o?(e[l]||[])[c]:e[i])&&null!=n.v&&"z"!==n.t){switch(a=["cell",i,"t"],n.t){case"s":case"str":a.push(t(n.v));break;case"n":n.f?(a[2]="vtf",a[3]="n",a[4]=n.v,a[5]=t(n.f)):(a[2]="v",a[3]=n.v);break;case"b":a[2]="vt"+(n.f?"f":"c"),a[3]="nl",a[4]=n.v?"1":"0",a[5]=t(n.f||(n.v?"TRUE":"FALSE"));break;case"d":var u=hw(ww(n.v));a[2]="vtc",a[3]="nd",a[4]=""+u,a[5]=n.w||Xb(n.z||vb[14],u);break;case"e":continue}r.push(a.join(":"))}return r.push("sheet:c:"+(s.e.c-s.s.c+1)+":r:"+(s.e.r-s.s.r+1)+":tvf:1"),r.push("valueformat:1:text-wiki"),r.join("\n")}return{to_workbook:function(e,t){return KS(n(e,t),t)},to_sheet:n,from_sheet:function(e){return[r,a,i,a,o(e),s].join("\n")}}}(),E_=function(){function e(e,t,n,r,a){a.raw?t[n][r]=e:""===e||("TRUE"===e?t[n][r]=!0:"FALSE"===e?t[n][r]=!1:isNaN(kw(e))?isNaN(xw(e).getDate())?t[n][r]=e:t[n][r]=ww(e):t[n][r]=kw(e))}var t={44:",",9:"\t",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function r(e){for(var r={},a=!1,i=0,s=0;i<e.length;++i)34==(s=e.charCodeAt(i))?a=!a:!a&&s in t&&(r[s]=(r[s]||0)+1);for(i in s=[],r)Object.prototype.hasOwnProperty.call(r,i)&&s.push([r[i],i]);if(!s.length)for(i in r=n)Object.prototype.hasOwnProperty.call(r,i)&&s.push([r[i],i]);return s.sort(function(e,t){return e[0]-t[0]||n[e[1]]-n[t[1]]}),t[s.pop()[1]]||44}function a(e,t){var n=t||{},a="";var i=n.dense?[]:{},s={s:{c:0,r:0},e:{c:0,r:0}};"sep="==e.slice(0,4)?13==e.charCodeAt(5)&&10==e.charCodeAt(6)?(a=e.charAt(4),e=e.slice(7)):13==e.charCodeAt(5)||10==e.charCodeAt(5)?(a=e.charAt(4),e=e.slice(6)):a=r(e.slice(0,1024)):a=n&&n.FS?n.FS:r(e.slice(0,1024));var o=0,l=0,c=0,u=0,h=0,f=a.charCodeAt(0),d=!1,p=0,m=e.charCodeAt(0);e=e.replace(/\r\n/gm,"\n");var g=null!=n.dateNF?function(e){var t="number"==typeof e?vb[e]:e;return t=t.replace(ew,"(\\d+)"),new RegExp("^"+t+"$")}(n.dateNF):null;function v(){var t=e.slice(u,h),r={};if('"'==t.charAt(0)&&'"'==t.charAt(t.length-1)&&(t=t.slice(1,-1).replace(/""/g,'"')),0===t.length)r.t="z";else if(n.raw)r.t="s",r.v=t;else if(0===t.trim().length)r.t="s",r.v=t;else if(61==t.charCodeAt(0))34==t.charCodeAt(1)&&34==t.charCodeAt(t.length-1)?(r.t="s",r.v=t.slice(2,-1).replace(/""/g,'"')):1!=t.length?(r.t="n",r.f=t.slice(1)):(r.t="s",r.v=t);else if("TRUE"==t)r.t="b",r.v=!0;else if("FALSE"==t)r.t="b",r.v=!1;else if(isNaN(c=kw(t)))if(!isNaN(xw(t).getDate())||g&&t.match(g)){r.z=n.dateNF||vb[14];var a=0;g&&t.match(g)&&(t=function(e,t,n){var r=-1,a=-1,i=-1,s=-1,o=-1,l=-1;(t.match(ew)||[]).forEach(function(e,t){var c=parseInt(n[t+1],10);switch(e.toLowerCase().charAt(0)){case"y":r=c;break;case"d":i=c;break;case"h":s=c;break;case"s":l=c;break;case"m":s>=0?o=c:a=c}}),l>=0&&-1==o&&a>=0&&(o=a,a=-1);var c=(""+(r>=0?r:(new Date).getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);7==c.length&&(c="0"+c),8==c.length&&(c="20"+c);var u=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return-1==s&&-1==o&&-1==l?c:-1==r&&-1==a&&-1==i?u:c+"T"+u}(0,n.dateNF,t.match(g)||[]),a=1),n.cellDates?(r.t="d",r.v=ww(t,a)):(r.t="n",r.v=hw(ww(t,a))),!1!==n.cellText&&(r.w=Xb(r.z,r.v instanceof Date?hw(r.v):r.v)),n.cellNF||delete r.z}else r.t="s",r.v=t;else r.t="n",!1!==n.cellText&&(r.w=t),r.v=c;if("z"==r.t||(n.dense?(i[o]||(i[o]=[]),i[o][l]=r):i[VS({c:l,r:o})]=r),u=h+1,m=e.charCodeAt(u),s.e.c<l&&(s.e.c=l),s.e.r<o&&(s.e.r=o),p==f)++l;else if(l=0,++o,n.sheetRows&&n.sheetRows<=o)return!0}e:for(;h<e.length;++h)switch(p=e.charCodeAt(h)){case 34:34===m&&(d=!d);break;case f:case 10:case 13:if(!d&&v())break e}return h-u>0&&v(),i["!ref"]=BS(s),i}function i(t,n){return n&&n.PRN?n.FS||"sep="==t.slice(0,4)||t.indexOf("\t")>=0||t.indexOf(",")>=0||t.indexOf(";")>=0?a(t,n):$S(function(t,n){var r=n||{},a=[];if(!t||0===t.length)return a;for(var i=t.split(/[\r\n]/),s=i.length-1;s>=0&&0===i[s].length;)--s;for(var o=10,l=0,c=0;c<=s;++c)-1==(l=i[c].indexOf(" "))?l=i[c].length:l++,o=Math.max(o,l);for(c=0;c<=s;++c){a[c]=[];var u=0;for(e(i[c].slice(0,o).trim(),a,c,u,r),u=1;u<=(i[c].length-o)/10+1;++u)e(i[c].slice(o+10*(u-1),o+10*u).trim(),a,c,u,r)}return r.sheetRows&&(a=a.slice(0,r.sheetRows)),a}(t,n),n):a(t,n)}function s(e,t){var n="",r="string"==t.type?[0,0,0,0]:qN(e,t);switch(t.type){case"base64":n=Yy(e);break;case"binary":case"string":n=e;break;case"buffer":n=65001==t.codepage?e.toString("utf8"):t.codepage&&"undefined"!==typeof Wy?Wy.utils.decode(t.codepage,e):Qy&&Buffer.isBuffer(e)?e.toString("binary"):rb(e);break;case"array":n=Tw(e);break;default:throw new Error("Unrecognized type "+t.type)}return 239==r[0]&&187==r[1]&&191==r[2]?n=cT(n.slice(3)):"string"!=t.type&&"buffer"!=t.type&&65001==t.codepage?n=cT(n):"binary"==t.type&&"undefined"!==typeof Wy&&t.codepage&&(n=Wy.utils.decode(t.codepage,Wy.utils.encode(28591,n))),"socialcalc:version:"==n.slice(0,19)?S_.to_sheet("string"==t.type?n:cT(n),t):i(n,t)}return{to_workbook:function(e,t){return KS(s(e,t),t)},to_sheet:s,from_sheet:function(e){for(var t,n=[],r=HS(e["!ref"]),a=Array.isArray(e),i=r.s.r;i<=r.e.r;++i){for(var s=[],o=r.s.c;o<=r.e.c;++o){var l=VS({r:i,c:o});if((t=a?(e[i]||[])[o]:e[l])&&null!=t.v){for(var c=(t.w||(GS(t),t.w)||"").slice(0,10);c.length<10;)c+=" ";s.push(c+(0===o?" ":""))}else s.push("          ")}n.push(s.join(""))}return n.join("\n")}}}();var k_=function(){function e(e,t,n){if(e){_S(e,e.l||0);for(var r=n.Enum||v;e.l<e.length;){var a=e.read_shift(2),i=r[a]||r[65535],s=e.read_shift(2),o=e.l+s,l=i.f&&i.f(e,s,n);if(e.l=o,t(l,i,a))return}}}function t(t,n){if(!t)return t;var r=n||{};var a=r.dense?[]:{},i="Sheet1",s="",o=0,l={},c=[],u=[],h={s:{r:0,c:0},e:{r:0,c:0}},f=r.sheetRows||0;if(0==t[2]&&(8==t[3]||9==t[3])&&t.length>=16&&5==t[14]&&108===t[15])throw new Error("Unsupported Works 3 for Mac file");if(2==t[2])r.Enum=v,e(t,function(e,t,n){switch(n){case 0:r.vers=e,e>=4096&&(r.qpro=!0);break;case 6:h=e;break;case 204:e&&(s=e);break;case 222:s=e;break;case 15:case 51:r.qpro||(e[1].v=e[1].v.slice(1));case 13:case 14:case 16:14==n&&112==(112&e[2])&&(15&e[2])>1&&(15&e[2])<15&&(e[1].z=r.dateNF||vb[14],r.cellDates&&(e[1].t="d",e[1].v=mw(e[1].v))),r.qpro&&e[3]>o&&(a["!ref"]=BS(h),l[i]=a,c.push(i),a=r.dense?[]:{},h={s:{r:0,c:0},e:{r:0,c:0}},o=e[3],i=s||"Sheet"+(o+1),s="");var u=r.dense?(a[e[0].r]||[])[e[0].c]:a[VS(e[0])];if(u){u.t=e[1].t,u.v=e[1].v,null!=e[1].z&&(u.z=e[1].z),null!=e[1].f&&(u.f=e[1].f);break}r.dense?(a[e[0].r]||(a[e[0].r]=[]),a[e[0].r][e[0].c]=e[1]):a[VS(e[0])]=e[1]}},r);else{if(26!=t[2]&&14!=t[2])throw new Error("Unrecognized LOTUS BOF "+t[2]);r.Enum=y,14==t[2]&&(r.qpro=!0,t.l=0),e(t,function(e,t,n){switch(n){case 204:i=e;break;case 22:e[1].v=e[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(e[3]>o&&(a["!ref"]=BS(h),l[i]=a,c.push(i),a=r.dense?[]:{},h={s:{r:0,c:0},e:{r:0,c:0}},o=e[3],i="Sheet"+(o+1)),f>0&&e[0].r>=f)break;r.dense?(a[e[0].r]||(a[e[0].r]=[]),a[e[0].r][e[0].c]=e[1]):a[VS(e[0])]=e[1],h.e.c<e[0].c&&(h.e.c=e[0].c),h.e.r<e[0].r&&(h.e.r=e[0].r);break;case 27:e[14e3]&&(u[e[14e3][0]]=e[14e3][1]);break;case 1537:u[e[0]]=e[1],e[0]==o&&(i=e[1])}},r)}if(a["!ref"]=BS(h),l[s||i]=a,c.push(s||i),!u.length)return{SheetNames:c,Sheets:l};for(var d={},p=[],m=0;m<u.length;++m)l[c[m]]?(p.push(u[m]||c[m]),d[u[m]]=l[u[m]]||l[c[m]]):(p.push(u[m]),d[u[m]]={"!ref":"A1"});return{SheetNames:p,Sheets:d}}function n(e,t,n){var r=[{c:0,r:0},{t:"n",v:0},0,0];return n.qpro&&20768!=n.vers?(r[0].c=e.read_shift(1),r[3]=e.read_shift(1),r[0].r=e.read_shift(2),e.l+=2):(r[2]=e.read_shift(1),r[0].c=e.read_shift(2),r[0].r=e.read_shift(2)),r}function r(e,t,r){var a=e.l+t,i=n(e,0,r);if(i[1].t="s",20768==r.vers){e.l++;var s=e.read_shift(1);return i[1].v=e.read_shift(s,"utf8"),i}return r.qpro&&e.l++,i[1].v=e.read_shift(a-e.l,"cstr"),i}function a(e,t,n){var r=CS(7+n.length);r.write_shift(1,255),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(1,39);for(var a=0;a<r.length;++a){var i=n.charCodeAt(a);r.write_shift(1,i>=128?95:i)}return r.write_shift(1,0),r}function i(e,t,n){var r=CS(7);return r.write_shift(1,255),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(2,n,"i"),r}function s(e,t,n){var r=CS(13);return r.write_shift(1,255),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(8,n,"f"),r}function o(e,t,n){var r=32768&t;return t=(r?e:0)+((t&=-32769)>=8192?t-16384:t),(r?"":"$")+(n?US(t):MS(t))}var l={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},c=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function u(e){var t=[{c:0,r:0},{t:"n",v:0},0];return t[0].r=e.read_shift(2),t[3]=e[e.l++],t[0].c=e[e.l++],t}function h(e,t,n,r){var a=CS(6+r.length);a.write_shift(2,e),a.write_shift(1,n),a.write_shift(1,t),a.write_shift(1,39);for(var i=0;i<r.length;++i){var s=r.charCodeAt(i);a.write_shift(1,s>=128?95:s)}return a.write_shift(1,0),a}function f(e,t){var n=u(e),r=e.read_shift(4),a=e.read_shift(4),i=e.read_shift(2);if(65535==i)return 0===r&&3221225472===a?(n[1].t="e",n[1].v=15):0===r&&3489660928===a?(n[1].t="e",n[1].v=42):n[1].v=0,n;var s=32768&i;return i=(32767&i)-16446,n[1].v=(1-2*s)*(a*Math.pow(2,i+32)+r*Math.pow(2,i)),n}function d(e,t,n,r){var a=CS(14);if(a.write_shift(2,e),a.write_shift(1,n),a.write_shift(1,t),0==r)return a.write_shift(4,0),a.write_shift(4,0),a.write_shift(2,65535),a;var i,s=0,o=0,l=0;return r<0&&(s=1,r=-r),o=0|Math.log2(r),0==(2147483648&(l=(r/=Math.pow(2,o-31))>>>0))&&(++o,l=(r/=2)>>>0),r-=l,l|=2147483648,l>>>=0,i=(r*=Math.pow(2,32))>>>0,a.write_shift(4,i),a.write_shift(4,l),o+=16383+(s?32768:0),a.write_shift(2,o),a}function p(e,t){var n=u(e),r=e.read_shift(8,"f");return n[1].v=r,n}function m(e,t){return 0==e[e.l+t-1]?e.read_shift(t,"cstr"):""}function g(e,t){var n=CS(5+e.length);n.write_shift(2,14e3),n.write_shift(2,t);for(var r=0;r<e.length;++r){var a=e.charCodeAt(r);n[n.l++]=a>127?95:a}return n[n.l++]=0,n}var v={0:{n:"BOF",f:Sk},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function(e,t,n){var r={s:{c:0,r:0},e:{c:0,r:0}};return 8==t&&n.qpro?(r.s.c=e.read_shift(1),e.l++,r.s.r=e.read_shift(2),r.e.c=e.read_shift(1),e.l++,r.e.r=e.read_shift(2),r):(r.s.c=e.read_shift(2),r.s.r=e.read_shift(2),12==t&&n.qpro&&(e.l+=2),r.e.c=e.read_shift(2),r.e.r=e.read_shift(2),12==t&&n.qpro&&(e.l+=2),65535==r.s.c&&(r.s.c=r.e.c=r.s.r=r.e.r=0),r)}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function(e,t,r){var a=n(e,0,r);return a[1].v=e.read_shift(2,"i"),a}},14:{n:"NUMBER",f:function(e,t,r){var a=n(e,0,r);return a[1].v=e.read_shift(8,"f"),a}},15:{n:"LABEL",f:r},16:{n:"FORMULA",f:function(e,t,r){var a=e.l+t,i=n(e,0,r);if(i[1].v=e.read_shift(8,"f"),r.qpro)e.l=a;else{var s=e.read_shift(2);!function(e,t){_S(e,0);var n=[],r=0,a="",i="",s="",u="";for(;e.l<e.length;){var h=e[e.l++];switch(h){case 0:n.push(e.read_shift(8,"f"));break;case 1:i=o(t[0].c,e.read_shift(2),!0),a=o(t[0].r,e.read_shift(2),!1),n.push(i+a);break;case 2:var f=o(t[0].c,e.read_shift(2),!0),d=o(t[0].r,e.read_shift(2),!1);i=o(t[0].c,e.read_shift(2),!0),a=o(t[0].r,e.read_shift(2),!1),n.push(f+d+":"+i+a);break;case 3:if(e.l<e.length)return void console.error("WK1 premature formula end");break;case 4:n.push("("+n.pop()+")");break;case 5:n.push(e.read_shift(2));break;case 6:for(var p="";h=e[e.l++];)p+=String.fromCharCode(h);n.push('"'+p.replace(/"/g,'""')+'"');break;case 8:n.push("-"+n.pop());break;case 23:n.push("+"+n.pop());break;case 22:n.push("NOT("+n.pop()+")");break;case 20:case 21:u=n.pop(),s=n.pop(),n.push(["AND","OR"][h-20]+"("+s+","+u+")");break;default:if(h<32&&c[h])u=n.pop(),s=n.pop(),n.push(s+c[h]+u);else{if(!l[h])return h<=7?console.error("WK1 invalid opcode "+h.toString(16)):h<=24?console.error("WK1 unsupported op "+h.toString(16)):h<=30?console.error("WK1 invalid opcode "+h.toString(16)):h<=115?console.error("WK1 unsupported function opcode "+h.toString(16)):console.error("WK1 unrecognized opcode "+h.toString(16));if(69==(r=l[h][1])&&(r=e[e.l++]),r>n.length)return void console.error("WK1 bad formula parse 0x"+h.toString(16)+":|"+n.join("|")+"|");var m=n.slice(-r);n.length-=r,n.push(l[h][0]+"("+m.join(",")+")")}}}1==n.length?t[1].f=""+n[0]:console.error("WK1 bad formula parse |"+n.join("|")+"|")}(e.slice(e.l,e.l+s),i),e.l+=s}return i}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:r},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:m},222:{n:"SHEETNAMELP",f:function(e,t){var n=e[e.l++];n>t-1&&(n=t-1);for(var r="";r.length<n;)r+=String.fromCharCode(e[e.l++]);return r}},65535:{n:""}},y={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:function(e,t){var n=u(e);return n[1].t="s",n[1].v=e.read_shift(t-4,"cstr"),n}},23:{n:"NUMBER17",f:f},24:{n:"NUMBER18",f:function(e,t){var n=u(e);n[1].v=e.read_shift(2);var r=n[1].v>>1;if(1&n[1].v)switch(7&r){case 0:r=5e3*(r>>3);break;case 1:r=500*(r>>3);break;case 2:r=(r>>3)/20;break;case 3:r=(r>>3)/200;break;case 4:r=(r>>3)/2e3;break;case 5:r=(r>>3)/2e4;break;case 6:r=(r>>3)/16;break;case 7:r=(r>>3)/64}return n[1].v=r,n}},25:{n:"FORMULA19",f:function(e,t){var n=f(e);return e.l+=t-14,n}},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:function(e,t){for(var n={},r=e.l+t;e.l<r;){var a=e.read_shift(2);if(14e3==a){for(n[a]=[0,""],n[a][0]=e.read_shift(2);e[e.l];)n[a][1]+=String.fromCharCode(e[e.l]),e.l++;e.l++}}return n}},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:function(e,t){var n=u(e),r=e.read_shift(4);return n[1].v=r>>6,n}},38:{n:"??"},39:{n:"NUMBER27",f:p},40:{n:"FORMULA28",f:function(e,t){var n=p(e);return e.l+=t-10,n}},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:m},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:function(e,t,n){if(n.qpro&&!(t<21)){var r=e.read_shift(1);return e.l+=17,e.l+=1,e.l+=2,[r,e.read_shift(t-21,"cstr")]}}},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:function(e,t){var n=t||{};if(+n.codepage>=0&&Vy(+n.codepage),"string"==n.type)throw new Error("Cannot write WK1 to JS string");var r=AS(),o=HS(e["!ref"]),l=Array.isArray(e),c=[];UA(r,0,function(e){var t=CS(2);return t.write_shift(2,e),t}(1030)),UA(r,6,function(e){var t=CS(8);return t.write_shift(2,e.s.c),t.write_shift(2,e.s.r),t.write_shift(2,e.e.c),t.write_shift(2,e.e.r),t}(o));for(var u=Math.min(o.e.r,8191),h=o.s.r;h<=u;++h)for(var f=MS(h),d=o.s.c;d<=o.e.c;++d){h===o.s.r&&(c[d]=US(d));var p=c[d]+f,m=l?(e[h]||[])[d]:e[p];if(m&&"z"!=m.t)if("n"==m.t)(0|m.v)==m.v&&m.v>=-32768&&m.v<=32767?UA(r,13,i(h,d,m.v)):UA(r,14,s(h,d,m.v));else UA(r,15,a(h,d,GS(m).slice(0,239)))}return UA(r,1),r.end()},book_to_wk3:function(e,t){var n=t||{};if(+n.codepage>=0&&Vy(+n.codepage),"string"==n.type)throw new Error("Cannot write WK3 to JS string");var r=AS();UA(r,0,function(e){var t=CS(26);t.write_shift(2,4096),t.write_shift(2,4),t.write_shift(4,0);for(var n=0,r=0,a=0,i=0;i<e.SheetNames.length;++i){var s=e.SheetNames[i],o=e.Sheets[s];if(o&&o["!ref"]){++a;var l=zS(o["!ref"]);n<l.e.r&&(n=l.e.r),r<l.e.c&&(r=l.e.c)}}n>8191&&(n=8191);return t.write_shift(2,n),t.write_shift(1,a),t.write_shift(1,r),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,1),t.write_shift(1,2),t.write_shift(4,0),t.write_shift(4,0),t}(e));for(var a=0,i=0;a<e.SheetNames.length;++a)(e.Sheets[e.SheetNames[a]]||{})["!ref"]&&UA(r,27,g(e.SheetNames[a],i++));var s=0;for(a=0;a<e.SheetNames.length;++a){var o=e.Sheets[e.SheetNames[a]];if(o&&o["!ref"]){for(var l=HS(o["!ref"]),c=Array.isArray(o),u=[],f=Math.min(l.e.r,8191),p=l.s.r;p<=f;++p)for(var m=MS(p),v=l.s.c;v<=l.e.c;++v){p===l.s.r&&(u[v]=US(v));var y=u[v]+m,b=c?(o[p]||[])[v]:o[y];if(b&&"z"!=b.t)if("n"==b.t)UA(r,23,d(p,v,s,b.v));else UA(r,22,h(p,v,s,GS(b).slice(0,239)))}++s}}return UA(r,1),r.end()},to_workbook:function(e,n){switch(n.type){case"base64":return t(tb(Yy(e)),n);case"binary":return t(tb(e),n);case"buffer":case"array":return t(e,n)}throw"Unsupported type "+n.type}}}();var __=function(){var e=hT("t"),t=hT("rPr");function n(n){var r=n.match(e);if(!r)return{t:"s",v:""};var a={t:"s",v:Yw(r[1])},i=n.match(t);return i&&(a.s=function(e){var t={},n=e.match(Hw),r=0,a=!1;if(n)for(;r!=n.length;++r){var i=Kw(n[r]);switch(i[0].replace(/\w*:/g,"")){case"<condense":case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if("1"==i.val)break;t.cp=Uy[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting"}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if("0"==i.val)break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if("0"==i.val)break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":case"<scheme":case"<scheme>":case"<scheme/>":case"</scheme>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(47!==i[0].charCodeAt(1)&&!a)throw new Error("Unrecognized rich format "+i[0])}}return t}(i[1])),a}var r=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(e){return e.replace(r,"").split(a).map(n).filter(function(e){return e.v})}}(),x_=function(){var e=/(\r\n|\n)/g;function t(t){var n=[[],t.v,[]];return t.v?(t.s&&function(e,t,n){var r=[];e.u&&r.push("text-decoration: underline;"),e.uval&&r.push("text-underline-style:"+e.uval+";"),e.sz&&r.push("font-size:"+e.sz+"pt;"),e.outline&&r.push("text-effect: outline;"),e.shadow&&r.push("text-shadow: auto;"),t.push('<span style="'+r.join("")+'">'),e.b&&(t.push("<b>"),n.push("</b>")),e.i&&(t.push("<i>"),n.push("</i>")),e.strike&&(t.push("<s>"),n.push("</s>"));var a=e.valign||"";"superscript"==a||"super"==a?a="sup":"subscript"==a&&(a="sub"),""!=a&&(t.push("<"+a+">"),n.push("</"+a+">")),n.push("</span>")}(t.s,n[0],n[2]),n[0].join("")+n[1].replace(e,"<br/>")+n[2].join("")):""}return function(e){return e.map(t).join("")}}(),C_=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,I_=/<(?:\w+:)?r>/,A_=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function N_(e,t){var n=!t||t.cellHTML,r={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(r.t=Yw(cT(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),r.r=cT(e),n&&(r.h=nT(r.t))):e.match(I_)&&(r.r=cT(e),r.t=Yw(cT((e.replace(A_,"").match(C_)||[]).join("").replace(Hw,""))),n&&(r.h=x_(__(r.r)))),r):{t:""}}var R_=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,O_=/<(?:\w+:)?(?:si|sstItem)>/g,P_=/<\/(?:\w+:)?(?:si|sstItem)>/;var D_=/^\s|\s$|[\t\n\r]/;function L_(e,t){if(!t.bookSST)return"";var n=[Vw];n[n.length]=wT("sst",null,{xmlns:FT[0],count:e.Count,uniqueCount:e.Unique});for(var r=0;r!=e.length;++r)if(null!=e[r]){var a=e[r],i="<si>";a.r?i+=a.r:(i+="<t",a.t||(a.t=""),a.t.match(D_)&&(i+=' xml:space="preserve"'),i+=">"+Zw(a.t)+"</t>"),i+="</si>",n[n.length]=i}return n.length>2&&(n[n.length]="</sst>",n[1]=n[1].replace("/>",">")),n.join("")}var M_=function(e,t){var n=!1;return null==t&&(n=!0,t=CS(15+4*e.t.length)),t.write_shift(1,0),QS(e.t,t),n?t.slice(0,t.l):t};function F_(e){var t=AS();NS(t,159,function(e,t){return t||(t=CS(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}(e));for(var n=0;n<e.length;++n)NS(t,19,M_(e[n]));return NS(t,160),t.end()}function U_(e){if("undefined"!==typeof Wy)return Wy.utils.encode(My,e);for(var t=[],n=e.split(""),r=0;r<n.length;++r)t[r]=n[r].charCodeAt(0);return t}function j_(e,t){var n={};return n.Major=e.read_shift(2),n.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),n}function V_(e){for(var t=e.read_shift(4),n=e.l+t-4,r={},a=e.read_shift(4),i=[];a-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(r.name=e.read_shift(0,"lpp4"),r.comps=i,e.l!=n)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+n);return r}function z_(e){var t=function(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=j_(e,4),t.U=j_(e,4),t.W=j_(e,4),t}(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),4!=e.read_shift(4))throw new Error("Bad !Primary record");return t}function B_(e,t){var n=e.l+t,r={};r.Flags=63&e.read_shift(4),e.l+=4,r.AlgID=e.read_shift(4);var a=!1;switch(r.AlgID){case 26126:case 26127:case 26128:a=36==r.Flags;break;case 26625:a=4==r.Flags;break;case 0:a=16==r.Flags||4==r.Flags||36==r.Flags;break;default:throw"Unrecognized encryption algorithm: "+r.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return r.AlgIDHash=e.read_shift(4),r.KeySize=e.read_shift(4),r.ProviderType=e.read_shift(4),e.l+=8,r.CSPName=e.read_shift(n-e.l>>1,"utf16le"),e.l=n,r}function H_(e,t){var n={},r=e.l+t;return e.l+=4,n.Salt=e.slice(e.l,e.l+16),e.l+=16,n.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),n.VerifierHash=e.slice(e.l,r),e.l=r,n}function W_(e){if(36!=(63&e.read_shift(4)))throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4);return{t:"Std",h:B_(e,t),v:H_(e,e.length-e.l)}}function G_(){throw new Error("File is password-protected: ECMA-376 Extensible")}function K_(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var n=e.read_shift(e.length-e.l,"utf8"),r={};return n.replace(Hw,function(e){var n=Kw(e);switch(qw(n[0])){case"<?xml":case"<encryption":case"</encryption>":case"</keyEncryptors>":case"</keyEncryptor>":break;case"<keyData":t.forEach(function(e){r[e]=n[e]});break;case"<dataIntegrity":r.encryptedHmacKey=n.encryptedHmacKey,r.encryptedHmacValue=n.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":r.encs=[];break;case"<keyEncryptor":r.uri=n.uri;break;case"<encryptedKey":r.encs.push(n);break;default:throw n[0]}}),r}function q_(e){var t,n,r=0,a=U_(e),i=a.length+1;for((t=Zy(i))[0]=a.length,n=1;n!=i;++n)t[n]=a[n-1];for(n=i-1;n>=0;--n)r=((0===(16384&r)?0:1)|r<<1&32767)^t[n];return 52811^r}var $_=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],n=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],r=function(e,t){return 255&((n=e^t)/2|128*n);var n};return function(a){for(var i,s,o,l=U_(a),c=function(e){for(var r=t[e.length-1],a=104,i=e.length-1;i>=0;--i)for(var s=e[i],o=0;7!=o;++o)64&s&&(r^=n[a]),s*=2,--a;return r}(l),u=l.length,h=Zy(16),f=0;16!=f;++f)h[f]=0;for(1===(1&u)&&(i=c>>8,h[u]=r(e[0],i),--u,i=255&c,s=l[l.length-1],h[u]=r(s,i));u>0;)i=c>>8,h[--u]=r(l[u],i),i=255&c,h[--u]=r(l[u],i);for(u=15,o=15-l.length;o>0;)i=c>>8,h[u]=r(e[o],i),--o,i=255&c,h[--u]=r(l[u],i),--u,--o;return h}}(),X_=function(e){var t=0,n=$_(e);return function(e){var r=function(e,t,n,r,a){var i,s;for(a||(a=t),r||(r=$_(e)),i=0;i!=t.length;++i)s=t[i],s=255&((s^=r[n])>>5|s<<3),a[i]=s,++n;return[a,n,r]}("",e,t,n);return t=r[1],r[0]}};function Y_(e,t,n){var r=n||{};return r.Info=e.read_shift(2),e.l-=2,1===r.Info?r.Data=function(e){var t={},n=t.EncryptionVersionInfo=j_(e,4);if(1!=n.Major||1!=n.Minor)throw"unrecognized version code "+n.Major+" : "+n.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}(e):r.Data=function(e,t){var n={},r=n.EncryptionVersionInfo=j_(e,4);if(t-=4,2!=r.Minor)throw new Error("unrecognized minor version code: "+r.Minor);if(r.Major>4||r.Major<2)throw new Error("unrecognized major version code: "+r.Major);n.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,n.EncryptionHeader=B_(e,a),t-=a,n.EncryptionVerifier=H_(e,t),n}(e,t),r}var Q_=function(){function e(e,n){switch(n.type){case"base64":return t(Yy(e),n);case"binary":return t(e,n);case"buffer":return t(Qy&&Buffer.isBuffer(e)?e.toString("binary"):rb(e),n);case"array":return t(Tw(e),n)}throw new Error("Unrecognized type "+n.type)}function t(e,t){var n=(t||{}).dense?[]:{},r=e.match(/\\trowd.*?\\row\b/g);if(!r.length)throw new Error("RTF missing table");var a={s:{c:0,r:0},e:{c:0,r:r.length-1}};return r.forEach(function(e,t){Array.isArray(n)&&(n[t]=[]);for(var r,i=/\\\w+\b/g,s=0,o=-1;r=i.exec(e);){if("\\cell"===r[0]){var l=e.slice(s,i.lastIndex-r[0].length);if(" "==l[0]&&(l=l.slice(1)),++o,l.length){var c={v:l,t:"s"};Array.isArray(n)?n[t][o]=c:n[VS({r:t,c:o})]=c}}s=i.lastIndex}o>a.e.c&&(a.e.c=o)}),n["!ref"]=BS(a),n}return{to_workbook:function(t,n){return KS(e(t,n),n)},to_sheet:e,from_sheet:function(e){for(var t,n=["{\\rtf1\\ansi"],r=HS(e["!ref"]),a=Array.isArray(e),i=r.s.r;i<=r.e.r;++i){n.push("\\trowd\\trautofit1");for(var s=r.s.c;s<=r.e.c;++s)n.push("\\cellx"+(s+1));for(n.push("\\pard\\intbl"),s=r.s.c;s<=r.e.c;++s){var o=VS({r:i,c:s});(t=a?(e[i]||[])[s]:e[o])&&(null!=t.v||t.f&&!t.F)&&(n.push(" "+(t.w||(GS(t),t.w))),n.push("\\cell"))}n.push("\\pard\\intbl\\row")}return n.join("")+"}"}}}();function J_(e){for(var t=0,n=1;3!=t;++t)n=256*n+(e[t]>255?255:e[t]<0?0:e[t]);return n.toString(16).toUpperCase().slice(1)}function Z_(e,t){if(0===t)return e;var n=function(e){var t=e[0]/255,n=e[1]/255,r=e[2]/255,a=Math.max(t,n,r),i=Math.min(t,n,r),s=a-i;if(0===s)return[0,0,t];var o,l=0,c=a+i;switch(o=s/(c>1?2-c:c),a){case t:l=((n-r)/s+6)%6;break;case n:l=(r-t)/s+2;break;case r:l=(t-n)/s+4}return[l/6,o,c/2]}(function(e){var t=e.slice("#"===e[0]?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}(e));return n[2]=t<0?n[2]*(1+t):1-(1-n[2])*(1-t),J_(function(e){var t,n=e[0],r=e[1],a=e[2],i=2*r*(a<.5?a:1-a),s=a-i/2,o=[s,s,s],l=6*n;if(0!==r)switch(0|l){case 0:case 6:t=i*l,o[0]+=i,o[1]+=t;break;case 1:t=i*(2-l),o[0]+=t,o[1]+=i;break;case 2:t=i*(l-2),o[1]+=i,o[2]+=t;break;case 3:t=i*(4-l),o[1]+=t,o[2]+=i;break;case 4:t=i*(l-4),o[2]+=i,o[0]+=t;break;case 5:t=i*(6-l),o[2]+=t,o[0]+=i}for(var c=0;3!=c;++c)o[c]=Math.round(255*o[c]);return o}(n))}var ex=6;function tx(e){return Math.floor((e+Math.round(128/ex)/256)*ex)}function nx(e){return Math.floor((e-5)/ex*100+.5)/100}function rx(e){return Math.round((e*ex+5)/ex*256)/256}function ax(e){return rx(nx(tx(e)))}function ix(e){var t=Math.abs(e-ax(e)),n=ex;if(t>.005)for(ex=1;ex<15;++ex)Math.abs(e-ax(e))<=t&&(t=Math.abs(e-ax(e)),n=ex);ex=n}function sx(e){e.width?(e.wpx=tx(e.width),e.wch=nx(e.wpx),e.MDW=ex):e.wpx?(e.wch=nx(e.wpx),e.width=rx(e.wch),e.MDW=ex):"number"==typeof e.wch&&(e.width=rx(e.wch),e.wpx=tx(e.width),e.MDW=ex),e.customWidth&&delete e.customWidth}var ox=96;function lx(e){return 96*e/ox}function cx(e){return e*ox/96}var ux={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};var hx=["numFmtId","fillId","fontId","borderId","xfId"],fx=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];var dx=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,r=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(i,s,o){var l,c={};return i?((l=(i=i.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"")).match(e))&&function(e,t,n){t.NumberFmt=[];for(var r=sw(vb),a=0;a<r.length;++a)t.NumberFmt[r[a]]=vb[r[a]];var i=e[0].match(Hw);if(i)for(a=0;a<i.length;++a){var s=Kw(i[a]);switch(qw(s[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":case"</numFmt>":break;case"<numFmt":var o=Yw(cT(s.formatCode)),l=parseInt(s.numFmtId,10);if(t.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&null!=t.NumberFmt[l];--l);t.NumberFmt[l]=o}Yb(o,l)}break;default:if(n.WTF)throw new Error("unrecognized "+s[0]+" in numFmts")}}}(l,c,o),(l=i.match(r))&&function(e,t,n,r){t.Fonts=[];var a={},i=!1;(e[0].match(Hw)||[]).forEach(function(e){var s=Kw(e);switch(qw(s[0])){case"<fonts":case"<fonts>":case"</fonts>":case"<font":case"<font>":case"<name/>":case"</name>":case"<sz/>":case"</sz>":case"<vertAlign/>":case"</vertAlign>":case"<family/>":case"</family>":case"<scheme/>":case"</scheme>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":s.val&&(a.name=cT(s.val));break;case"<b":a.bold=s.val?aT(s.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=s.val?aT(s.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(s.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=s.val?aT(s.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=s.val?aT(s.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=s.val?aT(s.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=s.val?aT(s.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=s.val?aT(s.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":s.val&&(a.sz=+s.val);break;case"<vertAlign":s.val&&(a.vertAlign=s.val);break;case"<family":s.val&&(a.family=parseInt(s.val,10));break;case"<scheme":s.val&&(a.scheme=s.val);break;case"<charset":if("1"==s.val)break;s.codepage=Uy[parseInt(s.val,10)];break;case"<color":if(a.color||(a.color={}),s.auto&&(a.color.auto=aT(s.auto)),s.rgb)a.color.rgb=s.rgb.slice(-6);else if(s.indexed){a.color.index=parseInt(s.indexed,10);var o=AE[a.color.index];81==a.color.index&&(o=AE[1]),o||(o=AE[1]),a.color.rgb=o[0].toString(16)+o[1].toString(16)+o[2].toString(16)}else s.theme&&(a.color.theme=parseInt(s.theme,10),s.tint&&(a.color.tint=parseFloat(s.tint)),s.theme&&n.themeElements&&n.themeElements.clrScheme&&(a.color.rgb=Z_(n.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<AlternateContent":case"<ext":i=!0;break;case"</AlternateContent>":case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+s[0]+" in fonts")}})}(l,c,s,o),(l=i.match(n))&&function(e,t,n,r){t.Fills=[];var a={},i=!1;(e[0].match(Hw)||[]).forEach(function(e){var n=Kw(e);switch(qw(n[0])){case"<fills":case"<fills>":case"</fills>":case"</fill>":case"<gradientFill>":case"<patternFill/>":case"</patternFill>":case"<bgColor/>":case"</bgColor>":case"<fgColor/>":case"</fgColor>":case"<stop":case"<stop/>":case"</stop>":case"<color":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":n.patternType&&(a.patternType=n.patternType);break;case"<bgColor":a.bgColor||(a.bgColor={}),n.indexed&&(a.bgColor.indexed=parseInt(n.indexed,10)),n.theme&&(a.bgColor.theme=parseInt(n.theme,10)),n.tint&&(a.bgColor.tint=parseFloat(n.tint)),n.rgb&&(a.bgColor.rgb=n.rgb.slice(-6));break;case"<fgColor":a.fgColor||(a.fgColor={}),n.theme&&(a.fgColor.theme=parseInt(n.theme,10)),n.tint&&(a.fgColor.tint=parseFloat(n.tint)),null!=n.rgb&&(a.fgColor.rgb=n.rgb.slice(-6));break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+n[0]+" in fills")}})}(l,c,0,o),(l=i.match(a))&&function(e,t,n,r){t.Borders=[];var a={},i=!1;(e[0].match(Hw)||[]).forEach(function(e){var n=Kw(e);switch(qw(n[0])){case"<borders":case"<borders>":case"</borders>":case"</border>":case"<left/>":case"<left":case"<left>":case"</left>":case"<right/>":case"<right":case"<right>":case"</right>":case"<top/>":case"<top":case"<top>":case"</top>":case"<bottom/>":case"<bottom":case"<bottom>":case"</bottom>":case"<diagonal":case"<diagonal>":case"<diagonal/>":case"</diagonal>":case"<horizontal":case"<horizontal>":case"<horizontal/>":case"</horizontal>":case"<vertical":case"<vertical>":case"<vertical/>":case"</vertical>":case"<start":case"<start>":case"<start/>":case"</start>":case"<end":case"<end>":case"<end/>":case"</end>":case"<color":case"<color>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<border":case"<border>":case"<border/>":a={},n.diagonalUp&&(a.diagonalUp=aT(n.diagonalUp)),n.diagonalDown&&(a.diagonalDown=aT(n.diagonalDown)),t.Borders.push(a);break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+n[0]+" in borders")}})}(l,c,0,o),(l=i.match(t))&&function(e,t,n){var r;t.CellXf=[];var a=!1;(e[0].match(Hw)||[]).forEach(function(e){var i=Kw(e),s=0;switch(qw(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":case"</xf>":case"</alignment>":case"<protection":case"</protection>":case"<protection/>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<xf":case"<xf/>":for(delete(r=i)[0],s=0;s<hx.length;++s)r[hx[s]]&&(r[hx[s]]=parseInt(r[hx[s]],10));for(s=0;s<fx.length;++s)r[fx[s]]&&(r[fx[s]]=aT(r[fx[s]]));if(t.NumberFmt&&r.numFmtId>392)for(s=392;s>60;--s)if(t.NumberFmt[r.numFmtId]==t.NumberFmt[s]){r.numFmtId=s;break}t.CellXf.push(r);break;case"<alignment":case"<alignment/>":var o={};i.vertical&&(o.vertical=i.vertical),i.horizontal&&(o.horizontal=i.horizontal),null!=i.textRotation&&(o.textRotation=i.textRotation),i.indent&&(o.indent=i.indent),i.wrapText&&(o.wrapText=aT(i.wrapText)),r.alignment=o;break;case"<AlternateContent":case"<ext":a=!0;break;case"</AlternateContent>":case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}(l,c,o),c):c}}();function px(e,t){var n,r=[Vw,wT("styleSheet",null,{xmlns:FT[0],"xmlns:vt":DT})];return e.SSF&&null!=(n=function(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var r=n[0];r<=n[1];++r)null!=e[r]&&(t[t.length]=wT("numFmt",null,{numFmtId:r,formatCode:Zw(e[r])}))}),1===t.length?"":(t[t.length]="</numFmts>",t[0]=wT("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}(e.SSF))&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=function(e){var t=[];return t[t.length]=wT("cellXfs",null),e.forEach(function(e){t[t.length]=wT("xf",null,e)}),t[t.length]="</cellXfs>",2===t.length?"":(t[0]=wT("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function mx(e,t,n){n||(n=CS(6+4*t.length)),n.write_shift(2,e),QS(t,n);var r=n.length>n.l?n.slice(0,n.l):n;return null==n.l&&(n.l=n.length),r}function gx(e,t){t||(t=CS(153)),t.write_shift(2,20*e.sz),function(e,t){t||(t=CS(2));var n=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);t.write_shift(1,n),t.write_shift(1,0)}(e,t),t.write_shift(2,e.bold?700:400);var n=0;"superscript"==e.vertAlign?n=1:"subscript"==e.vertAlign&&(n=2),t.write_shift(2,n),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),wE(e.color,t);var r=0;return"major"==e.scheme&&(r=1),"minor"==e.scheme&&(r=2),t.write_shift(1,r),QS(e.name,t),t.length>t.l?t.slice(0,t.l):t}var vx,yx=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],bx=xS;function wx(e,t){t||(t=CS(84)),vx||(vx=lw(yx));var n=vx[e.patternType];null==n&&(n=40),t.write_shift(4,n);var r=0;if(40!=n)for(wE({auto:1},t),wE({auto:1},t);r<12;++r)t.write_shift(4,0);else{for(;r<4;++r)t.write_shift(4,0);for(;r<12;++r)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function Tx(e,t,n){n||(n=CS(16)),n.write_shift(2,t||0),n.write_shift(2,e.numFmtId||0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(1,0),n.write_shift(1,0);return n.write_shift(1,0),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(1,0),n}function Sx(e,t){return t||(t=CS(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var Ex=xS;function kx(e){var t;NS(e,613,XS(1)),NS(e,46,(t||(t=CS(51)),t.write_shift(1,0),Sx(0,t),Sx(0,t),Sx(0,t),Sx(0,t),Sx(0,t),t.length>t.l?t.slice(0,t.l):t)),NS(e,614)}function _x(e){var t,n;NS(e,619,XS(1)),NS(e,48,(t={xfId:0,builtinId:0,name:"Normal"},n||(n=CS(52)),n.write_shift(4,t.xfId),n.write_shift(2,1),n.write_shift(1,+t.builtinId),n.write_shift(1,0),cE(t.name||"",n),n.length>n.l?n.slice(0,n.l):n)),NS(e,620)}function xx(e){NS(e,508,function(e,t,n){var r=CS(2052);return r.write_shift(4,e),cE(t,r),cE(n,r),r.length>r.l?r.slice(0,r.l):r}(0,"TableStyleMedium9","PivotStyleMedium4")),NS(e,509)}function Cx(e,t){var n=AS();return NS(n,278),function(e,t){if(t){var n=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var r=e[0];r<=e[1];++r)null!=t[r]&&++n}),0!=n&&(NS(e,615,XS(n)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var r=n[0];r<=n[1];++r)null!=t[r]&&NS(e,44,mx(r,t[r]))}),NS(e,616))}}(n,e.SSF),function(e){NS(e,611,XS(1)),NS(e,43,gx({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),NS(e,612)}(n),function(e){NS(e,603,XS(2)),NS(e,45,wx({patternType:"none"})),NS(e,45,wx({patternType:"gray125"})),NS(e,604)}(n),kx(n),function(e){NS(e,626,XS(1)),NS(e,47,Tx({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),NS(e,627)}(n),function(e,t){NS(e,617,XS(t.length)),t.forEach(function(t){NS(e,47,Tx(t,0))}),NS(e,618)}(n,t.cellXfs),_x(n),function(e){NS(e,505,XS(0)),NS(e,506)}(n),xx(n),NS(n,279),n.end()}var Ix=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Ax(e,t,n){t.themeElements.clrScheme=[];var r={};(e[0].match(Hw)||[]).forEach(function(e){var a=Kw(e);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":r.rgb=a.val;break;case"<a:sysClr":r.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":"/"===a[0].charAt(1)?(t.themeElements.clrScheme[Ix.indexOf(a[0])]=r,r={}):r.name=a[0].slice(3,a[0].length-1);break;default:if(n&&n.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function Nx(){}function Rx(){}var Ox=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Px=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Dx=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;var Lx=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Mx(e,t){var n;e&&0!==e.length||(e=Fx());var r={};if(!(n=e.match(Lx)))throw new Error("themeElements not found in theme");return function(e,t,n){var r;t.themeElements={},[["clrScheme",Ox,Ax],["fontScheme",Px,Nx],["fmtScheme",Dx,Rx]].forEach(function(a){if(!(r=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](r,t,n)})}(n[0],r,t),r.raw=e,r}function Fx(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&"string"==typeof e.raw)return e.raw;var n=[Vw];return n[n.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',n[n.length]="<a:themeElements>",n[n.length]='<a:clrScheme name="Office">',n[n.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',n[n.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',n[n.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',n[n.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',n[n.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',n[n.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',n[n.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',n[n.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',n[n.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',n[n.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',n[n.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',n[n.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',n[n.length]="</a:clrScheme>",n[n.length]='<a:fontScheme name="Office">',n[n.length]="<a:majorFont>",n[n.length]='<a:latin typeface="Cambria"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',n[n.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',n[n.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',n[n.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',n[n.length]='<a:font script="Arab" typeface="Times New Roman"/>',n[n.length]='<a:font script="Hebr" typeface="Times New Roman"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="MoolBoran"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Times New Roman"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:majorFont>",n[n.length]="<a:minorFont>",n[n.length]='<a:latin typeface="Calibri"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',n[n.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',n[n.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',n[n.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',n[n.length]='<a:font script="Arab" typeface="Arial"/>',n[n.length]='<a:font script="Hebr" typeface="Arial"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="DaunPenh"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Arial"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:minorFont>",n[n.length]="</a:fontScheme>",n[n.length]='<a:fmtScheme name="Office">',n[n.length]="<a:fillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="1"/>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="0"/>',n[n.length]="</a:gradFill>",n[n.length]="</a:fillStyleLst>",n[n.length]="<a:lnStyleLst>",n[n.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]="</a:lnStyleLst>",n[n.length]="<a:effectStyleLst>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',n[n.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',n[n.length]="</a:effectStyle>",n[n.length]="</a:effectStyleLst>",n[n.length]="<a:bgFillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]="</a:bgFillStyleLst>",n[n.length]="</a:fmtScheme>",n[n.length]="</a:themeElements>",n[n.length]="<a:objectDefaults>",n[n.length]="<a:spDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',n[n.length]="</a:spDef>",n[n.length]="<a:lnDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',n[n.length]="</a:lnDef>",n[n.length]="</a:objectDefaults>",n[n.length]="<a:extraClrSchemeLst/>",n[n.length]="</a:theme>",n.join("")}function Ux(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:case 4:e.l+=4;break;case 1:t.xclrValue=function(e,t){return xS(e,t)}(e,4);break;case 2:t.xclrValue=Fk(e);break;case 3:t.xclrValue=function(e){return e.read_shift(4)}(e)}return e.l+=8,t}function jx(e){var t=e.read_shift(2),n=e.read_shift(2)-4,r=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:r[1]=Ux(e);break;case 6:r[1]=function(e,t){return xS(e,t)}(e,n);break;case 14:case 15:r[1]=e.read_shift(1===n?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+n)}return r}function Vx(e,t){t.forEach(function(e){e[0]})}function zx(){var e=AS();return NS(e,332),NS(e,334,XS(1)),NS(e,335,function(e){var t=CS(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),QS(e.name,t),t.slice(0,t.l)}({name:"XLDAPR",version:12e4,flags:3496657072})),NS(e,336),NS(e,339,function(e,t){var n=CS(8+2*t.length);return n.write_shift(4,e),QS(t,n),n.slice(0,n.l)}(1,"XLDAPR")),NS(e,52),NS(e,35,XS(514)),NS(e,4096,XS(0)),NS(e,4097,Ek(1)),NS(e,36),NS(e,53),NS(e,340),NS(e,337,function(e,t){var n=CS(8);return n.write_shift(4,e),n.write_shift(4,t?1:0),n}(1,!0)),NS(e,51,function(e){var t=CS(4+8*e.length);t.write_shift(4,e.length);for(var n=0;n<e.length;++n)t.write_shift(4,e[n][0]),t.write_shift(4,e[n][1]);return t}([[1,0]])),NS(e,338),NS(e,333),e.end()}function Bx(){var e=[Vw];return e.push('<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">\n  <metadataTypes count="1">\n    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>\n  </metadataTypes>\n  <futureMetadata name="XLDAPR" count="1">\n    <bk>\n      <extLst>\n        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">\n          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>\n        </ext>\n      </extLst>\n    </bk>\n  </futureMetadata>\n  <cellMetadata count="1">\n    <bk>\n      <rc t="1" v="0"/>\n    </bk>\n  </cellMetadata>\n</metadata>'),e.join("")}var Hx=1024;function Wx(e,t){for(var n=[21600,21600],r=["m0,0l0",n[1],n[0],n[1],n[0],"0xe"].join(","),a=[wT("xml",null,{"xmlns:v":HT,"xmlns:o":UT,"xmlns:x":jT,"xmlns:mv":BT}).replace(/\/>/,">"),wT("o:shapelayout",wT("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),wT("v:shapetype",[wT("v:stroke",null,{joinstyle:"miter"}),wT("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:n.join(","),path:r})];Hx<1e3*e;)Hx+=1e3;return t.forEach(function(e){var t=jS(e[0]),n={color2:"#BEFF82",type:"gradient"};"gradient"==n.type&&(n.angle="-180");var r="gradient"==n.type?wT("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,i=wT("v:fill",r,n);++Hx,a=a.concat(["<v:shape"+bT({id:"_x0000_s"+Hx,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(e[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",i,wT("v:shadow",null,{on:"t",obscured:"t"}),wT("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",yT("x:Anchor",[t.c+1,0,t.r+1,0,t.c+3,20,t.r+5,20].join(",")),yT("x:AutoFill","False"),yT("x:Row",String(t.r)),yT("x:Column",String(t.c)),e[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function Gx(e,t,n,r){var a,i=Array.isArray(e);t.forEach(function(t){var s=jS(t.ref);if(i?(e[s.r]||(e[s.r]=[]),a=e[s.r][s.c]):a=e[t.ref],!a){a={t:"z"},i?e[s.r][s.c]=a:e[t.ref]=a;var o=HS(e["!ref"]||"BDWGO1000001:A1");o.s.r>s.r&&(o.s.r=s.r),o.e.r<s.r&&(o.e.r=s.r),o.s.c>s.c&&(o.s.c=s.c),o.e.c<s.c&&(o.e.c=s.c);var l=BS(o);l!==e["!ref"]&&(e["!ref"]=l)}a.c||(a.c=[]);var c={a:t.author,t:t.t,r:t.r,T:n};t.h&&(c.h=t.h);for(var u=a.c.length-1;u>=0;--u){if(!n&&a.c[u].T)return;n&&!a.c[u].T&&a.c.splice(u,1)}if(n&&r)for(u=0;u<r.length;++u)if(c.a==r[u].id){c.a=r[u].name||c.a;break}a.c.push(c)})}function Kx(e){var t=[Vw,wT("comments",null,{xmlns:FT[0]})],n=[];return t.push("<authors>"),e.forEach(function(e){e[1].forEach(function(e){var r=Zw(e.a);-1==n.indexOf(r)&&(n.push(r),t.push("<author>"+r+"</author>")),e.T&&e.ID&&-1==n.indexOf("tc="+e.ID)&&(n.push("tc="+e.ID),t.push("<author>tc="+e.ID+"</author>"))})}),0==n.length&&(n.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(e){var r=0,a=[];if(e[1][0]&&e[1][0].T&&e[1][0].ID?r=n.indexOf("tc="+e[1][0].ID):e[1].forEach(function(e){e.a&&(r=n.indexOf(Zw(e.a))),a.push(e.t||"")}),t.push('<comment ref="'+e[0]+'" authorId="'+r+'"><text>'),a.length<=1)t.push(yT("t",Zw(a[0]||"")));else{for(var i="Comment:\n    "+a[0]+"\n",s=1;s<a.length;++s)i+="Reply:\n    "+a[s]+"\n";t.push(yT("t",Zw(i)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function qx(e,t,n){var r=[Vw,wT("ThreadedComments",null,{xmlns:AT}).replace(/[\/]>/,">")];return e.forEach(function(e){var a="";(e[1]||[]).forEach(function(i,s){if(i.T){i.a&&-1==t.indexOf(i.a)&&t.push(i.a);var o={ref:e[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+n.tcid++).slice(-12)+"}"};0==s?a=o.id:o.parentId=a,i.ID=o.id,i.a&&(o.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(i.a)).slice(-12)+"}"),r.push(wT("threadedComment",yT("text",i.t||""),o))}else delete i.ID})}),r.push("</ThreadedComments>"),r.join("")}var $x=YS;function Xx(e){var t=AS(),n=[];return NS(t,628),NS(t,630),e.forEach(function(e){e[1].forEach(function(e){n.indexOf(e.a)>-1||(n.push(e.a.slice(0,54)),NS(t,632,function(e){return QS(e.slice(0,54))}(e.a)))})}),NS(t,631),NS(t,633),e.forEach(function(e){e[1].forEach(function(r){r.iauthor=n.indexOf(r.a);var a={s:jS(e[0]),e:jS(e[0])};NS(t,635,function(e,t){return null==t&&(t=CS(36)),t.write_shift(4,e[1].iauthor),vE(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}([a,r])),r.t&&r.t.length>0&&NS(t,637,tE(r)),NS(t,636),delete r.iauthor})}),NS(t,634),NS(t,629),t.end()}var Yx=["xlsb","xlsm","xlam","biff8","xla"];var Qx=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function n(e,n,r,a){var i=!1,s=!1;0==r.length?s=!0:"["==r.charAt(0)&&(s=!0,r=r.slice(1,-1)),0==a.length?i=!0:"["==a.charAt(0)&&(i=!0,a=a.slice(1,-1));var o=r.length>0?0|parseInt(r,10):0,l=a.length>0?0|parseInt(a,10):0;return i?l+=t.c:--l,s?o+=t.r:--o,n+(i?"":"$")+US(l)+(s?"":"$")+MS(o)}return function(r,a){return t=a,r.replace(e,n)}}(),Jx=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Zx=function(){return function(e,t){return e.replace(Jx,function(e,n,r,a,i,s){var o=FS(a)-(r?0:t.c),l=LS(s)-(i?0:t.r);return n+"R"+(0==l?"":i?l+1:"["+l+"]")+"C"+(0==o?"":r?o+1:"["+o+"]")})}}();function eC(e,t){return e.replace(Jx,function(e,n,r,a,i,s){return n+("$"==r?r+a:US(FS(a)+t.c))+("$"==i?i+s:MS(LS(s)+t.r))})}function tC(e,t,n){var r=zS(t).s,a=jS(n);return eC(e,{r:a.r-r.r,c:a.c-r.c})}function nC(e){return e.replace(/_xlfn\./g,"")}function rC(e){e.l+=1}function aC(e,t){var n=e.read_shift(1==t?1:2);return[16383&n,n>>14&1,n>>15&1]}function iC(e,t,n){var r=2;if(n){if(n.biff>=2&&n.biff<=5)return sC(e);12==n.biff&&(r=4)}var a=e.read_shift(r),i=e.read_shift(r),s=aC(e,2),o=aC(e,2);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function sC(e){var t=aC(e,2),n=aC(e,2),r=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:r,cRel:t[1],rRel:t[2]},e:{r:n[0],c:a,cRel:n[1],rRel:n[2]}}}function oC(e,t,n){if(n&&n.biff>=2&&n.biff<=5)return function(e){var t=aC(e,2),n=e.read_shift(1);return{r:t[0],c:n,cRel:t[1],rRel:t[2]}}(e);var r=e.read_shift(n&&12==n.biff?4:2),a=aC(e,2);return{r:r,c:a[0],cRel:a[1],rRel:a[2]}}function lC(e){var t=e.read_shift(2),n=e.read_shift(2);return{r:t,c:255&n,fQuoted:!!(16384&n),cRel:n>>15,rRel:n>>15}}function cC(e){var t=1&e[e.l+1];return e.l+=4,[t,1]}function uC(e){return[e.read_shift(1),e.read_shift(1)]}function hC(e,t){var n=[e.read_shift(1)];if(12==t)switch(n[0]){case 2:n[0]=4;break;case 4:n[0]=16;break;case 0:n[0]=1;break;case 1:n[0]=2}switch(n[0]){case 4:n[1]=wk(e,1)?"TRUE":"FALSE",12!=t&&(e.l+=7);break;case 37:case 16:n[1]=NE[e[e.l]],e.l+=12==t?4:8;break;case 0:e.l+=8;break;case 1:n[1]=yE(e);break;case 2:n[1]=Rk(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+n[0])}return n}function fC(e,t,n){for(var r=e.read_shift(12==n.biff?4:2),a=[],i=0;i!=r;++i)a.push((12==n.biff?gE:Hk)(e,8));return a}function dC(e,t,n){var r=0,a=0;12==n.biff?(r=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),r=1+e.read_shift(2)),n.biff>=2&&n.biff<8&&(--r,0==--a&&(a=256));for(var i=0,s=[];i!=r&&(s[i]=[]);++i)for(var o=0;o!=a;++o)s[i][o]=hC(e,n.biff);return s}function pC(e,t,n){return e.l+=2,[lC(e)]}function mC(e){return e.l+=6,[]}function gC(e){return e.l+=2,[Sk(e),1&e.read_shift(2)]}var vC=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];var yC={1:{n:"PtgExp",f:function(e,t,n){return e.l++,n&&12==n.biff?[e.read_shift(4,"i"),0]:[e.read_shift(2),e.read_shift(n&&2==n.biff?1:2)]}},2:{n:"PtgTbl",f:xS},3:{n:"PtgAdd",f:rC},4:{n:"PtgSub",f:rC},5:{n:"PtgMul",f:rC},6:{n:"PtgDiv",f:rC},7:{n:"PtgPower",f:rC},8:{n:"PtgConcat",f:rC},9:{n:"PtgLt",f:rC},10:{n:"PtgLe",f:rC},11:{n:"PtgEq",f:rC},12:{n:"PtgGe",f:rC},13:{n:"PtgGt",f:rC},14:{n:"PtgNe",f:rC},15:{n:"PtgIsect",f:rC},16:{n:"PtgUnion",f:rC},17:{n:"PtgRange",f:rC},18:{n:"PtgUplus",f:rC},19:{n:"PtgUminus",f:rC},20:{n:"PtgPercent",f:rC},21:{n:"PtgParen",f:rC},22:{n:"PtgMissArg",f:rC},23:{n:"PtgStr",f:function(e,t,n){return e.l++,xk(e,0,n)}},26:{n:"PtgSheet",f:function(e,t,n){return e.l+=5,e.l+=2,e.l+=2==n.biff?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function(e,t,n){return e.l+=2==n.biff?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function(e){return e.l++,NE[e.read_shift(1)]}},29:{n:"PtgBool",f:function(e){return e.l++,0!==e.read_shift(1)}},30:{n:"PtgInt",f:function(e){return e.l++,e.read_shift(2)}},31:{n:"PtgNum",f:function(e){return e.l++,yE(e)}},32:{n:"PtgArray",f:function(e,t,n){var r=(96&e[e.l++])>>5;return e.l+=2==n.biff?6:12==n.biff?14:7,[r]}},33:{n:"PtgFunc",f:function(e,t,n){var r=(96&e[e.l])>>5;e.l+=1;var a=e.read_shift(n&&n.biff<=3?1:2);return[VC[a],jC[a],r]}},34:{n:"PtgFuncVar",f:function(e,t,n){var r=e[e.l++],a=e.read_shift(1),i=n&&n.biff<=3?[88==r?-1:0,e.read_shift(1)]:function(e){return[e[e.l+1]>>7,32767&e.read_shift(2)]}(e);return[a,(0===i[0]?jC:UC)[i[1]]]}},35:{n:"PtgName",f:function(e,t,n){var r=e.read_shift(1)>>>5&3,a=!n||n.biff>=8?4:2,i=e.read_shift(a);switch(n.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12}return[r,0,i]}},36:{n:"PtgRef",f:function(e,t,n){var r=(96&e[e.l])>>5;return e.l+=1,[r,oC(e,0,n)]}},37:{n:"PtgArea",f:function(e,t,n){return[(96&e[e.l++])>>5,iC(e,n.biff>=2&&n.biff,n)]}},38:{n:"PtgMemArea",f:function(e,t,n){var r=e.read_shift(1)>>>5&3;return e.l+=n&&2==n.biff?3:4,[r,e.read_shift(n&&2==n.biff?1:2)]}},39:{n:"PtgMemErr",f:xS},40:{n:"PtgMemNoMem",f:xS},41:{n:"PtgMemFunc",f:function(e,t,n){return[e.read_shift(1)>>>5&3,e.read_shift(n&&2==n.biff?1:2)]}},42:{n:"PtgRefErr",f:function(e,t,n){var r=e.read_shift(1)>>>5&3;return e.l+=4,n.biff<8&&e.l--,12==n.biff&&(e.l+=2),[r]}},43:{n:"PtgAreaErr",f:function(e,t,n){var r=(96&e[e.l++])>>5;return e.l+=n&&n.biff>8?12:n.biff<8?6:8,[r]}},44:{n:"PtgRefN",f:function(e,t,n){var r=(96&e[e.l])>>5;e.l+=1;var a=function(e,t,n){var r=n&&n.biff?n.biff:8;if(r>=2&&r<=5)return function(e){var t=e.read_shift(2),n=e.read_shift(1),r=(32768&t)>>15,a=(16384&t)>>14;return t&=16383,1==r&&t>=8192&&(t-=16384),1==a&&n>=128&&(n-=256),{r:t,c:n,cRel:a,rRel:r}}(e);var a=e.read_shift(r>=12?4:2),i=e.read_shift(2),s=(16384&i)>>14,o=(32768&i)>>15;if(i&=16383,1==o)for(;a>524287;)a-=1048576;if(1==s)for(;i>8191;)i-=16384;return{r:a,c:i,cRel:s,rRel:o}}(e,0,n);return[r,a]}},45:{n:"PtgAreaN",f:function(e,t,n){var r=(96&e[e.l++])>>5,a=function(e,t,n){if(n.biff<8)return sC(e);var r=e.read_shift(12==n.biff?4:2),a=e.read_shift(12==n.biff?4:2),i=aC(e,2),s=aC(e,2);return{s:{r:r,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:s[0],cRel:s[1],rRel:s[2]}}}(e,0,n);return[r,a]}},46:{n:"PtgMemAreaN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},47:{n:"PtgMemNoMemN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},57:{n:"PtgNameX",f:function(e,t,n){return 5==n.biff?function(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2,"i");e.l+=8;var r=e.read_shift(2);return e.l+=12,[t,n,r]}(e):[e.read_shift(1)>>>5&3,e.read_shift(2),e.read_shift(4)]}},58:{n:"PtgRef3d",f:function(e,t,n){var r=(96&e[e.l])>>5;e.l+=1;var a=e.read_shift(2);return n&&5==n.biff&&(e.l+=12),[r,a,oC(e,0,n)]}},59:{n:"PtgArea3d",f:function(e,t,n){var r=(96&e[e.l++])>>5,a=e.read_shift(2,"i");if(n)switch(n.biff){case 5:e.l+=12;break;case 12:0}return[r,a,iC(e,0,n)]}},60:{n:"PtgRefErr3d",f:function(e,t,n){var r=(96&e[e.l++])>>5,a=e.read_shift(2),i=4;if(n)switch(n.biff){case 5:i=15;break;case 12:i=6}return e.l+=i,[r,a]}},61:{n:"PtgAreaErr3d",f:function(e,t,n){var r=(96&e[e.l++])>>5,a=e.read_shift(2),i=8;if(n)switch(n.biff){case 5:e.l+=12,i=6;break;case 12:i=12}return e.l+=i,[r,a]}},255:{}},bC={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},wC={1:{n:"PtgElfLel",f:gC},2:{n:"PtgElfRw",f:pC},3:{n:"PtgElfCol",f:pC},6:{n:"PtgElfRwV",f:pC},7:{n:"PtgElfColV",f:pC},10:{n:"PtgElfRadical",f:pC},11:{n:"PtgElfRadicalS",f:mC},13:{n:"PtgElfColS",f:mC},15:{n:"PtgElfColSV",f:mC},16:{n:"PtgElfRadicalLel",f:gC},25:{n:"PtgList",f:function(e){e.l+=2;var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(4),a=e.read_shift(2),i=e.read_shift(2);return{ixti:t,coltype:3&n,rt:vC[n>>2&31],idx:r,c:a,C:i}}},29:{n:"PtgSxName",f:function(e){return e.l+=2,[e.read_shift(4)]}},255:{}},TC={0:{n:"PtgAttrNoop",f:function(e){return e.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function(e,t,n){var r=255&e[e.l+1]?1:0;return e.l+=n&&2==n.biff?3:4,[r]}},2:{n:"PtgAttrIf",f:function(e,t,n){var r=255&e[e.l+1]?1:0;return e.l+=2,[r,e.read_shift(n&&2==n.biff?1:2)]}},4:{n:"PtgAttrChoose",f:function(e,t,n){e.l+=2;for(var r=e.read_shift(n&&2==n.biff?1:2),a=[],i=0;i<=r;++i)a.push(e.read_shift(n&&2==n.biff?1:2));return a}},8:{n:"PtgAttrGoto",f:function(e,t,n){var r=255&e[e.l+1]?1:0;return e.l+=2,[r,e.read_shift(n&&2==n.biff?1:2)]}},16:{n:"PtgAttrSum",f:function(e,t,n){e.l+=n&&2==n.biff?3:4}},32:{n:"PtgAttrBaxcel",f:cC},33:{n:"PtgAttrBaxcel",f:cC},64:{n:"PtgAttrSpace",f:function(e){return e.read_shift(2),uC(e)}},65:{n:"PtgAttrSpaceSemi",f:function(e){return e.read_shift(2),uC(e)}},128:{n:"PtgAttrIfError",f:function(e){var t=255&e[e.l+1]?1:0;return e.l+=2,[t,e.read_shift(2)]}},255:{}};function SC(e,t,n,r){if(r.biff<8)return xS(e,t);for(var a=e.l+t,i=[],s=0;s!==n.length;++s)switch(n[s][0]){case"PtgArray":n[s][1]=dC(e,0,r),i.push(n[s][1]);break;case"PtgMemArea":n[s][2]=fC(e,n[s][1],r),i.push(n[s][2]);break;case"PtgExp":r&&12==r.biff&&(n[s][1][1]=e.read_shift(4),i.push(n[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+n[s][0]}return 0!==(t=a-e.l)&&i.push(xS(e,t)),i}function EC(e,t,n){for(var r,a,i=e.l+t,s=[];i!=e.l;)t=i-e.l,a=e[e.l],r=yC[a]||yC[bC[a]],24!==a&&25!==a||(r=(24===a?wC:TC)[e[e.l+1]]),r&&r.f?s.push([r.n,r.f(e,t,n)]):xS(e,t);return s}function kC(e){for(var t=[],n=0;n<e.length;++n){for(var r=e[n],a=[],i=0;i<r.length;++i){var s=r[i];if(s)if(2===s[0])a.push('"'+s[1].replace(/"/g,'""')+'"');else a.push(s[1]);else a.push("")}t.push(a.join(","))}return t.join(";")}var _C={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function xC(e,t,n){if(!e)return"SH33TJSERR0";if(n.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var r=e.XTI[t];if(n.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),0==t?"":e.XTI[t-1];if(!r)return"SH33TJSERR1";var a="";if(n.biff>8)switch(e[r[0]][0]){case 357:return a=-1==r[1]?"#REF":e.SheetNames[r[1]],r[1]==r[2]?a:a+":"+e.SheetNames[r[2]];case 358:return null!=n.SID?e.SheetNames[n.SID]:"SH33TJSSAME"+e[r[0]][0];default:return"SH33TJSSRC"+e[r[0]][0]}switch(e[r[0]][0][0]){case 1025:return a=-1==r[1]?"#REF":e.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?a:a+":"+e.SheetNames[r[2]];case 14849:return e[r[0]].slice(1).map(function(e){return e.Name}).join(";;");default:return e[r[0]][0][3]?(a=-1==r[1]?"#REF":e[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?a:a+":"+e[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function CC(e,t,n){var r=xC(e,t,n);return"#REF"==r?r:function(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}(r,n)}function IC(e,t,n,r,a){var i,s,o,l,c=a&&a.biff||8,u={s:{c:0,r:0},e:{c:0,r:0}},h=[],f=0,d=0,p="";if(!e[0]||!e[0][0])return"";for(var m=-1,g="",v=0,y=e[0].length;v<y;++v){var b=e[0][v];switch(b[0]){case"PtgUminus":h.push("-"+h.pop());break;case"PtgUplus":h.push("+"+h.pop());break;case"PtgPercent":h.push(h.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(i=h.pop(),s=h.pop(),m>=0){switch(e[0][m][1][0]){case 0:g=Ew(" ",e[0][m][1][1]);break;case 1:g=Ew("\r",e[0][m][1][1]);break;default:if(g="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}s+=g,m=-1}h.push(s+_C[b[0]]+i);break;case"PtgIsect":i=h.pop(),s=h.pop(),h.push(s+" "+i);break;case"PtgUnion":i=h.pop(),s=h.pop(),h.push(s+","+i);break;case"PtgRange":i=h.pop(),s=h.pop(),h.push(s+":"+i);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":case"PtgAttrBaxcel":case"PtgAttrSemi":case"PtgMemArea":case"PtgTbl":case"PtgMemErr":case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgRef":o=RS(b[1][1],u,a),h.push(PS(o,c));break;case"PtgRefN":o=n?RS(b[1][1],n,a):b[1][1],h.push(PS(o,c));break;case"PtgRef3d":f=b[1][1],o=RS(b[1][2],u,a);p=CC(r,f,a);h.push(p+"!"+PS(o,c));break;case"PtgFunc":case"PtgFuncVar":var w=b[1][0],T=b[1][1];w||(w=0);var S=0==(w&=127)?[]:h.slice(-w);h.length-=w,"User"===T&&(T=S.shift()),h.push(T+"("+S.join(",")+")");break;case"PtgBool":h.push(b[1]?"TRUE":"FALSE");break;case"PtgInt":case"PtgErr":h.push(b[1]);break;case"PtgNum":h.push(String(b[1]));break;case"PtgStr":h.push('"'+b[1].replace(/"/g,'""')+'"');break;case"PtgAreaN":l=OS(b[1][1],n?{s:n}:u,a),h.push(DS(l,a));break;case"PtgArea":l=OS(b[1][1],u,a),h.push(DS(l,a));break;case"PtgArea3d":f=b[1][1],l=b[1][2],p=CC(r,f,a),h.push(p+"!"+DS(l,a));break;case"PtgAttrSum":h.push("SUM("+h.pop()+")");break;case"PtgName":d=b[1][2];var E=(r.names||[])[d-1]||(r[0]||[])[d],k=E?E.Name:"SH33TJSNAME"+String(d);k&&"_xlfn."==k.slice(0,6)&&!a.xlfn&&(k=k.slice(6)),h.push(k);break;case"PtgNameX":var _,x=b[1][1];if(d=b[1][2],!(a.biff<=5)){var C="";if(14849==((r[x]||[])[0]||[])[0]||(1025==((r[x]||[])[0]||[])[0]?r[x][d]&&r[x][d].itab>0&&(C=r.SheetNames[r[x][d].itab-1]+"!"):C=r.SheetNames[d-1]+"!"),r[x]&&r[x][d])C+=r[x][d].Name;else if(r[0]&&r[0][d])C+=r[0][d].Name;else{var I=(xC(r,x,a)||"").split(";;");I[d-1]?C=I[d-1]:C+="SH33TJSERRX"}h.push(C);break}x<0&&(x=-x),r[x]&&(_=r[x][d]),_||(_={Name:"SH33TJSERRY"}),h.push(_.Name);break;case"PtgParen":var A="(",N=")";if(m>=0){switch(g="",e[0][m][1][0]){case 2:A=Ew(" ",e[0][m][1][1])+A;break;case 3:A=Ew("\r",e[0][m][1][1])+A;break;case 4:N=Ew(" ",e[0][m][1][1])+N;break;case 5:N=Ew("\r",e[0][m][1][1])+N;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}m=-1}h.push(A+h.pop()+N);break;case"PtgRefErr":case"PtgRefErr3d":case"PtgAreaErr":case"PtgAreaErr3d":h.push("#REF!");break;case"PtgExp":o={c:b[1][1],r:b[1][0]};var R={c:n.c,r:n.r};if(r.sharedf[VS(o)]){var O=r.sharedf[VS(o)];h.push(IC(O,u,R,r,a))}else{var P=!1;for(i=0;i!=r.arrayf.length;++i)if(s=r.arrayf[i],!(o.c<s[0].s.c||o.c>s[0].e.c)&&!(o.r<s[0].s.r||o.r>s[0].e.r)){h.push(IC(s[1],u,R,r,a)),P=!0;break}P||h.push(b[1])}break;case"PtgArray":h.push("{"+kC(b[1])+"}");break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=v;break;case"PtgMissArg":h.push("");break;case"PtgList":h.push("Table"+b[1].idx+"[#"+b[1].rt+"]");break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");default:throw new Error("Unrecognized Formula Token: "+String(b))}if(3!=a.biff&&m>=0&&-1==["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(e[0][v][0])){var D=!0;switch((b=e[0][m])[1][0]){case 4:D=!1;case 0:g=Ew(" ",b[1][1]);break;case 5:D=!1;case 1:g=Ew("\r",b[1][1]);break;default:if(g="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+b[1][0])}h.push((D?g:"")+h.pop()+(D?"":g)),m=-1}}if(h.length>1&&a.WTF)throw new Error("bad formula stack");return h[0]}function AC(e,t,n){var r,a=e.l+t,i=2==n.biff?1:2,s=e.read_shift(i);if(65535==s)return[[],xS(e,t-2)];var o=EC(e,s,n);return t!==s+i&&(r=SC(e,t-s-i,o,n)),e.l=a,[o,r]}function NC(e,t,n){var r,a=e.l+t,i=e.read_shift(2),s=EC(e,i,n);return 65535==i?[[],xS(e,t-2)]:(t!==i+2&&(r=SC(e,a-i-2,s,n)),[s,r])}function RC(e,t,n){var r=e.l+t,a=jk(e);2==n.biff&&++e.l;var i=function(e){var t;if(65535!==pS(e,e.l+6))return[yE(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=1===e[e.l+2],e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}(e),s=e.read_shift(1);2!=n.biff&&(e.read_shift(1),n.biff>=5&&e.read_shift(4));var o=function(e,t,n){var r,a=e.l+t,i=2==n.biff?1:2,s=e.read_shift(i);if(65535==s)return[[],xS(e,t-2)];var o=EC(e,s,n);return t!==s+i&&(r=SC(e,t-s-i,o,n)),e.l=a,[o,r]}(e,r-e.l,n);return{cell:a,val:i[0],formula:o,shared:s>>3&1,tt:i[1]}}function OC(e,t,n,r,a){var i=Vk(t,n,a),s=function(e){if(null==e){var t=CS(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}return bE("number"==typeof e?e:0)}(e.v),o=CS(6);o.write_shift(2,33),o.write_shift(4,0);for(var l=CS(e.bf.length),c=0;c<e.bf.length;++c)l[c]=e.bf[c];return ib([i,s,o,l])}function PC(e,t,n){var r=e.read_shift(4),a=EC(e,r,n),i=e.read_shift(4);return[a,i>0?SC(e,i,a,n):null]}var DC=PC,LC=PC,MC=PC,FC=PC,UC={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},jC={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},VC={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function zC(e){return"of:"==e.slice(0,3)&&(e=e.slice(3)),61==e.charCodeAt(0)&&61==(e=e.slice(1)).charCodeAt(0)&&(e=e.slice(1)),(e=(e=(e=e.replace(/COM\.MICROSOFT\./g,"")).replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,t){return t.replace(/\./g,"")})).replace(/\[.(#[A-Z]*[?!])\]/g,"$1")).replace(/[;~]/g,",").replace(/\|/g,";")}function BC(e){return("of:="+e.replace(Jx,"$1[.$2$3$4$5]").replace(/\]:\[/g,":")).replace(/;/g,"|").replace(/,/g,";")}function HC(e){var t=e.split(":");return[t[0].split(".")[0],t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function WC(e){return e.replace(/\./,"!")}var GC={},KC={},qC="undefined"!==typeof Map;function $C(e,t,n){var r=0,a=e.length;if(n){if(qC?n.has(t):Object.prototype.hasOwnProperty.call(n,t))for(var i=qC?n.get(t):n[t];r<i.length;++r)if(e[i[r]].t===t)return e.Count++,i[r]}else for(;r<a;++r)if(e[r].t===t)return e.Count++,r;return e[a]={t:t},e.Count++,e.Unique++,n&&(qC?(n.has(t)||n.set(t,[]),n.get(t).push(a)):(Object.prototype.hasOwnProperty.call(n,t)||(n[t]=[]),n[t].push(a))),a}function XC(e,t){var n={min:e+1,max:e+1},r=-1;return t.MDW&&(ex=t.MDW),null!=t.width?n.customWidth=1:null!=t.wpx?r=nx(t.wpx):null!=t.wch&&(r=t.wch),r>-1?(n.width=rx(r),n.customWidth=1):null!=t.width&&(n.width=t.width),t.hidden&&(n.hidden=!0),null!=t.level&&(n.outlineLevel=n.level=t.level),n}function YC(e,t){if(e){var n=[.7,.7,.75,.75,.3,.3];"xlml"==t&&(n=[1,1,1,1,.5,.5]),null==e.left&&(e.left=n[0]),null==e.right&&(e.right=n[1]),null==e.top&&(e.top=n[2]),null==e.bottom&&(e.bottom=n[3]),null==e.header&&(e.header=n[4]),null==e.footer&&(e.footer=n[5])}}function QC(e,t,n){var r=n.revssf[null!=t.z?t.z:"General"],a=60,i=e.length;if(null==r&&n.ssf)for(;a<392;++a)if(null==n.ssf[a]){Yb(t.z,a),n.ssf[a]=t.z,n.revssf[t.z]=r=a;break}for(a=0;a!=i;++a)if(e[a].numFmtId===r)return a;return e[i]={numFmtId:r,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function JC(e,t,n,r,a,i){try{r.cellNF&&(e.z=vb[t])}catch(AR){if(r.WTF)throw AR}if("z"!==e.t||r.cellStyles){if("d"===e.t&&"string"===typeof e.v&&(e.v=ww(e.v)),(!r||!1!==r.cellText)&&"z"!==e.t)try{if(null==vb[t]&&Yb(Zb[t]||"General",t),"e"===e.t)e.w=e.w||NE[e.v];else if(0===t)if("n"===e.t)(0|e.v)===e.v?e.w=e.v.toString(10):e.w=Cb(e.v);else if("d"===e.t){var s=hw(e.v);e.w=(0|s)===s?s.toString(10):Cb(s)}else{if(void 0===e.v)return"";e.w=Ib(e.v,KC)}else"d"===e.t?e.w=Xb(t,hw(e.v),KC):e.w=Xb(t,e.v,KC)}catch(AR){if(r.WTF)throw AR}if(r.cellStyles&&null!=n)try{e.s=i.Fills[n],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Z_(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),r.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Z_(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),r.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(AR){if(r.WTF&&i.Fills)throw AR}}}function ZC(e,t,n){if(e&&e["!ref"]){var r=HS(e["!ref"]);if(r.e.c<r.s.c||r.e.r<r.s.r)throw new Error("Bad range ("+n+"): "+e["!ref"])}}var eI=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,tI=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,nI=/<(?:\w:)?hyperlink [^>]*>/gm,rI=/"(\w*:\w*)"/,aI=/<(?:\w:)?col\b[^>]*[\/]?>/g,iI=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,sI=/<(?:\w:)?pageMargins[^>]*\/>/g,oI=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,lI=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,cI=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function uI(e,t,n,r,a,i,s){if(!e)return e;r||(r={"!id":{}});var o=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",u="",h=e.match(tI);h?(c=e.slice(0,h.index),u=e.slice(h.index+h[0].length)):c=u=e;var f=c.match(oI);f?hI(f[0],o,a,n):(f=c.match(lI))&&function(e,t,n,r,a){hI(e.slice(0,e.indexOf(">")),n,r,a)}(f[0],f[1],o,a,n);var d=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(d>0){var p=c.slice(d,d+50).match(rI);p&&function(e,t){var n=HS(t);n.s.r<=n.e.r&&n.s.c<=n.e.c&&n.s.r>=0&&n.s.c>=0&&(e["!ref"]=BS(n))}(o,p[1])}var m=c.match(cI);m&&m[1]&&function(e,t){t.Views||(t.Views=[{}]);(e.match(pI)||[]).forEach(function(e,n){var r=Kw(e);t.Views[n]||(t.Views[n]={}),+r.zoomScale&&(t.Views[n].zoom=+r.zoomScale),aT(r.rightToLeft)&&(t.Views[n].RTL=!0)})}(m[1],a);var g=[];if(t.cellStyles){var v=c.match(aI);v&&function(e,t){for(var n=!1,r=0;r!=t.length;++r){var a=Kw(t[r],!0);a.hidden&&(a.hidden=aT(a.hidden));var i=parseInt(a.min,10)-1,s=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!n&&a.width&&(n=!0,ix(a.width)),sx(a);i<=s;)e[i++]=Sw(a)}}(g,v)}h&&gI(h[1],o,t,l,i,s);var y=u.match(iI);y&&(o["!autofilter"]=function(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}(y[0]));var b=[],w=u.match(eI);if(w)for(d=0;d!=w.length;++d)b[d]=HS(w[d].slice(w[d].indexOf('"')+1));var T=u.match(nI);T&&function(e,t,n){for(var r=Array.isArray(e),a=0;a!=t.length;++a){var i=Kw(cT(t[a]),!0);if(!i.ref)return;var s=((n||{})["!id"]||[])[i.id];s?(i.Target=s.Target,i.location&&(i.Target+="#"+Yw(i.location))):(i.Target="#"+Yw(i.location),s={Target:i.Target,TargetMode:"Internal"}),i.Rel=s,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var o=HS(i.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var u=VS({c:c,r:l});r?(e[l]||(e[l]=[]),e[l][c]||(e[l][c]={t:"z",v:void 0}),e[l][c].l=i):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=i)}}}(o,T,r);var S=u.match(sI);if(S&&(o["!margins"]=function(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(n){e[n]&&(t[n]=parseFloat(e[n]))}),t}(Kw(S[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=BS(l)),t.sheetRows>0&&o["!ref"]){var E=HS(o["!ref"]);t.sheetRows<=+E.e.r&&(E.e.r=t.sheetRows-1,E.e.r>l.e.r&&(E.e.r=l.e.r),E.e.r<E.s.r&&(E.s.r=E.e.r),E.e.c>l.e.c&&(E.e.c=l.e.c),E.e.c<E.s.c&&(E.s.c=E.e.c),o["!fullref"]=o["!ref"],o["!ref"]=BS(E))}return g.length>0&&(o["!cols"]=g),b.length>0&&(o["!merges"]=b),o}function hI(e,t,n,r){var a=Kw(e);n.Sheets[r]||(n.Sheets[r]={}),a.codeName&&(n.Sheets[r].CodeName=Yw(cT(a.codeName)))}var fI=["objects","scenarios","selectLockedCells","selectUnlockedCells"],dI=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];var pI=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function mI(e,t,n,r){if(e.c&&n["!comments"].push([t,e.c]),void 0===e.v&&"string"!==typeof e.f||"z"===e.t&&!e.f)return"";var a="",i=e.t,s=e.v;if("z"!==e.t)switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=NE[e.v];break;case"d":r&&r.cellDates?a=ww(e.v,-1).toISOString():((e=Sw(e)).t="n",a=""+(e.v=hw(ww(e.v)))),"undefined"===typeof e.z&&(e.z=vb[14]);break;default:a=e.v}var o=yT("v",Zw(a)),l={r:t},c=QC(r.cellXfs,e,r);switch(0!==c&&(l.s=c),e.t){case"n":case"z":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;default:if(null==e.v){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(r&&r.bookSST){o=yT("v",""+$C(r.Strings,e.v,r.revStrings)),l.t="s";break}l.t="str"}if(e.t!=i&&(e.t=i,e.v=s),"string"==typeof e.f&&e.f){var u=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=wT("f",Zw(e.f),u)+(null!=e.v?o:"")}return e.l&&n["!links"].push([t,e.l]),e.D&&(l.cm=1),wT("c",o,l)}var gI=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,n=/r=["']([^"']*)["']/,r=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,i=hT("v"),s=hT("f");return function(o,l,c,u,h,f){for(var d,p,m,g,v,y=0,b="",w=[],T=[],S=0,E=0,k=0,_="",x=0,C=0,I=0,A=0,N=Array.isArray(f.CellXf),R=[],O=[],P=Array.isArray(l),D=[],L={},M=!1,F=!!c.sheetStubs,U=o.split(t),j=0,V=U.length;j!=V;++j){var z=(b=U[j].trim()).length;if(0!==z){var B=0;e:for(y=0;y<z;++y)switch(b[y]){case">":if("/"!=b[y-1]){++y;break e}if(c&&c.cellStyles){if(x=null!=(p=Kw(b.slice(B,y),!0)).r?parseInt(p.r,10):x+1,C=-1,c.sheetRows&&c.sheetRows<x)continue;L={},M=!1,p.ht&&(M=!0,L.hpt=parseFloat(p.ht),L.hpx=cx(L.hpt)),"1"==p.hidden&&(M=!0,L.hidden=!0),null!=p.outlineLevel&&(M=!0,L.level=+p.outlineLevel),M&&(D[x-1]=L)}break;case"<":B=y}if(B>=y)break;if(x=null!=(p=Kw(b.slice(B,y),!0)).r?parseInt(p.r,10):x+1,C=-1,!(c.sheetRows&&c.sheetRows<x)){u.s.r>x-1&&(u.s.r=x-1),u.e.r<x-1&&(u.e.r=x-1),c&&c.cellStyles&&(L={},M=!1,p.ht&&(M=!0,L.hpt=parseFloat(p.ht),L.hpx=cx(L.hpt)),"1"==p.hidden&&(M=!0,L.hidden=!0),null!=p.outlineLevel&&(M=!0,L.level=+p.outlineLevel),M&&(D[x-1]=L)),w=b.slice(y).split(e);for(var H=0;H!=w.length&&"<"==w[H].trim().charAt(0);++H);for(w=w.slice(H),y=0;y!=w.length;++y)if(0!==(b=w[y].trim()).length){if(T=b.match(n),S=y,E=0,k=0,b="<c "+("<"==b.slice(0,1)?">":"")+b,null!=T&&2===T.length){for(S=0,_=T[1],E=0;E!=_.length&&!((k=_.charCodeAt(E)-64)<1||k>26);++E)S=26*S+k;C=--S}else++C;for(E=0;E!=b.length&&62!==b.charCodeAt(E);++E);if(++E,(p=Kw(b.slice(0,E),!0)).r||(p.r=VS({r:x-1,c:C})),d={t:""},null!=(T=(_=b.slice(E)).match(i))&&""!==T[1]&&(d.v=Yw(T[1])),c.cellFormula){if(null!=(T=_.match(s))&&""!==T[1]){if(d.f=Yw(cT(T[1])).replace(/\r\n/g,"\n"),c.xlfn||(d.f=nC(d.f)),T[0].indexOf('t="array"')>-1)d.F=(_.match(a)||[])[1],d.F.indexOf(":")>-1&&R.push([HS(d.F),d.F]);else if(T[0].indexOf('t="shared"')>-1){g=Kw(T[0]);var W=Yw(cT(T[1]));c.xlfn||(W=nC(W)),O[parseInt(g.si,10)]=[g,W,p.r]}}else(T=_.match(/<f[^>]*\/>/))&&O[(g=Kw(T[0])).si]&&(d.f=tC(O[g.si][1],O[g.si][2],p.r));var G=jS(p.r);for(E=0;E<R.length;++E)G.r>=R[E][0].s.r&&G.r<=R[E][0].e.r&&G.c>=R[E][0].s.c&&G.c<=R[E][0].e.c&&(d.F=R[E][1])}if(null==p.t&&void 0===d.v)if(d.f||d.F)d.v=0,d.t="n";else{if(!F)continue;d.t="z"}else d.t=p.t||"n";switch(u.s.c>C&&(u.s.c=C),u.e.c<C&&(u.e.c=C),d.t){case"n":if(""==d.v||null==d.v){if(!F)continue;d.t="z"}else d.v=parseFloat(d.v);break;case"s":if("undefined"==typeof d.v){if(!F)continue;d.t="z"}else m=GC[parseInt(d.v,10)],d.v=m.t,d.r=m.r,c.cellHTML&&(d.h=m.h);break;case"str":d.t="s",d.v=null!=d.v?cT(d.v):"",c.cellHTML&&(d.h=nT(d.v));break;case"inlineStr":T=_.match(r),d.t="s",null!=T&&(m=N_(T[1]))?(d.v=m.t,c.cellHTML&&(d.h=m.h)):d.v="";break;case"b":d.v=aT(d.v);break;case"d":c.cellDates?d.v=ww(d.v,1):(d.v=hw(ww(d.v,1)),d.t="n");break;case"e":c&&!1===c.cellText||(d.w=d.v),d.v=RE[d.v]}if(I=A=0,v=null,N&&void 0!==p.s&&null!=(v=f.CellXf[p.s])&&(null!=v.numFmtId&&(I=v.numFmtId),c.cellStyles&&null!=v.fillId&&(A=v.fillId)),JC(d,I,A,c,h,f),c.cellDates&&N&&"n"==d.t&&Gb(vb[I])&&(d.t="d",d.v=mw(d.v)),p.cm&&c.xlmeta){var K=(c.xlmeta.Cell||[])[+p.cm-1];K&&"XLDAPR"==K.type&&(d.D=!0)}if(P){var q=jS(p.r);l[q.r]||(l[q.r]=[]),l[q.r][q.c]=d}else l[p.r]=d}}}}D.length>0&&(l["!rows"]=D)}}();function vI(e,t,n,r){var a,i=[Vw,wT("worksheet",null,{xmlns:FT[0],"xmlns:r":PT})],s=n.SheetNames[e],o="",l=n.Sheets[s];null==l&&(l={});var c=l["!ref"]||"A1",u=HS(c);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),c=BS(u)}r||(r={}),l["!comments"]=[];var h=[];!function(e,t,n,r,a){var i=!1,s={},o=null;if("xlsx"!==r.bookType&&t.vbaraw){var l=t.SheetNames[n];try{t.Workbook&&(l=t.Workbook.Sheets[n].CodeName||l)}catch(AR){}i=!0,s.codeName=uT(Zw(l))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),o=(o||"")+wT("outlinePr",null,c)}(i||o)&&(a[a.length]=wT("sheetPr",o,s))}(l,n,e,t,i),i[i.length]=wT("dimension",null,{ref:c}),i[i.length]=function(e,t,n,r){var a={workbookViewId:"0"};return(((r||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),wT("sheetViews",wT("sheetView",null,a),{})}(0,0,0,n),t.sheetFormat&&(i[i.length]=wT("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),null!=l["!cols"]&&l["!cols"].length>0&&(i[i.length]=function(e,t){for(var n,r=["<cols>"],a=0;a!=t.length;++a)(n=t[a])&&(r[r.length]=wT("col",null,XC(a,n)));return r[r.length]="</cols>",r.join("")}(0,l["!cols"])),i[a=i.length]="<sheetData/>",l["!links"]=[],null!=l["!ref"]&&(o=function(e,t){var n,r,a=[],i=[],s=HS(e["!ref"]),o="",l="",c=[],u=0,h=0,f=e["!rows"],d=Array.isArray(e),p={r:l},m=-1;for(h=s.s.c;h<=s.e.c;++h)c[h]=US(h);for(u=s.s.r;u<=s.e.r;++u){for(i=[],l=MS(u),h=s.s.c;h<=s.e.c;++h){n=c[h]+l;var g=d?(e[u]||[])[h]:e[n];void 0!==g&&null!=(o=mI(g,n,e,t))&&i.push(o)}(i.length>0||f&&f[u])&&(p={r:l},f&&f[u]&&((r=f[u]).hidden&&(p.hidden=1),m=-1,r.hpx?m=lx(r.hpx):r.hpt&&(m=r.hpt),m>-1&&(p.ht=m,p.customHeight=1),r.level&&(p.outlineLevel=r.level)),a[a.length]=wT("row",i.join(""),p))}if(f)for(;u<f.length;++u)f&&f[u]&&(p={r:u+1},(r=f[u]).hidden&&(p.hidden=1),m=-1,r.hpx?m=lx(r.hpx):r.hpt&&(m=r.hpt),m>-1&&(p.ht=m,p.customHeight=1),r.level&&(p.outlineLevel=r.level),a[a.length]=wT("row","",p));return a.join("")}(l,t,0,0),o.length>0&&(i[i.length]=o)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),l["!protect"]&&(i[i.length]=function(e){var t={sheet:1};return fI.forEach(function(n){null!=e[n]&&e[n]&&(t[n]="1")}),dI.forEach(function(n){null==e[n]||e[n]||(t[n]="0")}),e.password&&(t.password=q_(e.password).toString(16).toUpperCase()),wT("sheetProtection",null,t)}(l["!protect"])),null!=l["!autofilter"]&&(i[i.length]=function(e,t,n,r){var a="string"==typeof e.ref?e.ref:BS(e.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var i=n.Workbook.Names,s=zS(a);s.s.r==s.e.r&&(s.e.r=zS(t["!ref"]).e.r,a=BS(s));for(var o=0;o<i.length;++o){var l=i[o];if("_xlnm._FilterDatabase"==l.Name&&l.Sheet==r){l.Ref="'"+n.SheetNames[r]+"'!"+a;break}}return o==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+n.SheetNames[r]+"'!"+a}),wT("autoFilter",null,{ref:a})}(l["!autofilter"],l,n,e)),null!=l["!merges"]&&l["!merges"].length>0&&(i[i.length]=function(e){if(0===e.length)return"";for(var t='<mergeCells count="'+e.length+'">',n=0;n!=e.length;++n)t+='<mergeCell ref="'+BS(e[n])+'"/>';return t+"</mergeCells>"}(l["!merges"]));var f,d,p=-1,m=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(e){e[1].Target&&(f={ref:e[0]},"#"!=e[1].Target.charAt(0)&&(m=jE(r,-1,Zw(e[1].Target).replace(/#.*$/,""),LE.HLINK),f["r:id"]="rId"+m),(p=e[1].Target.indexOf("#"))>-1&&(f.location=Zw(e[1].Target.slice(p+1))),e[1].Tooltip&&(f.tooltip=Zw(e[1].Tooltip)),i[i.length]=wT("hyperlink",null,f))}),i[i.length]="</hyperlinks>"),delete l["!links"],null!=l["!margins"]&&(i[i.length]=(YC(d=l["!margins"]),wT("pageMargins",null,d))),t&&!t.ignoreEC&&void 0!=t.ignoreEC||(i[i.length]=yT("ignoredErrors",wT("ignoredError",null,{numberStoredAsText:1,sqref:c}))),h.length>0&&(m=jE(r,-1,"../drawings/drawing"+(e+1)+".xml",LE.DRAW),i[i.length]=wT("drawing",null,{"r:id":"rId"+m}),l["!drawing"]=h),l["!comments"].length>0&&(m=jE(r,-1,"../drawings/vmlDrawing"+(e+1)+".vml",LE.VML),i[i.length]=wT("legacyDrawing",null,{"r:id":"rId"+m}),l["!legacy"]=m),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function yI(e,t,n,r){var a=function(e,t,n){var r=CS(145),a=(n["!rows"]||[])[e]||{};r.write_shift(4,e),r.write_shift(4,0);var i=320;a.hpx?i=20*lx(a.hpx):a.hpt&&(i=20*a.hpt),r.write_shift(2,i),r.write_shift(1,0);var s=0;a.level&&(s|=a.level),a.hidden&&(s|=16),(a.hpx||a.hpt)&&(s|=32),r.write_shift(1,s),r.write_shift(1,0);var o=0,l=r.l;r.l+=4;for(var c={r:e,c:0},u=0;u<16;++u)if(!(t.s.c>u+1<<10||t.e.c<u<<10)){for(var h=-1,f=-1,d=u<<10;d<u+1<<10;++d)c.c=d,(Array.isArray(n)?(n[c.r]||[])[c.c]:n[VS(c)])&&(h<0&&(h=d),f=d);h<0||(++o,r.write_shift(4,h),r.write_shift(4,f))}var p=r.l;return r.l=l,r.write_shift(4,o),r.l=p,r.length>r.l?r.slice(0,r.l):r}(r,n,t);(a.length>17||(t["!rows"]||[])[r])&&NS(e,0,a)}var bI=gE,wI=vE;function TI(e){return[aE(e),yE(e),"n"]}var SI=gE,EI=vE;var kI=["left","right","top","bottom","header","footer"];function _I(e,t,n,r,a,i,s){if(void 0===t.v)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":(t=Sw(t)).z=t.z||vb[14],t.v=hw(ww(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v}var l={r:n,c:r};switch(l.s=QC(a.cellXfs,t,a),t.l&&i["!links"].push([VS(l),t.l]),t.c&&i["!comments"].push([VS(l),t.c]),t.t){case"s":case"str":return a.bookSST?(o=$C(a.Strings,t.v,a.revStrings),l.t="s",l.v=o,s?NS(e,18,function(e,t,n){return null==n&&(n=CS(8)),iE(t,n),n.write_shift(4,t.v),n}(0,l)):NS(e,7,function(e,t,n){return null==n&&(n=CS(12)),rE(t,n),n.write_shift(4,t.v),n}(0,l))):(l.t="str",s?NS(e,17,function(e,t,n){return null==n&&(n=CS(8+4*e.v.length)),iE(t,n),QS(e.v,n),n.length>n.l?n.slice(0,n.l):n}(t,l)):NS(e,6,function(e,t,n){return null==n&&(n=CS(12+4*e.v.length)),rE(t,n),QS(e.v,n),n.length>n.l?n.slice(0,n.l):n}(t,l))),!0;case"n":return t.v==(0|t.v)&&t.v>-1e3&&t.v<1e3?s?NS(e,13,function(e,t,n){return null==n&&(n=CS(8)),iE(t,n),pE(e.v,n),n}(t,l)):NS(e,2,function(e,t,n){return null==n&&(n=CS(12)),rE(t,n),pE(e.v,n),n}(t,l)):s?NS(e,16,function(e,t,n){return null==n&&(n=CS(12)),iE(t,n),bE(e.v,n),n}(t,l)):NS(e,5,function(e,t,n){return null==n&&(n=CS(16)),rE(t,n),bE(e.v,n),n}(t,l)),!0;case"b":return l.t="b",s?NS(e,15,function(e,t,n){return null==n&&(n=CS(5)),iE(t,n),n.write_shift(1,e.v?1:0),n}(t,l)):NS(e,4,function(e,t,n){return null==n&&(n=CS(9)),rE(t,n),n.write_shift(1,e.v?1:0),n}(t,l)),!0;case"e":return l.t="e",s?NS(e,14,function(e,t,n){return null==n&&(n=CS(8)),iE(t,n),n.write_shift(1,e.v),n.write_shift(2,0),n.write_shift(1,0),n}(t,l)):NS(e,3,function(e,t,n){return null==n&&(n=CS(9)),rE(t,n),n.write_shift(1,e.v),n}(t,l)),!0}return s?NS(e,12,function(e,t,n){return null==n&&(n=CS(4)),iE(t,n)}(0,l)):NS(e,1,function(e,t,n){return null==n&&(n=CS(8)),rE(t,n)}(0,l)),!0}function xI(e,t){var n,r;t&&t["!merges"]&&(NS(e,177,(n=t["!merges"].length,null==r&&(r=CS(4)),r.write_shift(4,n),r)),t["!merges"].forEach(function(t){NS(e,176,EI(t))}),NS(e,178))}function CI(e,t){t&&t["!cols"]&&(NS(e,390),t["!cols"].forEach(function(t,n){t&&NS(e,60,function(e,t,n){null==n&&(n=CS(18));var r=XC(e,t);n.write_shift(-4,e),n.write_shift(-4,e),n.write_shift(4,256*(r.width||10)),n.write_shift(4,0);var a=0;return t.hidden&&(a|=1),"number"==typeof r.width&&(a|=2),t.level&&(a|=t.level<<8),n.write_shift(2,a),n}(n,t))}),NS(e,391))}function II(e,t){t&&t["!ref"]&&(NS(e,648),NS(e,649,function(e){var t=CS(24);return t.write_shift(4,4),t.write_shift(4,1),vE(e,t),t}(HS(t["!ref"]))),NS(e,650))}function AI(e,t,n){t["!links"].forEach(function(t){if(t[1].Target){var r=jE(n,-1,t[1].Target.replace(/#.*$/,""),LE.HLINK);NS(e,494,function(e,t){var n=CS(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));vE({s:jS(e[0]),e:jS(e[0])},n),fE("rId"+t,n);var r=e[1].Target.indexOf("#");return QS((-1==r?"":e[1].Target.slice(r+1))||"",n),QS(e[1].Tooltip||"",n),QS("",n),n.slice(0,n.l)}(t,r))}}),delete t["!links"]}function NI(e,t,n){NS(e,133),NS(e,137,function(e,t,n){null==n&&(n=CS(30));var r=924;return(((t||{}).Views||[])[0]||{}).RTL&&(r|=32),n.write_shift(2,r),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(2,0),n.write_shift(2,100),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(4,0),n}(0,n)),NS(e,138),NS(e,134)}function RI(e,t){var n,r;t["!protect"]&&NS(e,535,(n=t["!protect"],null==r&&(r=CS(66)),r.write_shift(2,n.password?q_(n.password):0),r.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(e){e[1]?r.write_shift(4,null==n[e[0]]||n[e[0]]?0:1):r.write_shift(4,null!=n[e[0]]&&n[e[0]]?0:1)}),r))}function OI(e,t,n,r){var a=AS(),i=n.SheetNames[e],s=n.Sheets[i]||{},o=i;try{n&&n.Workbook&&(o=n.Workbook.Sheets[e].CodeName||o)}catch(AR){}var l,c,u=HS(s["!ref"]||"A1");if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575)}return s["!links"]=[],s["!comments"]=[],NS(a,129),(n.vbaraw||s["!outline"])&&NS(a,147,function(e,t,n){null==n&&(n=CS(84+4*e.length));var r=192;t&&(t.above&&(r&=-65),t.left&&(r&=-129)),n.write_shift(1,r);for(var a=1;a<3;++a)n.write_shift(1,0);return wE({auto:1},n),n.write_shift(-4,-1),n.write_shift(-4,-1),oE(e,n),n.slice(0,n.l)}(o,s["!outline"])),NS(a,148,wI(u)),NI(a,0,n.Workbook),CI(a,s),function(e,t,n,r){var a,i=HS(t["!ref"]||"A1"),s="",o=[];NS(e,145);var l=Array.isArray(t),c=i.e.r;t["!rows"]&&(c=Math.max(i.e.r,t["!rows"].length-1));for(var u=i.s.r;u<=c;++u){s=MS(u),yI(e,t,i,u);var h=!1;if(u<=i.e.r)for(var f=i.s.c;f<=i.e.c;++f){u===i.s.r&&(o[f]=US(f)),a=o[f]+s;var d=l?(t[u]||[])[f]:t[a];h=!!d&&_I(e,d,u,f,r,t,h)}}NS(e,146)}(a,s,0,t),RI(a,s),function(e,t,n,r){if(t["!autofilter"]){var a=t["!autofilter"],i="string"===typeof a.ref?a.ref:BS(a.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var s=n.Workbook.Names,o=zS(i);o.s.r==o.e.r&&(o.e.r=zS(t["!ref"]).e.r,i=BS(o));for(var l=0;l<s.length;++l){var c=s[l];if("_xlnm._FilterDatabase"==c.Name&&c.Sheet==r){c.Ref="'"+n.SheetNames[r]+"'!"+i;break}}l==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+n.SheetNames[r]+"'!"+i}),NS(e,161,vE(HS(i))),NS(e,162)}}(a,s,n,e),xI(a,s),AI(a,s,r),s["!margins"]&&NS(a,476,(l=s["!margins"],null==c&&(c=CS(48)),YC(l),kI.forEach(function(e){bE(l[e],c)}),c)),t&&!t.ignoreEC&&void 0!=t.ignoreEC||II(a,s),function(e,t,n,r){if(t["!comments"].length>0){var a=jE(r,-1,"../drawings/vmlDrawing"+(n+1)+".vml",LE.VML);NS(e,551,fE("rId"+a)),t["!legacy"]=a}}(a,s,e,r),NS(a,130),a.end()}function PI(e,t,n,r,a,i){var s=i||{"!type":"chart"};if(!e)return i;var o=0,l=0,c="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(e){var t=function(e){var t,n=[],r=e.match(/^<c:numCache>/);(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/gm)||[]).forEach(function(e){var t=e.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);t&&(n[+t[1]]=r?+t[2]:t[2])});var a=Yw((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/gm)||[]).forEach(function(e){t=e.replace(/<.*?>/g,"")}),[n,a,t]}(e);u.s.r=u.s.c=0,u.e.c=o,c=US(o),t[0].forEach(function(e,n){s[c+MS(n)]={t:"n",v:e,z:t[1]},l=n}),u.e.r<l&&(u.e.r=l),++o}),o>0&&(s["!ref"]=BS(u)),s}var DI=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],LI=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],MI=[],FI=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function UI(e,t){for(var n=0;n!=e.length;++n)for(var r=e[n],a=0;a!=t.length;++a){var i=t[a];if(null==r[i[0]])r[i[0]]=i[1];else switch(i[2]){case"bool":"string"==typeof r[i[0]]&&(r[i[0]]=aT(r[i[0]]));break;case"int":"string"==typeof r[i[0]]&&(r[i[0]]=parseInt(r[i[0]],10))}}}function jI(e,t){for(var n=0;n!=t.length;++n){var r=t[n];if(null==e[r[0]])e[r[0]]=r[1];else switch(r[2]){case"bool":"string"==typeof e[r[0]]&&(e[r[0]]=aT(e[r[0]]));break;case"int":"string"==typeof e[r[0]]&&(e[r[0]]=parseInt(e[r[0]],10))}}}function VI(e){jI(e.WBProps,DI),jI(e.CalcPr,FI),UI(e.WBView,LI),UI(e.Sheets,MI),KC.date1904=aT(e.WBProps.date1904)}var zI="][*?/\\".split("");function BI(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var n=!0;return zI.forEach(function(r){if(-1!=e.indexOf(r)){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");n=!1}}),n}function HI(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];!function(e,t,n){e.forEach(function(r,a){BI(r);for(var i=0;i<a;++i)if(r==e[i])throw new Error("Duplicate Sheet Name: "+r);if(n){var s=t&&t[a]&&t[a].CodeName||r;if(95==s.charCodeAt(0)&&s.length>22)throw new Error("Bad Code Name: Worksheet"+s)}})}(e.SheetNames,t,!!e.vbaraw);for(var n=0;n<e.SheetNames.length;++n)ZC(e.Sheets[e.SheetNames[n]],e.SheetNames[n],n)}var WI=/<\w+:workbook/;function GI(e){var t=[Vw];t[t.length]=wT("workbook",null,{xmlns:FT[0],"xmlns:r":PT});var n=e.Workbook&&(e.Workbook.Names||[]).length>0,r={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(DI.forEach(function(t){null!=e.Workbook.WBProps[t[0]]&&e.Workbook.WBProps[t[0]]!=t[1]&&(r[t[0]]=e.Workbook.WBProps[t[0]])}),e.Workbook.WBProps.CodeName&&(r.codeName=e.Workbook.WBProps.CodeName,delete r.CodeName)),t[t.length]=wT("workbookPr",null,r);var a=e.Workbook&&e.Workbook.Sheets||[],i=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&a[i]&&a[i].Hidden;++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var s={name:Zw(e.SheetNames[i].slice(0,31))};if(s.sheetId=""+(i+1),s["r:id"]="rId"+(i+1),a[i])switch(a[i].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden"}t[t.length]=wT("sheet",null,s)}return t[t.length]="</sheets>",n&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(e){var n={name:e.Name};e.Comment&&(n.comment=e.Comment),null!=e.Sheet&&(n.localSheetId=""+e.Sheet),e.Hidden&&(n.hidden="1"),e.Ref&&(t[t.length]=wT("definedName",Zw(e.Ref),n))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function KI(e,t){return t||(t=CS(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),fE(e.strRelID,t),QS(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function qI(e,t){var n={};return e.read_shift(4),n.ArchID=e.read_shift(4),e.l+=t-8,n}function $I(e,t){if(t.Workbook&&t.Workbook.Sheets){for(var n,r,a=t.Workbook.Sheets,i=0,s=-1,o=-1;i<a.length;++i)!a[i]||!a[i].Hidden&&-1==s?s=i:1==a[i].Hidden&&-1==o&&(o=i);if(!(o>s))NS(e,135),NS(e,158,(n=s,r||(r=CS(29)),r.write_shift(-4,0),r.write_shift(-4,460),r.write_shift(4,28800),r.write_shift(4,17600),r.write_shift(4,500),r.write_shift(4,n),r.write_shift(4,n),r.write_shift(1,120),r.length>r.l?r.slice(0,r.l):r)),NS(e,136)}}function XI(e,t){var n=AS();return NS(n,131),NS(n,128,function(e,t){t||(t=CS(127));for(var n=0;4!=n;++n)t.write_shift(4,0);return QS("SheetJS",t),QS(Dy.version,t),QS(Dy.version,t),QS("7262",t),t.length>t.l?t.slice(0,t.l):t}()),NS(n,153,function(e,t){t||(t=CS(72));var n=0;return e&&e.filterPrivacy&&(n|=8),t.write_shift(4,n),t.write_shift(4,0),oE(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}(e.Workbook&&e.Workbook.WBProps||null)),$I(n,e),function(e,t){NS(e,143);for(var n=0;n!=t.SheetNames.length;++n)NS(e,156,KI({Hidden:t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[n]&&t.Workbook.Sheets[n].Hidden||0,iTabID:n+1,strRelID:"rId"+(n+1),name:t.SheetNames[n]}));NS(e,144)}(n,e),NS(n,132),n.end()}function YI(e,t,n){return".bin"===t.slice(-4)?function(e,t){var n={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},r=[],a=!1;t||(t={}),t.biff=12;var i=[],s=[[]];return s.SheetNames=[],s.XTI=[],MA[16]={n:"BrtFRTArchID$",f:qI},IS(e,function(e,o,l){switch(l){case 156:s.SheetNames.push(e.name),n.Sheets.push(e);break;case 153:n.WBProps=e;break;case 39:null!=e.Sheet&&(t.SID=e.Sheet),e.Ref=IC(e.Ptg,0,null,s,t),delete t.SID,delete e.Ptg,i.push(e);break;case 1036:case 361:case 2071:case 158:case 143:case 664:case 353:case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:case 16:break;case 357:case 358:case 355:case 667:s[0].length?s.push([l,e]):s[0]=[l,e],s[s.length-1].XTI=[];break;case 362:0===s.length&&(s[0]=[],s[0].XTI=[]),s[s.length-1].XTI=s[s.length-1].XTI.concat(e),s.XTI=s.XTI.concat(e);break;case 35:case 37:r.push(l),a=!0;break;case 36:case 38:r.pop(),a=!1;break;default:if(o.T);else if(!a||t.WTF&&37!=r[r.length-1]&&35!=r[r.length-1])throw new Error("Unexpected record 0x"+l.toString(16))}},t),VI(n),n.Names=i,n.supbooks=s,n}(e,n):function(e,t){if(!e)throw new Error("Could not find file");var n={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},r=!1,a="xmlns",i={},s=0;if(e.replace(Hw,function(o,l){var c=Kw(o);switch(qw(c[0])){case"<?xml":case"</workbook>":case"<fileVersion/>":case"</fileVersion>":case"<fileSharing":case"<fileSharing/>":case"</workbookPr>":case"<workbookProtection":case"<workbookProtection/>":case"<bookViews":case"<bookViews>":case"</bookViews>":case"</workbookView>":case"<sheets":case"<sheets>":case"</sheets>":case"</sheet>":case"<functionGroups":case"<functionGroups/>":case"<functionGroup":case"<externalReferences":case"</externalReferences>":case"<externalReferences>":case"<externalReference":case"<definedNames/>":case"<definedName/>":case"</calcPr>":case"<oleSize":case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":case"<customWorkbookView":case"</customWorkbookView>":case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":case"<pivotCache":case"<smartTagPr":case"<smartTagPr/>":case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":case"<smartTagType":case"<webPublishing":case"<webPublishing/>":case"<fileRecoveryPr":case"<fileRecoveryPr/>":case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":case"<webPublishObject":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":case"<ArchID":case"<revisionPtr":break;case"<workbook":o.match(WI)&&(a="xmlns"+o.match(/<(\w+):/)[1]),n.xmlns=c[a];break;case"<fileVersion":delete c[0],n.AppVersion=c;break;case"<workbookPr":case"<workbookPr/>":DI.forEach(function(e){if(null!=c[e[0]])switch(e[2]){case"bool":n.WBProps[e[0]]=aT(c[e[0]]);break;case"int":n.WBProps[e[0]]=parseInt(c[e[0]],10);break;default:n.WBProps[e[0]]=c[e[0]]}}),c.codeName&&(n.WBProps.CodeName=cT(c.codeName));break;case"<workbookView":case"<workbookView/>":delete c[0],n.WBView.push(c);break;case"<sheet":switch(c.state){case"hidden":c.Hidden=1;break;case"veryHidden":c.Hidden=2;break;default:c.Hidden=0}delete c.state,c.name=Yw(cT(c.name)),delete c[0],n.Sheets.push(c);break;case"<definedNames>":case"<definedNames":case"<ext":case"<AlternateContent":case"<AlternateContent>":r=!0;break;case"</definedNames>":case"</ext>":case"</AlternateContent>":r=!1;break;case"<definedName":(i={}).Name=cT(c.name),c.comment&&(i.Comment=c.comment),c.localSheetId&&(i.Sheet=+c.localSheetId),aT(c.hidden||"0")&&(i.Hidden=!0),s=l+o.length;break;case"</definedName>":i.Ref=Yw(cT(e.slice(s,l))),n.Names.push(i);break;case"<calcPr":case"<calcPr/>":delete c[0],n.CalcPr=c;break;default:if(!r&&t.WTF)throw new Error("unrecognized "+c[0]+" in workbook")}return o}),-1===FT.indexOf(n.xmlns))throw new Error("Unknown Namespace: "+n.xmlns);return VI(n),n}(e,n)}function QI(e,t,n,r,a,i,s,o){return".bin"===t.slice(-4)?function(e,t,n,r,a,i,s){if(!e)return e;var o=t||{};r||(r={"!id":{}});var l,c,u,h,f,d,p,m,g,v,y=o.dense?[]:{},b={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=[],T=!1,S=!1,E=[];o.biff=12,o["!row"]=0;var k=0,_=!1,x=[],C={},I=o.supbooks||a.supbooks||[[]];if(I.sharedf=C,I.arrayf=x,I.SheetNames=a.SheetNames||a.Sheets.map(function(e){return e.name}),!o.supbooks&&(o.supbooks=I,a.Names))for(var A=0;A<a.Names.length;++A)I[0][A+1]=a.Names[A];var N,R,O=[],P=[],D=!1;if(MA[16]={n:"BrtShortReal",f:TI},IS(e,function(e,t,A){if(!S)switch(A){case 148:l=e;break;case 0:c=e,o.sheetRows&&o.sheetRows<=c.r&&(S=!0),g=MS(f=c.r),o["!row"]=c.r,(e.hidden||e.hpt||null!=e.level)&&(e.hpt&&(e.hpx=cx(e.hpt)),P[e.r]=e);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(u={t:e[2]},e[2]){case"n":u.v=e[1];break;case"s":m=GC[e[1]],u.v=m.t,u.r=m.r;break;case"b":u.v=!!e[1];break;case"e":u.v=e[1],!1!==o.cellText&&(u.w=NE[u.v]);break;case"str":u.t="s",u.v=e[1];break;case"is":u.t="s",u.v=e[1].t}if((h=s.CellXf[e[0].iStyleRef])&&JC(u,h.numFmtId,null,o,i,s),d=-1==e[0].c?d+1:e[0].c,o.dense?(y[f]||(y[f]=[]),y[f][d]=u):y[US(d)+g]=u,o.cellFormula){for(_=!1,k=0;k<x.length;++k){var L=x[k];c.r>=L[0].s.r&&c.r<=L[0].e.r&&d>=L[0].s.c&&d<=L[0].e.c&&(u.F=BS(L[0]),_=!0)}!_&&e.length>3&&(u.f=e[3])}if(b.s.r>c.r&&(b.s.r=c.r),b.s.c>d&&(b.s.c=d),b.e.r<c.r&&(b.e.r=c.r),b.e.c<d&&(b.e.c=d),o.cellDates&&h&&"n"==u.t&&Gb(vb[h.numFmtId])){var M=Tb(u.v);M&&(u.t="d",u.v=new Date(M.y,M.m-1,M.d,M.H,M.M,M.S,M.u))}N&&("XLDAPR"==N.type&&(u.D=!0),N=void 0),R&&(R=void 0);break;case 1:case 12:if(!o.sheetStubs||T)break;u={t:"z",v:void 0},d=-1==e[0].c?d+1:e[0].c,o.dense?(y[f]||(y[f]=[]),y[f][d]=u):y[US(d)+g]=u,b.s.r>c.r&&(b.s.r=c.r),b.s.c>d&&(b.s.c=d),b.e.r<c.r&&(b.e.r=c.r),b.e.c<d&&(b.e.c=d),N&&("XLDAPR"==N.type&&(u.D=!0),N=void 0),R&&(R=void 0);break;case 176:E.push(e);break;case 49:N=((o.xlmeta||{}).Cell||[])[e-1];break;case 494:var F=r["!id"][e.relId];for(F?(e.Target=F.Target,e.loc&&(e.Target+="#"+e.loc),e.Rel=F):""==e.relId&&(e.Target="#"+e.loc),f=e.rfx.s.r;f<=e.rfx.e.r;++f)for(d=e.rfx.s.c;d<=e.rfx.e.c;++d)o.dense?(y[f]||(y[f]=[]),y[f][d]||(y[f][d]={t:"z",v:void 0}),y[f][d].l=e):(p=VS({c:d,r:f}),y[p]||(y[p]={t:"z",v:void 0}),y[p].l=e);break;case 426:if(!o.cellFormula)break;x.push(e),(v=o.dense?y[f][d]:y[US(d)+g]).f=IC(e[1],0,{r:c.r,c:d},I,o),v.F=BS(e[0]);break;case 427:if(!o.cellFormula)break;C[VS(e[0].s)]=e[1],(v=o.dense?y[f][d]:y[US(d)+g]).f=IC(e[1],0,{r:c.r,c:d},I,o);break;case 60:if(!o.cellStyles)break;for(;e.e>=e.s;)O[e.e--]={width:e.w/256,hidden:!!(1&e.flags),level:e.level},D||(D=!0,ix(e.w/256)),sx(O[e.e+1]);break;case 161:y["!autofilter"]={ref:BS(e)};break;case 476:y["!margins"]=e;break;case 147:a.Sheets[n]||(a.Sheets[n]={}),e.name&&(a.Sheets[n].CodeName=e.name),(e.above||e.left)&&(y["!outline"]={above:e.above,left:e.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),e.RTL&&(a.Views[0].RTL=!0);break;case 485:case 64:case 1053:case 151:case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:T=!0;break;case 36:T=!1;break;case 37:w.push(A),T=!0;break;case 38:w.pop(),T=!1;break;default:if(t.T);else if(!T||o.WTF)throw new Error("Unexpected record 0x"+A.toString(16))}},o),delete o.supbooks,delete o["!row"],!y["!ref"]&&(b.s.r<2e6||l&&(l.e.r>0||l.e.c>0||l.s.r>0||l.s.c>0))&&(y["!ref"]=BS(l||b)),o.sheetRows&&y["!ref"]){var L=HS(y["!ref"]);o.sheetRows<=+L.e.r&&(L.e.r=o.sheetRows-1,L.e.r>b.e.r&&(L.e.r=b.e.r),L.e.r<L.s.r&&(L.s.r=L.e.r),L.e.c>b.e.c&&(L.e.c=b.e.c),L.e.c<L.s.c&&(L.s.c=L.e.c),y["!fullref"]=y["!ref"],y["!ref"]=BS(L))}return E.length>0&&(y["!merges"]=E),O.length>0&&(y["!cols"]=O),P.length>0&&(y["!rows"]=P),y}(e,r,n,a,i,s,o):uI(e,r,n,a,i,s,o)}function JI(e,t,n,r,a,i,s,o){return".bin"===t.slice(-4)?function(e,t,n,r,a){if(!e)return e;r||(r={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s=[],o=!1;return IS(e,function(e,r,l){switch(l){case 550:i["!rel"]=e;break;case 651:a.Sheets[n]||(a.Sheets[n]={}),e.name&&(a.Sheets[n].CodeName=e.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:s.push(l);break;case 38:s.pop();break;default:if(r.T>0)s.push(l);else if(r.T<0)s.pop();else if(!o||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}},t),r["!id"][i["!rel"]]&&(i["!drawel"]=r["!id"][i["!rel"]]),i}(e,r,n,a,i):function(e,t,n,r,a){if(!e)return e;r||(r={"!id":{}});var i,s={"!type":"chart","!drawel":null,"!rel":""},o=e.match(oI);return o&&hI(o[0],0,a,n),(i=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=i[1]),r["!id"][s["!rel"]]&&(s["!drawel"]=r["!id"][s["!rel"]]),s}(e,0,n,a,i)}function ZI(e,t,n,r){return".bin"===t.slice(-4)?function(e,t,n){var r={NumberFmt:[]};for(var a in vb)r.NumberFmt[a]=vb[a];r.CellXf=[],r.Fonts=[];var i=[],s=!1;return IS(e,function(e,a,o){switch(o){case 44:r.NumberFmt[e[0]]=e[1],Yb(e[1],e[0]);break;case 43:r.Fonts.push(e),null!=e.color.theme&&t&&t.themeElements&&t.themeElements.clrScheme&&(e.color.rgb=Z_(t.themeElements.clrScheme[e.color.theme].rgb,e.color.tint||0));break;case 1025:case 45:case 46:case 48:case 507:case 572:case 475:case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 47:617==i[i.length-1]&&r.CellXf.push(e);break;case 35:s=!0;break;case 36:s=!1;break;case 37:i.push(o),s=!0;break;case 38:i.pop(),s=!1;break;default:if(a.T>0)i.push(o);else if(a.T<0)i.pop();else if(!s||n.WTF&&37!=i[i.length-1])throw new Error("Unexpected record 0x"+o.toString(16))}}),r}(e,n,r):dx(e,n,r)}function eA(e,t,n){return".bin"===t.slice(-4)?function(e,t){var n=[],r=!1;return IS(e,function(e,a,i){switch(i){case 159:n.Count=e[0],n.Unique=e[1];break;case 19:n.push(e);break;case 160:return!0;case 35:r=!0;break;case 36:r=!1;break;default:if(a.T,!r||t.WTF)throw new Error("Unexpected record 0x"+i.toString(16))}}),n}(e,n):function(e,t){var n=[],r="";if(!e)return n;var a=e.match(R_);if(a){r=a[2].replace(O_,"").split(P_);for(var i=0;i!=r.length;++i){var s=N_(r[i].trim(),t);null!=s&&(n[n.length]=s)}a=Kw(a[1]),n.Count=a.count,n.Unique=a.uniqueCount}return n}(e,n)}function tA(e,t,n){return".bin"===t.slice(-4)?function(e,t){var n=[],r=[],a={},i=!1;return IS(e,function(e,s,o){switch(o){case 632:r.push(e);break;case 635:a=e;break;case 637:a.t=e.t,a.h=e.h,a.r=e.r;break;case 636:if(a.author=r[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,n.push(a);break;case 3072:case 37:case 38:break;case 35:i=!0;break;case 36:i=!1;break;default:if(s.T);else if(!i||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}(e,n):function(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var n=[],r=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(e){if(""!==e&&""!==e.trim()){var t=e.match(/<(?:\w+:)?author[^>]*>(.*)/);t&&n.push(t[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(e){if(""!==e&&""!==e.trim()){var a=e.match(/<(?:\w+:)?comment[^>]*>/);if(a){var i=Kw(a[0]),s={author:i.authorId&&n[i.authorId]||"sheetjsghost",ref:i.ref,guid:i.guid},o=jS(i.ref);if(!(t.sheetRows&&t.sheetRows<=o.r)){var l=e.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),c=!!l&&!!l[1]&&N_(l[1])||{r:"",t:"",h:""};s.r=c.r,"<t></t>"==c.r&&(c.t=c.h=""),s.t=(c.t||"").replace(/\r\n/g,"\n").replace(/\r/g,"\n"),t.cellHTML&&(s.h=c.h),r.push(s)}}}}),r}(e,n)}function nA(e,t,n){return".bin"===t.slice(-4)?function(e){var t=[];return IS(e,function(e,n,r){if(63===r)t.push(e);else if(!n.T)throw new Error("Unexpected record 0x"+r.toString(16))}),t}(e):function(e){var t=[];if(!e)return t;var n=1;return(e.match(Hw)||[]).forEach(function(e){var r=Kw(e);switch(r[0]){case"<?xml":case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete r[0],r.i?n=r.i:r.i=n,t.push(r)}}),t}(e)}function rA(e,t,n,r){if(".bin"===n.slice(-4))return function(e,t,n,r){if(!e)return e;var a=r||{},i=!1;IS(e,function(e,t,n){switch(n){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(t.T);else if(!i||a.WTF)throw new Error("Unexpected record 0x"+n.toString(16))}},a)}(e,0,0,r)}function aA(e,t,n){return".bin"===t.slice(-4)?function(e,t,n){var r={Types:[],Cell:[],Value:[]},a=n||{},i=[],s=!1,o=2;return IS(e,function(e,t,n){switch(n){case 335:r.Types.push({name:e.name});break;case 51:e.forEach(function(e){1==o?r.Cell.push({type:r.Types[e[0]-1].name,index:e[1]}):0==o&&r.Value.push({type:r.Types[e[0]-1].name,index:e[1]})});break;case 337:o=e?1:0;break;case 338:o=2;break;case 35:i.push(n),s=!0;break;case 36:i.pop(),s=!1;break;default:if(t.T);else if(!s||a.WTF&&35!=i[i.length-1])throw new Error("Unexpected record 0x"+n.toString(16))}}),r}(e,0,n):function(e,t,n){var r={Types:[],Cell:[],Value:[]};if(!e)return r;var a,i=!1,s=2;return e.replace(Hw,function(e){var t=Kw(e);switch(qw(t[0])){case"<?xml":case"<metadata":case"</metadata>":case"<metadataTypes":case"</metadataTypes>":case"</metadataType>":case"</futureMetadata>":case"<bk>":case"</bk>":case"</rc>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<metadataType":r.Types.push({name:t.name});break;case"<futureMetadata":for(var o=0;o<r.Types.length;++o)r.Types[o].name==t.name&&(a=r.Types[o]);break;case"<rc":1==s?r.Cell.push({type:r.Types[t.t-1].name,index:+t.v}):0==s&&r.Value.push({type:r.Types[t.t-1].name,index:+t.v});break;case"<cellMetadata":s=1;break;case"</cellMetadata>":case"</valueMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+t.i);break;default:if(!i&&n.WTF)throw new Error("unrecognized "+t[0]+" in metadata")}return e}),r}(e,0,n)}function iA(e,t,n,r,a){return(".bin"===t.slice(-4)?OI:vI)(e,n,r,a)}function sA(e,t,n){return(".bin"===t.slice(-4)?Xx:Kx)(e,n)}var oA,lA=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,cA=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function uA(e,t){var n=e.split(/\s+/),r=[];if(t||(r[0]=n[0]),1===n.length)return r;var a,i,s,o=e.match(lA);if(o)for(s=0;s!=o.length;++s)-1===(i=(a=o[s].match(cA))[1].indexOf(":"))?r[a[1]]=a[2].slice(1,a[2].length-1):r["xmlns:"===a[1].slice(0,6)?"xmlns"+a[1].slice(6):a[1].slice(i+1)]=a[2].slice(1,a[2].length-1);return r}function hA(e){var t={};if(1===e.split(/\s+/).length)return t;var n,r,a,i=e.match(lA);if(i)for(a=0;a!=i.length;++a)-1===(r=(n=i[a].match(cA))[1].indexOf(":"))?t[n[1]]=n[2].slice(1,n[2].length-1):t["xmlns:"===n[1].slice(0,6)?"xmlns"+n[1].slice(6):n[1].slice(r+1)]=n[2].slice(1,n[2].length-1);return t}function fA(e,t,n,r){var a=r;switch((n[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=aT(r);break;case"i2":case"int":a=parseInt(r,10);break;case"r4":case"float":a=parseFloat(r);break;case"date":case"dateTime.tz":a=ww(r);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+n[0])}e[Yw(t)]=a}function dA(e,t,n){if("z"!==e.t){if(!n||!1!==n.cellText)try{"e"===e.t?e.w=e.w||NE[e.v]:"General"===t?"n"===e.t?(0|e.v)===e.v?e.w=e.v.toString(10):e.w=Cb(e.v):e.w=Ib(e.v):e.w=function(e,t){var n=oA[e]||Yw(e);return"General"===n?Ib(t):Xb(n,t)}(t||"General",e.v)}catch(AR){if(n.WTF)throw AR}try{var r=oA[t]||t||"General";if(n.cellNF&&(e.z=r),n.cellDates&&"n"==e.t&&Gb(r)){var a=Tb(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(AR){if(n.WTF)throw AR}}}function pA(e,t,n){if(n.cellStyles&&t.Interior){var r=t.Interior;r.Pattern&&(r.patternType=ux[r.Pattern]||r.Pattern)}e[t.ID]=t}function mA(e,t,n,r,a,i,s,o,l,c){var u="General",h=r.StyleID,f={};c=c||{};var d=[],p=0;for(void 0===h&&o&&(h=o.StyleID),void 0===h&&s&&(h=s.StyleID);void 0!==i[h]&&(i[h].nf&&(u=i[h].nf),i[h].Interior&&d.push(i[h].Interior),i[h].Parent);)h=i[h].Parent;switch(n.Type){case"Boolean":r.t="b",r.v=aT(e);break;case"String":r.t="s",r.r=rT(Yw(e)),r.v=e.indexOf("<")>-1?Yw(t||e).replace(/<.*?>/g,""):r.r;break;case"DateTime":"Z"!=e.slice(-1)&&(e+="Z"),r.v=(ww(e)-new Date(Date.UTC(1899,11,30)))/864e5,r.v!==r.v?r.v=Yw(e):r.v<60&&(r.v=r.v-1),u&&"General"!=u||(u="yyyy-mm-dd");case"Number":void 0===r.v&&(r.v=+e),r.t||(r.t="n");break;case"Error":r.t="e",r.v=RE[e],!1!==c.cellText&&(r.w=e);break;default:""==e&&""==t?r.t="z":(r.t="s",r.v=rT(t||e))}if(dA(r,u,c),!1!==c.cellFormula)if(r.Formula){var m=Yw(r.Formula);61==m.charCodeAt(0)&&(m=m.slice(1)),r.f=Qx(m,a),delete r.Formula,"RC"==r.ArrayRange?r.F=Qx("RC:RC",a):r.ArrayRange&&(r.F=Qx(r.ArrayRange,a),l.push([HS(r.F),r.F]))}else for(p=0;p<l.length;++p)a.r>=l[p][0].s.r&&a.r<=l[p][0].e.r&&a.c>=l[p][0].s.c&&a.c<=l[p][0].e.c&&(r.F=l[p][1]);c.cellStyles&&(d.forEach(function(e){!f.patternType&&e.patternType&&(f.patternType=e.patternType)}),r.s=f),void 0!==r.StyleID&&(r.ixfe=r.StyleID)}function gA(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),e.v=e.w=e.ixfe=void 0}function vA(e,t){var n=t||{};Jb();var r=Gy(ST(e));"binary"!=n.type&&"array"!=n.type&&"base64"!=n.type||(r="undefined"!==typeof Wy?Wy.utils.decode(65001,By(r)):cT(r));var a,i=r.slice(0,1024).toLowerCase(),s=!1;if((1023&(i=i.replace(/".*?"/g,"")).indexOf(">"))>Math.min(1023&i.indexOf(","),1023&i.indexOf(";"))){var o=Sw(n);return o.type="string",E_.to_workbook(r,o)}if(-1==i.indexOf("<?xml")&&["html","table","head","meta","script","style","div"].forEach(function(e){i.indexOf("<"+e)>=0&&(s=!0)}),s)return function(e,t){var n=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!n||0==n.length)throw new Error("Invalid HTML: could not find <table>");if(1==n.length)return KS($A(n[0],t),t);var r={SheetNames:[],Sheets:{}};return n.forEach(function(e,n){dR(r,$A(e,t),"Sheet"+(n+1))}),r}(r,n);oA={"General Number":"General","General Date":vb[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":vb[15],"Short Date":vb[14],"Long Time":vb[19],"Medium Time":vb[18],"Short Time":vb[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:vb[2],Standard:vb[4],Percent:vb[10],Scientific:vb[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c=[];var u,h={},f=[],d=n.dense?[]:{},p="",m={},g={},v=uA('<Data ss:Type="String">'),y=0,b=0,w=0,T={s:{r:2e6,c:2e6},e:{r:0,c:0}},S={},E={},k="",_=0,x=[],C={},I={},A=0,N=[],R=[],O={},P=[],D=!1,L=[],M=[],F={},U=0,j=0,V={Sheets:[],WBProps:{date1904:!1}},z={};ET.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/gm,"");for(var B="";a=ET.exec(r);)switch(a[3]=(B=a[3]).toLowerCase()){case"data":if("data"==B){if("/"===a[1]){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"))}else"/"!==a[0].charAt(a[0].length-2)&&c.push([a[3],!0]);break}if(c[c.length-1][1])break;"/"===a[1]?mA(r.slice(y,a.index),k,v,"comment"==c[c.length-1][0]?O:m,{c:b,r:w},S,P[b],g,L,n):(k="",v=uA(a[0]),y=a.index+a[0].length);break;case"cell":if("/"===a[1])if(R.length>0&&(m.c=R),(!n.sheetRows||n.sheetRows>w)&&void 0!==m.v&&(n.dense?(d[w]||(d[w]=[]),d[w][b]=m):d[US(b)+MS(w)]=m),m.HRef&&(m.l={Target:Yw(m.HRef)},m.HRefScreenTip&&(m.l.Tooltip=m.HRefScreenTip),delete m.HRef,delete m.HRefScreenTip),(m.MergeAcross||m.MergeDown)&&(U=b+(0|parseInt(m.MergeAcross,10)),j=w+(0|parseInt(m.MergeDown,10)),x.push({s:{c:b,r:w},e:{c:U,r:j}})),n.sheetStubs)if(m.MergeAcross||m.MergeDown){for(var H=b;H<=U;++H)for(var W=w;W<=j;++W)(H>b||W>w)&&(n.dense?(d[W]||(d[W]=[]),d[W][H]={t:"z"}):d[US(H)+MS(W)]={t:"z"});b=U+1}else++b;else m.MergeAcross?b=U+1:++b;else(m=hA(a[0])).Index&&(b=+m.Index-1),b<T.s.c&&(T.s.c=b),b>T.e.c&&(T.e.c=b),"/>"===a[0].slice(-2)&&++b,R=[];break;case"row":"/"===a[1]||"/>"===a[0].slice(-2)?(w<T.s.r&&(T.s.r=w),w>T.e.r&&(T.e.r=w),"/>"===a[0].slice(-2)&&(g=uA(a[0])).Index&&(w=+g.Index-1),b=0,++w):((g=uA(a[0])).Index&&(w=+g.Index-1),F={},("0"==g.AutoFitHeight||g.Height)&&(F.hpx=parseInt(g.Height,10),F.hpt=lx(F.hpx),M[w]=F),"1"==g.Hidden&&(F.hidden=!0,M[w]=F));break;case"worksheet":if("/"===a[1]){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"));f.push(p),T.s.r<=T.e.r&&T.s.c<=T.e.c&&(d["!ref"]=BS(T),n.sheetRows&&n.sheetRows<=T.e.r&&(d["!fullref"]=d["!ref"],T.e.r=n.sheetRows-1,d["!ref"]=BS(T))),x.length&&(d["!merges"]=x),P.length>0&&(d["!cols"]=P),M.length>0&&(d["!rows"]=M),h[p]=d}else T={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=b=0,c.push([a[3],!1]),l=uA(a[0]),p=Yw(l.Name),d=n.dense?[]:{},x=[],L=[],M=[],z={name:p,Hidden:0},V.Sheets.push(z);break;case"table":if("/"===a[1]){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"))}else{if("/>"==a[0].slice(-2))break;c.push([a[3],!1]),P=[],D=!1}break;case"style":"/"===a[1]?pA(S,E,n):E=uA(a[0]);break;case"numberformat":E.nf=Yw(uA(a[0]).Format||"General"),oA[E.nf]&&(E.nf=oA[E.nf]);for(var G=0;392!=G&&vb[G]!=E.nf;++G);if(392==G)for(G=57;392!=G;++G)if(null==vb[G]){Yb(E.nf,G);break}break;case"column":if("table"!==c[c.length-1][0])break;if((u=uA(a[0])).Hidden&&(u.hidden=!0,delete u.Hidden),u.Width&&(u.wpx=parseInt(u.Width,10)),!D&&u.wpx>10){D=!0,ex=6;for(var K=0;K<P.length;++K)P[K]&&sx(P[K])}D&&sx(u),P[u.Index-1||P.length]=u;for(var q=0;q<+u.Span;++q)P[P.length]=Sw(u);break;case"namedrange":if("/"===a[1])break;V.Names||(V.Names=[]);var $=Kw(a[0]),X={Name:$.Name,Ref:Qx($.RefersTo.slice(1),{r:0,c:0})};V.Sheets.length>0&&(X.Sheet=V.Sheets.length-1),V.Names.push(X);break;case"namedcell":case"b":case"i":case"u":case"s":case"em":case"h2":case"h3":case"sub":case"sup":case"span":case"alignment":case"borders":case"border":case"protection":case"paragraphs":case"name":case"pixelsperinch":case"null":break;case"font":if("/>"===a[0].slice(-2))break;"/"===a[1]?k+=r.slice(_,a.index):_=a.index+a[0].length;break;case"interior":if(!n.cellStyles)break;E.Interior=uA(a[0]);break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if("/>"===a[0].slice(-2))break;"/"===a[1]?nk(C,B,r.slice(A,a.index)):A=a.index+a[0].length;break;case"styles":case"workbook":if("/"===a[1]){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"))}else c.push([a[3],!1]);break;case"comment":if("/"===a[1]){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"));gA(O),R.push(O)}else c.push([a[3],!1]),O={a:(l=uA(a[0])).Author};break;case"autofilter":if("/"===a[1]){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"))}else if("/"!==a[0].charAt(a[0].length-2)){var Y=uA(a[0]);d["!autofilter"]={ref:Qx(Y.Range).replace(/\$/g,"")},c.push([a[3],!0])}break;case"datavalidation":if("/"===a[1]){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"))}else"/"!==a[0].charAt(a[0].length-2)&&c.push([a[3],!0]);break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if("/"===a[1]){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"))}else"/"!==a[0].charAt(a[0].length-2)&&c.push([a[3],!0]);break;default:if(0==c.length&&"document"==a[3])return oN(r,n);if(0==c.length&&"uof"==a[3])return oN(r,n);var Q=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(a[3]){case"allowpng":case"removepersonalinformation":case"downloadcomponents":case"locationofcomponents":case"colors":case"color":case"index":case"rgb":case"targetscreensize":case"readonlyrecommended":break;default:Q=!1}break;case"componentoptions":switch(a[3]){case"toolbar":case"hideofficelogo":case"spreadsheetautofit":case"label":case"caption":case"maxheight":case"maxwidth":case"nextsheetnumber":break;default:Q=!1}break;case"excelworkbook":switch(a[3]){case"date1904":V.WBProps.date1904=!0;break;case"windowheight":case"windowwidth":case"windowtopx":case"windowtopy":case"tabratio":case"protectstructure":case"protectwindow":case"protectwindows":case"activesheet":case"displayinknotes":case"firstvisiblesheet":case"supbook":case"sheetname":case"sheetindex":case"sheetindexfirst":case"sheetindexlast":case"dll":case"acceptlabelsinformulas":case"donotsavelinkvalues":case"iteration":case"maxiterations":case"maxchange":case"path":case"xct":case"count":case"selectedsheets":case"calculation":case"uncalced":case"startupprompt":case"crn":case"externname":case"formula":case"colfirst":case"collast":case"wantadvise":case"boolean":case"error":case"text":case"ole":case"noautorecover":case"publishobjects":case"donotcalculatebeforesave":case"number":case"refmoder1c1":case"embedsavesmarttags":break;default:Q=!1}break;case"workbookoptions":switch(a[3]){case"owcversion":case"height":case"width":break;default:Q=!1}break;case"worksheetoptions":switch(a[3]){case"visible":if("/>"===a[0].slice(-2));else if("/"===a[1])switch(r.slice(A,a.index)){case"SheetHidden":z.Hidden=1;break;case"SheetVeryHidden":z.Hidden=2}else A=a.index+a[0].length;break;case"header":d["!margins"]||YC(d["!margins"]={},"xlml"),isNaN(+Kw(a[0]).Margin)||(d["!margins"].header=+Kw(a[0]).Margin);break;case"footer":d["!margins"]||YC(d["!margins"]={},"xlml"),isNaN(+Kw(a[0]).Margin)||(d["!margins"].footer=+Kw(a[0]).Margin);break;case"pagemargins":var J=Kw(a[0]);d["!margins"]||YC(d["!margins"]={},"xlml"),isNaN(+J.Top)||(d["!margins"].top=+J.Top),isNaN(+J.Left)||(d["!margins"].left=+J.Left),isNaN(+J.Right)||(d["!margins"].right=+J.Right),isNaN(+J.Bottom)||(d["!margins"].bottom=+J.Bottom);break;case"displayrighttoleft":V.Views||(V.Views=[]),V.Views[0]||(V.Views[0]={}),V.Views[0].RTL=!0;break;case"freezepanes":case"frozennosplit":case"splithorizontal":case"splitvertical":case"donotdisplaygridlines":case"activerow":case"activecol":case"toprowbottompane":case"leftcolumnrightpane":case"unsynced":case"print":case"printerrors":case"panes":case"scale":case"pane":case"number":case"layout":case"pagesetup":case"selected":case"protectobjects":case"enableselection":case"protectscenarios":case"validprinterinfo":case"horizontalresolution":case"verticalresolution":case"numberofcopies":case"activepane":case"toprowvisible":case"leftcolumnvisible":case"fittopage":case"rangeselection":case"papersizeindex":case"pagelayoutzoom":case"pagebreakzoom":case"filteron":case"fitwidth":case"fitheight":case"commentslayout":case"zoom":case"lefttoright":case"gridlines":case"allowsort":case"allowfilter":case"allowinsertrows":case"allowdeleterows":case"allowinsertcols":case"allowdeletecols":case"allowinserthyperlinks":case"allowformatcells":case"allowsizecols":case"allowsizerows":case"tabcolorindex":case"donotdisplayheadings":case"showpagelayoutzoom":case"blackandwhite":case"donotdisplayzeros":case"displaypagebreak":case"rowcolheadings":case"donotdisplayoutline":case"noorientation":case"allowusepivottables":case"zeroheight":case"viewablerange":case"selection":case"protectcontents":break;case"nosummaryrowsbelowdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].above=!0;break;case"nosummarycolumnsrightdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].left=!0;break;default:Q=!1}break;case"pivottable":case"pivotcache":switch(a[3]){case"immediateitemsondrop":case"showpagemultipleitemlabel":case"compactrowindent":case"location":case"pivotfield":case"orientation":case"layoutform":case"layoutsubtotallocation":case"layoutcompactrow":case"position":case"pivotitem":case"datatype":case"datafield":case"sourcename":case"parentfield":case"ptlineitems":case"ptlineitem":case"countofsameitems":case"item":case"itemtype":case"ptsource":case"cacheindex":case"consolidationreference":case"filename":case"reference":case"nocolumngrand":case"norowgrand":case"blanklineafteritems":case"hidden":case"subtotal":case"basefield":case"mapchilditems":case"function":case"refreshonfileopen":case"printsettitles":case"mergelabels":case"defaultversion":case"refreshname":case"refreshdate":case"refreshdatecopy":case"versionlastrefresh":case"versionlastupdate":case"versionupdateablemin":case"versionrefreshablemin":case"calculation":break;default:Q=!1}break;case"pagebreaks":switch(a[3]){case"colbreaks":case"colbreak":case"rowbreaks":case"rowbreak":case"colstart":case"colend":case"rowend":break;default:Q=!1}break;case"autofilter":switch(a[3]){case"autofiltercolumn":case"autofiltercondition":case"autofilterand":case"autofilteror":break;default:Q=!1}break;case"querytable":switch(a[3]){case"id":case"autoformatfont":case"autoformatpattern":case"querysource":case"querytype":case"enableredirections":case"refreshedinxl9":case"urlstring":case"htmltables":case"connection":case"commandtext":case"refreshinfo":case"notitles":case"nextid":case"columninfo":case"overwritecells":case"donotpromptforfile":case"textwizardsettings":case"source":case"number":case"decimal":case"thousandseparator":case"trailingminusnumbers":case"formatsettings":case"fieldtype":case"delimiters":case"tab":case"comma":case"autoformatname":case"versionlastedit":case"versionlastrefresh":break;default:Q=!1}break;case"datavalidation":switch(a[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":case"cellrangelist":break;default:Q=!1}break;case"sorting":case"conditionalformatting":switch(a[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"cellrangelist":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":break;default:Q=!1}break;case"mapinfo":case"schema":case"data":switch(a[3]){case"map":case"entry":case"range":case"xpath":case"field":case"xsdtype":case"filteron":case"aggregate":case"elementtype":case"attributetype":case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":case"row":break;default:Q=!1}break;case"smarttags":break;default:Q=!1}if(Q)break;if(a[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+a[3]+"|"+c.join("|");if("customdocumentproperties"===c[c.length-1][0]){if("/>"===a[0].slice(-2))break;"/"===a[1]?fA(I,B,N,r.slice(A,a.index)):(N=a,A=a.index+a[0].length);break}if(n.WTF)throw"Unrecognized tag: "+a[3]+"|"+c.join("|")}var Z={};return n.bookSheets||n.bookProps||(Z.Sheets=h),Z.SheetNames=f,Z.Workbook=V,Z.SSF=Sw(vb),Z.Props=C,Z.Custprops=I,Z}function yA(e,t){switch(jN(t=t||{}),t.type||"base64"){case"base64":return vA(Yy(e),t);case"binary":case"buffer":case"file":return vA(e,t);case"array":return vA(rb(e),t)}}function bA(e,t){var n=[];return e.Props&&n.push(function(e,t){var n=[];return sw(tk).map(function(e){for(var t=0;t<HE.length;++t)if(HE[t][1]==e)return HE[t];for(t=0;t<$E.length;++t)if($E[t][1]==e)return $E[t];throw e}).forEach(function(r){if(null!=e[r[1]]){var a=t&&t.Props&&null!=t.Props[r[1]]?t.Props[r[1]]:e[r[1]];"date"===r[2]&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"Z")),"number"==typeof a?a=String(a):!0===a||!1===a?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),n.push(yT(tk[r[1]]||r[1],a))}}),wT("DocumentProperties",n.join(""),{xmlns:UT})}(e.Props,t)),e.Custprops&&n.push(function(e,t){var n=["Worksheets","SheetNames"],r="CustomDocumentProperties",a=[];return e&&sw(e).forEach(function(t){if(Object.prototype.hasOwnProperty.call(e,t)){for(var r=0;r<HE.length;++r)if(t==HE[r][1])return;for(r=0;r<$E.length;++r)if(t==$E[r][1])return;for(r=0;r<n.length;++r)if(t==n[r])return;var i=e[t],s="string";"number"==typeof i?(s="float",i=String(i)):!0===i||!1===i?(s="boolean",i=i?"1":"0"):i=String(i),a.push(wT(eT(t),i,{"dt:dt":s}))}}),t&&sw(t).forEach(function(n){if(Object.prototype.hasOwnProperty.call(t,n)&&(!e||!Object.prototype.hasOwnProperty.call(e,n))){var r=t[n],i="string";"number"==typeof r?(i="float",r=String(r)):!0===r||!1===r?(i="boolean",r=r?"1":"0"):r instanceof Date?(i="dateTime.tz",r=r.toISOString()):r=String(r),a.push(wT(eT(n),r,{"dt:dt":i}))}}),"<"+r+' xmlns="'+UT+'">'+a.join("")+"</"+r+">"}(e.Props,e.Custprops)),n.join("")}function wA(e){return wT("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Zx(e.Ref,{r:0,c:0})})}function TA(e,t,n,r,a,i,s){if(!e||void 0==e.v&&void 0==e.f)return"";var o={};if(e.f&&(o["ss:Formula"]="="+Zw(Zx(e.f,s))),e.F&&e.F.slice(0,t.length)==t){var l=jS(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==s.r?"":"["+(l.r-s.r)+"]")+"C"+(l.c==s.c?"":"["+(l.c-s.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=Zw(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=Zw(e.l.Tooltip))),n["!merges"])for(var c=n["!merges"],u=0;u!=c.length;++u)c[u].s.c==s.c&&c[u].s.r==s.r&&(c[u].e.c>c[u].s.c&&(o["ss:MergeAcross"]=c[u].e.c-c[u].s.c),c[u].e.r>c[u].s.r&&(o["ss:MergeDown"]=c[u].e.r-c[u].s.r));var h="",f="";switch(e.t){case"z":if(!r.sheetStubs)return"";break;case"n":h="Number",f=String(e.v);break;case"b":h="Boolean",f=e.v?"1":"0";break;case"e":h="Error",f=NE[e.v];break;case"d":h="DateTime",f=new Date(e.v).toISOString(),null==e.z&&(e.z=e.z||vb[14]);break;case"s":h="String",f=((e.v||"")+"").replace(Qw,function(e){return Xw[e]}).replace(tT,function(e){return"&#x"+e.charCodeAt(0).toString(16).toUpperCase()+";"})}var d=QC(r.cellXfs,e,r);o["ss:StyleID"]="s"+(21+d),o["ss:Index"]=s.c+1;var p=null!=e.v?f:"",m="z"==e.t?"":'<Data ss:Type="'+h+'">'+p+"</Data>";return(e.c||[]).length>0&&(m+=e.c.map(function(e){var t=wT("ss:Data",(e.t||"").replace(/(\r\n|[\r\n])/g,"&#10;"),{xmlns:"http://www.w3.org/TR/REC-html40"});return wT("Comment",t,{"ss:Author":e.a})}).join("")),wT("Cell",m,o)}function SA(e,t){var n='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=cx(t.hpt)),t.hpx&&(n+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(n+=' ss:Hidden="1"')),n+">"}function EA(e,t,n){var r=[],a=n.SheetNames[e],i=n.Sheets[a],s=i?function(e,t,n,r){if(!e)return"";if(!((r||{}).Workbook||{}).Names)return"";for(var a=r.Workbook.Names,i=[],s=0;s<a.length;++s){var o=a[s];o.Sheet==n&&(o.Name.match(/^_xlfn\./)||i.push(wA(o)))}return i.join("")}(i,0,e,n):"";return s.length>0&&r.push("<Names>"+s+"</Names>"),s=i?function(e,t){if(!e["!ref"])return"";var n=HS(e["!ref"]),r=e["!merges"]||[],a=0,i=[];e["!cols"]&&e["!cols"].forEach(function(e,t){sx(e);var n=!!e.width,r=XC(t,e),a={"ss:Index":t+1};n&&(a["ss:Width"]=tx(r.width)),e.hidden&&(a["ss:Hidden"]="1"),i.push(wT("Column",null,a))});for(var s=Array.isArray(e),o=n.s.r;o<=n.e.r;++o){for(var l=[SA(o,(e["!rows"]||[])[o])],c=n.s.c;c<=n.e.c;++c){var u=!1;for(a=0;a!=r.length;++a)if(!(r[a].s.c>c)&&!(r[a].s.r>o)&&!(r[a].e.c<c)&&!(r[a].e.r<o)){r[a].s.c==c&&r[a].s.r==o||(u=!0);break}if(!u){var h={r:o,c:c},f=VS(h),d=s?(e[o]||[])[c]:e[f];l.push(TA(d,f,e,t,0,0,h))}}l.push("</Row>"),l.length>2&&i.push(l.join(""))}return i.join("")}(i,t):"",s.length>0&&r.push("<Table>"+s+"</Table>"),r.push(function(e,t,n,r){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(wT("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(wT("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(wT("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),r&&r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[n])if(r.Workbook.Sheets[n].Hidden)a.push(wT("Visible",1==r.Workbook.Sheets[n].Hidden?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<n&&(!r.Workbook.Sheets[i]||r.Workbook.Sheets[i].Hidden);++i);i==n&&a.push("<Selected/>")}return((((r||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(yT("ProtectContents","True")),e["!protect"].objects&&a.push(yT("ProtectObjects","True")),e["!protect"].scenarios&&a.push(yT("ProtectScenarios","True")),null==e["!protect"].selectLockedCells||e["!protect"].selectLockedCells?null==e["!protect"].selectUnlockedCells||e["!protect"].selectUnlockedCells||a.push(yT("EnableSelection","UnlockedCells")):a.push(yT("EnableSelection","NoSelection")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(t){e["!protect"][t[0]]&&a.push("<"+t[1]+"/>")})),0==a.length?"":wT("WorksheetOptions",a.join(""),{xmlns:jT})}(i,0,e,n)),r.join("")}function kA(e,t){t||(t={}),e.SSF||(e.SSF=Sw(vb)),e.SSF&&(Jb(),Qb(e.SSF),t.revssf=cw(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],QC(t.cellXfs,{},{revssf:{General:0}}));var n=[];n.push(bA(e,t)),n.push(""),n.push(""),n.push("");for(var r=0;r<e.SheetNames.length;++r)n.push(wT("Worksheet",EA(r,t,e),{"ss:Name":Zw(e.SheetNames[r])}));return n[2]=function(e,t){var n=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(e,t){var r=[];r.push(wT("NumberFormat",null,{"ss:Format":Zw(vb[e.numFmtId])}));var a={"ss:ID":"s"+(21+t)};n.push(wT("Style",r.join(""),a))}),wT("Styles",n.join(""))}(0,t),n[3]=function(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,n=[],r=0;r<t.length;++r){var a=t[r];null==a.Sheet&&(a.Name.match(/^_xlfn\./)||n.push(wA(a)))}return wT("Names",n.join(""))}(e),Vw+wT("Workbook",n.join(""),{xmlns:VT,"xmlns:o":UT,"xmlns:x":jT,"xmlns:ss":VT,"xmlns:dt":zT,"xmlns:html":WT})}function _A(e){var t={},n=e.content;if(n.l=28,t.AnsiUserType=n.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=function(e){return TE(e,1)}(n),n.length-n.l<=4)return t;var r=n.read_shift(4);return 0==r||r>40?t:(n.l-=4,t.Reserved1=n.read_shift(0,"lpstr-ansi"),n.length-n.l<=4||1907505652!==(r=n.read_shift(4))?t:(t.UnicodeClipboardFormat=function(e){return TE(e,2)}(n),0==(r=n.read_shift(4))||r>40?t:(n.l-=4,void(t.Reserved2=n.read_shift(0,"lpwstr")))))}var xA=[60,1084,2066,2165,2175];function CA(e,t,n,r,a){var i=r,s=[],o=n.slice(n.l,n.l+i);if(a&&a.enc&&a.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:case 133:break;default:a.enc.insitu(o)}s.push(o),n.l+=i;for(var l=pS(n,n.l),c=FA[l],u=0;null!=c&&xA.indexOf(l)>-1;)i=pS(n,n.l+2),u=n.l+4,2066==l?u+=4:2165!=l&&2175!=l||(u+=12),o=n.slice(u,n.l+4+i),s.push(o),n.l+=4+i,c=FA[l=pS(n,n.l)];var h=ib(s);_S(h,0);var f=0;h.lens=[];for(var d=0;d<s.length;++d)h.lens.push(f),f+=s[d].length;if(h.length<r)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+h.length+" < "+r;return t.f(h,h.length,a)}function IA(e,t,n){if("z"!==e.t&&e.XF){var r=0;try{r=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=vb[r])}catch(AR){if(t.WTF)throw AR}if(!t||!1!==t.cellText)try{"e"===e.t?e.w=e.w||NE[e.v]:0===r||"General"==r?"n"===e.t?(0|e.v)===e.v?e.w=e.v.toString(10):e.w=Cb(e.v):e.w=Ib(e.v):e.w=Xb(r,e.v,{date1904:!!n,dateNF:t&&t.dateNF})}catch(AR){if(t.WTF)throw AR}if(t.cellDates&&r&&"n"==e.t&&Gb(vb[r]||String(r))){var a=Tb(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function AA(e,t,n){return{v:e,ixfe:t,t:n}}function NA(e,t){var n={opts:{}},r={};var a,i,s,o,l,c,u,h,f=t.dense?[]:{},d={},p={},m=null,g=[],v="",y={},b="",w={},T=[],S=[],E=[],k={Sheets:[],WBProps:{date1904:!1},Views:[{}]},_={},x=function(e){return e<8?AE[e]:e<64&&E[e-8]||AE[e]},C=function(e,t,n){if(!(F>1)&&!(n.sheetRows&&e.r>=n.sheetRows)){if(n.cellStyles&&t.XF&&t.XF.data&&function(e,t,n){var r,a=t.XF.data;a&&a.patternType&&n&&n.cellStyles&&(t.s={},t.s.patternType=a.patternType,(r=J_(x(a.icvFore)))&&(t.s.fgColor={rgb:r}),(r=J_(x(a.icvBack)))&&(t.s.bgColor={rgb:r}))}(0,t,n),delete t.ixfe,delete t.XF,a=e,b=VS(e),p&&p.s&&p.e||(p={s:{r:0,c:0},e:{r:0,c:0}}),e.r<p.s.r&&(p.s.r=e.r),e.c<p.s.c&&(p.s.c=e.c),e.r+1>p.e.r&&(p.e.r=e.r+1),e.c+1>p.e.c&&(p.e.c=e.c+1),n.cellFormula&&t.f)for(var r=0;r<T.length;++r)if(!(T[r][0].s.c>e.c||T[r][0].s.r>e.r)&&!(T[r][0].e.c<e.c||T[r][0].e.r<e.r)){t.F=BS(T[r][0]),T[r][0].s.c==e.c&&T[r][0].s.r==e.r||delete t.f,t.f&&(t.f=""+IC(T[r][1],0,e,D,I));break}n.dense?(f[e.r]||(f[e.r]=[]),f[e.r][e.c]=t):f[b]=t}},I={enc:!1,sbcch:0,snames:[],sharedf:w,arrayf:T,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(I.password=t.password);var A=[],N=[],R=[],O=[],P=!1,D=[];D.SheetNames=I.snames,D.sharedf=I.sharedf,D.arrayf=I.arrayf,D.names=[],D.XTI=[];var L,M=0,F=0,U=0,j=[],V=[];I.codepage=1200,Vy(1200);for(var z=!1;e.l<e.length-1;){var B=e.l,H=e.read_shift(2);if(0===H&&10===M)break;var W=e.l===e.length?0:e.read_shift(2),G=FA[H];if(G&&G.f){if(t.bookSheets&&133===M&&133!==H)break;if(M=H,2===G.r||12==G.r){var K=e.read_shift(2);if(W-=2,!I.enc&&K!==H&&((255&K)<<8|K>>8)!==H)throw new Error("rt mismatch: "+K+"!="+H);12==G.r&&(e.l+=10,W-=10)}var q={};if(q=10===H?G.f(e,W,I):CA(H,G,e,W,I),0==F&&-1===[9,521,1033,2057].indexOf(M))continue;switch(H){case 34:n.opts.Date1904=k.WBProps.date1904=q;break;case 134:n.opts.WriteProtect=!0;break;case 47:if(I.enc||(e.l=0),I.enc=q,!t.password)throw new Error("File is password-protected");if(null==q.valid)throw new Error("Encryption scheme unsupported");if(!q.valid)throw new Error("Password is incorrect");break;case 92:I.lastuser=q;break;case 66:var $=Number(q);switch($){case 21010:$=1200;break;case 32768:$=1e4;break;case 32769:$=1252}Vy(I.codepage=$),z=!0;break;case 317:I.rrtabid=q;break;case 25:I.winlocked=q;break;case 439:n.opts.RefreshAll=q;break;case 12:n.opts.CalcCount=q;break;case 16:n.opts.CalcDelta=q;break;case 17:n.opts.CalcIter=q;break;case 13:n.opts.CalcMode=q;break;case 14:n.opts.CalcPrecision=q;break;case 95:n.opts.CalcSaveRecalc=q;break;case 15:I.CalcRefMode=q;break;case 2211:n.opts.FullCalc=q;break;case 129:q.fDialog&&(f["!type"]="dialog"),q.fBelow||((f["!outline"]||(f["!outline"]={})).above=!0),q.fRight||((f["!outline"]||(f["!outline"]={})).left=!0);break;case 224:S.push(q);break;case 430:D.push([q]),D[D.length-1].XTI=[];break;case 35:case 547:D[D.length-1].push(q);break;case 24:case 536:L={Name:q.Name,Ref:IC(q.rgce,0,null,D,I)},q.itab>0&&(L.Sheet=q.itab-1),D.names.push(L),D[0]||(D[0]=[],D[0].XTI=[]),D[D.length-1].push(q),"_xlnm._FilterDatabase"==q.Name&&q.itab>0&&q.rgce&&q.rgce[0]&&q.rgce[0][0]&&"PtgArea3d"==q.rgce[0][0][0]&&(V[q.itab-1]={ref:BS(q.rgce[0][0][1][2])});break;case 22:I.ExternCount=q;break;case 23:0==D.length&&(D[0]=[],D[0].XTI=[]),D[D.length-1].XTI=D[D.length-1].XTI.concat(q),D.XTI=D.XTI.concat(q);break;case 2196:if(I.biff<8)break;null!=L&&(L.Comment=q[1]);break;case 18:f["!protect"]=q;break;case 19:0!==q&&I.WTF&&console.error("Password verifier: "+q);break;case 133:d[q.pos]=q,I.snames.push(q.name);break;case 10:if(--F)break;if(p.e){if(p.e.r>0&&p.e.c>0){if(p.e.r--,p.e.c--,f["!ref"]=BS(p),t.sheetRows&&t.sheetRows<=p.e.r){var X=p.e.r;p.e.r=t.sheetRows-1,f["!fullref"]=f["!ref"],f["!ref"]=BS(p),p.e.r=X}p.e.r++,p.e.c++}A.length>0&&(f["!merges"]=A),N.length>0&&(f["!objects"]=N),R.length>0&&(f["!cols"]=R),O.length>0&&(f["!rows"]=O),k.Sheets.push(_)}""===v?y=f:r[v]=f,f=t.dense?[]:{};break;case 9:case 521:case 1033:case 2057:if(8===I.biff&&(I.biff={9:2,521:3,1033:4}[H]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[q.BIFFVer]||8),I.biffguess=0==q.BIFFVer,0==q.BIFFVer&&4096==q.dt&&(I.biff=5,z=!0,Vy(I.codepage=28591)),8==I.biff&&0==q.BIFFVer&&16==q.dt&&(I.biff=2),F++)break;if(f=t.dense?[]:{},I.biff<8&&!z&&(z=!0,Vy(I.codepage=t.codepage||1252)),I.biff<5||0==q.BIFFVer&&4096==q.dt){""===v&&(v="Sheet1"),p={s:{r:0,c:0},e:{r:0,c:0}};var Y={pos:e.l-W,name:v};d[Y.pos]=Y,I.snames.push(v)}else v=(d[B]||{name:""}).name;32==q.dt&&(f["!type"]="chart"),64==q.dt&&(f["!type"]="macro"),A=[],N=[],I.arrayf=T=[],R=[],O=[],P=!1,_={Hidden:(d[B]||{hs:0}).hs,name:v};break;case 515:case 3:case 2:"chart"==f["!type"]&&(t.dense?(f[q.r]||[])[q.c]:f[VS({c:q.c,r:q.r})])&&++q.c,c={ixfe:q.ixfe,XF:S[q.ixfe]||{},v:q.val,t:"n"},U>0&&(c.z=j[c.ixfe>>8&63]),IA(c,t,n.opts.Date1904),C({c:q.c,r:q.r},c,t);break;case 5:case 517:c={ixfe:q.ixfe,XF:S[q.ixfe],v:q.val,t:q.t},U>0&&(c.z=j[c.ixfe>>8&63]),IA(c,t,n.opts.Date1904),C({c:q.c,r:q.r},c,t);break;case 638:c={ixfe:q.ixfe,XF:S[q.ixfe],v:q.rknum,t:"n"},U>0&&(c.z=j[c.ixfe>>8&63]),IA(c,t,n.opts.Date1904),C({c:q.c,r:q.r},c,t);break;case 189:for(var Q=q.c;Q<=q.C;++Q){var J=q.rkrec[Q-q.c][0];c={ixfe:J,XF:S[J],v:q.rkrec[Q-q.c][1],t:"n"},U>0&&(c.z=j[c.ixfe>>8&63]),IA(c,t,n.opts.Date1904),C({c:Q,r:q.r},c,t)}break;case 6:case 518:case 1030:if("String"==q.val){m=q;break}if((c=AA(q.val,q.cell.ixfe,q.tt)).XF=S[c.ixfe],t.cellFormula){var Z=q.formula;if(Z&&Z[0]&&Z[0][0]&&"PtgExp"==Z[0][0][0]){var ee=Z[0][0][1][0],te=Z[0][0][1][1],ne=VS({r:ee,c:te});w[ne]?c.f=""+IC(q.formula,0,q.cell,D,I):c.F=((t.dense?(f[ee]||[])[te]:f[ne])||{}).F}else c.f=""+IC(q.formula,0,q.cell,D,I)}U>0&&(c.z=j[c.ixfe>>8&63]),IA(c,t,n.opts.Date1904),C(q.cell,c,t),m=q;break;case 7:case 519:if(!m)throw new Error("String record expects Formula");m.val=q,(c=AA(q,m.cell.ixfe,"s")).XF=S[c.ixfe],t.cellFormula&&(c.f=""+IC(m.formula,0,m.cell,D,I)),U>0&&(c.z=j[c.ixfe>>8&63]),IA(c,t,n.opts.Date1904),C(m.cell,c,t),m=null;break;case 33:case 545:T.push(q);var re=VS(q[0].s);if(i=t.dense?(f[q[0].s.r]||[])[q[0].s.c]:f[re],t.cellFormula&&i){if(!m)break;if(!re||!i)break;i.f=""+IC(q[1],0,q[0],D,I),i.F=BS(q[0])}break;case 1212:if(!t.cellFormula)break;if(b){if(!m)break;w[VS(m.cell)]=q[0],((i=t.dense?(f[m.cell.r]||[])[m.cell.c]:f[VS(m.cell)])||{}).f=""+IC(q[0],0,a,D,I)}break;case 253:c=AA(g[q.isst].t,q.ixfe,"s"),g[q.isst].h&&(c.h=g[q.isst].h),c.XF=S[c.ixfe],U>0&&(c.z=j[c.ixfe>>8&63]),IA(c,t,n.opts.Date1904),C({c:q.c,r:q.r},c,t);break;case 513:t.sheetStubs&&(c={ixfe:q.ixfe,XF:S[q.ixfe],t:"z"},U>0&&(c.z=j[c.ixfe>>8&63]),IA(c,t,n.opts.Date1904),C({c:q.c,r:q.r},c,t));break;case 190:if(t.sheetStubs)for(var ae=q.c;ae<=q.C;++ae){var ie=q.ixfe[ae-q.c];c={ixfe:ie,XF:S[ie],t:"z"},U>0&&(c.z=j[c.ixfe>>8&63]),IA(c,t,n.opts.Date1904),C({c:ae,r:q.r},c,t)}break;case 214:case 516:case 4:(c=AA(q.val,q.ixfe,"s")).XF=S[c.ixfe],U>0&&(c.z=j[c.ixfe>>8&63]),IA(c,t,n.opts.Date1904),C({c:q.c,r:q.r},c,t);break;case 0:case 512:1===F&&(p=q);break;case 252:g=q;break;case 1054:if(4==I.biff){j[U++]=q[1];for(var se=0;se<U+163&&vb[se]!=q[1];++se);se>=163&&Yb(q[1],U+163)}else Yb(q[1],q[0]);break;case 30:j[U++]=q;for(var oe=0;oe<U+163&&vb[oe]!=q;++oe);oe>=163&&Yb(q,U+163);break;case 229:A=A.concat(q);break;case 93:N[q.cmo[0]]=I.lastobj=q;break;case 438:I.lastobj.TxO=q;break;case 127:I.lastobj.ImData=q;break;case 440:for(l=q[0].s.r;l<=q[0].e.r;++l)for(o=q[0].s.c;o<=q[0].e.c;++o)(i=t.dense?(f[l]||[])[o]:f[VS({c:o,r:l})])&&(i.l=q[1]);break;case 2048:for(l=q[0].s.r;l<=q[0].e.r;++l)for(o=q[0].s.c;o<=q[0].e.c;++o)(i=t.dense?(f[l]||[])[o]:f[VS({c:o,r:l})])&&i.l&&(i.l.Tooltip=q[1]);break;case 28:if(I.biff<=5&&I.biff>=2)break;i=t.dense?(f[q[0].r]||[])[q[0].c]:f[VS(q[0])];var le=N[q[2]];i||(t.dense?(f[q[0].r]||(f[q[0].r]=[]),i=f[q[0].r][q[0].c]={t:"z"}):i=f[VS(q[0])]={t:"z"},p.e.r=Math.max(p.e.r,q[0].r),p.s.r=Math.min(p.s.r,q[0].r),p.e.c=Math.max(p.e.c,q[0].c),p.s.c=Math.min(p.s.c,q[0].c)),i.c||(i.c=[]),s={a:q[1],t:le.TxO.t},i.c.push(s);break;case 2173:Vx(S[q.ixfe],q.ext);break;case 125:if(!I.cellStyles)break;for(;q.e>=q.s;)R[q.e--]={width:q.w/256,level:q.level||0,hidden:!!(1&q.flags)},P||(P=!0,ix(q.w/256)),sx(R[q.e+1]);break;case 520:var ce={};null!=q.level&&(O[q.r]=ce,ce.level=q.level),q.hidden&&(O[q.r]=ce,ce.hidden=!0),q.hpt&&(O[q.r]=ce,ce.hpt=q.hpt,ce.hpx=cx(q.hpt));break;case 38:case 39:case 40:case 41:f["!margins"]||YC(f["!margins"]={}),f["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[H]]=q;break;case 161:f["!margins"]||YC(f["!margins"]={}),f["!margins"].header=q.header,f["!margins"].footer=q.footer;break;case 574:q.RTL&&(k.Views[0].RTL=!0);break;case 146:E=q;break;case 2198:h=q;break;case 140:u=q;break;case 442:v?_.CodeName=q||_.name:k.WBProps.CodeName=q||"ThisWorkbook"}}else G||console.error("Missing Info for XLS Record 0x"+H.toString(16)),e.l+=W}return n.SheetNames=sw(d).sort(function(e,t){return Number(e)-Number(t)}).map(function(e){return d[e].name}),t.bookSheets||(n.Sheets=r),!n.SheetNames.length&&y["!ref"]?(n.SheetNames.push("Sheet1"),n.Sheets&&(n.Sheets.Sheet1=y)):n.Preamble=y,n.Sheets&&V.forEach(function(e,t){n.Sheets[n.SheetNames[t]]["!autofilter"]=e}),n.Strings=g,n.SSF=Sw(vb),I.enc&&(n.Encryption=I.enc),h&&(n.Themes=h),n.Metadata={},void 0!==u&&(n.Metadata.Country=u),D.names.length>0&&(k.Names=D.names),n.Workbook=k,n}var RA="e0859ff2f94f6810ab9108002b27b3d9",OA="02d5cdd59c2e1b10939708002b2cf9ae",PA="05d5cdd59c2e1b10939708002b2cf9ae";function DA(e,t){var n,r,a,i;if(t||(t={}),jN(t),zy(),t.codepage&&jy(t.codepage),e.FullPaths){if(nw.find(e,"/encryption"))throw new Error("File is password-protected");n=nw.find(e,"!CompObj"),r=nw.find(e,"/Workbook")||nw.find(e,"/Book")}else{switch(t.type){case"base64":e=tb(Yy(e));break;case"binary":e=tb(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e))}_S(e,0),r={content:e}}if(n&&_A(n),t.bookProps&&!t.bookSheets)a={};else{var s=Qy?"buffer":"array";if(r&&r.content)a=NA(r.content,t);else if((i=nw.find(e,"PerfectOffice_MAIN"))&&i.content)a=k_.to_workbook(i.content,(t.type=s,t));else{if(!(i=nw.find(e,"NativeContent_MAIN"))||!i.content)throw(i=nw.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");a=k_.to_workbook(i.content,(t.type=s,t))}t.bookVBA&&e.FullPaths&&nw.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=function(e){var t=nw.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(n,r){if("/"!==n.slice(-1)&&n.match(/_VBA_PROJECT_CUR/)){var a=n.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");nw.utils.cfb_add(t,a,e.FileIndex[r].content)}}),nw.write(t)}(e))}var o={};return e.FullPaths&&function(e,t,n){var r=nw.find(e,"/!DocumentSummaryInformation");if(r&&r.size>0)try{var a=vk(r,kE,OA);for(var i in a)t[i]=a[i]}catch(AR){if(n.WTF)throw AR}var s=nw.find(e,"/!SummaryInformation");if(s&&s.size>0)try{var o=vk(s,_E,RA);for(var l in o)null==t[l]&&(t[l]=o[l])}catch(AR){if(n.WTF)throw AR}t.HeadingPairs&&t.TitlesOfParts&&(YE(t.HeadingPairs,t.TitlesOfParts,t,n),delete t.HeadingPairs,delete t.TitlesOfParts)}(e,o,t),a.Props=a.Custprops=o,t.bookFiles&&(a.cfb=e),a}function LA(e,t){var n=t||{},r=nw.utils.cfb_new({root:"R"}),a="/Workbook";switch(n.bookType||"xls"){case"xls":n.bookType="biff8";case"xla":n.bookType||(n.bookType="xla");case"biff8":a="/Workbook",n.biff=8;break;case"biff5":a="/Book",n.biff=5;break;default:throw new Error("invalid type "+n.bookType+" for XLS CFB")}return nw.utils.cfb_add(r,a,qA(e,n)),8==n.biff&&(e.Props||e.Custprops)&&function(e,t){var n,r=[],a=[],i=[],s=0,o=ow(kE,"n"),l=ow(_E,"n");if(e.Props)for(n=sw(e.Props),s=0;s<n.length;++s)(Object.prototype.hasOwnProperty.call(o,n[s])?r:Object.prototype.hasOwnProperty.call(l,n[s])?a:i).push([n[s],e.Props[n[s]]]);if(e.Custprops)for(n=sw(e.Custprops),s=0;s<n.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},n[s])||(Object.prototype.hasOwnProperty.call(o,n[s])?r:Object.prototype.hasOwnProperty.call(l,n[s])?a:i).push([n[s],e.Custprops[n[s]]]);var c=[];for(s=0;s<i.length;++s)pk.indexOf(i[s][0])>-1||XE.indexOf(i[s][0])>-1||null!=i[s][1]&&c.push(i[s]);a.length&&nw.utils.cfb_add(t,"/\x05SummaryInformation",yk(a,RA,l,_E)),(r.length||c.length)&&nw.utils.cfb_add(t,"/\x05DocumentSummaryInformation",yk(r,OA,o,kE,c.length?c:null,PA))}(e,r),8==n.biff&&e.vbaraw&&function(e,t){t.FullPaths.forEach(function(n,r){if(0!=r){var a=n.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");"/"!==a.slice(-1)&&nw.utils.cfb_add(e,a,t.FileIndex[r].content)}})}(r,nw.read(e.vbaraw,{type:"string"==typeof e.vbaraw?"binary":"buffer"})),r}var MA={0:{f:function(e,t){var n={},r=e.l+t;n.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=r,7&i&&(n.level=7&i),16&i&&(n.hidden=!0),32&i&&(n.hpt=a/20),n}},1:{f:function(e){return[nE(e)]}},2:{f:function(e){return[nE(e),dE(e),"n"]}},3:{f:function(e){return[nE(e),e.read_shift(1),"e"]}},4:{f:function(e){return[nE(e),e.read_shift(1),"b"]}},5:{f:function(e){return[nE(e),yE(e),"n"]}},6:{f:function(e){return[nE(e),YS(e),"str"]}},7:{f:function(e){return[nE(e),e.read_shift(4),"s"]}},8:{f:function(e,t,n){var r=e.l+t,a=nE(e);a.r=n["!row"];var i=[a,YS(e),"str"];if(n.cellFormula){e.l+=2;var s=LC(e,r-e.l,n);i[3]=IC(s,0,a,n.supbooks,n)}else e.l=r;return i}},9:{f:function(e,t,n){var r=e.l+t,a=nE(e);a.r=n["!row"];var i=[a,yE(e),"n"];if(n.cellFormula){e.l+=2;var s=LC(e,r-e.l,n);i[3]=IC(s,0,a,n.supbooks,n)}else e.l=r;return i}},10:{f:function(e,t,n){var r=e.l+t,a=nE(e);a.r=n["!row"];var i=[a,e.read_shift(1),"b"];if(n.cellFormula){e.l+=2;var s=LC(e,r-e.l,n);i[3]=IC(s,0,a,n.supbooks,n)}else e.l=r;return i}},11:{f:function(e,t,n){var r=e.l+t,a=nE(e);a.r=n["!row"];var i=[a,e.read_shift(1),"e"];if(n.cellFormula){e.l+=2;var s=LC(e,r-e.l,n);i[3]=IC(s,0,a,n.supbooks,n)}else e.l=r;return i}},12:{f:function(e){return[aE(e)]}},13:{f:function(e){return[aE(e),dE(e),"n"]}},14:{f:function(e){return[aE(e),e.read_shift(1),"e"]}},15:{f:function(e){return[aE(e),e.read_shift(1),"b"]}},16:{f:TI},17:{f:function(e){return[aE(e),YS(e),"str"]}},18:{f:function(e){return[aE(e),e.read_shift(4),"s"]}},19:{f:ZS},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:function(e,t,n){var r=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),i=uE(e),s=MC(e,0,n),o=lE(e);e.l=r;var l={Name:i,Ptg:s};return a<268435455&&(l.Sheet=a),o&&(l.Comment=o),l}},40:{},42:{},43:{f:function(e,t,n){var r={};r.sz=e.read_shift(2)/20;var a=function(e){var t=e.read_shift(1);return e.l++,{fBold:1&t,fItalic:2&t,fUnderline:4&t,fStrikeout:8&t,fOutline:16&t,fShadow:32&t,fCondense:64&t,fExtend:128&t}}(e);switch(a.fItalic&&(r.italic=1),a.fCondense&&(r.condense=1),a.fExtend&&(r.extend=1),a.fShadow&&(r.shadow=1),a.fOutline&&(r.outline=1),a.fStrikeout&&(r.strike=1),700===e.read_shift(2)&&(r.bold=1),e.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript"}var i=e.read_shift(1);0!=i&&(r.underline=i);var s=e.read_shift(1);s>0&&(r.family=s);var o=e.read_shift(1);switch(o>0&&(r.charset=o),e.l++,r.color=function(e){var t={},n=e.read_shift(1)>>>1,r=e.read_shift(1),a=e.read_shift(2,"i"),i=e.read_shift(1),s=e.read_shift(1),o=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=r;var l=AE[r];l&&(t.rgb=J_(l));break;case 2:t.rgb=J_([i,s,o]);break;case 3:t.theme=r}return 0!=a&&(t.tint=a>0?a/32767:a/32768),t}(e),e.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor"}return r.name=YS(e),r}},44:{f:function(e,t){return[e.read_shift(2),YS(e)]}},45:{f:bx},46:{f:Ex},47:{f:function(e,t){var n=e.l+t,r=e.read_shift(2),a=e.read_shift(2);return e.l=n,{ixfe:r,numFmtId:a}}},48:{},49:{f:function(e){return e.read_shift(4,"i")}},50:{},51:{f:function(e){for(var t=[],n=e.read_shift(4);n-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:p_},62:{f:function(e){return[nE(e),ZS(e),"is"]}},63:{f:function(e){var t={};t.i=e.read_shift(4);var n={};n.r=e.read_shift(4),n.c=e.read_shift(4),t.r=VS(n);var r=e.read_shift(1);return 2&r&&(t.l="1"),8&r&&(t.a="1"),t}},64:{f:function(){}},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:xS,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:function(e){var t=e.read_shift(2);return e.l+=28,{RTL:32&t}}},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:function(e,t){var n={},r=e[e.l];return++e.l,n.above=!(64&r),n.left=!(128&r),e.l+=18,n.name=sE(e,t-19),n}},148:{f:bI,p:16},151:{f:function(){}},152:{},153:{f:function(e,t){var n={},r=e.read_shift(4);n.defaultThemeVersion=e.read_shift(4);var a=t>8?YS(e):"";return a.length>0&&(n.CodeName=a),n.autoCompressPictures=!!(65536&r),n.backupFile=!!(64&r),n.checkCompatibility=!!(4096&r),n.date1904=!!(1&r),n.filterPrivacy=!!(8&r),n.hidePivotFieldList=!!(1024&r),n.promptedSolutions=!!(16&r),n.publishItems=!!(2048&r),n.refreshAllConnections=!!(262144&r),n.saveExternalLinkValues=!!(128&r),n.showBorderUnselectedTables=!!(4&r),n.showInkAnnotation=!!(32&r),n.showObjects=["all","placeholders","none"][r>>13&3],n.showPivotChartFilter=!!(32768&r),n.updateLinks=["userSet","never","always"][r>>8&3],n}},154:{},155:{},156:{f:function(e,t){var n={};return n.Hidden=e.read_shift(4),n.iTabID=e.read_shift(4),n.strRelID=hE(e,t-8),n.name=YS(e),n}},157:{},158:{},159:{T:1,f:function(e){return[e.read_shift(4),e.read_shift(4)]}},160:{T:-1},161:{T:1,f:gE},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:SI},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:function(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:YS(e)}}},336:{T:-1},337:{f:function(e){return e.l+=4,0!=e.read_shift(4)},T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:hE},357:{},358:{},359:{},360:{T:1},361:{},362:{f:c_},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:function(e,t,n){var r=e.l+t,a=mE(e),i=e.read_shift(1),s=[a];if(s[2]=i,n.cellFormula){var o=DC(e,r-e.l,n);s[1]=o}else e.l=r;return s}},427:{f:function(e,t,n){var r=e.l+t,a=[gE(e,16)];if(n.cellFormula){var i=FC(e,r-e.l,n);a[1]=i,e.l=r}else e.l=r;return a}},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:function(e){var t={};return kI.forEach(function(n){t[n]=yE(e)}),t}},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:function(){}},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:function(e,t){var n=e.l+t,r=gE(e,16),a=lE(e),i=YS(e),s=YS(e),o=YS(e);e.l=n;var l={rfx:r,relId:a,loc:i,display:o};return s&&(l.Tooltip=s),l}},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:hE},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:$x},633:{T:1},634:{T:-1},635:{T:1,f:function(e){var t={};t.iauthor=e.read_shift(4);var n=gE(e,16);return t.rfx=n.s,t.ref=VS(n.s),e.l+=16,t}},636:{T:-1},637:{f:eE},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:function(e,t){return e.l+=10,{name:YS(e)}}},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:function(){}},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},FA={6:{f:RC},10:{f:bk},12:{f:Sk},13:{f:Sk},14:{f:wk},15:{f:wk},16:{f:yE},17:{f:wk},18:{f:wk},19:{f:Sk},20:{f:i_},21:{f:i_},23:{f:c_},24:{f:l_},25:{f:wk},26:{},27:{},28:{f:function(e,t,n){return function(e,t,n){if(!(n.biff<8)){var r=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=Rk(e,0,n);return n.biff<8&&e.read_shift(1),[{r:r,c:a},o,s,i]}}(e,0,n)}},29:{},34:{f:wk},35:{f:s_},38:{f:yE},39:{f:yE},40:{f:yE},41:{f:yE},42:{f:wk},43:{f:wk},47:{f:function(e,t,n){var r={Type:n.biff>=8?e.read_shift(2):0};return r.Type?Y_(e,t-2,r):function(e,t,n,r){var a={key:Sk(e),verificationBytes:Sk(e)};n.password&&(a.verifier=q_(n.password)),r.valid=a.verificationBytes===a.verifier,r.valid&&(r.insitu=X_(n.password))}(e,n.biff,n,r),r}},49:{f:function(e,t,n){var r={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(n&&n.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10}return r.name=xk(e,0,n),r}},51:{f:Sk},60:{},61:{f:function(e){return{Pos:[e.read_shift(2),e.read_shift(2)],Dim:[e.read_shift(2),e.read_shift(2)],Flags:e.read_shift(2),CurTab:e.read_shift(2),FirstTab:e.read_shift(2),Selected:e.read_shift(2),TabRatio:e.read_shift(2)}}},64:{f:wk},65:{f:function(){}},66:{f:Sk},77:{},80:{},81:{},82:{},85:{f:Sk},89:{},90:{},91:{},92:{f:function(e,t,n){if(n.enc)return e.l+=t,"";var r=e.l,a=Rk(e,0,n);return e.read_shift(t+r-e.l),a}},93:{f:function(e,t,n){if(n&&n.biff<8)return function(e,t,n){e.l+=4;var r=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var s=[];return s.push((h_[r]||xS)(e,t,n)),{cmo:[a,r,i],ft:s}}(e,t,n);var r=qk(e),a=function(e,t){for(var n=e.l+t,r=[];e.l<n;){var a=e.read_shift(2);e.l-=2;try{r.push(Xk[a](e,n-e.l))}catch(AR){return e.l=n,r}}return e.l!=n&&(e.l=n),r}(e,t-22,r[1]);return{cmo:r,ft:a}}},94:{},95:{f:wk},96:{},97:{},99:{f:wk},125:{f:p_},128:{f:function(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(0!==t[0]&&t[0]--,0!==t[1]&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}},129:{f:function(e,t,n){var r=n&&8==n.biff||2==t?e.read_shift(2):(e.l+=t,0);return{fDialog:16&r,fBelow:64&r,fRight:128&r}}},130:{f:Sk},131:{f:wk},132:{f:wk},133:{f:function(e,t,n){var r=e.read_shift(4),a=3&e.read_shift(1),i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule"}var s=xk(e,0,n);return 0===s.length&&(s="Sheet1"),{pos:r,hs:a,dt:i,name:s}}},134:{},140:{f:function(e){var t,n=[0,0];return t=e.read_shift(2),n[0]=xE[t]||t,t=e.read_shift(2),n[1]=xE[t]||t,n}},141:{f:Sk},144:{},146:{f:function(e){for(var t=e.read_shift(2),n=[];t-- >0;)n.push(Uk(e));return n}},151:{},152:{},153:{},154:{},155:{},156:{f:Sk},157:{},158:{},160:{f:g_},161:{f:function(e,t){var n={};return t<32||(e.l+=16,n.header=yE(e),n.footer=yE(e),e.l+=2),n}},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:function(e,t){for(var n=e.l+t-2,r=e.read_shift(2),a=e.read_shift(2),i=[];e.l<n;)i.push(Bk(e));if(e.l!==n)throw new Error("MulRK read error");var s=e.read_shift(2);if(i.length!=s-a+1)throw new Error("MulRK length mismatch");return{r:r,c:a,C:s,rkrec:i}}},190:{f:function(e,t){for(var n=e.l+t-2,r=e.read_shift(2),a=e.read_shift(2),i=[];e.l<n;)i.push(e.read_shift(2));if(e.l!==n)throw new Error("MulBlank read error");var s=e.read_shift(2);if(i.length!=s-a+1)throw new Error("MulBlank length mismatch");return{r:r,c:a,C:s,ixfe:i}}},193:{f:bk},197:{},198:{},199:{},200:{},201:{},202:{f:wk},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Sk},220:{},221:{f:wk},222:{},224:{f:function(e,t,n){var r={};return r.ifnt=e.read_shift(2),r.numFmtId=e.read_shift(2),r.flags=e.read_shift(2),r.fStyle=r.flags>>2&1,r.data=function(e,t,n,r){var a={},i=e.read_shift(4),s=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(2);return a.patternType=CE[o>>26],r.cellStyles?(a.alc=7&i,a.fWrap=i>>3&1,a.alcV=i>>4&7,a.fJustLast=i>>7&1,a.trot=i>>8&255,a.cIndent=i>>16&15,a.fShrinkToFit=i>>20&1,a.iReadOrder=i>>22&2,a.fAtrNum=i>>26&1,a.fAtrFnt=i>>27&1,a.fAtrAlc=i>>28&1,a.fAtrBdr=i>>29&1,a.fAtrPat=i>>30&1,a.fAtrProt=i>>31&1,a.dgLeft=15&s,a.dgRight=s>>4&15,a.dgTop=s>>8&15,a.dgBottom=s>>12&15,a.icvLeft=s>>16&127,a.icvRight=s>>23&127,a.grbitDiag=s>>30&3,a.icvTop=127&o,a.icvBottom=o>>7&127,a.icvDiag=o>>14&127,a.dgDiag=o>>21&15,a.icvFore=127&l,a.icvBack=l>>7&127,a.fsxButton=l>>14&1,a):a}(e,0,r.fStyle,n),r}},225:{f:function(e,t){return 0===t||e.read_shift(2),1200}},226:{f:bk},227:{},229:{f:function(e,t){for(var n=[],r=e.read_shift(2);r--;)n.push(Hk(e));return n}},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:function(e,t){for(var n=e.l+t,r=e.read_shift(4),a=e.read_shift(4),i=[],s=0;s!=a&&e.l<n;++s)i.push(Ck(e));return i.Count=r,i.Unique=a,i}},253:{f:function(e){var t=jk(e);return t.isst=e.read_shift(4),t}},255:{f:function(e,t){var n={};return n.dsst=e.read_shift(2),e.l+=t-2,n}},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:kk},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:wk},353:{f:bk},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:function(e,t,n){var r=e.l+t,a=e.read_shift(2),i=e.read_shift(2);if(n.sbcch=i,1025==i||14849==i)return[i,a];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var s=Ak(e,i),o=[];r>e.l;)o.push(Nk(e));return[i,a,s,o]}},431:{f:wk},432:{},433:{},434:{},437:{},438:{f:function(e,t,n){var r=e.l,a="";try{e.l+=4;var i=(n.lastobj||{cmo:[0,0]}).cmo[1];-1==[0,5,7,11,12,14].indexOf(i)?e.l+=6:function(e){var t=e.read_shift(1);e.l++;var n=e.read_shift(2);return e.l+=2,[t,n]}(e);var s=e.read_shift(2);e.read_shift(2),Sk(e);var o=e.read_shift(2);e.l+=o;for(var l=1;l<e.lens.length-1;++l){if(e.l-r!=e.lens[l])throw new Error("TxO: bad continue record");var c=e[e.l];if((a+=Ak(e,e.lens[l+1]-e.lens[l]-1)).length>=(c?s:2*s))break}if(a.length!==s&&a.length!==2*s)throw new Error("cchText: "+s+" != "+a.length);return e.l=r+t,{t:a}}catch(AR){return e.l=r+t,{t:a}}}},439:{f:wk},440:{f:function(e,t){var n=Hk(e);e.l+=16;var r=function(e,t){var n=e.l+t,r=e.read_shift(4);if(2!==r)throw new Error("Unrecognized streamVersion: "+r);var a=e.read_shift(2);e.l+=2;var i,s,o,l,c,u,h="";16&a&&(i=Dk(e,e.l)),128&a&&(s=Dk(e,e.l)),257===(257&a)&&(o=Dk(e,e.l)),1===(257&a)&&(l=Pk(e,e.l)),8&a&&(h=Dk(e,e.l)),32&a&&(c=e.read_shift(16)),64&a&&(u=rk(e)),e.l=n;var f=s||o||l||"";f&&h&&(f+="#"+h),f||(f="#"+h),2&a&&"/"==f.charAt(0)&&"/"!=f.charAt(1)&&(f="file://"+f);var d={Target:f};return c&&(d.guid=c),u&&(d.time=u),i&&(d.Tooltip=i),d}(e,t-24);return[n,r]}},441:{},442:{f:Nk},443:{},444:{f:Sk},445:{},446:{},448:{f:bk},449:{f:function(e){return e.read_shift(2),e.read_shift(4)},r:2},450:{f:bk},512:{f:n_},513:{f:m_},515:{f:function(e,t,n){n.biffguess&&2==n.biff&&(n.biff=5);var r=jk(e),a=yE(e);return r.val=a,r}},516:{f:function(e,t,n){n.biffguess&&2==n.biff&&(n.biff=5),e.l;var r=jk(e);2==n.biff&&e.l++;var a=Nk(e,e.l,n);return r.val=a,r}},517:{f:a_},519:{f:v_},520:{f:function(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var n=e.read_shift(2);e.l+=4;var r=e.read_shift(1);return e.l+=3,7&r&&(t.level=7&r),32&r&&(t.hidden=!0),64&r&&(t.hpt=n/20),t}},523:{},545:{f:u_},549:{f:Zk},566:{},574:{f:function(e,t,n){return n&&n.biff>=2&&n.biff<5?{}:{RTL:64&e.read_shift(2)}}},638:{f:function(e){var t=e.read_shift(2),n=e.read_shift(2),r=Bk(e);return{r:t,c:n,ixfe:r[0],rknum:r[1]}}},659:{},1048:{},1054:{f:function(e,t,n){return[e.read_shift(2),Rk(e,0,n)]}},1084:{},1212:{f:function(e,t,n){var r=Gk(e);e.l++;var a=e.read_shift(1);return[NC(e,t-=8,n),a,r]}},2048:{f:function(e,t){e.read_shift(2);var n=Hk(e),r=e.read_shift((t-10)/2,"dbcs-cont");return[n,r=r.replace(sb,"")]}},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Yk},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:bk},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:function(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t},r:12},2173:{f:function(e,t){e.l,e.l+=2;var n=e.read_shift(2);e.l+=2;for(var r=e.read_shift(2),a=[];r-- >0;)a.push(jx(e,e.l));return{ixfe:n,ext:a}},r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:wk,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:function(e,t,n){if(!(n.biff<8)){var r=e.read_shift(2),a=e.read_shift(2);return[Ak(e,r,n),Ak(e,a,n)]}e.l+=t},r:12},2197:{},2198:{f:function(e,t,n){var r=e.l+t;if(124226!==e.read_shift(4))if(n.cellStyles){var a,i=e.slice(e.l);e.l=r;try{a=Uw(i,{type:"array"})}catch(AR){return}var s=Pw(a,"theme/theme/theme1.xml",!0);if(s)return Mx(s,n)}else e.l=r},r:12},2199:{},2200:{},2201:{},2202:{f:function(e){return[0!==e.read_shift(4),0!==e.read_shift(4),e.read_shift(4)]},r:12},2203:{f:bk},2204:{},2205:{},2206:{},2207:{},2211:{f:function(e){var t=function(e){var t=e.read_shift(2),n=e.read_shift(2);return e.l+=8,{type:t,flags:n}}(e);if(2211!=t.type)throw new Error("Invalid Future Record "+t.type);return 0!==e.read_shift(4)}},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Sk},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:function(e,t,n){var r={area:!1};if(5!=n.biff)return e.l+=t,r;var a=e.read_shift(1);return e.l+=3,16&a&&(r.area=!0),r}},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:function(e){for(var t=e.read_shift(2),n=[];t-- >0;)n.push(Uk(e));return n}},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:n_},1:{},2:{f:function(e){var t=jk(e);++e.l;var n=e.read_shift(2);return t.t="n",t.val=n,t}},3:{f:function(e){var t=jk(e);++e.l;var n=yE(e);return t.t="n",t.val=n,t}},4:{f:function(e,t,n){n.biffguess&&5==n.biff&&(n.biff=2);var r=jk(e);++e.l;var a=Rk(e,0,n);return r.t="str",r.val=a,r}},5:{f:a_},7:{f:function(e){var t=e.read_shift(1);return 0===t?(e.l++,""):e.read_shift(t,"sbcs-cont")}},8:{},9:{f:Yk},11:{},22:{f:Sk},30:{f:t_},31:{},32:{},33:{f:u_},36:{},37:{f:Zk},50:{f:function(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}},62:{},52:{},67:{},68:{f:Sk},69:{},86:{},126:{},127:{f:function(e){var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(4),a={fmt:t,env:n,len:r,data:e.slice(e.l,e.l+r)};return e.l+=r,a}},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:function(e,t,n){var r=e.l+t,a=jk(e),i=e.read_shift(2),s=Ak(e,i,n);return e.l=r,a.t="str",a.val=s,a}},223:{},234:{},354:{},421:{},518:{f:RC},521:{f:Yk},536:{f:l_},547:{f:s_},561:{},579:{},1030:{f:RC},1033:{f:Yk},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function UA(e,t,n,r){var a=t;if(!isNaN(a)){var i=r||(n||[]).length||0,s=e.next(4);s.write_shift(2,a),s.write_shift(2,i),i>0&&hS(n)&&e.push(n)}}function jA(e,t,n){return e||(e=CS(7)),e.write_shift(2,t),e.write_shift(2,n),e.write_shift(2,0),e.write_shift(1,0),e}function VA(e,t,n,r){if(null!=t.v)switch(t.t){case"d":case"n":var a="d"==t.t?hw(ww(t.v)):t.v;return void(a==(0|a)&&a>=0&&a<65536?UA(e,2,function(e,t,n){var r=CS(9);return jA(r,e,t),r.write_shift(2,n),r}(n,r,a)):UA(e,3,function(e,t,n){var r=CS(15);return jA(r,e,t),r.write_shift(8,n,"f"),r}(n,r,a)));case"b":case"e":return void UA(e,5,function(e,t,n,r){var a=CS(9);return jA(a,e,t),_k(n,r||"b",a),a}(n,r,t.v,t.t));case"s":case"str":return void UA(e,4,function(e,t,n){var r=CS(8+2*n.length);return jA(r,e,t),r.write_shift(1,n.length),r.write_shift(n.length,n,"sbcs"),r.l<r.length?r.slice(0,r.l):r}(n,r,(t.v||"").slice(0,255)))}UA(e,1,jA(null,n,r))}function zA(e,t){var n=t||{};for(var r=AS(),a=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==n.sheet&&(a=i);if(0==a&&n.sheet&&e.SheetNames[0]!=n.sheet)throw new Error("Sheet not found: "+n.sheet);return UA(r,4==n.biff?1033:3==n.biff?521:9,Qk(0,16,n)),function(e,t,n,r){var a,i=Array.isArray(t),s=HS(t["!ref"]||"A1"),o="",l=[];if(s.e.c>255||s.e.r>16383){if(r.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=BS(s)}for(var c=s.s.r;c<=s.e.r;++c){o=MS(c);for(var u=s.s.c;u<=s.e.c;++u){c===s.s.r&&(l[u]=US(u)),a=l[u]+o;var h=i?(t[c]||[])[u]:t[a];h&&VA(e,h,c,u)}}}(r,e.Sheets[e.SheetNames[a]],0,n),UA(r,10),r.end()}function BA(e,t,n){UA(e,49,function(e,t){var n=e.name||"Arial",r=t&&5==t.biff,a=CS(r?15+n.length:16+2*n.length);return a.write_shift(2,20*(e.sz||12)),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,n.length),r||a.write_shift(1,1),a.write_shift((r?1:2)*n.length,n,r?"sbcs":"utf16le"),a}({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},n))}function HA(e,t){if(t){var n=0;t.forEach(function(t,r){++n<=256&&t&&UA(e,125,function(e,t){var n=CS(12);n.write_shift(2,t),n.write_shift(2,t),n.write_shift(2,256*e.width),n.write_shift(2,0);var r=0;return e.hidden&&(r|=1),n.write_shift(1,r),r=e.level||0,n.write_shift(1,r),n.write_shift(2,0),n}(XC(r,t),r))})}}function WA(e,t,n,r,a){var i=16+QC(a.cellXfs,t,a);if(null!=t.v||t.bf)if(t.bf)UA(e,6,OC(t,n,r,0,i));else switch(t.t){case"d":case"n":UA(e,515,function(e,t,n,r){var a=CS(14);return Vk(e,t,r,a),bE(n,a),a}(n,r,"d"==t.t?hw(ww(t.v)):t.v,i));break;case"b":case"e":UA(e,517,function(e,t,n,r,a,i){var s=CS(8);return Vk(e,t,r,s),_k(n,i,s),s}(n,r,t.v,i,0,t.t));break;case"s":case"str":if(a.bookSST)UA(e,253,function(e,t,n,r){var a=CS(10);return Vk(e,t,r,a),a.write_shift(4,n),a}(n,r,$C(a.Strings,t.v,a.revStrings),i));else UA(e,516,function(e,t,n,r,a){var i=!a||8==a.biff,s=CS(+i+8+(1+i)*n.length);return Vk(e,t,r,s),s.write_shift(2,n.length),i&&s.write_shift(1,1),s.write_shift((1+i)*n.length,n,i?"utf16le":"sbcs"),s}(n,r,(t.v||"").slice(0,255),i,a));break;default:UA(e,513,Vk(n,r,i))}else UA(e,513,Vk(n,r,i))}function GA(e,t,n){var r,a=AS(),i=n.SheetNames[e],s=n.Sheets[i]||{},o=(n||{}).Workbook||{},l=(o.Sheets||[])[e]||{},c=Array.isArray(s),u=8==t.biff,h="",f=[],d=HS(s["!ref"]||"A1"),p=u?65536:16384;if(d.e.c>255||d.e.r>=p){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");d.e.c=Math.min(d.e.c,255),d.e.r=Math.min(d.e.c,p-1)}UA(a,2057,Qk(0,16,t)),UA(a,13,Ek(1)),UA(a,12,Ek(100)),UA(a,15,Tk(!0)),UA(a,17,Tk(!1)),UA(a,16,bE(.001)),UA(a,95,Tk(!0)),UA(a,42,Tk(!1)),UA(a,43,Tk(!1)),UA(a,130,Ek(1)),UA(a,128,function(e){var t=CS(8);return t.write_shift(4,0),t.write_shift(2,e[0]?e[0]+1:0),t.write_shift(2,e[1]?e[1]+1:0),t}([0,0])),UA(a,131,Tk(!1)),UA(a,132,Tk(!1)),u&&HA(a,s["!cols"]),UA(a,512,function(e,t){var n=8!=t.biff&&t.biff?2:4,r=CS(2*n+6);return r.write_shift(n,e.s.r),r.write_shift(n,e.e.r+1),r.write_shift(2,e.s.c),r.write_shift(2,e.e.c+1),r.write_shift(2,0),r}(d,t)),u&&(s["!links"]=[]);for(var m=d.s.r;m<=d.e.r;++m){h=MS(m);for(var g=d.s.c;g<=d.e.c;++g){m===d.s.r&&(f[g]=US(g)),r=f[g]+h;var v=c?(s[m]||[])[g]:s[r];v&&(WA(a,v,m,g,t),u&&v.l&&s["!links"].push([r,v.l]))}}var y=l.CodeName||l.name||i;return u&&UA(a,574,function(e){var t=CS(18),n=1718;return e&&e.RTL&&(n|=64),t.write_shift(2,n),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}((o.Views||[])[0])),u&&(s["!merges"]||[]).length&&UA(a,229,function(e){var t=CS(2+8*e.length);t.write_shift(2,e.length);for(var n=0;n<e.length;++n)Wk(e[n],t);return t}(s["!merges"])),u&&function(e,t){for(var n=0;n<t["!links"].length;++n){var r=t["!links"][n];UA(e,440,f_(r)),r[1].Tooltip&&UA(e,2048,d_(r))}delete t["!links"]}(a,s),UA(a,442,Ok(y)),u&&function(e,t){var n=CS(19);n.write_shift(4,2151),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,1),n.write_shift(4,0),UA(e,2151,n),(n=CS(39)).write_shift(4,2152),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,0),n.write_shift(4,0),n.write_shift(2,1),n.write_shift(4,4),n.write_shift(2,0),Wk(HS(t["!ref"]||"A1"),n),n.write_shift(4,4),UA(e,2152,n)}(a,s),UA(a,10),a.end()}function KA(e,t,n){var r=AS(),a=(e||{}).Workbook||{},i=a.Sheets||[],s=a.WBProps||{},o=8==n.biff,l=5==n.biff;(UA(r,2057,Qk(0,5,n)),"xla"==n.bookType&&UA(r,135),UA(r,225,o?Ek(1200):null),UA(r,193,function(e,t){t||(t=CS(e));for(var n=0;n<e;++n)t.write_shift(1,0);return t}(2)),l&&UA(r,191),l&&UA(r,192),UA(r,226),UA(r,92,function(e,t){var n=!t||8==t.biff,r=CS(n?112:54);for(r.write_shift(8==t.biff?2:1,7),n&&r.write_shift(1,0),r.write_shift(4,859007059),r.write_shift(4,5458548|(n?0:536870912));r.l<r.length;)r.write_shift(1,n?0:32);return r}(0,n)),UA(r,66,Ek(o?1200:1252)),o&&UA(r,353,Ek(0)),o&&UA(r,448),UA(r,317,function(e){for(var t=CS(2*e),n=0;n<e;++n)t.write_shift(2,n+1);return t}(e.SheetNames.length)),o&&e.vbaraw&&UA(r,211),o&&e.vbaraw)&&UA(r,442,Ok(s.CodeName||"ThisWorkbook"));UA(r,156,Ek(17)),UA(r,25,Tk(!1)),UA(r,18,Tk(!1)),UA(r,19,Ek(0)),o&&UA(r,431,Tk(!1)),o&&UA(r,444,Ek(0)),UA(r,61,function(){var e=CS(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}()),UA(r,64,Tk(!1)),UA(r,141,Ek(0)),UA(r,34,Tk("true"==function(e){return e.Workbook&&e.Workbook.WBProps&&aT(e.Workbook.WBProps.date1904)?"true":"false"}(e))),UA(r,14,Tk(!0)),o&&UA(r,439,Tk(!1)),UA(r,218,Ek(0)),BA(r,0,n),function(e,t,n){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)null!=t[a]&&UA(e,1054,e_(a,t[a],n))})}(r,e.SSF,n),function(e,t){for(var n=0;n<16;++n)UA(e,224,r_({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){UA(e,224,r_(n,0,t))})}(r,n),o&&UA(r,352,Tk(!1));var c,u=r.end(),h=AS();o&&UA(h,140,(c||(c=CS(4)),c.write_shift(2,1),c.write_shift(2,1),c)),o&&n.Strings&&function(e,t,n,r){var a=r||(n||[]).length||0;if(a<=8224)return UA(e,t,n,a);var i=t;if(!isNaN(i)){for(var s=n.parts||[],o=0,l=0,c=0;c+(s[o]||8224)<=8224;)c+=s[o]||8224,o++;var u=e.next(4);for(u.write_shift(2,i),u.write_shift(2,c),e.push(n.slice(l,l+c)),l+=c;l<a;){for((u=e.next(4)).write_shift(2,60),c=0;c+(s[o]||8224)<=8224;)c+=s[o]||8224,o++;u.write_shift(2,c),e.push(n.slice(l,l+c)),l+=c}}}(h,252,function(e){var t=CS(8);t.write_shift(4,e.Count),t.write_shift(4,e.Unique);for(var n=[],r=0;r<e.length;++r)n[r]=Ik(e[r]);var a=ib([t].concat(n));return a.parts=[t.length].concat(n.map(function(e){return e.length})),a}(n.Strings)),UA(h,10);var f=h.end(),d=AS(),p=0,m=0;for(m=0;m<e.SheetNames.length;++m)p+=(o?12:11)+(o?2:1)*e.SheetNames[m].length;var g=u.length+p+f.length;for(m=0;m<e.SheetNames.length;++m){UA(d,133,Jk({pos:g,hs:(i[m]||{}).Hidden||0,dt:0,name:e.SheetNames[m]},n)),g+=t[m].length}var v=d.end();if(p!=v.length)throw new Error("BS8 "+p+" != "+v.length);var y=[];return u.length&&y.push(u),v.length&&y.push(v),f.length&&y.push(f),ib(y)}function qA(e,t){for(var n=0;n<=e.SheetNames.length;++n){var r=e.Sheets[e.SheetNames[n]];if(r&&r["!ref"])zS(r["!ref"]).e.c>255&&"undefined"!=typeof console&&console.error&&console.error("Worksheet '"+e.SheetNames[n]+"' extends beyond column IV (255).  Data may be lost.")}var a=t||{};switch(a.biff||2){case 8:case 5:return function(e,t){var n=t||{},r=[];e&&!e.SSF&&(e.SSF=Sw(vb)),e&&e.SSF&&(Jb(),Qb(e.SSF),n.revssf=cw(e.SSF),n.revssf[e.SSF[65535]]=0,n.ssf=e.SSF),n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,VN(n),n.cellXfs=[],QC(n.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)r[r.length]=GA(a,n,e);return r.unshift(KA(e,r,n)),ib(r)}(e,t);case 4:case 3:case 2:return zA(e,t)}throw new Error("invalid type "+a.bookType+" for BIFF")}function $A(e,t){var n=t||{};var r=n.dense?[]:{},a=(e=e.replace(/<!--.*?-->/g,"")).match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),s=a.index,o=i&&i.index||e.length,l=Cw(e.slice(s,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,u=0,h=0,f=0,d={s:{r:1e7,c:1e7},e:{r:0,c:0}},p=[];for(s=0;s<l.length;++s){var m=l[s].trim(),g=m.slice(0,3).toLowerCase();if("<tr"!=g){if("<td"==g||"<th"==g){var v=m.split(/<\/t[dh]>/i);for(o=0;o<v.length;++o){var y=v[o].trim();if(y.match(/<t[dh]/i)){for(var b=y,w=0;"<"==b.charAt(0)&&(w=b.indexOf(">"))>-1;)b=b.slice(w+1);for(var T=0;T<p.length;++T){var S=p[T];S.s.c==u&&S.s.r<c&&c<=S.e.r&&(u=S.e.c+1,T=-1)}var E=Kw(y.slice(0,y.indexOf(">")));f=E.colspan?+E.colspan:1,((h=+E.rowspan)>1||f>1)&&p.push({s:{r:c,c:u},e:{r:c+(h||1)-1,c:u+f-1}});var k=E.t||E["data-t"]||"";if(b.length)if(b=fT(b),d.s.r>c&&(d.s.r=c),d.e.r<c&&(d.e.r=c),d.s.c>u&&(d.s.c=u),d.e.c<u&&(d.e.c=u),b.length){var _={t:"s",v:b};n.raw||!b.trim().length||"s"==k||("TRUE"===b?_={t:"b",v:!0}:"FALSE"===b?_={t:"b",v:!1}:isNaN(kw(b))?isNaN(xw(b).getDate())||(_={t:"d",v:ww(b)},n.cellDates||(_={t:"n",v:hw(_.v)}),_.z=n.dateNF||vb[14]):_={t:"n",v:kw(b)}),n.dense?(r[c]||(r[c]=[]),r[c][u]=_):r[VS({r:c,c:u})]=_,u+=f}else u+=f;else u+=f}}}}else{if(++c,n.sheetRows&&n.sheetRows<=c){--c;break}u=0}}return r["!ref"]=BS(d),p.length&&(r["!merges"]=p),r}function XA(e,t,n,r){for(var a=e["!merges"]||[],i=[],s=t.s.c;s<=t.e.c;++s){for(var o=0,l=0,c=0;c<a.length;++c)if(!(a[c].s.r>n||a[c].s.c>s)&&!(a[c].e.r<n||a[c].e.c<s)){if(a[c].s.r<n||a[c].s.c<s){o=-1;break}o=a[c].e.r-a[c].s.r+1,l=a[c].e.c-a[c].s.c+1;break}if(!(o<0)){var u=VS({r:n,c:s}),h=r.dense?(e[n]||[])[s]:e[u],f=h&&null!=h.v&&(h.h||nT(h.w||(GS(h),h.w)||""))||"",d={};o>1&&(d.rowspan=o),l>1&&(d.colspan=l),r.editable?f='<span contenteditable="true">'+f+"</span>":h&&(d["data-t"]=h&&h.t||"z",null!=h.v&&(d["data-v"]=h.v),null!=h.z&&(d["data-z"]=h.z),h.l&&"#"!=(h.l.Target||"#").charAt(0)&&(f='<a href="'+h.l.Target+'">'+f+"</a>")),d.id=(r.id||"sjs")+"-"+u,i.push(wT("td",f,d))}}return"<tr>"+i.join("")+"</tr>"}var YA='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',QA="</body></html>";function JA(e,t,n){return[].join("")+"<table"+(n&&n.id?' id="'+n.id+'"':"")+">"}function ZA(e,t){var n=t||{},r=null!=n.header?n.header:YA,a=null!=n.footer?n.footer:QA,i=[r],s=zS(e["!ref"]);n.dense=Array.isArray(e),i.push(JA(0,0,n));for(var o=s.s.r;o<=s.e.r;++o)i.push(XA(e,s,o,n));return i.push("</table>"+a),i.join("")}function eN(e,t,n){var r=n||{};var a=0,i=0;if(null!=r.origin)if("number"==typeof r.origin)a=r.origin;else{var s="string"==typeof r.origin?jS(r.origin):r.origin;a=s.r,i=s.c}var o=t.getElementsByTagName("tr"),l=Math.min(r.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:a,c:i}};if(e["!ref"]){var u=zS(e["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),-1==a&&(c.e.r=a=u.e.r+1)}var h=[],f=0,d=e["!rows"]||(e["!rows"]=[]),p=0,m=0,g=0,v=0,y=0,b=0;for(e["!cols"]||(e["!cols"]=[]);p<o.length&&m<l;++p){var w=o[p];if(nN(w)){if(r.display)continue;d[m]={hidden:!0}}var T=w.children;for(g=v=0;g<T.length;++g){var S=T[g];if(!r.display||!nN(S)){var E=S.hasAttribute("data-v")?S.getAttribute("data-v"):S.hasAttribute("v")?S.getAttribute("v"):fT(S.innerHTML),k=S.getAttribute("data-z")||S.getAttribute("z");for(f=0;f<h.length;++f){var _=h[f];_.s.c==v+i&&_.s.r<m+a&&m+a<=_.e.r&&(v=_.e.c+1-i,f=-1)}b=+S.getAttribute("colspan")||1,((y=+S.getAttribute("rowspan")||1)>1||b>1)&&h.push({s:{r:m+a,c:v+i},e:{r:m+a+(y||1)-1,c:v+i+(b||1)-1}});var x={t:"s",v:E},C=S.getAttribute("data-t")||S.getAttribute("t")||"";null!=E&&(0==E.length?x.t=C||"z":r.raw||0==E.trim().length||"s"==C||("TRUE"===E?x={t:"b",v:!0}:"FALSE"===E?x={t:"b",v:!1}:isNaN(kw(E))?isNaN(xw(E).getDate())||(x={t:"d",v:ww(E)},r.cellDates||(x={t:"n",v:hw(x.v)}),x.z=r.dateNF||vb[14]):x={t:"n",v:kw(E)})),void 0===x.z&&null!=k&&(x.z=k);var I="",A=S.getElementsByTagName("A");if(A&&A.length)for(var N=0;N<A.length&&(!A[N].hasAttribute("href")||"#"==(I=A[N].getAttribute("href")).charAt(0));++N);I&&"#"!=I.charAt(0)&&(x.l={Target:I}),r.dense?(e[m+a]||(e[m+a]=[]),e[m+a][v+i]=x):e[VS({c:v+i,r:m+a})]=x,c.e.c<v+i&&(c.e.c=v+i),v+=b}}++m}return h.length&&(e["!merges"]=(e["!merges"]||[]).concat(h)),c.e.r=Math.max(c.e.r,m-1+a),e["!ref"]=BS(c),m>=l&&(e["!fullref"]=BS((c.e.r=o.length-p+m-1+a,c))),e}function tN(e,t){return eN((t||{}).dense?[]:{},e,t)}function nN(e){var t="",n=function(e){return e.ownerDocument.defaultView&&"function"===typeof e.ownerDocument.defaultView.getComputedStyle?e.ownerDocument.defaultView.getComputedStyle:"function"===typeof getComputedStyle?getComputedStyle:null}(e);return n&&(t=n(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),"none"===t}function rN(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(e,t){return Array(parseInt(t,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"\t").replace(/<text:line-break\/>/g,"\n");return[Yw(t.replace(/<[^>]*>/g,""))]}var aN={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function iN(e,t){var n=t||{};var r,a,i,s,o,l,c=ST(e),u=[],h={name:""},f="",d=0,p={},m=[],g=n.dense?[]:{},v={value:""},y="",b=0,w=[],T=-1,S=-1,E={s:{r:1e6,c:1e7},e:{r:0,c:0}},k=0,_={},x=[],C={},I=[],A=1,N=1,R=[],O={Names:[]},P={},D=["",""],L=[],M={},F="",U=0,j=!1,V=!1,z=0;for(ET.lastIndex=0,c=c.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");o=ET.exec(c);)switch(o[3]=o[3].replace(/_.*$/,"")){case"table":case"\u5de5\u4f5c\u8868":"/"===o[1]?(E.e.c>=E.s.c&&E.e.r>=E.s.r?g["!ref"]=BS(E):g["!ref"]="A1:A1",n.sheetRows>0&&n.sheetRows<=E.e.r&&(g["!fullref"]=g["!ref"],E.e.r=n.sheetRows-1,g["!ref"]=BS(E)),x.length&&(g["!merges"]=x),I.length&&(g["!rows"]=I),i.name=i["\u540d\u79f0"]||i.name,"undefined"!==typeof JSON&&JSON.stringify(i),m.push(i.name),p[i.name]=g,V=!1):"/"!==o[0].charAt(o[0].length-2)&&(i=Kw(o[0],!1),T=S=-1,E.s.r=E.s.c=1e7,E.e.r=E.e.c=0,g=n.dense?[]:{},x=[],I=[],V=!0);break;case"table-row-group":"/"===o[1]?--k:++k;break;case"table-row":case"\u884c":if("/"===o[1]){T+=A,A=1;break}if((s=Kw(o[0],!1))["\u884c\u53f7"]?T=s["\u884c\u53f7"]-1:-1==T&&(T=0),(A=+s["number-rows-repeated"]||1)<10)for(z=0;z<A;++z)k>0&&(I[T+z]={level:k});S=-1;break;case"covered-table-cell":"/"!==o[1]&&++S,n.sheetStubs&&(n.dense?(g[T]||(g[T]=[]),g[T][S]={t:"z"}):g[VS({r:T,c:S})]={t:"z"}),y="",w=[];break;case"table-cell":case"\u6570\u636e":if("/"===o[0].charAt(o[0].length-2))++S,v=Kw(o[0],!1),N=parseInt(v["number-columns-repeated"]||"1",10),l={t:"z",v:null},v.formula&&0!=n.cellFormula&&(l.f=zC(Yw(v.formula))),"string"==(v["\u6570\u636e\u7c7b\u578b"]||v["value-type"])&&(l.t="s",l.v=Yw(v["string-value"]||""),n.dense?(g[T]||(g[T]=[]),g[T][S]=l):g[VS({r:T,c:S})]=l),S+=N-1;else if("/"!==o[1]){y="",b=0,w=[],N=1;var B=A?T+A-1:T;if(++S>E.e.c&&(E.e.c=S),S<E.s.c&&(E.s.c=S),T<E.s.r&&(E.s.r=T),B>E.e.r&&(E.e.r=B),L=[],M={},l={t:(v=Kw(o[0],!1))["\u6570\u636e\u7c7b\u578b"]||v["value-type"],v:null},n.cellFormula)if(v.formula&&(v.formula=Yw(v.formula)),v["number-matrix-columns-spanned"]&&v["number-matrix-rows-spanned"]&&(C={s:{r:T,c:S},e:{r:T+(parseInt(v["number-matrix-rows-spanned"],10)||0)-1,c:S+(parseInt(v["number-matrix-columns-spanned"],10)||0)-1}},l.F=BS(C),R.push([C,l.F])),v.formula)l.f=zC(v.formula);else for(z=0;z<R.length;++z)T>=R[z][0].s.r&&T<=R[z][0].e.r&&S>=R[z][0].s.c&&S<=R[z][0].e.c&&(l.F=R[z][1]);switch((v["number-columns-spanned"]||v["number-rows-spanned"])&&(C={s:{r:T,c:S},e:{r:T+(parseInt(v["number-rows-spanned"],10)||0)-1,c:S+(parseInt(v["number-columns-spanned"],10)||0)-1}},x.push(C)),v["number-columns-repeated"]&&(N=parseInt(v["number-columns-repeated"],10)),l.t){case"boolean":l.t="b",l.v=aT(v["boolean-value"]);break;case"float":case"percentage":case"currency":l.t="n",l.v=parseFloat(v.value);break;case"date":l.t="d",l.v=ww(v["date-value"]),n.cellDates||(l.t="n",l.v=hw(l.v)),l.z="m/d/yy";break;case"time":l.t="n",l.v=gw(v["time-value"])/86400,n.cellDates&&(l.t="d",l.v=mw(l.v)),l.z="HH:MM:SS";break;case"number":l.t="n",l.v=parseFloat(v["\u6570\u636e\u6570\u503c"]);break;default:if("string"!==l.t&&"text"!==l.t&&l.t)throw new Error("Unsupported value type "+l.t);l.t="s",null!=v["string-value"]&&(y=Yw(v["string-value"]),w=[])}}else{if(j=!1,"s"===l.t&&(l.v=y||"",w.length&&(l.R=w),j=0==b),P.Target&&(l.l=P),L.length>0&&(l.c=L,L=[]),y&&!1!==n.cellText&&(l.w=y),j&&(l.t="z",delete l.v),(!j||n.sheetStubs)&&!(n.sheetRows&&n.sheetRows<=T))for(var H=0;H<A;++H){if(N=parseInt(v["number-columns-repeated"]||"1",10),n.dense)for(g[T+H]||(g[T+H]=[]),g[T+H][S]=0==H?l:Sw(l);--N>0;)g[T+H][S+N]=Sw(l);else for(g[VS({r:T+H,c:S})]=l;--N>0;)g[VS({r:T+H,c:S+N})]=Sw(l);E.e.c<=S&&(E.e.c=S)}S+=(N=parseInt(v["number-columns-repeated"]||"1",10))-1,N=0,l={},y="",w=[]}P={};break;case"document":case"document-content":case"\u7535\u5b50\u8868\u683c\u6587\u6863":case"spreadsheet":case"\u4e3b\u4f53":case"scripts":case"styles":case"font-face-decls":case"master-styles":if("/"===o[1]){if((r=u.pop())[0]!==o[3])throw"Bad state: "+r}else"/"!==o[0].charAt(o[0].length-2)&&u.push([o[3],!0]);break;case"annotation":if("/"===o[1]){if((r=u.pop())[0]!==o[3])throw"Bad state: "+r;M.t=y,w.length&&(M.R=w),M.a=F,L.push(M)}else"/"!==o[0].charAt(o[0].length-2)&&u.push([o[3],!1]);F="",U=0,y="",b=0,w=[];break;case"creator":"/"===o[1]?F=c.slice(U,o.index):U=o.index+o[0].length;break;case"meta":case"\u5143\u6570\u636e":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if("/"===o[1]){if((r=u.pop())[0]!==o[3])throw"Bad state: "+r}else"/"!==o[0].charAt(o[0].length-2)&&u.push([o[3],!1]);y="",b=0,w=[];break;case"scientific-number":case"currency-symbol":case"currency-style":case"script":case"libraries":case"automatic-styles":case"default-style":case"page-layout":case"style":case"map":case"font-face":case"paragraph-properties":case"table-properties":case"table-column-properties":case"table-row-properties":case"table-cell-properties":case"fraction":case"boolean-style":case"boolean":case"text-style":case"text-content":case"text-properties":case"embedded-text":case"body":case"\u7535\u5b50\u8868\u683c":case"forms":case"table-column":case"table-header-rows":case"table-rows":case"table-column-group":case"table-header-columns":case"table-columns":case"null-date":case"graphic-properties":case"calculation-settings":case"named-expressions":case"label-range":case"label-ranges":case"named-expression":case"sort":case"sort-by":case"sort-groups":case"tab":case"line-break":case"span":case"s":case"date":case"object":case"title":case"\u6807\u9898":case"desc":case"binary-data":case"table-source":case"scenario":case"iteration":case"content-validations":case"content-validation":case"help-message":case"error-message":case"database-ranges":case"filter":case"filter-and":case"filter-or":case"filter-condition":case"list-level-style-bullet":case"list-level-style-number":case"list-level-properties":case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":case"event-listener":case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":case"config-item":case"page-number":case"page-count":case"time":case"cell-range-source":case"detective":case"operation":case"highlighted-range":case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":case"rect":case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":case"properties":case"property":case"table-protection":case"data-pilot-grand-total":case"office-document-common-attrs":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if("/"===o[1]){if(_[h.name]=f,(r=u.pop())[0]!==o[3])throw"Bad state: "+r}else"/"!==o[0].charAt(o[0].length-2)&&(f="",h=Kw(o[0],!1),u.push([o[3],!0]));break;case"number":case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(u[u.length-1][0]){case"time-style":case"date-style":a=Kw(o[0],!1),f+=aN[o[3]]["long"===a.style?1:0]}break;case"text":if("/>"===o[0].slice(-2))break;if("/"===o[1])switch(u[u.length-1][0]){case"number-style":case"date-style":case"time-style":f+=c.slice(d,o.index)}else d=o.index+o[0].length;break;case"named-range":D=HC((a=Kw(o[0],!1))["cell-range-address"]);var W={Name:a.name,Ref:D[0]+"!"+D[1]};V&&(W.Sheet=m.length),O.Names.push(W);break;case"p":case"\u6587\u672c\u4e32":if(["master-styles"].indexOf(u[u.length-1][0])>-1)break;if("/"!==o[1]||v&&v["string-value"])Kw(o[0],!1),b=o.index+o[0].length;else{var G=rN(c.slice(b,o.index));y=(y.length>0?y+"\n":"")+G[0]}break;case"database-range":if("/"===o[1])break;try{p[(D=HC(Kw(o[0])["target-range-address"]))[0]]["!autofilter"]={ref:D[1]}}catch(AR){}break;case"a":if("/"!==o[1]){if(!(P=Kw(o[0],!1)).href)break;P.Target=Yw(P.href),delete P.href,"#"==P.Target.charAt(0)&&P.Target.indexOf(".")>-1?(D=HC(P.Target.slice(1)),P.Target="#"+D[0]+"!"+D[1]):P.Target.match(/^\.\.[\\\/]/)&&(P.Target=P.Target.slice(3))}break;default:switch(o[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"\u8868:":case"\u5b57:":break;default:if(n.WTF)throw new Error(o)}}var K={Sheets:p,SheetNames:m,Workbook:O};return n.bookSheets&&delete K.Sheets,K}function sN(e,t){t=t||{},Nw(e,"META-INF/manifest.xml")&&function(e,t){for(var n,r,a=ST(e);n=ET.exec(a);)switch(n[3]){case"manifest":break;case"file-entry":if("/"==(r=Kw(n[0],!1)).path&&"application/vnd.oasis.opendocument.spreadsheet"!==r.type)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}(Ow(e,"META-INF/manifest.xml"),t);var n=Pw(e,"content.xml");if(!n)throw new Error("Missing content.xml in ODS / UOF file");var r=iN(cT(n),t);return Nw(e,"meta.xml")&&(r.Props=GE(Ow(e,"meta.xml"))),r}function oN(e,t){return iN(e,t)}var lN=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+bT({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Vw+t}}(),cN=function(){var e=function(e){return Zw(e).replace(/  +/g,function(e){return'<text:s text:c="'+e.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t="          <table:table-cell />\n",n=function(n,r,a){var i=[];i.push('      <table:table table:name="'+Zw(r.SheetNames[a])+'" table:style-name="ta1">\n');var s=0,o=0,l=zS(n["!ref"]||"A1"),c=n["!merges"]||[],u=0,h=Array.isArray(n);if(n["!cols"])for(o=0;o<=l.e.c;++o)i.push("        <table:table-column"+(n["!cols"][o]?' table:style-name="co'+n["!cols"][o].ods+'"':"")+"></table:table-column>\n");var f="",d=n["!rows"]||[];for(s=0;s<l.s.r;++s)f=d[s]?' table:style-name="ro'+d[s].ods+'"':"",i.push("        <table:table-row"+f+"></table:table-row>\n");for(;s<=l.e.r;++s){for(f=d[s]?' table:style-name="ro'+d[s].ods+'"':"",i.push("        <table:table-row"+f+">\n"),o=0;o<l.s.c;++o)i.push(t);for(;o<=l.e.c;++o){var p=!1,m={},g="";for(u=0;u!=c.length;++u)if(!(c[u].s.c>o)&&!(c[u].s.r>s)&&!(c[u].e.c<o)&&!(c[u].e.r<s)){c[u].s.c==o&&c[u].s.r==s||(p=!0),m["table:number-columns-spanned"]=c[u].e.c-c[u].s.c+1,m["table:number-rows-spanned"]=c[u].e.r-c[u].s.r+1;break}if(p)i.push("          <table:covered-table-cell/>\n");else{var v=VS({r:s,c:o}),y=h?(n[s]||[])[o]:n[v];if(y&&y.f&&(m["table:formula"]=Zw(BC(y.f)),y.F&&y.F.slice(0,v.length)==v)){var b=zS(y.F);m["table:number-matrix-columns-spanned"]=b.e.c-b.s.c+1,m["table:number-matrix-rows-spanned"]=b.e.r-b.s.r+1}if(y){switch(y.t){case"b":g=y.v?"TRUE":"FALSE",m["office:value-type"]="boolean",m["office:boolean-value"]=y.v?"true":"false";break;case"n":g=y.w||String(y.v||0),m["office:value-type"]="float",m["office:value"]=y.v||0;break;case"s":case"str":g=null==y.v?"":y.v,m["office:value-type"]="string";break;case"d":g=y.w||ww(y.v).toISOString(),m["office:value-type"]="date",m["office:date-value"]=ww(y.v).toISOString(),m["table:style-name"]="ce1";break;default:i.push(t);continue}var w=e(g);if(y.l&&y.l.Target){var T=y.l.Target;"#"==(T="#"==T.charAt(0)?"#"+WC(T.slice(1)):T).charAt(0)||T.match(/^\w+:/)||(T="../"+T),w=wT("text:a",w,{"xlink:href":T.replace(/&/g,"&amp;")})}i.push("          "+wT("table:table-cell",wT("text:p",w,{}),m)+"\n")}else i.push(t)}}i.push("        </table:table-row>\n")}return i.push("      </table:table>\n"),i.join("")};return function(e,t){var r=[Vw],a=bT({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),i=bT({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});"fods"==t.bookType?(r.push("<office:document"+a+i+">\n"),r.push(BE().replace(/office:document-meta/g,"office:meta"))):r.push("<office:document-content"+a+">\n"),function(e,t){e.push(" <office:automatic-styles>\n"),e.push('  <number:date-style style:name="N37" number:automatic-order="true">\n'),e.push('   <number:month number:style="long"/>\n'),e.push("   <number:text>/</number:text>\n"),e.push('   <number:day number:style="long"/>\n'),e.push("   <number:text>/</number:text>\n"),e.push("   <number:year/>\n"),e.push("  </number:date-style>\n");var n=0;t.SheetNames.map(function(e){return t.Sheets[e]}).forEach(function(t){if(t&&t["!cols"])for(var r=0;r<t["!cols"].length;++r)if(t["!cols"][r]){var a=t["!cols"][r];if(null==a.width&&null==a.wpx&&null==a.wch)continue;sx(a),a.ods=n;var i=t["!cols"][r].wpx+"px";e.push('  <style:style style:name="co'+n+'" style:family="table-column">\n'),e.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+i+'"/>\n'),e.push("  </style:style>\n"),++n}});var r=0;t.SheetNames.map(function(e){return t.Sheets[e]}).forEach(function(t){if(t&&t["!rows"])for(var n=0;n<t["!rows"].length;++n)if(t["!rows"][n]){t["!rows"][n].ods=r;var a=t["!rows"][n].hpx+"px";e.push('  <style:style style:name="ro'+r+'" style:family="table-row">\n'),e.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+a+'"/>\n'),e.push("  </style:style>\n"),++r}}),e.push('  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">\n'),e.push('   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>\n'),e.push("  </style:style>\n"),e.push('  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>\n'),e.push(" </office:automatic-styles>\n")}(r,e),r.push("  <office:body>\n"),r.push("    <office:spreadsheet>\n");for(var s=0;s!=e.SheetNames.length;++s)r.push(n(e.Sheets[e.SheetNames[s]],e,s));return r.push("    </office:spreadsheet>\n"),r.push("  </office:body>\n"),"fods"==t.bookType?r.push("</office:document>"):r.push("</office:document-content>"),r.join("")}}();function uN(e,t){if("fods"==t.bookType)return cN(e,t);var n=Fw(),r="",a=[],i=[];return Mw(n,r="mimetype","application/vnd.oasis.opendocument.spreadsheet"),Mw(n,r="content.xml",cN(e,t)),a.push([r,"text/xml"]),i.push([r,"ContentFile"]),Mw(n,r="styles.xml",lN(e,t)),a.push([r,"text/xml"]),i.push([r,"StylesFile"]),Mw(n,r="meta.xml",Vw+BE()),a.push([r,"text/xml"]),i.push([r,"MetadataFile"]),Mw(n,r="manifest.rdf",function(e){var t=[Vw];t.push('<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">\n');for(var n=0;n!=e.length;++n)t.push(VE(e[n][0],e[n][1])),t.push(zE("",e[n][0]));return t.push(VE("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}(i)),a.push([r,"application/rdf+xml"]),Mw(n,r="META-INF/manifest.xml",function(e){var t=[Vw];t.push('<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">\n'),t.push('  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>\n');for(var n=0;n<e.length;++n)t.push('  <manifest:file-entry manifest:full-path="'+e[n][0]+'" manifest:media-type="'+e[n][1]+'"/>\n');return t.push("</manifest:manifest>"),t.join("")}(a)),n}function hN(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function fN(e){return"undefined"!=typeof TextDecoder?(new TextDecoder).decode(e):cT(rb(e))}function dN(e){return"undefined"!=typeof TextEncoder?(new TextEncoder).encode(e):tb(uT(e))}function pN(e){var t=e.reduce(function(e,t){return e+t.length},0),n=new Uint8Array(t),r=0;return e.forEach(function(e){n.set(e,r),r+=e.length}),n}function mN(e){return 16843009*((e=(858993459&(e-=e>>1&1431655765))+(e>>2&858993459))+(e>>4)&252645135)>>>24}function gN(e,t){var n=t?t[0]:0,r=127&e[n];e:if(e[n++]>=128){if(r|=(127&e[n])<<7,e[n++]<128)break e;if(r|=(127&e[n])<<14,e[n++]<128)break e;if(r|=(127&e[n])<<21,e[n++]<128)break e;if(r+=(127&e[n])*Math.pow(2,28),++n,e[n++]<128)break e;if(r+=(127&e[n])*Math.pow(2,35),++n,e[n++]<128)break e;if(r+=(127&e[n])*Math.pow(2,42),++n,e[n++]<128)break e}return t&&(t[0]=n),r}function vN(e){var t=new Uint8Array(7);t[0]=127&e;var n=1;e:if(e>127){if(t[n-1]|=128,t[n]=e>>7&127,++n,e<=16383)break e;if(t[n-1]|=128,t[n]=e>>14&127,++n,e<=2097151)break e;if(t[n-1]|=128,t[n]=e>>21&127,++n,e<=268435455)break e;if(t[n-1]|=128,t[n]=e/256>>>21&127,++n,e<=34359738367)break e;if(t[n-1]|=128,t[n]=e/65536>>>21&127,++n,e<=4398046511103)break e;t[n-1]|=128,t[n]=e/16777216>>>21&127,++n}return t.slice(0,n)}function yN(e){var t=0,n=127&e[t];e:if(e[t++]>=128){if(n|=(127&e[t])<<7,e[t++]<128)break e;if(n|=(127&e[t])<<14,e[t++]<128)break e;if(n|=(127&e[t])<<21,e[t++]<128)break e;n|=(127&e[t])<<28}return n}function bN(e){for(var t=[],n=[0];n[0]<e.length;){var r,a=n[0],i=gN(e,n),s=7&i,o=0;if(0==(i=Math.floor(i/8)))break;switch(s){case 0:for(var l=n[0];e[n[0]++]>=128;);r=e.slice(l,n[0]);break;case 5:o=4,r=e.slice(n[0],n[0]+o),n[0]+=o;break;case 1:o=8,r=e.slice(n[0],n[0]+o),n[0]+=o;break;case 2:o=gN(e,n),r=e.slice(n[0],n[0]+o),n[0]+=o;break;default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(a))}var c={data:r,type:s};null==t[i]?t[i]=[c]:t[i].push(c)}return t}function wN(e){var t=[];return e.forEach(function(e,n){e.forEach(function(e){e.data&&(t.push(vN(8*n+e.type)),2==e.type&&t.push(vN(e.data.length)),t.push(e.data))})}),pN(t)}function TN(e,t){return(null==e?void 0:e.map(function(e){return t(e.data)}))||[]}function SN(e){for(var t,n=[],r=[0];r[0]<e.length;){var a=gN(e,r),i=bN(e.slice(r[0],r[0]+a));r[0]+=a;var s={id:yN(i[1][0].data),messages:[]};i[2].forEach(function(t){var n=bN(t.data),a=yN(n[3][0].data);s.messages.push({meta:n,data:e.slice(r[0],r[0]+a)}),r[0]+=a}),(null==(t=i[3])?void 0:t[0])&&(s.merge=yN(i[3][0].data)>>>0>0),n.push(s)}return n}function EN(e){var t=[];return e.forEach(function(e){var n=[];n[1]=[{data:vN(e.id),type:0}],n[2]=[],null!=e.merge&&(n[3]=[{data:vN(+!!e.merge),type:0}]);var r=[];e.messages.forEach(function(e){r.push(e.data),e.meta[3]=[{type:0,data:vN(e.data.length)}],n[2].push({data:wN(e.meta),type:2})});var a=wN(n);t.push(vN(a.length)),t.push(a),r.forEach(function(e){return t.push(e)})}),pN(t)}function kN(e,t){if(0!=e)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var n=[0],r=gN(t,n),a=[];n[0]<t.length;){var i=3&t[n[0]];if(0!=i){var s=0,o=0;if(1==i?(o=4+(t[n[0]]>>2&7),s=(224&t[n[0]++])<<3,s|=t[n[0]++]):(o=1+(t[n[0]++]>>2),2==i?(s=t[n[0]]|t[n[0]+1]<<8,n[0]+=2):(s=(t[n[0]]|t[n[0]+1]<<8|t[n[0]+2]<<16|t[n[0]+3]<<24)>>>0,n[0]+=4)),a=[pN(a)],0==s)throw new Error("Invalid offset 0");if(s>a[0].length)throw new Error("Invalid offset beyond length");if(o>=s)for(a.push(a[0].slice(-s)),o-=s;o>=a[a.length-1].length;)a.push(a[a.length-1]),o-=a[a.length-1].length;a.push(a[0].slice(-s,-s+o))}else{var l=t[n[0]++]>>2;if(l<60)++l;else{var c=l-59;l=t[n[0]],c>1&&(l|=t[n[0]+1]<<8),c>2&&(l|=t[n[0]+2]<<16),c>3&&(l|=t[n[0]+3]<<24),l>>>=0,l++,n[0]+=c}a.push(t.slice(n[0],n[0]+l)),n[0]+=l}}var u=pN(a);if(u.length!=r)throw new Error("Unexpected length: ".concat(u.length," != ").concat(r));return u}function _N(e){for(var t=[],n=0;n<e.length;){var r=e[n++],a=e[n]|e[n+1]<<8|e[n+2]<<16;n+=3,t.push(kN(r,e.slice(n,n+a))),n+=a}if(n!==e.length)throw new Error("data is not a valid framed stream!");return pN(t)}function xN(e){for(var t=[],n=0;n<e.length;){var r=Math.min(e.length-n,268435455),a=new Uint8Array(4);t.push(a);var i=vN(r),s=i.length;t.push(i),r<=60?(s++,t.push(new Uint8Array([r-1<<2]))):r<=256?(s+=2,t.push(new Uint8Array([240,r-1&255]))):r<=65536?(s+=3,t.push(new Uint8Array([244,r-1&255,r-1>>8&255]))):r<=16777216?(s+=4,t.push(new Uint8Array([248,r-1&255,r-1>>8&255,r-1>>16&255]))):r<=4294967296&&(s+=5,t.push(new Uint8Array([252,r-1&255,r-1>>8&255,r-1>>16&255,r-1>>>24&255]))),t.push(e.slice(n,n+r)),s+=r,a[0]=0,a[1]=255&s,a[2]=s>>8&255,a[3]=s>>16&255,n+=r}return pN(t)}function CN(e,t,n){var r,a=hN(e),i=a.getUint32(8,!0),s=12,o=-1,l=-1,c=NaN,u=NaN,h=new Date(2001,0,1);switch(1&i&&(c=function(e,t){for(var n=(127&e[t+15])<<7|e[t+14]>>1,r=1&e[t+14],a=t+13;a>=t;--a)r=256*r+e[a];return(128&e[t+15]?-r:r)*Math.pow(10,n-6176)}(e,s),s+=16),2&i&&(u=a.getFloat64(s,!0),s+=8),4&i&&(h.setTime(h.getTime()+1e3*a.getFloat64(s,!0)),s+=8),8&i&&(l=a.getUint32(s,!0),s+=4),16&i&&(o=a.getUint32(s,!0),s+=4),e[1]){case 0:break;case 2:case 10:r={t:"n",v:c};break;case 3:r={t:"s",v:t[l]};break;case 5:r={t:"d",v:h};break;case 6:r={t:"b",v:u>0};break;case 7:r={t:"n",v:u/86400};break;case 8:r={t:"e",v:0};break;case 9:if(!(o>-1))throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(31&i," : ").concat(e.slice(0,4)));r={t:"s",v:n[o]};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(31&i," : ").concat(e.slice(0,4)))}return r}function IN(e,t){var n=new Uint8Array(32),r=hN(n),a=12,i=0;switch(n[0]=5,e.t){case"n":n[1]=2,function(e,t,n){var r=Math.floor(0==n?0:Math.LOG10E*Math.log(Math.abs(n)))+6176-20,a=n/Math.pow(10,r-6176);e[t+15]|=r>>7,e[t+14]|=(127&r)<<1;for(var i=0;a>=1;++i,a/=256)e[t+i]=255&a;e[t+15]|=n>=0?0:128}(n,a,e.v),i|=1,a+=16;break;case"b":n[1]=6,r.setFloat64(a,e.v?1:0,!0),i|=2,a+=8;break;case"s":if(-1==t.indexOf(e.v))throw new Error("Value ".concat(e.v," missing from SST!"));n[1]=3,r.setUint32(a,t.indexOf(e.v),!0),i|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return r.setUint32(8,i,!0),n.slice(0,a)}function AN(e,t){var n=new Uint8Array(32),r=hN(n),a=12,i=0;switch(n[0]=3,e.t){case"n":n[2]=2,r.setFloat64(a,e.v,!0),i|=32,a+=8;break;case"b":n[2]=6,r.setFloat64(a,e.v?1:0,!0),i|=32,a+=8;break;case"s":if(-1==t.indexOf(e.v))throw new Error("Value ".concat(e.v," missing from SST!"));n[2]=3,r.setUint32(a,t.indexOf(e.v),!0),i|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return r.setUint32(4,i,!0),n.slice(0,a)}function NN(e,t,n){switch(e[0]){case 0:case 1:case 2:case 3:return function(e,t,n,r){var a,i=hN(e),s=i.getUint32(4,!0),o=(r>1?12:8)+4*mN(s&(r>1?3470:398)),l=-1,c=-1,u=NaN,h=new Date(2001,0,1);switch(512&s&&(l=i.getUint32(o,!0),o+=4),o+=4*mN(s&(r>1?12288:4096)),16&s&&(c=i.getUint32(o,!0),o+=4),32&s&&(u=i.getFloat64(o,!0),o+=8),64&s&&(h.setTime(h.getTime()+1e3*i.getFloat64(o,!0)),o+=8),e[2]){case 0:break;case 2:a={t:"n",v:u};break;case 3:a={t:"s",v:t[c]};break;case 5:a={t:"d",v:h};break;case 6:a={t:"b",v:u>0};break;case 7:a={t:"n",v:u/86400};break;case 8:a={t:"e",v:0};break;case 9:if(l>-1)a={t:"s",v:n[l]};else if(c>-1)a={t:"s",v:t[c]};else{if(isNaN(u))throw new Error("Unsupported cell type ".concat(e.slice(0,4)));a={t:"n",v:u}}break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return a}(e,t,n,e[0]);case 5:return CN(e,t,n);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function RN(e){return gN(bN(e)[1][0].data)}function ON(e,t){var n=bN(t.data),r=yN(n[1][0].data),a=n[3],i=[];return(a||[]).forEach(function(t){var n=bN(t.data),a=yN(n[1][0].data)>>>0;switch(r){case 1:i[a]=fN(n[3][0].data);break;case 8:var s=bN(e[RN(n[9][0].data)][0].data),o=e[RN(s[1][0].data)][0],l=yN(o.meta[1][0].data);if(2001!=l)throw new Error("2000 unexpected reference to ".concat(l));var c=bN(o.data);i[a]=c[3].map(function(e){return fN(e.data)}).join("")}}),i}function PN(e,t){var n,r=bN(t.data),a=(null==(n=null==r?void 0:r[7])?void 0:n[0])?yN(r[7][0].data)>>>0>0?1:0:-1,i=TN(r[5],function(e){return function(e,t){var n,r,a,i,s,o,l,c,u,h,f,d,p,m,g,v,y=bN(e),b=yN(y[1][0].data)>>>0,w=yN(y[2][0].data)>>>0,T=(null==(r=null==(n=y[8])?void 0:n[0])?void 0:r.data)&&yN(y[8][0].data)>0||!1;if((null==(i=null==(a=y[7])?void 0:a[0])?void 0:i.data)&&0!=t)g=null==(o=null==(s=y[7])?void 0:s[0])?void 0:o.data,v=null==(c=null==(l=y[6])?void 0:l[0])?void 0:c.data;else{if(!(null==(h=null==(u=y[4])?void 0:u[0])?void 0:h.data)||1==t)throw"NUMBERS Tile missing ".concat(t," cell storage");g=null==(d=null==(f=y[4])?void 0:f[0])?void 0:d.data,v=null==(m=null==(p=y[3])?void 0:p[0])?void 0:m.data}for(var S=T?4:1,E=hN(g),k=[],_=0;_<g.length/2;++_){var x=E.getUint16(2*_,!0);x<65535&&k.push([_,x])}if(k.length!=w)throw"Expected ".concat(w," cells, found ").concat(k.length);var C=[];for(_=0;_<k.length-1;++_)C[k[_][0]]=v.subarray(k[_][1]*S,k[_+1][1]*S);return k.length>=1&&(C[k[k.length-1][0]]=v.subarray(k[k.length-1][1]*S)),{R:b,cells:C}}(e,a)});return{nrows:yN(r[4][0].data)>>>0,data:i.reduce(function(e,t){return e[t.R]||(e[t.R]=[]),t.cells.forEach(function(n,r){if(e[t.R][r])throw new Error("Duplicate cell r=".concat(t.R," c=").concat(r));e[t.R][r]=n}),e},[])}}function DN(e,t){var n={"!ref":"A1"},r=e[RN(bN(t.data)[2][0].data)],a=yN(r[0].meta[1][0].data);if(6001!=a)throw new Error("6000 unexpected reference to ".concat(a));return function(e,t,n){var r,a=bN(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(yN(a[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(i.e.c=(yN(a[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));n["!ref"]=BS(i);var s=bN(a[4][0].data),o=ON(e,e[RN(s[4][0].data)][0]),l=(null==(r=s[17])?void 0:r[0])?ON(e,e[RN(s[17][0].data)][0]):[],c=bN(s[3][0].data),u=0;c[1].forEach(function(t){var r=bN(t.data),a=e[RN(r[2][0].data)][0],i=yN(a.meta[1][0].data);if(6002!=i)throw new Error("6001 unexpected reference to ".concat(i));var s=PN(0,a);s.data.forEach(function(e,t){e.forEach(function(e,r){var a=VS({r:u+t,c:r}),i=NN(e,o,l);i&&(n[a]=i)})}),u+=s.nrows})}(e,r[0],n),n}function LN(e,t){var n={SheetNames:[],Sheets:{}};if(TN(bN(t.data)[1],RN).forEach(function(t){e[t].forEach(function(t){if(2==yN(t.meta[1][0].data)){var r=function(e,t){var n,r=bN(t.data),a={name:(null==(n=r[1])?void 0:n[0])?fN(r[1][0].data):"",sheets:[]};return TN(r[2],RN).forEach(function(t){e[t].forEach(function(t){6e3==yN(t.meta[1][0].data)&&a.sheets.push(DN(e,t))})}),a}(e,t);r.sheets.forEach(function(e,t){dR(n,e,0==t?r.name:r.name+"_"+t,!0)})}})}),0==n.SheetNames.length)throw new Error("Empty NUMBERS file");return n}function MN(e){var t,n,r,a,i={},s=[];if(e.FullPaths.forEach(function(e){if(e.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(e){if(e.name.match(/\.iwa$/)){var t,n;try{t=_N(e.content)}catch(AR){return console.log("?? "+e.content.length+" "+(AR.message||AR))}try{n=SN(t)}catch(AR){return console.log("## "+(AR.message||AR))}n.forEach(function(e){i[e.id]=e.messages,s.push(e.id)})}}),!s.length)throw new Error("File has no messages");var o=(null==(a=null==(r=null==(n=null==(t=null==i?void 0:i[1])?void 0:t[0])?void 0:n.meta)?void 0:r[1])?void 0:a[0].data)&&1==yN(i[1][0].meta[1][0].data)&&i[1][0];if(o||s.forEach(function(e){i[e].forEach(function(e){if(1==yN(e.meta[1][0].data)>>>0){if(o)throw new Error("Document has multiple roots");o=e}})}),!o)throw new Error("Cannot find Document root");return LN(i,o)}function FN(e,t,n){var r,a,i,s;if(!(null==(r=e[6])?void 0:r[0])||!(null==(a=e[7])?void 0:a[0]))throw"Mutation only works on post-BNC storages!";if((null==(s=null==(i=e[8])?void 0:i[0])?void 0:s.data)&&yN(e[8][0].data)>0||!1)throw"Math only works with normal offsets";for(var o=0,l=hN(e[7][0].data),c=0,u=[],h=hN(e[4][0].data),f=0,d=[],p=0;p<t.length;++p)if(null!=t[p]){var m,g;switch(l.setUint16(2*p,c,!0),h.setUint16(2*p,f,!0),typeof t[p]){case"string":m=IN({t:"s",v:t[p]},n),g=AN({t:"s",v:t[p]},n);break;case"number":m=IN({t:"n",v:t[p]},n),g=AN({t:"n",v:t[p]},n);break;case"boolean":m=IN({t:"b",v:t[p]},n),g=AN({t:"b",v:t[p]},n);break;default:throw new Error("Unsupported value "+t[p])}u.push(m),c+=m.length,d.push(g),f+=g.length,++o}else l.setUint16(2*p,65535,!0),h.setUint16(2*p,65535);for(e[2][0].data=vN(o);p<e[7][0].data.length/2;++p)l.setUint16(2*p,65535,!0),h.setUint16(2*p,65535,!0);return e[6][0].data=pN(u),e[3][0].data=pN(d),o}function UN(e){return function(t){for(var n=0;n!=e.length;++n){var r=e[n];void 0===t[r[0]]&&(t[r[0]]=r[1]),"n"===r[2]&&(t[r[0]]=Number(t[r[0]]))}}}function jN(e){UN([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function VN(e){UN([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function zN(e,t,n,r,a,i,s,o,l,c,u,h){try{i[r]=FE(Pw(e,n,!0),t);var f,d=Ow(e,t);switch(o){case"sheet":f=QI(d,t,a,l,i[r],c,u,h);break;case"chart":if(!(f=JI(d,t,a,l,i[r],c))||!f["!drawel"])break;var p=jw(f["!drawel"].Target,t),m=ME(p),g=function(e,t){if(!e)return"??";var n=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][n].Target}(Pw(e,p,!0),FE(Pw(e,m,!0),p)),v=jw(g,p),y=ME(v);f=PI(Pw(e,v,!0),0,0,FE(Pw(e,y,!0),v),0,f);break;case"macro":w=t,i[r],w.slice(-4),f={"!type":"macro"};break;case"dialog":f=function(e,t){return t.slice(-4),{"!type":"dialog"}}(0,t,0,0,i[r]);break;default:throw new Error("Unrecognized sheet type "+o)}s[r]=f;var b=[];i&&i[r]&&sw(i[r]).forEach(function(n){var a="";if(i[r][n].Type==LE.CMNT){a=jw(i[r][n].Target,t);var s=tA(Ow(e,a,!0),a,l);if(!s||!s.length)return;Gx(f,s,!1)}i[r][n].Type==LE.TCMNT&&(a=jw(i[r][n].Target,t),b=b.concat(function(e,t){var n=[],r=!1,a={},i=0;return e.replace(Hw,function(s,o){var l=Kw(s);switch(qw(l[0])){case"<?xml":case"<ThreadedComments":case"</ThreadedComments>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<threadedComment":a={author:l.personId,guid:l.id,ref:l.ref,T:1};break;case"</threadedComment>":null!=a.t&&n.push(a);break;case"<text>":case"<text":i=o+s.length;break;case"</text>":a.t=e.slice(i,o).replace(/\r\n/g,"\n").replace(/\r/g,"\n");break;case"<mentions":case"<mentions>":case"<ext":r=!0;break;case"</mentions>":case"</ext>":r=!1;break;default:if(!r&&t.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return s}),n}(Ow(e,a,!0),l)))}),b&&b.length&&Gx(f,b,!0,l.people||[])}catch(AR){if(l.WTF)throw AR}var w}function BN(e){return"/"==e.charAt(0)?e.slice(1):e}function HN(e,t){if(Jb(),jN(t=t||{}),Nw(e,"META-INF/manifest.xml"))return sN(e,t);if(Nw(e,"objectdata.xml"))return sN(e,t);if(Nw(e,"Index/Document.iwa")){if("undefined"==typeof Uint8Array)throw new Error("NUMBERS file parsing requires Uint8Array support");if(e.FileIndex)return MN(e);var n=nw.utils.cfb_new();return Lw(e).forEach(function(t){Mw(n,t,Dw(e,t))}),MN(n)}if(!Nw(e,"[Content_Types].xml")){if(Nw(e,"index.xml.gz"))throw new Error("Unsupported NUMBERS 08 file");if(Nw(e,"index.xml"))throw new Error("Unsupported NUMBERS 09 file");throw new Error("Unsupported ZIP file")}var r,a,i=Lw(e),s=function(e){var t={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};if(!e||!e.match)return t;var n={};if((e.match(Hw)||[]).forEach(function(e){var r=Kw(e);switch(r[0].replace(Ww,"<")){case"<?xml":break;case"<Types":t.xmlns=r["xmlns"+(r[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":n[r.Extension]=r.ContentType;break;case"<Override":void 0!==t[OE[r.ContentType]]&&t[OE[r.ContentType]].push(r.PartName)}}),t.xmlns!==CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=n,delete t.calcchains,t}(Pw(e,"[Content_Types].xml")),o=!1;if(0===s.workbooks.length&&Ow(e,a="xl/workbook.xml",!0)&&s.workbooks.push(a),0===s.workbooks.length){if(!Ow(e,a="xl/workbook.bin",!0))throw new Error("Could not find workbook");s.workbooks.push(a),o=!0}"bin"==s.workbooks[0].slice(-3)&&(o=!0);var l={},c={};if(!t.bookSheets&&!t.bookProps){if(GC=[],s.sst)try{GC=eA(Ow(e,BN(s.sst)),s.sst,t)}catch(AR){if(t.WTF)throw AR}t.cellStyles&&s.themes.length&&(l=function(e,t,n){return Mx(e,n)}(Pw(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(c=ZI(Ow(e,BN(s.style)),s.style,l,t))}s.links.map(function(n){try{FE(Pw(e,ME(BN(n))),n);return rA(Ow(e,BN(n)),0,n,t)}catch(AR){}});var u=YI(Ow(e,BN(s.workbooks[0])),s.workbooks[0],t),h={},f="";s.coreprops.length&&((f=Ow(e,BN(s.coreprops[0]),!0))&&(h=GE(f)),0!==s.extprops.length&&(f=Ow(e,BN(s.extprops[0]),!0))&&function(e,t,n){var r={};t||(t={}),e=cT(e),$E.forEach(function(n){var a=(e.match(hT(n[0]))||[])[1];switch(n[2]){case"string":a&&(t[n[1]]=Yw(a));break;case"bool":t[n[1]]="true"===a;break;case"raw":var i=e.match(new RegExp("<"+n[0]+"[^>]*>([\\s\\S]*?)</"+n[0]+">"));i&&i.length>0&&(r[n[1]]=i[1])}}),r.HeadingPairs&&r.TitlesOfParts&&YE(r.HeadingPairs,r.TitlesOfParts,t,n)}(f,h,t));var d={};t.bookSheets&&!t.bookProps||0!==s.custprops.length&&(f=Pw(e,BN(s.custprops[0]),!0))&&(d=function(e,t){var n={},r="",a=e.match(JE);if(a)for(var i=0;i!=a.length;++i){var s=a[i],o=Kw(s);switch(o[0]){case"<?xml":case"<Properties":break;case"<property":r=Yw(o.name);break;case"</property>":r=null;break;default:if(0===s.indexOf("<vt:")){var l=s.split(">"),c=l[0].slice(4),u=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":case"cy":case"error":n[r]=Yw(u);break;case"bool":n[r]=aT(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":n[r]=parseInt(u,10);break;case"r4":case"r8":case"decimal":n[r]=parseFloat(u);break;case"filetime":case"date":n[r]=ww(u);break;default:if("/"==c.slice(-1))break;t.WTF&&"undefined"!==typeof console&&console.warn("Unexpected",s,c,l)}}else if("</"===s.slice(0,2));else if(t.WTF)throw new Error(s)}}return n}(f,t));var p={};if((t.bookSheets||t.bookProps)&&(u.Sheets?r=u.Sheets.map(function(e){return e.name}):h.Worksheets&&h.SheetNames.length>0&&(r=h.SheetNames),t.bookProps&&(p.Props=h,p.Custprops=d),t.bookSheets&&"undefined"!==typeof r&&(p.SheetNames=r),t.bookSheets?p.SheetNames:t.bookProps))return p;r={};var m={};t.bookDeps&&s.calcchain&&(m=nA(Ow(e,BN(s.calcchain)),s.calcchain));var g,v,y=0,b={},w=u.Sheets;h.Worksheets=w.length,h.SheetNames=[];for(var T=0;T!=w.length;++T)h.SheetNames[T]=w[T].name;var S=o?"bin":"xml",E=s.workbooks[0].lastIndexOf("/"),k=(s.workbooks[0].slice(0,E+1)+"_rels/"+s.workbooks[0].slice(E+1)+".rels").replace(/^\//,"");Nw(e,k)||(k="xl/_rels/workbook."+S+".rels");var _=FE(Pw(e,k,!0),k.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=aA(Ow(e,BN(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=function(e,t){var n=[],r=!1;return e.replace(Hw,function(e){var a=Kw(e);switch(qw(a[0])){case"<?xml":case"<personList":case"</personList>":case"</person>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<person":n.push({name:a.displayname,id:a.id});break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&t.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return e}),n}(Ow(e,BN(s.people[0])),t)),_&&(_=function(e,t){if(!e)return 0;try{e=t.map(function(t){return t.id||(t.id=t.strRelID),[t.name,e["!id"][t.id].Target,(n=e["!id"][t.id].Type,LE.WS.indexOf(n)>-1?"sheet":LE.CS&&n==LE.CS?"chart":LE.DS&&n==LE.DS?"dialog":LE.MS&&n==LE.MS?"macro":n&&n.length?n:"sheet")];var n})}catch(AR){return null}return e&&0!==e.length?e:null}(_,u.Sheets));var x=Ow(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(y=0;y!=h.Worksheets;++y){var C="sheet";if(_&&_[y]?(g="xl/"+_[y][1].replace(/[\/]?xl\//,""),Nw(e,g)||(g=_[y][1]),Nw(e,g)||(g=k.replace(/_rels\/.*$/,"")+_[y][1]),C=_[y][2]):g=(g="xl/worksheets/sheet"+(y+1-x)+"."+S).replace(/sheet0\./,"sheet."),v=g.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&null!=t.sheets)switch(typeof t.sheets){case"number":if(y!=t.sheets)continue e;break;case"string":if(h.SheetNames[y].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var I=!1,A=0;A!=t.sheets.length;++A)"number"==typeof t.sheets[A]&&t.sheets[A]==y&&(I=1),"string"==typeof t.sheets[A]&&t.sheets[A].toLowerCase()==h.SheetNames[y].toLowerCase()&&(I=1);if(!I)continue e}}zN(e,g,v,h.SheetNames[y],y,b,r,C,t,u,l,c)}return p={Directory:s,Workbook:u,Props:h,Custprops:d,Deps:m,Sheets:r,SheetNames:h.SheetNames,Strings:GC,Styles:c,Themes:l,SSF:Sw(vb)},t&&t.bookFiles&&(e.files?(p.keys=i,p.files=e.files):(p.keys=[],p.files={},e.FullPaths.forEach(function(t,n){t=t.replace(/^Root Entry[\/]/,""),p.keys.push(t),p.files[t]=e.FileIndex[n]}))),t&&t.bookVBA&&(s.vba.length>0?p.vbaraw=Ow(e,BN(s.vba[0]),!0):s.defaults&&"application/vnd.ms-office.vbaProject"===s.defaults.bin&&(p.vbaraw=Ow(e,"xl/vbaProject.bin",!0))),p}function WN(e,t){var n=t||{},r="Workbook",a=nw.find(e,r);try{if(r="/!DataSpaces/Version",!(a=nw.find(e,r))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(function(e){var t={};t.id=e.read_shift(0,"lpp4"),t.R=j_(e,4),t.U=j_(e,4),t.W=j_(e,4)}(a.content),r="/!DataSpaces/DataSpaceMap",!(a=nw.find(e,r))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var i=function(e){var t=[];e.l+=4;for(var n=e.read_shift(4);n-- >0;)t.push(V_(e));return t}(a.content);if(1!==i.length||1!==i[0].comps.length||0!==i[0].comps[0].t||"StrongEncryptionDataSpace"!==i[0].name||"EncryptedPackage"!==i[0].comps[0].v)throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",!(a=nw.find(e,r))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var s=function(e){var t=[];e.l+=4;for(var n=e.read_shift(4);n-- >0;)t.push(e.read_shift(0,"lpp4"));return t}(a.content);if(1!=s.length||"StrongEncryptionTransform"!=s[0])throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",!(a=nw.find(e,r))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);z_(a.content)}catch(AR){}if(r="/EncryptionInfo",!(a=nw.find(e,r))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var o=function(e){var t=j_(e);switch(t.Minor){case 2:return[t.Minor,W_(e)];case 3:return[t.Minor,G_()];case 4:return[t.Minor,K_(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}(a.content);if(r="/EncryptedPackage",!(a=nw.find(e,r))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(4==o[0]&&"undefined"!==typeof decrypt_agile)return decrypt_agile(o[1],a.content,n.password||"",n);if(2==o[0]&&"undefined"!==typeof decrypt_std76)return decrypt_std76(o[1],a.content,n.password||"",n);throw new Error("File is password-protected")}function GN(e,t){return"ods"==t.bookType?uN(e,t):"numbers"==t.bookType?function(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var n=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var r=zS(n["!ref"]);r.s.r=r.s.c=0;var a=!1;r.e.c>9&&(a=!0,r.e.c=9),r.e.r>49&&(a=!0,r.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(BS(r)));var i=iR(n,{range:r,header:1}),s=["~Sh33tJ5~"];i.forEach(function(e){return e.forEach(function(e){"string"==typeof e&&s.push(e)})});var o={},l=[],c=nw.read(t.numbers,{type:"base64"});c.FileIndex.map(function(e,t){return[e,c.FullPaths[t]]}).forEach(function(e){var t=e[0],n=e[1];2==t.type&&t.name.match(/\.iwa/)&&SN(_N(t.content)).forEach(function(e){l.push(e.id),o[e.id]={deps:[],location:n,type:yN(e.messages[0].meta[1][0].data)}})}),l.sort(function(e,t){return e-t});var u=l.filter(function(e){return e>1}).map(function(e){return[e,vN(e)]});c.FileIndex.map(function(e,t){return[e,c.FullPaths[t]]}).forEach(function(e){var t=e[0];e[1],t.name.match(/\.iwa/)&&SN(_N(t.content)).forEach(function(e){e.messages.forEach(function(t){u.forEach(function(t){e.messages.some(function(e){return 11006!=yN(e.meta[1][0].data)&&function(e,t){e:for(var n=0;n<=e.length-t.length;++n){for(var r=0;r<t.length;++r)if(e[n+r]!=t[r])continue e;return!0}return!1}(e.data,t[1])})&&o[t[0]].deps.push(e.id)})})})});for(var h,f=nw.find(c,o[1].location),d=SN(_N(f.content)),p=0;p<d.length;++p){var m=d[p];1==m.id&&(h=m)}var g=RN(bN(h.messages[0].data)[1][0].data);for(d=SN(_N((f=nw.find(c,o[g].location)).content)),p=0;p<d.length;++p)(m=d[p]).id==g&&(h=m);for(g=RN(bN(h.messages[0].data)[2][0].data),d=SN(_N((f=nw.find(c,o[g].location)).content)),p=0;p<d.length;++p)(m=d[p]).id==g&&(h=m);for(g=RN(bN(h.messages[0].data)[2][0].data),d=SN(_N((f=nw.find(c,o[g].location)).content)),p=0;p<d.length;++p)(m=d[p]).id==g&&(h=m);var v=bN(h.messages[0].data);v[6][0].data=vN(r.e.r+1),v[7][0].data=vN(r.e.c+1);for(var y=RN(v[46][0].data),b=nw.find(c,o[y].location),w=SN(_N(b.content)),T=0;T<w.length&&w[T].id!=y;++T);if(w[T].id!=y)throw"Bad ColumnRowUIDMapArchive";var S=bN(w[T].messages[0].data);S[1]=[],S[2]=[],S[3]=[];for(var E=0;E<=r.e.c;++E){var k=[];k[1]=k[2]=[{type:0,data:vN(E+420690)}],S[1].push({type:2,data:wN(k)}),S[2].push({type:0,data:vN(E)}),S[3].push({type:0,data:vN(E)})}S[4]=[],S[5]=[],S[6]=[];for(var _=0;_<=r.e.r;++_)(k=[])[1]=k[2]=[{type:0,data:vN(_+726270)}],S[4].push({type:2,data:wN(k)}),S[5].push({type:0,data:vN(_)}),S[6].push({type:0,data:vN(_)});w[T].messages[0].data=wN(S),b.content=xN(EN(w)),b.size=b.content.length,delete v[46];var x=bN(v[4][0].data);x[7][0].data=vN(r.e.r+1);var C=RN(bN(x[1][0].data)[2][0].data);if((w=SN(_N((b=nw.find(c,o[C].location)).content)))[0].id!=C)throw"Bad HeaderStorageBucket";var I=bN(w[0].messages[0].data);for(_=0;_<i.length;++_){var A=bN(I[2][0].data);A[1][0].data=vN(_),A[4][0].data=vN(i[_].length),I[2][_]={type:I[2][0].type,data:wN(A)}}w[0].messages[0].data=wN(I),b.content=xN(EN(w)),b.size=b.content.length;var N=RN(x[2][0].data);if((w=SN(_N((b=nw.find(c,o[N].location)).content)))[0].id!=N)throw"Bad HeaderStorageBucket";for(I=bN(w[0].messages[0].data),E=0;E<=r.e.c;++E)(A=bN(I[2][0].data))[1][0].data=vN(E),A[4][0].data=vN(r.e.r+1),I[2][E]={type:I[2][0].type,data:wN(A)};w[0].messages[0].data=wN(I),b.content=xN(EN(w)),b.size=b.content.length;var R=RN(x[4][0].data);!function(){for(var e,t=nw.find(c,o[R].location),n=SN(_N(t.content)),r=0;r<n.length;++r){var a=n[r];a.id==R&&(e=a)}var i=bN(e.messages[0].data);i[3]=[];var l=[];s.forEach(function(e,t){l[1]=[{type:0,data:vN(t)}],l[2]=[{type:0,data:vN(1)}],l[3]=[{type:2,data:dN(e)}],i[3].push({type:2,data:wN(l)})}),e.messages[0].data=wN(i);var u=xN(EN(n));t.content=u,t.size=t.content.length}();var O=bN(x[3][0].data),P=O[1][0];delete O[2];var D=bN(P.data),L=RN(D[2][0].data);!function(){for(var e,t=nw.find(c,o[L].location),n=SN(_N(t.content)),a=0;a<n.length;++a){var l=n[a];l.id==L&&(e=l)}var u=bN(e.messages[0].data);delete u[6],delete O[7];var h=new Uint8Array(u[5][0].data);u[5]=[];for(var f=0,d=0;d<=r.e.r;++d){var p=bN(h);f+=FN(p,i[d],s),p[1][0].data=vN(d),u[5].push({data:wN(p),type:2})}u[1]=[{type:0,data:vN(r.e.c+1)}],u[2]=[{type:0,data:vN(r.e.r+1)}],u[3]=[{type:0,data:vN(f)}],u[4]=[{type:0,data:vN(r.e.r+1)}],e.messages[0].data=wN(u);var m=xN(EN(n));t.content=m,t.size=t.content.length}(),P.data=wN(D),x[3][0].data=wN(O),v[4][0].data=wN(x),h.messages[0].data=wN(v);var M=xN(EN(d));return f.content=M,f.size=f.content.length,c}(e,t):"xlsb"==t.bookType?function(e,t){Hx=1024,e&&!e.SSF&&(e.SSF=Sw(vb));e&&e.SSF&&(Jb(),Qb(e.SSF),t.revssf=cw(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF);t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,qC?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var n="xlsb"==t.bookType?"bin":"xml",r=Yx.indexOf(t.bookType)>-1,a={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};VN(t=t||{});var i=Fw(),s="",o=0;t.cellXfs=[],QC(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});if(Mw(i,s="docProps/core.xml",qE(e.Props,t)),a.coreprops.push(s),jE(t.rels,2,s,LE.CORE_PROPS),s="docProps/app.xml",e.Props&&e.Props.SheetNames);else if(e.Workbook&&e.Workbook.Sheets){for(var l=[],c=0;c<e.SheetNames.length;++c)2!=(e.Workbook.Sheets[c]||{}).Hidden&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}else e.Props.SheetNames=e.SheetNames;e.Props.Worksheets=e.Props.SheetNames.length,Mw(i,s,QE(e.Props)),a.extprops.push(s),jE(t.rels,3,s,LE.EXT_PROPS),e.Custprops!==e.Props&&sw(e.Custprops||{}).length>0&&(Mw(i,s="docProps/custom.xml",ZE(e.Custprops)),a.custprops.push(s),jE(t.rels,4,s,LE.CUST_PROPS));for(o=1;o<=e.SheetNames.length;++o){var u={"!id":{}},h=e.Sheets[e.SheetNames[o-1]];(h||{})["!type"];if(Mw(i,s="xl/worksheets/sheet"+o+"."+n,iA(o-1,s,t,e,u)),a.sheets.push(s),jE(t.wbrels,-1,"worksheets/sheet"+o+"."+n,LE.WS[0]),h){var f=h["!comments"],d=!1,p="";f&&f.length>0&&(Mw(i,p="xl/comments"+o+"."+n,sA(f,p,t)),a.comments.push(p),jE(u,-1,"../comments"+o+"."+n,LE.CMNT),d=!0),h["!legacy"]&&d&&Mw(i,"xl/drawings/vmlDrawing"+o+".vml",Wx(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}u["!id"].rId1&&Mw(i,ME(s),UE(u))}null!=t.Strings&&t.Strings.length>0&&(Mw(i,s="xl/sharedStrings."+n,function(e,t,n){return(".bin"===t.slice(-4)?F_:L_)(e,n)}(t.Strings,s,t)),a.strs.push(s),jE(t.wbrels,-1,"sharedStrings."+n,LE.SST));Mw(i,s="xl/workbook."+n,function(e,t,n){return(".bin"===t.slice(-4)?XI:GI)(e,n)}(e,s,t)),a.workbooks.push(s),jE(t.rels,1,s,LE.WB),Mw(i,s="xl/theme/theme1.xml",Fx(e.Themes,t)),a.themes.push(s),jE(t.wbrels,-1,"theme/theme1.xml",LE.THEME),Mw(i,s="xl/styles."+n,function(e,t,n){return(".bin"===t.slice(-4)?Cx:px)(e,n)}(e,s,t)),a.styles.push(s),jE(t.wbrels,-1,"styles."+n,LE.STY),e.vbaraw&&r&&(Mw(i,s="xl/vbaProject.bin",e.vbaraw),a.vba.push(s),jE(t.wbrels,-1,"vbaProject.bin",LE.VBA));return Mw(i,s="xl/metadata."+n,function(e){return(".bin"===e.slice(-4)?zx:Bx)()}(s)),a.metadata.push(s),jE(t.wbrels,-1,"metadata."+n,LE.XLMETA),Mw(i,"[Content_Types].xml",DE(a,t)),Mw(i,"_rels/.rels",UE(t.rels)),Mw(i,"xl/_rels/workbook."+n+".rels",UE(t.wbrels)),delete t.revssf,delete t.ssf,i}(e,t):KN(e,t)}function KN(e,t){Hx=1024,e&&!e.SSF&&(e.SSF=Sw(vb)),e&&e.SSF&&(Jb(),Qb(e.SSF),t.revssf=cw(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,qC?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var n="xml",r=Yx.indexOf(t.bookType)>-1,a={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};VN(t=t||{});var i=Fw(),s="",o=0;if(t.cellXfs=[],QC(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),Mw(i,s="docProps/core.xml",qE(e.Props,t)),a.coreprops.push(s),jE(t.rels,2,s,LE.CORE_PROPS),s="docProps/app.xml",e.Props&&e.Props.SheetNames);else if(e.Workbook&&e.Workbook.Sheets){for(var l=[],c=0;c<e.SheetNames.length;++c)2!=(e.Workbook.Sheets[c]||{}).Hidden&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}else e.Props.SheetNames=e.SheetNames;e.Props.Worksheets=e.Props.SheetNames.length,Mw(i,s,QE(e.Props)),a.extprops.push(s),jE(t.rels,3,s,LE.EXT_PROPS),e.Custprops!==e.Props&&sw(e.Custprops||{}).length>0&&(Mw(i,s="docProps/custom.xml",ZE(e.Custprops)),a.custprops.push(s),jE(t.rels,4,s,LE.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var h={"!id":{}},f=e.Sheets[e.SheetNames[o-1]];(f||{})["!type"];if(Mw(i,s="xl/worksheets/sheet"+o+"."+n,vI(o-1,t,e,h)),a.sheets.push(s),jE(t.wbrels,-1,"worksheets/sheet"+o+"."+n,LE.WS[0]),f){var d=f["!comments"],p=!1,m="";if(d&&d.length>0){var g=!1;d.forEach(function(e){e[1].forEach(function(e){1==e.T&&(g=!0)})}),g&&(Mw(i,m="xl/threadedComments/threadedComment"+o+"."+n,qx(d,u,t)),a.threadedcomments.push(m),jE(h,-1,"../threadedComments/threadedComment"+o+"."+n,LE.TCMNT)),Mw(i,m="xl/comments"+o+"."+n,Kx(d)),a.comments.push(m),jE(h,-1,"../comments"+o+"."+n,LE.CMNT),p=!0}f["!legacy"]&&p&&Mw(i,"xl/drawings/vmlDrawing"+o+".vml",Wx(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}h["!id"].rId1&&Mw(i,ME(s),UE(h))}return null!=t.Strings&&t.Strings.length>0&&(Mw(i,s="xl/sharedStrings."+n,L_(t.Strings,t)),a.strs.push(s),jE(t.wbrels,-1,"sharedStrings."+n,LE.SST)),Mw(i,s="xl/workbook."+n,GI(e)),a.workbooks.push(s),jE(t.rels,1,s,LE.WB),Mw(i,s="xl/theme/theme1.xml",Fx(e.Themes,t)),a.themes.push(s),jE(t.wbrels,-1,"theme/theme1.xml",LE.THEME),Mw(i,s="xl/styles."+n,px(e,t)),a.styles.push(s),jE(t.wbrels,-1,"styles."+n,LE.STY),e.vbaraw&&r&&(Mw(i,s="xl/vbaProject.bin",e.vbaraw),a.vba.push(s),jE(t.wbrels,-1,"vbaProject.bin",LE.VBA)),Mw(i,s="xl/metadata."+n,Bx()),a.metadata.push(s),jE(t.wbrels,-1,"metadata."+n,LE.XLMETA),u.length>1&&(Mw(i,s="xl/persons/person.xml",function(e){var t=[Vw,wT("personList",null,{xmlns:AT,"xmlns:x":FT[0]}).replace(/[\/]>/,">")];return e.forEach(function(e,n){t.push(wT("person",null,{displayName:e,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:e,providerId:"None"}))}),t.push("</personList>"),t.join("")}(u)),a.people.push(s),jE(t.wbrels,-1,"persons/person.xml",LE.PEOPLE)),Mw(i,"[Content_Types].xml",DE(a,t)),Mw(i,"_rels/.rels",UE(t.rels)),Mw(i,"xl/_rels/workbook.xml.rels",UE(t.wbrels)),delete t.revssf,delete t.ssf,i}function qN(e,t){var n="";switch((t||{}).type||"base64"){case"buffer":case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":n=Yy(e.slice(0,12));break;case"binary":n=e;break;default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[n.charCodeAt(0),n.charCodeAt(1),n.charCodeAt(2),n.charCodeAt(3),n.charCodeAt(4),n.charCodeAt(5),n.charCodeAt(6),n.charCodeAt(7)]}function $N(e,t){var n=0;e:for(;n<e.length;)switch(e.charCodeAt(n)){case 10:case 13:case 32:++n;break;case 60:return yA(e.slice(n),t);default:break e}return E_.to_workbook(e,t)}function XN(e,t,n,r){return r?(n.type="string",E_.to_workbook(e,n)):E_.to_workbook(t,n)}function YN(e,t){zy();var n=t||{};if("undefined"!==typeof ArrayBuffer&&e instanceof ArrayBuffer)return YN(new Uint8Array(e),((n=Sw(n)).type="array",n));"undefined"!==typeof Uint8Array&&e instanceof Uint8Array&&!n.type&&(n.type="undefined"!==typeof Deno?"buffer":"array");var r,a=e,i=!1;if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),KC={},n.dateNF&&(KC.dateNF=n.dateNF),n.type||(n.type=Qy&&Buffer.isBuffer(e)?"buffer":"base64"),"file"==n.type&&(n.type=Qy?"buffer":"binary",a=function(e){if("undefined"!==typeof rw)return rw.readFileSync(e);if("undefined"!==typeof Deno)return Deno.readFileSync(e);if("undefined"!==typeof $&&"undefined"!==typeof File&&"undefined"!==typeof Folder)try{var t=File(e);t.open("r"),t.encoding="binary";var n=t.read();return t.close(),n}catch(AR){if(!AR.message||!AR.message.match(/onstruct/))throw AR}throw new Error("Cannot access file "+e)}(e),"undefined"===typeof Uint8Array||Qy||(n.type="array")),"string"==n.type&&(i=!0,n.type="binary",n.codepage=65001,a=function(e){return e.match(/[^\x00-\x7F]/)?uT(e):e}(e)),"array"==n.type&&"undefined"!==typeof Uint8Array&&e instanceof Uint8Array&&"undefined"!==typeof ArrayBuffer){var s=new ArrayBuffer(3),o=new Uint8Array(s);if(o.foo="bar",!o.foo)return(n=Sw(n)).type="array",YN(ab(a),n)}switch((r=qN(a,n))[0]){case 208:if(207===r[1]&&17===r[2]&&224===r[3]&&161===r[4]&&177===r[5]&&26===r[6]&&225===r[7])return function(e,t){return nw.find(e,"EncryptedPackage")?WN(e,t):DA(e,t)}(nw.read(a,n),n);break;case 9:if(r[1]<=8)return DA(a,n);break;case 60:return yA(a,n);case 73:if(73===r[1]&&42===r[2]&&0===r[3])throw new Error("TIFF Image File is not a spreadsheet");if(68===r[1])return function(e,t){var n=t||{},r=!!n.WTF;n.WTF=!0;try{var a=w_.to_workbook(e,n);return n.WTF=r,a}catch(AR){if(n.WTF=r,!AR.message.match(/SYLK bad record ID/)&&r)throw AR;return E_.to_workbook(e,t)}}(a,n);break;case 84:if(65===r[1]&&66===r[2]&&76===r[3])return T_.to_workbook(a,n);break;case 80:return 75===r[1]&&r[2]<9&&r[3]<9?function(e,t){var n=e,r=t||{};return r.type||(r.type=Qy&&Buffer.isBuffer(e)?"buffer":"base64"),HN(Uw(n,r),r)}(a,n):XN(e,a,n,i);case 239:return 60===r[3]?yA(a,n):XN(e,a,n,i);case 255:if(254===r[1])return function(e,t){var n=e;return"base64"==t.type&&(n=Yy(n)),n=Wy.utils.decode(1200,n.slice(2),"str"),t.type="binary",$N(n,t)}(a,n);if(0===r[1]&&2===r[2]&&0===r[3])return k_.to_workbook(a,n);break;case 0:if(0===r[1]){if(r[2]>=2&&0===r[3])return k_.to_workbook(a,n);if(0===r[2]&&(8===r[3]||9===r[3]))return k_.to_workbook(a,n)}break;case 3:case 131:case 139:case 140:return b_.to_workbook(a,n);case 123:if(92===r[1]&&114===r[2]&&116===r[3])return Q_.to_workbook(a,n);break;case 10:case 13:case 32:return function(e,t){var n="",r=qN(e,t);switch(t.type){case"base64":n=Yy(e);break;case"binary":n=e;break;case"buffer":n=e.toString("binary");break;case"array":n=Tw(e);break;default:throw new Error("Unrecognized type "+t.type)}return 239==r[0]&&187==r[1]&&191==r[2]&&(n=cT(n)),t.type="binary",$N(n,t)}(a,n);case 137:if(80===r[1]&&78===r[2]&&71===r[3])throw new Error("PNG Image File is not a spreadsheet")}return y_.indexOf(r[0])>-1&&r[2]<=12&&r[3]<=31?b_.to_workbook(a,n):XN(e,a,n,i)}function QN(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return iw(t.file,nw.write(e,{type:Qy?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return nw.write(e,t)}function JN(e,t){var n={},r=Qy?"nodebuffer":"undefined"!==typeof Uint8Array?"array":"string";if(t.compression&&(n.compression="DEFLATE"),t.password)n.type=r;else switch(t.type){case"base64":n.type="base64";break;case"binary":n.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":n.type=r;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?nw.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[n.type]||n.type,compression:!!t.compression}):e.generate(n);if("undefined"!==typeof Deno&&"string"==typeof a){if("binary"==t.type||"base64"==t.type)return a;a=new Uint8Array(nb(a))}return t.password&&"undefined"!==typeof encrypt_agile?QN(encrypt_agile(a,t.password),t):"file"===t.type?iw(t.file,a):"string"==t.type?cT(a):a}function ZN(e,t,n){n||(n="");var r=n+e;switch(t.type){case"base64":return Xy(uT(r));case"binary":return uT(r);case"string":return e;case"file":return iw(t.file,r,"utf8");case"buffer":return Qy?Jy(r,"utf8"):"undefined"!==typeof TextEncoder?(new TextEncoder).encode(r):ZN(r,{type:"binary"}).split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function eR(e,t){switch(t.type){case"string":case"base64":case"binary":for(var n="",r=0;r<e.length;++r)n+=String.fromCharCode(e[r]);return"base64"==t.type?Xy(n):"string"==t.type?cT(n):n;case"file":return iw(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function tR(e,t){zy(),HI(e);var n=Sw(t||{});if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),"array"==n.type){n.type="binary";var r=tR(e,n);return n.type="array",nb(r)}var a=0;if(n.sheet&&(a="number"==typeof n.sheet?n.sheet:e.SheetNames.indexOf(n.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+n.sheet+" : "+typeof n.sheet);switch(n.bookType||"xlsb"){case"xml":case"xlml":return ZN(kA(e,n),n);case"slk":case"sylk":return ZN(w_.from_sheet(e.Sheets[e.SheetNames[a]],n),n);case"htm":case"html":return ZN(ZA(e.Sheets[e.SheetNames[a]],n),n);case"txt":return function(e,t){switch(t.type){case"base64":return Xy(e);case"binary":case"string":return e;case"file":return iw(t.file,e,"binary");case"buffer":return Qy?Jy(e,"binary"):e.split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}(cR(e.Sheets[e.SheetNames[a]],n),n);case"csv":return ZN(lR(e.Sheets[e.SheetNames[a]],n),n,"\ufeff");case"dif":return ZN(T_.from_sheet(e.Sheets[e.SheetNames[a]],n),n);case"dbf":return eR(b_.from_sheet(e.Sheets[e.SheetNames[a]],n),n);case"prn":return ZN(E_.from_sheet(e.Sheets[e.SheetNames[a]],n),n);case"rtf":return ZN(Q_.from_sheet(e.Sheets[e.SheetNames[a]],n),n);case"eth":return ZN(S_.from_sheet(e.Sheets[e.SheetNames[a]],n),n);case"fods":return ZN(uN(e,n),n);case"wk1":return eR(k_.sheet_to_wk1(e.Sheets[e.SheetNames[a]],n),n);case"wk3":return eR(k_.book_to_wk3(e,n),n);case"biff2":n.biff||(n.biff=2);case"biff3":n.biff||(n.biff=3);case"biff4":return n.biff||(n.biff=4),eR(qA(e,n),n);case"biff5":n.biff||(n.biff=5);case"biff8":case"xla":case"xls":return n.biff||(n.biff=8),function(e,t){var n=t||{};return QN(LA(e,n),n)}(e,n);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return function(e,t){var n=Sw(t||{});return JN(GN(e,n),n)}(e,n);default:throw new Error("Unrecognized bookType |"+n.bookType+"|")}}function nR(e){if(!e.bookType){var t=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(e.bookType=t.slice(1)),e.bookType={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"}[e.bookType]||e.bookType}}function rR(e,t,n){var r=n||{};return r.type="file",r.file=t,nR(r),tR(e,r)}function aR(e,t,n,r,a,i,s,o){var l=MS(n),c=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,f=1===a?[]:{};if(1!==a)if(Object.defineProperty)try{Object.defineProperty(f,"__rowNum__",{value:n,enumerable:!1})}catch(AR){f.__rowNum__=n}else f.__rowNum__=n;if(!s||e[n])for(var d=t.s.c;d<=t.e.c;++d){var p=s?e[n][d]:e[r[d]+l];if(void 0!==p&&void 0!==p.t){var m=p.v;switch(p.t){case"z":if(null==m)break;continue;case"e":m=0==m?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(null!=i[d]){if(null==m)if("e"==p.t&&null===m)f[i[d]]=null;else if(void 0!==c)f[i[d]]=c;else{if(!u||null!==m)continue;f[i[d]]=null}else f[i[d]]=u&&("n"!==p.t||"n"===p.t&&!1!==o.rawNumbers)?m:GS(p,m,o);null!=m&&(h=!1)}}else{if(void 0===c)continue;null!=i[d]&&(f[i[d]]=c)}}return{row:f,isempty:h}}function iR(e,t){if(null==e||null==e["!ref"])return[];var n={t:"n",v:0},r=0,a=1,i=[],s=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},u=null!=c.range?c.range:e["!ref"];switch(1===c.header?r=1:"A"===c.header?r=2:Array.isArray(c.header)?r=3:null==c.header&&(r=0),typeof u){case"string":l=HS(u);break;case"number":(l=HS(e["!ref"])).s.r=u;break;default:l=u}r>0&&(a=0);var h=MS(l.s.r),f=[],d=[],p=0,m=0,g=Array.isArray(e),v=l.s.r,y=0,b={};g&&!e[v]&&(e[v]=[]);var w=c.skipHidden&&e["!cols"]||[],T=c.skipHidden&&e["!rows"]||[];for(y=l.s.c;y<=l.e.c;++y)if(!(w[y]||{}).hidden)switch(f[y]=US(y),n=g?e[v][y]:e[f[y]+h],r){case 1:i[y]=y-l.s.c;break;case 2:i[y]=f[y];break;case 3:i[y]=c.header[y-l.s.c];break;default:if(null==n&&(n={w:"__EMPTY",t:"s"}),o=s=GS(n,null,c),m=b[s]||0){do{o=s+"_"+m++}while(b[o]);b[s]=m,b[o]=1}else b[s]=1;i[y]=o}for(v=l.s.r+a;v<=l.e.r;++v)if(!(T[v]||{}).hidden){var S=aR(e,l,v,f,r,i,g,c);(!1===S.isempty||(1===r?!1!==c.blankrows:c.blankrows))&&(d[p++]=S.row)}return d.length=p,d}var sR=/"/g;function oR(e,t,n,r,a,i,s,o){for(var l=!0,c=[],u="",h=MS(n),f=t.s.c;f<=t.e.c;++f)if(r[f]){var d=o.dense?(e[n]||[])[f]:e[r[f]+h];if(null==d)u="";else if(null!=d.v){l=!1,u=""+(o.rawNumbers&&"n"==d.t?d.v:GS(d,null,o));for(var p=0,m=0;p!==u.length;++p)if((m=u.charCodeAt(p))===a||m===i||34===m||o.forceQuotes){u='"'+u.replace(sR,'""')+'"';break}"ID"==u&&(u='"ID"')}else null==d.f||d.F?u="":(l=!1,(u="="+d.f).indexOf(",")>=0&&(u='"'+u.replace(sR,'""')+'"'));c.push(u)}return!1===o.blankrows&&l?null:c.join(s)}function lR(e,t){var n=[],r=null==t?{}:t;if(null==e||null==e["!ref"])return"";var a=HS(e["!ref"]),i=void 0!==r.FS?r.FS:",",s=i.charCodeAt(0),o=void 0!==r.RS?r.RS:"\n",l=o.charCodeAt(0),c=new RegExp(("|"==i?"\\|":i)+"+$"),u="",h=[];r.dense=Array.isArray(e);for(var f=r.skipHidden&&e["!cols"]||[],d=r.skipHidden&&e["!rows"]||[],p=a.s.c;p<=a.e.c;++p)(f[p]||{}).hidden||(h[p]=US(p));for(var m=0,g=a.s.r;g<=a.e.r;++g)(d[g]||{}).hidden||null!=(u=oR(e,a,g,h,s,l,i,r))&&(r.strip&&(u=u.replace(c,"")),(u||!1!==r.blankrows)&&n.push((m++?o:"")+u));return delete r.dense,n.join("")}function cR(e,t){t||(t={}),t.FS="\t",t.RS="\n";var n=lR(e,t);if("undefined"==typeof Wy||"string"==t.type)return n;var r=Wy.utils.encode(1200,n,"str");return String.fromCharCode(255)+String.fromCharCode(254)+r}function uR(e,t,n){var r,a=n||{},i=+!a.skipHeader,s=e||{},o=0,l=0;if(s&&null!=a.origin)if("number"==typeof a.origin)o=a.origin;else{var c="string"==typeof a.origin?jS(a.origin):a.origin;o=c.r,l=c.c}var u={s:{c:0,r:0},e:{c:l,r:o+t.length-1+i}};if(s["!ref"]){var h=HS(s["!ref"]);u.e.c=Math.max(u.e.c,h.e.c),u.e.r=Math.max(u.e.r,h.e.r),-1==o&&(o=h.e.r+1,u.e.r=o+t.length-1+i)}else-1==o&&(o=0,u.e.r=t.length-1+i);var f=a.header||[],d=0;t.forEach(function(e,t){sw(e).forEach(function(n){-1==(d=f.indexOf(n))&&(f[d=f.length]=n);var c=e[n],u="z",h="",p=VS({c:l+d,r:o+t+i});r=hR(s,p),!c||"object"!==typeof c||c instanceof Date?("number"==typeof c?u="n":"boolean"==typeof c?u="b":"string"==typeof c?u="s":c instanceof Date?(u="d",a.cellDates||(u="n",c=hw(c)),h=a.dateNF||vb[14]):null===c&&a.nullError&&(u="e",c=0),r?(r.t=u,r.v=c,delete r.w,delete r.R,h&&(r.z=h)):s[p]=r={t:u,v:c},h&&(r.z=h)):s[p]=c})}),u.e.c=Math.max(u.e.c,l+f.length-1);var p=MS(o);if(i)for(d=0;d<f.length;++d)s[US(d+l)+p]={t:"s",v:f[d]};return s["!ref"]=BS(u),s}function hR(e,t,n){if("string"==typeof t){if(Array.isArray(e)){var r=jS(t);return e[r.r]||(e[r.r]=[]),e[r.r][r.c]||(e[r.r][r.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return hR(e,VS("number"!=typeof t?t:{r:t,c:n||0}))}function fR(){return{SheetNames:[],Sheets:{}}}function dR(e,t,n,r){var a=1;if(!n)for(;a<=65535&&-1!=e.SheetNames.indexOf(n="Sheet"+a);++a,n=void 0);if(!n||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&e.SheetNames.indexOf(n)>=0){var i=n.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var s=i&&i[1]||n;for(++a;a<=65535&&-1!=e.SheetNames.indexOf(n=s+a);++a);}if(BI(n),e.SheetNames.indexOf(n)>=0)throw new Error("Worksheet with name |"+n+"| already exists!");return e.SheetNames.push(n),e.Sheets[n]=t,n}function pR(e,t,n){return t?(e.l={Target:t},n&&(e.l.Tooltip=n)):delete e.l,e}var mR={encode_col:US,encode_row:MS,encode_cell:VS,encode_range:BS,decode_col:FS,decode_row:LS,split_cell:function(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:jS,decode_range:zS,format_cell:GS,sheet_add_aoa:qS,sheet_add_json:uR,sheet_add_dom:eN,aoa_to_sheet:$S,json_to_sheet:function(e,t){return uR(null,e,t)},table_to_sheet:tN,table_to_book:function(e,t){return KS(tN(e,t),t)},sheet_to_csv:lR,sheet_to_txt:cR,sheet_to_json:iR,sheet_to_html:ZA,sheet_to_formulae:function(e){var t,n="",r="";if(null==e||null==e["!ref"])return[];var a,i=HS(e["!ref"]),s="",o=[],l=[],c=Array.isArray(e);for(a=i.s.c;a<=i.e.c;++a)o[a]=US(a);for(var u=i.s.r;u<=i.e.r;++u)for(s=MS(u),a=i.s.c;a<=i.e.c;++a)if(n=o[a]+s,r="",void 0!==(t=c?(e[u]||[])[a]:e[n])){if(null!=t.F){if(n=t.F,!t.f)continue;r=t.f,-1==n.indexOf(":")&&(n=n+":"+n)}if(null!=t.f)r=t.f;else{if("z"==t.t)continue;if("n"==t.t&&null!=t.v)r=""+t.v;else if("b"==t.t)r=t.v?"TRUE":"FALSE";else if(void 0!==t.w)r="'"+t.w;else{if(void 0===t.v)continue;r="s"==t.t?"'"+t.v:""+t.v}}l[l.length]=n+"="+r}return l},sheet_to_row_object_array:iR,sheet_get_cell:hR,book_new:fR,book_append_sheet:dR,book_set_sheet_visibility:function(e,t,n){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var r=function(e,t){if("number"==typeof t){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}if("string"==typeof t){var n=e.SheetNames.indexOf(t);if(n>-1)return n;throw new Error("Cannot find sheet name |"+t+"|")}throw new Error("Cannot find sheet |"+t+"|")}(e,t);switch(e.Workbook.Sheets[r]||(e.Workbook.Sheets[r]={}),n){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+n)}e.Workbook.Sheets[r].Hidden=n},cell_set_number_format:function(e,t){return e.z=t,e},cell_set_hyperlink:pR,cell_set_internal_link:function(e,t,n){return pR(e,"#"+t,n)},cell_add_comment:function(e,t,n){e.c||(e.c=[]),e.c.push({t:t,a:n||"SheetJS"})},sheet_set_array_formula:function(e,t,n,r){for(var a="string"!=typeof t?t:HS(t),i="string"==typeof t?t:BS(t),s=a.s.r;s<=a.e.r;++s)for(var o=a.s.c;o<=a.e.c;++o){var l=hR(e,s,o);l.t="n",l.F=i,delete l.v,s==a.s.r&&o==a.s.c&&(l.f=n,r&&(l.D=!0))}return e},consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};Dy.version;const gR=new class{constructor(){this.templateUrl="https://docs.google.com/spreadsheets/d/1zjRfnTCH_gxBQpQ7-jN4O3KmY9ew_oHjMb629narNok/edit?gid=0#gid=0"}getFixedIngredientOrder(){return["C\xc0 PH\xca","S\u1eeeA \u0110\u1eb6C","M\u1ee8T VI\u1ec6T QU\u1ea4T","C\u1ed0T D\u1eeaA (400ML/ LON)","TR\xc0 COZY (100 G\xd3I)","TR\xc0 G\u1eeaNG","MATCHA","M\u1eacT ONG (1000ML/ CHAI)","THU\u1ed0C 3 S\u1ed0 VI\u1ec6T","THU\u1ed0C M\xc8O MI","THU\u1ed0C M\xc8O \u0110\u1ece","H\u01af\u1edaNG D\u01af\u01a0NG","B\xc1NH G\u1ea4U","B\xc1NH TAI HEO","B\xc1NH QUE","S\u1eeeA T\u01af\u01a0I (1L/ H\u1ed8P)","S\u1eeeA OATSIDE (1L/ H\u1ed8P)","RICH (454G/ H\u1ed8P)","S\u1eeeA CHUA (100G/ H\u1ee6)","PEPSI","STING","REDBULL","\u1ed4I","CAM S\xc0NH","TH\u01a0M","D\u1eeaA","T\xc1O","B\u01a0","N\u1eaeP U\u1ed0NG TR\u1ef0C TI\u1ebeP","LY PET 360ML (50 LY/ C\xc2Y)"]}generateInventoryData(e,t){const n=[],r=this.getFixedIngredientOrder();return n.push(["STT","T\xean nguy\xean li\u1ec7u","\u0110\u01a1n v\u1ecb","S\u1ed1 l\u01b0\u1ee3ng hi\u1ec7n c\xf3","S\u1ed1 l\u01b0\u1ee3ng ki\u1ec3m k\xea","Ch\xeanh l\u1ec7ch","Ghi ch\xfa"]),r.forEach((r,a)=>{const i=t.find(e=>e.name.toUpperCase()===r.toUpperCase()||e.name.toUpperCase().includes(r.toUpperCase())||r.toUpperCase().includes(e.name.toUpperCase()));if(i){const s=Object.keys(e).find(e=>{const n=t.find(t=>t.id===e||t.id===parseInt(e).toString()||t.ingredientId===parseInt(e));return n&&n.id===i.id}),o=s&&e[s]||0,l=0,c=l-o;n.push([a+1,r,i.unit,o,l,c,""])}else n.push([a+1,r,"g",0,0,0,"Ch\u01b0a c\xf3 trong h\u1ec7 th\u1ed1ng"])}),n}generateSummaryData(e,t,n,r){const a=[];a.push(["STT","T\xean m\xf3n","Nguy\xean li\u1ec7u","\u0110\u01a1n v\u1ecb","S\u1ed1 l\u01b0\u1ee3ng c\u1ea7n","S\u1ed1 l\u01b0\u1ee3ng c\xf3","C\xf3 th\u1ec3 l\xe0m","Ghi ch\xfa"]);let i=1;return e.forEach(e=>{const s=t[e.id];s&&Object.keys(s).length>0&&Object.entries(s).forEach(t=>{let[s,o]=t;const l=n.find(e=>e.id===s||e.id===parseInt(s).toString()||e.ingredientId===parseInt(s));if(l){const t="object"===typeof o?o.amount:o,n=r[s]||0,c=Math.floor(n/t);a.push([i++,e.name,l.name,l.unit,t,n,c,c>0?"C\xf3 th\u1ec3 l\xe0m":"Thi\u1ebfu nguy\xean li\u1ec7u"])}})}),a}async exportToExcel(e,t,n,r){try{const a=mR.book_new(),i=this.generateInventoryData(e,t),s=mR.aoa_to_sheet(i),o={font:{bold:!0,color:{rgb:"FFFFFF"}},fill:{fgColor:{rgb:"4472C4"}},alignment:{horizontal:"center",vertical:"center"}},l=mR.decode_range(s["!ref"]);for(let e=l.s.c;e<=l.e.c;e++){const t=mR.encode_cell({r:0,c:e});s[t]||(s[t]={}),s[t].s=o}s["!cols"]=[{wch:5},{wch:25},{wch:10},{wch:15},{wch:15},{wch:12},{wch:20}],mR.book_append_sheet(a,s,"Ki\u1ec3m k\xea nguy\xean li\u1ec7u");const c=this.generateSummaryData(n,r,t,e),u=mR.aoa_to_sheet(c),h=mR.decode_range(u["!ref"]);for(let e=h.s.c;e<=h.e.c;e++){const t=mR.encode_cell({r:0,c:e});u[t]||(u[t]={}),u[t].s=o}u["!cols"]=[{wch:5},{wch:20},{wch:20},{wch:10},{wch:12},{wch:12},{wch:12},{wch:20}],mR.book_append_sheet(a,u,"B\xe1o c\xe1o t\u1ed5ng h\u1ee3p");const f="Kiem_ke_nguyen_lieu_".concat((new Date).toISOString().split("T")[0],".xlsx");return rR(a,f),{success:!0,fileName:f,message:"Xu\u1ea5t file Excel th\xe0nh c\xf4ng!"}}catch(a){return console.error("L\u1ed7i khi xu\u1ea5t Excel:",a),{success:!1,error:a.message,message:"C\xf3 l\u1ed7i x\u1ea3y ra khi xu\u1ea5t file Excel!"}}}exportSimpleInventory(e,t){try{const n=mR.book_new(),r=this.getFixedIngredientOrder(),a=[];a.push(["T\xean nguy\xean li\u1ec7u","B\xe1n \u0110\u01b0\u1ee3c"]),r.forEach(n=>{const r=t.find(e=>e.name.toUpperCase()===n.toUpperCase()||e.name.toUpperCase().includes(n.toUpperCase())||n.toUpperCase().includes(e.name.toUpperCase()));if(r){const i=Object.keys(e).find(e=>{const n=t.find(t=>t.id===e||t.id===parseInt(e).toString()||t.ingredientId===parseInt(e));return n&&n.id===r.id}),s=i&&e[i]||0;a.push([n,s])}else a.push([n,0])});const i=mR.aoa_to_sheet(a),s={font:{bold:!0,color:{rgb:"FFFFFF"},size:14},fill:{fgColor:{rgb:"2E5984"}},alignment:{horizontal:"center",vertical:"center"},border:{top:{style:"thick",color:{rgb:"000000"}},bottom:{style:"thick",color:{rgb:"000000"}},left:{style:"thick",color:{rgb:"000000"}},right:{style:"thick",color:{rgb:"000000"}}}},o=mR.decode_range(i["!ref"]);for(let e=o.s.c;e<=o.e.c;e++){const t=mR.encode_cell({r:0,c:e});i[t]||(i[t]={}),i[t].s=s}const l={font:{size:12},border:{top:{style:"thin",color:{rgb:"CCCCCC"}},bottom:{style:"thin",color:{rgb:"CCCCCC"}},left:{style:"thin",color:{rgb:"CCCCCC"}},right:{style:"thin",color:{rgb:"CCCCCC"}}}};for(let e=1;e<=o.e.r;e++)for(let t=o.s.c;t<=o.e.c;t++){const n=mR.encode_cell({r:e,c:t});i[n]||(i[n]={}),i[n].s=l}i["!cols"]=[{wch:30},{wch:15}],mR.book_append_sheet(n,i,"B\xe1n \u0111\u01b0\u1ee3c");const c="Ban_duoc_nguyen_lieu_".concat((new Date).toISOString().split("T")[0],".xlsx");return rR(n,c),{success:!0,fileName:c,message:"Xu\u1ea5t file Excel theo layout 2 c\u1ed9t th\xe0nh c\xf4ng!"}}catch(n){return console.error("L\u1ed7i khi xu\u1ea5t Excel \u0111\u01a1n gi\u1ea3n:",n),{success:!1,error:n.message,message:"C\xf3 l\u1ed7i x\u1ea3y ra khi xu\u1ea5t file Excel!"}}}async exportWithTemplate(e,t,n,r,a){try{const r=await fetch(e);if(!r.ok)throw new Error("Kh\xf4ng th\u1ec3 t\u1ea3i template t\u1eeb URL");const a=YN(await r.arrayBuffer(),{type:"array"}),i=a.SheetNames[0],s=a.Sheets[i],o=mR.decode_range(s["!ref"]);let l=1;for(let e=1;e<=o.e.r;e++){const t=mR.encode_cell({r:e,c:0});if(!s[t]||!s[t].v){l=e;break}}const c=this.generateInventoryData(t,n).slice(1);c.forEach((e,t)=>{e.forEach((e,n)=>{const r=mR.encode_cell({r:l+t,c:n});s[r]={v:e}})});const u=mR.encode_range({s:{r:0,c:0},e:{r:l+c.length-1,c:6}});s["!ref"]=u;const h="Kiem_ke_nguyen_lieu_template_".concat((new Date).toISOString().split("T")[0],".xlsx");return rR(a,h),{success:!0,fileName:h,message:"Xu\u1ea5t file Excel v\u1edbi template th\xe0nh c\xf4ng!"}}catch(i){return console.error("L\u1ed7i khi xu\u1ea5t Excel v\u1edbi template:",i),{success:!1,error:i.message,message:"C\xf3 l\u1ed7i x\u1ea3y ra khi xu\u1ea5t file Excel v\u1edbi template!"}}}},vR=gR,yR=e=>{let{text:t="\u0110ang t\u1ea3i...",className:n=""}=e;return(0,ky.jsx)("div",{className:"d-flex align-items-center justify-content-center ".concat(n),style:{padding:"3rem",textAlign:"center",minHeight:"200px"},children:(0,ky.jsx)("div",{style:{fontSize:"1.1rem",fontWeight:"500",color:"#6b7280",background:"#f8f9fa",padding:"1rem 2rem",borderRadius:"8px",border:"1px solid #e9ecef"},children:t})})},bR=e=>{let{items:t=[],selectedItems:n={},onSelectionChange:r,onAmountChange:a,onRemove:i,searchTerm:s="",onSearchChange:o,leftTitle:c="Danh S\xe1ch",rightTitle:u="\u0110\xe3 Ch\u1ecdn",placeholder:h="T\xecm ki\u1ebfm...",showAmountInput:f=!0,showSearch:d=!0,className:p=""}=e;const m=t.filter(e=>e.name.toLowerCase().includes(s.toLowerCase())),g=Object.entries(n).filter(e=>{let[t,n]=e;return n}).map(e=>{let[n,r]=e;const a=t.find(e=>e.id===n||e.id===parseInt(n).toString()||e.id===parseInt(n));return l(l({id:n},a),{},{amount:r.amount||"",unit:r.unit})}),v=e=>{const n=t.find(t=>t.id===e||t.id===parseInt(e).toString()||t.id===parseInt(e));r(e,{amount:"1",unit:(null===n||void 0===n?void 0:n.unit)||"g"})},y=(e,t)=>{a(e,t)};return(0,ky.jsxs)("div",{className:"multi-select-grid ".concat(p),style:{display:"flex",gap:"1rem",height:"auto",minHeight:"300px",maxHeight:"500px",flex:1},children:[(0,ky.jsxs)("div",{style:{flex:1,display:"flex",flexDirection:"column",minHeight:0},children:[d&&(0,ky.jsx)("div",{style:{marginBottom:"0.75rem",flexShrink:0},children:(0,ky.jsx)("input",{type:"text",placeholder:"\ud83d\udd0d ".concat(h),value:s,onChange:e=>o(e.target.value),style:{width:"100%",padding:"0.75rem 1rem",border:"2px solid #e2e8f0",borderRadius:"8px",fontSize:"0.875rem",outline:"none",transition:"all 0.2s",background:"#f8fafc"},onFocus:e=>{e.target.style.borderColor="#4f46e5",e.target.style.background="white"},onBlur:e=>{e.target.style.borderColor="#e2e8f0",e.target.style.background="#f8fafc"}})}),(0,ky.jsx)("div",{style:{flex:1,overflowY:"auto",border:"2px solid #e2e8f0",borderRadius:"8px",padding:"0.25rem",background:"#f8fafc",scrollbarWidth:"thin",scrollbarColor:"#cbd5e1 #f1f5f9",minHeight:0,maxHeight:"100%"},children:m.map(e=>(0,ky.jsxs)("div",{style:{display:"flex",alignItems:"center",padding:"0.5rem 0.75rem",borderBottom:"1px solid #e2e8f0",cursor:"pointer",transition:"all 0.2s",background:n[e.id]?"#eef2ff":"white",minHeight:"40px"},onClick:()=>v(e.id),onMouseEnter:t=>{n[e.id]||(t.target.style.background="#f8fafc")},onMouseLeave:t=>{n[e.id]||(t.target.style.background="white")},children:[(0,ky.jsx)("input",{type:"checkbox",checked:!!n[e.id],onChange:()=>v(e.id),style:{width:"16px",height:"16px",marginRight:"0.5rem",accentColor:"#4f46e5"}}),(0,ky.jsxs)("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,ky.jsx)("div",{style:{fontSize:"0.8rem",fontWeight:"500",color:"#374151",lineHeight:"1.2",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",flex:1},children:e.name}),n[e.id]&&(0,ky.jsx)("div",{style:{width:"16px",height:"16px",background:"#4f46e5",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontSize:"0.6rem"},children:"\u2713"})]})]},e.id))})]}),(0,ky.jsx)("div",{style:{flex:1,display:"flex",flexDirection:"column",background:"#f8fafc",minHeight:0},children:0===g.length?(0,ky.jsx)("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",color:"#6b7280",textAlign:"center"},children:(0,ky.jsx)("p",{style:{fontSize:"1rem",margin:0},children:"Ch\u1ecdn t\u1eeb c\u1ed9t b\xean tr\xe1i"})}):(0,ky.jsx)("div",{style:{flex:1,overflowY:"auto",border:"2px solid #e2e8f0",borderRadius:"8px",padding:"0.25rem",background:"white",scrollbarWidth:"thin",scrollbarColor:"#cbd5e1 #f1f5f9",minHeight:0,maxHeight:"100%"},children:g.map(e=>(0,ky.jsxs)("div",{className:"item-row",style:{display:"flex",padding:"0.5rem 0.75rem",borderBottom:"1px solid #e2e8f0",background:"#f8fafc",marginBottom:"0.25rem",borderRadius:"6px",minHeight:"40px"},children:[(0,ky.jsx)("div",{className:"item-content",style:{flex:1,minWidth:0,overflow:"hidden"},children:(0,ky.jsx)("div",{className:"item-name",style:{fontSize:"0.8rem",fontWeight:"500",color:"#374151",lineHeight:"1.2",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:(null===e||void 0===e?void 0:e.name)||"Ingredient ".concat(e.id)})}),(0,ky.jsxs)("div",{className:"item-controls",style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[f&&(0,ky.jsxs)(ky.Fragment,{children:[(0,ky.jsx)("button",{type:"button",onClick:()=>{const t=parseInt(e.amount)||1;y(e.id,(t-1).toString())},style:{width:"24px",height:"24px",background:"#ef4444",border:"none",color:"white",borderRadius:"4px",cursor:"pointer",fontSize:"0.75rem",fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s"},onMouseEnter:e=>{e.target.style.background="#dc2626"},onMouseLeave:e=>{e.target.style.background="#ef4444"},children:"-"}),(0,ky.jsx)("input",{type:"number",min:"1",step:"1",placeholder:"1",value:e.amount,onChange:t=>y(e.id,t.target.value),style:{width:"50px",padding:"0.25rem 0.375rem",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"0.75rem",textAlign:"center",outline:"none",background:"white"},onFocus:e=>{e.target.style.borderColor="#4f46e5",e.target.style.boxShadow="0 0 0 2px rgba(79, 70, 229, 0.1)"},onBlur:e=>{e.target.style.borderColor="#d1d5db",e.target.style.boxShadow="none"}}),(0,ky.jsx)("button",{type:"button",onClick:()=>{const t=parseInt(e.amount)||1;y(e.id,(t+1).toString())},style:{width:"24px",height:"24px",background:"#10b981",border:"none",color:"white",borderRadius:"4px",cursor:"pointer",fontSize:"0.75rem",fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s"},onMouseEnter:e=>{e.target.style.background="#059669"},onMouseLeave:e=>{e.target.style.background="#10b981"},children:"+"})]}),(0,ky.jsx)("button",{type:"button",onClick:()=>{return t=e.id,void i(t);var t},style:{background:"#ef4444",border:"none",color:"white",cursor:"pointer",fontSize:"0.7rem",padding:"0.25rem",borderRadius:"4px",width:"24px",height:"24px",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s"},onMouseEnter:e=>{e.target.style.background="#dc2626",e.target.style.transform="scale(1.1)"},onMouseLeave:e=>{e.target.style.background="#ef4444",e.target.style.transform="scale(1)"},children:"\u2715"})]})]},e.id))})})]})},wR=()=>{const{menuItems:t,ingredients:n,recipes:r,isLoading:a}=xy(),[i,s]=(0,e.useState)({}),[o,c]=(0,e.useState)((new Date).toISOString().split("T")[0]),[u,h]=(0,e.useState)(""),[f,d]=(0,e.useState)({}),[p,m]=(0,e.useState)(!1);(0,e.useEffect)(()=>{const e=Ey.getSalesByDate(o);s(e)},[o]),(0,e.useEffect)(()=>{const e={};Object.keys(i).forEach(n=>{if(i[n]>0){t.find(e=>e.id===parseInt(n))&&(e[n]={amount:i[n].toString(),unit:"ly"})}}),d(e)},[i,t]);const g=(e,t)=>{const n=Math.max(0,t);s(t=>{const r=l(l({},t),{},{[e]:n});return Ey.updateSales(o,r),r})},v=()=>{const e={};return Object.keys(i).forEach(t=>{const n=i[t];n>0&&r[t]&&Object.keys(r[t]).forEach(a=>{const i=r[t][a],s="object"===typeof i?parseFloat(null===i||void 0===i?void 0:i.amount):parseFloat(i),o=(Number.isFinite(s)?s:0)*n;e[a]=(e[a]||0)+o})}),e},y=v();return a?(0,ky.jsx)("div",{className:"container",style:{paddingTop:"2rem",paddingBottom:"2rem"},children:(0,ky.jsx)(yR,{text:"\u0110ang t\u1ea3i d\u1eef li\u1ec7u kho h\xe0ng..."})}):(0,ky.jsxs)("div",{className:"container",style:{paddingTop:"2rem",paddingBottom:"2rem"},children:[(0,ky.jsxs)("div",{className:"card text-center fade-in",style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",border:"none",marginBottom:"2rem"},children:[(0,ky.jsx)("h1",{className:"text-xl",style:{marginBottom:"0.5rem",fontSize:"2.5rem",fontWeight:"bold"},children:"\ud83d\udcca Ki\u1ec3m K\xea Nguy\xean Li\u1ec7u"}),(0,ky.jsx)("p",{className:"text-lg",style:{opacity:.9},children:"Theo d\xf5i s\u1ed1 l\u01b0\u1ee3ng b\xe1n h\xe0ng v\xe0 t\xednh to\xe1n nguy\xean li\u1ec7u \u0111\xe3 s\u1eed d\u1ee5ng"})]}),(0,ky.jsx)("div",{className:"card text-center fade-in",style:{marginBottom:"2rem"},children:(0,ky.jsxs)("div",{className:"form-group",children:[(0,ky.jsx)("label",{className:"form-label text-lg",children:"\ud83d\udcc5 Ch\u1ecdn ng\xe0y ki\u1ec3m k\xea"}),(0,ky.jsx)("input",{type:"date",value:o,onChange:e=>c(e.target.value),className:"form-control",style:{maxWidth:"300px",margin:"0 auto"}})]})}),(0,ky.jsxs)("div",{className:"card fade-in",style:{marginBottom:"3rem"},children:[(0,ky.jsx)("h2",{className:"text-lg font-bold mb-3 text-center",children:"\ud83c\udf79 Ki\u1ec3m K\xea S\u1ed1 L\u01b0\u1ee3ng B\xe1n"}),0===t.length?(0,ky.jsxs)("div",{className:"text-center",style:{padding:"2rem",color:"#666"},children:[(0,ky.jsx)("p",{children:"Kh\xf4ng c\xf3 m\xf3n n\xe0o \u0111\u01b0\u1ee3c t\xecm th\u1ea5y."}),(0,ky.jsx)("p",{children:"H\xe3y ki\u1ec3m tra k\u1ebft n\u1ed1i d\u1eef li\u1ec7u ho\u1eb7c t\u1ea1o m\xf3n m\u1edbi."})]}):(0,ky.jsx)("div",{style:{padding:"1rem"},children:(0,ky.jsx)(bR,{items:t.map(e=>l(l({},e),{},{unit:"ly"})),selectedItems:f,onSelectionChange:(e,t)=>{d(n=>l(l({},n),{},{[e]:t})),t&&t.amount&&g(e,parseInt(t.amount)||1)},onAmountChange:(e,t)=>{d(n=>l(l({},n),{},{[e]:l(l({},n[e]),{},{amount:t})})),g(e,parseInt(t)||1)},onRemove:e=>{d(t=>{const n=l({},t);return delete n[e],n}),g(e,0)},searchTerm:u,onSearchChange:h,leftTitle:"Danh S\xe1ch M\xf3n",rightTitle:"S\u1ed1 L\u01b0\u1ee3ng \u0110\xe3 B\xe1n",placeholder:"T\xecm ki\u1ebfm m\xf3n...",showAmountInput:!0,showSearch:!0})})]}),(0,ky.jsxs)("div",{className:"card fade-in",style:{marginBottom:"2rem"},children:[(0,ky.jsxs)("div",{className:"card-header",children:[(0,ky.jsx)("h2",{className:"text-lg font-bold mb-0 text-center",children:"T\u1ed5ng Nguy\xean Li\u1ec7u \u0110\xe3 S\u1eed D\u1ee5ng"}),(0,ky.jsx)("button",{className:"btn btn-success",onClick:()=>{m(!0);try{const e=v(),t=vR.exportSimpleInventory(e,n);t.success?gy.success(t.message):gy.error(t.message)}catch(e){gy.error("C\xf3 l\u1ed7i x\u1ea3y ra khi xu\u1ea5t file Excel!")}finally{m(!1)}},disabled:p||0===Object.keys(y).length,style:{padding:"0.5rem 1rem",fontSize:"0.9rem",display:"flex",alignItems:"center",gap:"0.5rem",whiteSpace:"nowrap",minWidth:"fit-content",opacity:p||0===Object.keys(y).length?.6:1,cursor:p||0===Object.keys(y).length?"not-allowed":"pointer"},children:"T\u1ea3i xu\u1ed1ng Excel"})]}),Object.keys(y).length>0?(0,ky.jsx)("div",{className:"grid grid-3",style:{gap:"1rem"},children:Object.keys(y).map(e=>{const t=n.find(t=>t.id===e||t.id===parseInt(e).toString()||t.ingredientId===parseInt(e));return(0,ky.jsx)("div",{className:"card",style:{padding:"1rem",backgroundColor:"#f8f9fa",border:"2px solid #e9ecef"},children:(0,ky.jsxs)("div",{className:"text-center",children:[(0,ky.jsx)("div",{className:"text-lg font-bold text-primary",children:Number.isFinite(y[e])?y[e]:0}),(0,ky.jsx)("div",{className:"text-sm text-muted",children:(null===t||void 0===t?void 0:t.unit)||""}),(0,ky.jsx)("div",{className:"font-semibold",style:{color:"#333"},children:(null===t||void 0===t?void 0:t.name)||"Ingredient ".concat(e)})]})},e)})}):(0,ky.jsxs)("div",{className:"text-center",style:{padding:"2rem"},children:[(0,ky.jsx)("div",{style:{fontSize:"3rem",marginBottom:"1rem"}}),(0,ky.jsx)("p",{className:"text-muted text-lg",children:"Ch\u01b0a c\xf3 m\xf3n n\xe0o \u0111\u01b0\u1ee3c b\xe1n h\xf4m nay"})]})]}),(0,ky.jsxs)("div",{className:"card fade-in",style:{background:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)",color:"white",border:"none",textAlign:"center"},children:[(0,ky.jsx)("h3",{className:"text-lg font-bold mb-2",children:"\ud83d\udcca T\u1ed5ng S\u1ed1 L\u01b0\u1ee3ng"}),(0,ky.jsxs)("div",{className:"text-xl font-bold",style:{fontSize:"2rem"},children:[Object.keys(i).reduce((e,t)=>e+(i[t]||0),0)," ly"]}),(0,ky.jsxs)("div",{className:"text-sm",style:{opacity:.9,marginTop:"0.5rem"},children:["Ng\xe0y ",new Date(o).toLocaleDateString("vi-VN")]})]})]})},TR=e=>{let{isOpen:t,onClose:n,title:r,children:a,size:i="medium"}=e;if(!t)return null;return(0,ky.jsx)("div",{className:"modal-overlay",style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999,padding:"1rem"},onClick:n,children:(0,ky.jsxs)("div",{className:"modal-content ".concat({small:"max-w-xs",medium:"max-w-sm",large:"max-w-md",xlarge:"max-w-lg"}[i]),style:l(l({backgroundColor:"white",borderRadius:"12px",boxShadow:"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)"},{small:{width:"300px",maxWidth:"90vw"},medium:{width:"400px",maxWidth:"90vw"},large:{width:"500px",maxWidth:"90vw"},xlarge:{width:"600px",maxWidth:"90vw"},compact:{width:"33vw",maxWidth:"400px",minWidth:"300px"}}[i]),{},{maxHeight:"90vh",overflow:"hidden",display:"flex",flexDirection:"column"}),onClick:e=>e.stopPropagation(),children:[(0,ky.jsxs)("div",{style:{padding:"1rem 1.25rem",borderBottom:"1px solid #e5e7eb",display:"flex",alignItems:"center",justifyContent:"space-between",backgroundColor:"#f9fafb"},children:[(0,ky.jsx)("h2",{className:"font-bold",style:{margin:0,color:"#1f2937",fontSize:"1.1rem"},children:r}),(0,ky.jsx)("button",{onClick:n,className:"btn btn-secondary btn-sm",style:{padding:"0.25rem",minWidth:"auto",borderRadius:"50%",width:"28px",height:"28px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.8rem"},children:"\u2715"})]}),(0,ky.jsx)("div",{style:{padding:"1.25rem",overflowY:"auto",flex:1},children:a})]})})},SR=t=>{let{isOpen:n,onClose:r,menuItem:a,ingredients:i,currentRecipe:s,onSave:o}=t;const[c,u]=(0,e.useState)({}),[h,f]=(0,e.useState)(""),[d,p]=(0,e.useState)(!1);(0,e.useEffect)(()=>{if(n){f("");const e={};s&&Object.entries(s).forEach(t=>{let[n,r]=t;const a="object"===typeof r?r.amount:r,s=i.find(e=>e.id===n||e.id===parseInt(n).toString()||e.ingredientId===parseInt(n)),o="object"===typeof r?r.unit:(null===s||void 0===s?void 0:s.unit)||"g";e[n]={amount:a||"",unit:o||"g"}}),u(e)}},[n,s,i]);const m=Object.entries(c).filter(e=>{let[t,n]=e;return n}).map(e=>{let[t,n]=e;const r=i.find(e=>e.id===t||e.id===parseInt(t).toString()||e.ingredientId===parseInt(t));return l(l({id:t},r),{},{amount:n.amount||"",unit:n.unit})});return(0,ky.jsx)(TR,{isOpen:n,onClose:r,size:"xlarge",children:(0,ky.jsxs)("div",{style:{padding:"0",height:"70vh",maxHeight:"600px",display:"flex",flexDirection:"column",background:"#f8fafc",borderRadius:"12px",overflow:"hidden"},children:[(0,ky.jsx)("div",{style:{padding:"1rem 1.5rem",background:"linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%)",color:"white",borderRadius:"12px 12px 0 0",flexShrink:0},children:(0,ky.jsx)("h2",{style:{fontSize:"1.25rem",fontWeight:"600",textAlign:"center",margin:0},children:"\u270f\ufe0f Ch\u1ec9nh S\u1eeda C\xf4ng Th\u1ee9c"})}),(0,ky.jsxs)("div",{style:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden"},children:[(0,ky.jsx)("div",{style:{padding:"1rem 1.5rem",background:"white",borderBottom:"1px solid #e2e8f0",flexShrink:0},children:(0,ky.jsx)("div",{children:(0,ky.jsxs)("label",{style:{display:"block",fontSize:"0.8rem",fontWeight:"600",color:"#374151",marginBottom:"0.375rem"},children:["M\xf3n: ",(null===a||void 0===a?void 0:a.name)||""]})})}),(0,ky.jsx)("div",{style:{flex:1,padding:"1rem",background:"white",minHeight:0,overflow:"hidden"},children:(0,ky.jsx)(bR,{items:i,selectedItems:c,onSelectionChange:(e,t)=>{u(n=>l(l({},n),{},{[e]:t}))},onAmountChange:(e,t)=>{u(n=>l(l({},n),{},{[e]:l(l({},n[e]),{},{amount:t})}))},onRemove:e=>{u(t=>{const n=l({},t);return delete n[e],n})},searchTerm:h,onSearchChange:f,leftTitle:"Danh S\xe1ch Nguy\xean Li\u1ec7u",rightTitle:"Nh\u1eadp Kh\u1ed1i L\u01b0\u1ee3ng",placeholder:"T\xecm ki\u1ebfm nguy\xean li\u1ec7u...",showAmountInput:!0,showSearch:!0})}),(0,ky.jsxs)("div",{style:{padding:"0.75rem 1rem",background:"white",borderTop:"1px solid #e2e8f0",display:"flex",gap:"0.5rem",justifyContent:"flex-end",flexShrink:0},children:[(0,ky.jsx)("button",{type:"button",onClick:r,style:{padding:"0.5rem 1rem",border:"1px solid #d1d5db",borderRadius:"6px",background:"white",color:"#6b7280",fontSize:"0.8rem",fontWeight:"500",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:e=>{e.target.style.borderColor="#9ca3af",e.target.style.color="#374151"},onMouseLeave:e=>{e.target.style.borderColor="#d1d5db",e.target.style.color="#6b7280"},disabled:d,children:"H\u1ee7y"}),(0,ky.jsx)("button",{type:"submit",onClick:async()=>{if(m.some(e=>e.amount&&""!==String(e.amount).trim())){p(!0);try{const e={};m.filter(e=>e.amount&&""!==String(e.amount).trim()).forEach(t=>{e[t.id]={amount:t.amount,unit:t.unit}}),o(e),r()}catch(e){gy.error("C\xf3 l\u1ed7i x\u1ea3y ra khi l\u01b0u c\xf4ng th\u1ee9c!")}finally{p(!1)}}else gy.warning("Vui l\xf2ng ch\u1ecdn \xedt nh\u1ea5t m\u1ed9t nguy\xean li\u1ec7u v\xe0 nh\u1eadp kh\u1ed1i l\u01b0\u1ee3ng!")},style:{padding:"0.5rem 1rem",border:"none",borderRadius:"6px",background:m.some(e=>e.amount&&""!==String(e.amount).trim())?"#4f46e5":"#9ca3af",color:"white",fontSize:"0.8rem",fontWeight:"600",cursor:m.some(e=>e.amount&&""!==String(e.amount).trim())?"pointer":"not-allowed",transition:"all 0.2s",boxShadow:m.some(e=>e.amount&&""!==String(e.amount).trim())?"0 2px 4px -1px rgba(79, 70, 229, 0.3)":"none"},onMouseEnter:e=>{m.some(e=>e.amount&&""!==String(e.amount).trim())&&(e.target.style.background="#3730a3",e.target.style.transform="translateY(-1px)")},onMouseLeave:e=>{m.some(e=>e.amount&&""!==String(e.amount).trim())&&(e.target.style.background="#4f46e5",e.target.style.transform="translateY(0)")},disabled:d||!m.some(e=>e.amount&&""!==String(e.amount).trim()),children:d?"\u0110ang l\u01b0u...":"L\u01b0u c\xf4ng th\u1ee9c (".concat(m.filter(e=>e.amount&&""!==String(e.amount).trim()).length,")")})]})]})]})})},ER=e=>{let{isOpen:t,onClose:n,menuItem:r,ingredients:a,recipe:i}=e;return(0,ky.jsx)(TR,{isOpen:t,onClose:n,title:"\ud83d\udc41\ufe0f ".concat((null===r||void 0===r?void 0:r.name)||""),size:"compact",children:(0,ky.jsxs)("div",{className:"fade-in",children:[(0,ky.jsx)("div",{className:"mb-2",style:{padding:"0.5rem",backgroundColor:"#f8f9fa",borderRadius:"6px",fontSize:"0.8rem"},children:(0,ky.jsx)("div",{className:"flex-between",children:(0,ky.jsx)("span",{className:"font-semibold",children:null===r||void 0===r?void 0:r.name})})}),(0,ky.jsxs)("div",{className:"mb-2",children:[(0,ky.jsx)("h4",{className:"font-bold mb-1",style:{color:"#555",fontSize:"0.9rem"},children:"\ud83d\udce6 C\xf4ng th\u1ee9c nguy\xean li\u1ec7u"}),i&&Object.keys(i).length>0?(0,ky.jsx)("div",{style:{maxHeight:"200px",overflowY:"auto"},children:Object.keys(i).map(e=>{const t=a.find(t=>t.id===e||t.id===parseInt(e).toString()||t.ingredientId===parseInt(e)),n=i[e],r="object"===typeof n?n.amount:n,s="object"===typeof n?n.unit:(null===t||void 0===t?void 0:t.unit)||"";return(0,ky.jsxs)("div",{style:{padding:"0.5rem",backgroundColor:"white",border:"1px solid #e9ecef",borderRadius:"4px",marginBottom:"0.25rem",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,ky.jsx)("div",{style:{flex:1,minWidth:0},children:(0,ky.jsx)("div",{className:"font-semibold text-xs",style:{color:"#333"},children:(null===t||void 0===t?void 0:t.name)||"Ingredient ".concat(e)})}),(0,ky.jsxs)("div",{className:"text-lg font-bold text-primary",children:[r," ",s]})]},e)})}):(0,ky.jsx)("div",{className:"text-center",style:{padding:"0.5rem"},children:(0,ky.jsx)("p",{className:"text-muted text-xs",children:"Ch\u01b0a c\xf3 c\xf4ng th\u1ee9c cho m\xf3n n\xe0y"})})]}),(0,ky.jsx)("div",{className:"flex justify-center",style:{paddingTop:"0.5rem",borderTop:"1px solid #e5e7eb"},children:(0,ky.jsx)("button",{onClick:n,className:"btn btn-secondary btn-sm",style:{minWidth:"80px"},children:"\u274c \u0110\xf3ng"})})]})})},kR=t=>{let{isOpen:n,onClose:r,onSave:a}=t;const[i,s]=(0,e.useState)({name:""}),[o,c]=(0,e.useState)([]),[u,h]=(0,e.useState)({}),[f,d]=(0,e.useState)(""),[p,m]=(0,e.useState)(!1);(0,e.useEffect)(()=>{n&&(c(Ey.getIngredients()),s({name:""}),h({}),d(""))},[n]);const g=Object.entries(u).filter(e=>{let[t,n]=e;return n}).map(e=>{let[t,n]=e;return l(l({id:t},o.find(e=>e.id===parseInt(t))),{},{amount:n.amount||"",unit:n.unit})});return(0,ky.jsx)(TR,{isOpen:n,onClose:r,size:"xlarge",children:(0,ky.jsxs)("div",{style:{padding:"0",height:"100%",maxHeight:"80vh",display:"flex",flexDirection:"column",background:"#f8fafc",borderRadius:"12px",overflow:"hidden"},children:[(0,ky.jsx)("div",{style:{padding:"0.5rem 1rem",background:"linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%)",color:"white",borderRadius:"12px 12px 0 0",flexShrink:0},children:(0,ky.jsx)("h2",{style:{fontSize:"1rem",fontWeight:"600",textAlign:"center",margin:0},children:"\u2728 T\u1ea1o M\xf3n M\u1edbi"})}),(0,ky.jsxs)("div",{style:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden"},children:[(0,ky.jsx)("div",{style:{padding:"0.75rem 1rem",background:"white",borderBottom:"1px solid #e2e8f0",flexShrink:0},children:(0,ky.jsxs)("div",{children:[(0,ky.jsx)("label",{style:{display:"block",fontSize:"0.75rem",fontWeight:"600",color:"#374151",marginBottom:"0.25rem"},children:"T\xean m\xf3n"}),(0,ky.jsx)("input",{type:"text",name:"name",value:i.name,onChange:e=>{const{name:t,value:n}=e.target;s(e=>l(l({},e),{},{[t]:n}))},style:{width:"100%",padding:"0.375rem 0.5rem",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"0.8rem",outline:"none",transition:"all 0.2s",background:"#f8fafc"},onFocus:e=>{e.target.style.borderColor="#4f46e5",e.target.style.background="white",e.target.style.boxShadow="0 0 0 2px rgba(79, 70, 229, 0.1)"},onBlur:e=>{e.target.style.borderColor="#d1d5db",e.target.style.background="#f8fafc",e.target.style.boxShadow="none"},placeholder:"Nh\u1eadp t\xean m\xf3n...",required:!0})]})}),(0,ky.jsx)("div",{style:{flex:1,padding:"0.75rem",background:"white",minHeight:0,overflow:"hidden",display:"flex",flexDirection:"column"},children:(0,ky.jsx)("div",{style:{flex:1,minHeight:0},children:(0,ky.jsx)(bR,{items:o,selectedItems:u,onSelectionChange:(e,t)=>{h(n=>l(l({},n),{},{[e]:t}))},onAmountChange:(e,t)=>{h(n=>l(l({},n),{},{[e]:l(l({},n[e]),{},{amount:t})}))},onRemove:e=>{h(t=>{const n=l({},t);return delete n[e],n})},searchTerm:f,onSearchChange:d,leftTitle:"Danh S\xe1ch Nguy\xean Li\u1ec7u",rightTitle:"Nh\u1eadp Kh\u1ed1i L\u01b0\u1ee3ng",placeholder:"T\xecm ki\u1ebfm nguy\xean li\u1ec7u...",showAmountInput:!0,showSearch:!0,className:"flex-1"})})}),(0,ky.jsxs)("div",{style:{padding:"0.5rem 1rem",background:"white",borderTop:"1px solid #e2e8f0",display:"flex",gap:"0.5rem",justifyContent:"flex-end",flexShrink:0},children:[(0,ky.jsx)("button",{type:"button",onClick:r,style:{padding:"0.375rem 0.75rem",border:"1px solid #d1d5db",borderRadius:"4px",background:"white",color:"#6b7280",fontSize:"0.75rem",fontWeight:"500",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:e=>{e.target.style.borderColor="#9ca3af",e.target.style.color="#374151"},onMouseLeave:e=>{e.target.style.borderColor="#d1d5db",e.target.style.color="#6b7280"},disabled:p,children:"H\u1ee7y"}),(0,ky.jsx)("button",{type:"submit",onClick:async e=>{if(e.preventDefault(),!i.name.trim())return void gy.warning("Vui l\xf2ng nh\u1eadp t\xean m\xf3n!");if(g.some(e=>e.amount&&""!==e.amount.trim())){m(!0);try{const e=await Ey.addMenuItem({name:i.name,description:"",category:"\u0110\u1ed3 u\u1ed1ng"}),t={};g.filter(e=>e.amount&&""!==e.amount.trim()).forEach(e=>{t[e.id]={amount:e.amount,unit:e.unit}}),await Ey.updateRecipe(e.id,t),gy.success("\u0110\xe3 t\u1ea1o m\xf3n m\u1edbi th\xe0nh c\xf4ng!"),a(),r()}catch(t){gy.error("C\xf3 l\u1ed7i x\u1ea3y ra khi t\u1ea1o m\xf3n m\u1edbi!")}finally{m(!1)}}else gy.warning("Vui l\xf2ng ch\u1ecdn \xedt nh\u1ea5t m\u1ed9t nguy\xean li\u1ec7u v\xe0 nh\u1eadp kh\u1ed1i l\u01b0\u1ee3ng!")},style:{padding:"0.375rem 0.75rem",border:"none",borderRadius:"4px",background:g.some(e=>e.amount&&""!==e.amount.trim())?"#4f46e5":"#9ca3af",color:"white",fontSize:"0.75rem",fontWeight:"600",cursor:g.some(e=>e.amount&&""!==e.amount.trim())?"pointer":"not-allowed",transition:"all 0.2s",boxShadow:g.some(e=>e.amount&&""!==e.amount.trim())?"0 2px 4px -1px rgba(79, 70, 229, 0.3)":"none"},onMouseEnter:e=>{g.some(e=>e.amount&&""!==e.amount.trim())&&(e.target.style.background="#3730a3",e.target.style.transform="translateY(-1px)")},onMouseLeave:e=>{g.some(e=>e.amount&&""!==e.amount.trim())&&(e.target.style.background="#4f46e5",e.target.style.transform="translateY(0)")},disabled:p||!g.some(e=>e.amount&&""!==e.amount.trim()),children:p?"\u0110ang t\u1ea1o...":"T\u1ea1o m\xf3n (".concat(g.filter(e=>e.amount&&""!==e.amount.trim()).length,")")})]})]})]})})},_R=()=>{const{menuItems:t,ingredients:n,recipes:r,isLoading:a,updateAllData:i}=xy(),[s,o]=(0,e.useState)(null),[l,c]=(0,e.useState)(null),[u,h]=(0,e.useState)(!1),[f,d]=(0,e.useState)(!1),[p,m]=(0,e.useState)(!1),[g,v]=(0,e.useState)(!1),[y,b]=(0,e.useState)(null),w=()=>{b(null),v(!1)};return a?(0,ky.jsx)("div",{className:"container",style:{paddingTop:"2rem",paddingBottom:"2rem"},children:(0,ky.jsx)(yR,{text:"\u0110ang t\u1ea3i d\u1eef li\u1ec7u c\xf4ng th\u1ee9c..."})}):(0,ky.jsxs)("div",{className:"container",style:{paddingTop:"2rem",paddingBottom:"2rem"},children:[(0,ky.jsxs)("div",{className:"card text-center fade-in",style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",border:"none",marginBottom:"2rem"},children:[(0,ky.jsx)("h1",{className:"text-xl",style:{marginBottom:"0.5rem",fontSize:"2.5rem",fontWeight:"bold"},children:"\ud83d\udcdd C\xf4ng Th\u1ee9c Nguy\xean Li\u1ec7u"}),(0,ky.jsx)("p",{className:"text-lg",style:{opacity:.9,marginBottom:"1rem"},children:"Qu\u1ea3n l\xfd v\xe0 ch\u1ec9nh s\u1eeda c\xf4ng th\u1ee9c cho t\u1eebng m\xf3n \u0111\u1ed3 u\u1ed1ng"}),(0,ky.jsx)("button",{onClick:()=>{m(!0)},className:"btn btn-success",style:{fontSize:"1rem",padding:"0.75rem 1.5rem",borderRadius:"0.5rem",fontWeight:"bold"},children:"\u2795 T\u1ea1o M\xf3n M\u1edbi"})]}),(0,ky.jsxs)("div",{className:"card fade-in",style:{marginBottom:"3rem"},children:[(0,ky.jsx)("h2",{className:"text-lg font-bold mb-3 text-center",children:"\ud83c\udf79 Danh S\xe1ch M\xf3n"}),0===t.length?(0,ky.jsxs)("div",{className:"text-center",style:{padding:"2rem",color:"#666"},children:[(0,ky.jsx)("p",{children:"Kh\xf4ng c\xf3 m\xf3n n\xe0o \u0111\u01b0\u1ee3c t\xecm th\u1ea5y."}),(0,ky.jsx)("p",{children:"H\xe3y th\u1eed t\u1ea1o m\xf3n m\u1edbi ho\u1eb7c ki\u1ec3m tra k\u1ebft n\u1ed1i d\u1eef li\u1ec7u."})]}):(0,ky.jsx)("div",{className:"grid grid-2",style:{gap:"1rem"},children:t.map(e=>(0,ky.jsxs)("div",{className:"card",style:{padding:"1rem",backgroundColor:s===e.id?"#e3f2fd":"#f8f9fa",border:s===e.id?"2px solid #3498db":"2px solid #e9ecef",transition:"all 0.3s ease"},children:[(0,ky.jsxs)("div",{className:"flex-between mb-2",children:[(0,ky.jsx)("div",{children:(0,ky.jsx)("h3",{className:"font-bold",style:{color:"#333",fontSize:"1.1rem"},children:e.name})}),(0,ky.jsxs)("div",{className:"badge badge-primary",children:[Object.keys(r[e.id]||{}).length," nguy\xean li\u1ec7u"]})]}),(0,ky.jsxs)("div",{className:"flex gap-1",style:{flexWrap:"wrap"},children:[(0,ky.jsx)("button",{onClick:()=>{return t=e.id,o(t),void d(!0);var t},className:"btn btn-primary btn-sm",style:{flex:"1 1 auto",minWidth:"60px",fontSize:"0.8rem",padding:"0.4rem 0.6rem"},children:"Xem"}),(0,ky.jsx)("button",{onClick:()=>{return t=e.id,c(t),h(!0),void o(null);var t},className:"btn btn-success btn-sm",style:{flex:"1 1 auto",minWidth:"60px",fontSize:"0.8rem",padding:"0.4rem 0.6rem"},children:"S\u1eeda"}),(0,ky.jsx)("button",{onClick:()=>{return t=e.id,b(t),void v(!0);var t},className:"btn btn-danger btn-sm",style:{flex:"1 1 auto",minWidth:"60px",fontSize:"0.8rem",padding:"0.4rem 0.6rem"},children:"X\xf3a"})]})]},e.id))})]}),(0,ky.jsxs)("div",{style:{backgroundColor:"#e9ecef",padding:"1.5rem",borderRadius:"8px"},children:[(0,ky.jsx)("h3",{style:{color:"#555",marginBottom:"1rem"},children:"T\xf3m T\u1eaft T\u1ea5t C\u1ea3 C\xf4ng Th\u1ee9c"}),(0,ky.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"1rem"},children:t.map(e=>(0,ky.jsxs)("div",{style:{backgroundColor:"white",padding:"1rem",borderRadius:"6px",border:"1px solid #dee2e6"},children:[(0,ky.jsx)("h4",{style:{margin:"0 0 0.5rem 0",color:"#333"},children:e.name}),Object.keys(r[e.id]||{}).map(t=>{const a=n.find(e=>e.id===t||e.id===parseInt(t).toString()||e.ingredientId===parseInt(t)),i=r[e.id][t],s="object"===typeof i?i.amount:i,o="object"===typeof i?i.unit:null===a||void 0===a?void 0:a.unit;return(0,ky.jsxs)("div",{style:{fontSize:"0.8rem",color:"#666"},children:["\u2022 ",(null===a||void 0===a?void 0:a.name)||"Ingredient ".concat(t),": ",s," ",o]},t)})]},e.id))})]}),(0,ky.jsx)(ER,{isOpen:f,onClose:()=>{o(null),d(!1)},menuItem:t.find(e=>e.id===s),ingredients:n,recipe:r[s]}),(0,ky.jsx)(SR,{isOpen:u,onClose:()=>{c(null),h(!1)},menuItem:t.find(e=>e.id===l),ingredients:n,currentRecipe:r[l],onSave:async e=>{try{await Ey.updateRecipe(l,e),i(),c(null),h(!1),gy.success("\u0110\xe3 l\u01b0u c\xf4ng th\u1ee9c th\xe0nh c\xf4ng!")}catch(t){gy.error("C\xf3 l\u1ed7i x\u1ea3y ra khi l\u01b0u c\xf4ng th\u1ee9c!")}}}),(0,ky.jsx)(kR,{isOpen:p,onClose:()=>{m(!1)},onSave:async()=>{i()}}),(0,ky.jsx)(TR,{isOpen:g,onClose:w,title:"X\xe1c nh\u1eadn x\xf3a",size:"sm",children:(0,ky.jsxs)("div",{className:"text-center",children:[(0,ky.jsx)("div",{className:"mb-3",style:{color:"#dc3545",fontSize:"4rem"},children:"\u26a0\ufe0f"}),(0,ky.jsx)("h3",{className:"mb-4",children:"B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n x\xf3a m\xf3n n\xe0y?"}),(0,ky.jsx)("p",{className:"mb-4",children:"H\xe0nh \u0111\u1ed9ng n\xe0y kh\xf4ng th\u1ec3 ho\xe0n t\xe1c. T\u1ea5t c\u1ea3 c\xf4ng th\u1ee9c c\u1ee7a m\xf3n n\xe0y s\u1ebd b\u1ecb x\xf3a v\u0129nh vi\u1ec5n."}),(0,ky.jsxs)("div",{className:"flex gap-2 justify-center",children:[(0,ky.jsx)("button",{onClick:w,className:"btn btn-secondary",style:{minWidth:"100px"},children:"H\u1ee7y"}),(0,ky.jsx)("button",{onClick:async()=>{if(y)try{await Ey.deleteMenuItem(y),await Ey.deleteRecipe(y),i(),gy.success("\u0110\xe3 x\xf3a m\xf3n th\xe0nh c\xf4ng!"),w()}catch(e){console.error("L\u1ed7i khi x\xf3a m\xf3n:",e),gy.error("C\xf3 l\u1ed7i x\u1ea3y ra khi x\xf3a m\xf3n!")}},className:"btn btn-danger",style:{minWidth:"100px"},children:"X\xf3a"})]})]})})]})},xR=()=>{const[t,n]=(0,e.useState)([]),[r,a]=(0,e.useState)(!1),[i,s]=(0,e.useState)(null),[o,c]=(0,e.useState)({name:"",unit:""}),[u,h]=(0,e.useState)(!0);(0,e.useEffect)(()=>{(async()=>{h(!0);try{Ey.isInitialized||await Ey.init(),n(Ey.getIngredients())}catch(e){n([])}finally{h(!1)}})()},[]);const f=()=>{s(null),c({name:"",unit:""}),a(!0)},d=()=>{a(!1),s(null),c({name:"",unit:""})},p=e=>{const{name:t,value:n}=e.target;c(e=>l(l({},e),{},{[t]:n}))};return u?(0,ky.jsx)("div",{className:"container",style:{paddingTop:"2rem",paddingBottom:"2rem"},children:(0,ky.jsx)(yR,{text:"\u0110ang t\u1ea3i danh s\xe1ch nguy\xean li\u1ec7u..."})}):(0,ky.jsxs)("div",{className:"container",style:{paddingTop:"2rem",paddingBottom:"2rem"},children:[(0,ky.jsxs)("div",{className:"card text-center fade-in",style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",border:"none",marginBottom:"2rem"},children:[(0,ky.jsx)("h1",{className:"text-xl",style:{marginBottom:"0.5rem",fontSize:"2.5rem",fontWeight:"bold"},children:"\ud83e\udd64 Qu\u1ea3n L\xfd Nguy\xean Li\u1ec7u"}),(0,ky.jsx)("p",{className:"text-lg",style:{opacity:.9},children:"Th\xeam, s\u1eeda, x\xf3a nguy\xean li\u1ec7u v\xe0 \u0111\u01a1n v\u1ecb \u0111o"})]}),(0,ky.jsx)("div",{className:"card fade-in",style:{marginBottom:"2rem"},children:(0,ky.jsxs)("div",{className:"grid grid-4 text-center",children:[(0,ky.jsxs)("div",{children:[(0,ky.jsx)("div",{className:"text-lg font-bold text-primary",children:t.length}),(0,ky.jsx)("div",{className:"text-sm text-muted",children:"T\u1ed5ng nguy\xean li\u1ec7u"})]}),(0,ky.jsxs)("div",{children:[(0,ky.jsx)("div",{className:"text-lg font-bold text-success",children:[...new Set(t.map(e=>e.unit))].length}),(0,ky.jsx)("div",{className:"text-sm text-muted",children:"\u0110\u01a1n v\u1ecb \u0111o"})]}),(0,ky.jsxs)("div",{children:[(0,ky.jsx)("div",{className:"text-lg font-bold text-warning",children:t.filter(e=>"g"===e.unit).length}),(0,ky.jsx)("div",{className:"text-sm text-muted",children:"Theo gram"})]}),(0,ky.jsxs)("div",{children:[(0,ky.jsx)("div",{className:"text-lg font-bold text-danger",children:t.filter(e=>"ml"===e.unit).length}),(0,ky.jsx)("div",{className:"text-sm text-muted",children:"Theo ml"})]})]})}),(0,ky.jsx)("div",{className:"card fade-in",style:{marginBottom:"2rem"},children:(0,ky.jsxs)("div",{className:"flex-between",children:[(0,ky.jsx)("h2",{className:"text-lg font-bold",children:"\ud83d\udccb Danh S\xe1ch Nguy\xean Li\u1ec7u"}),(0,ky.jsx)("button",{onClick:f,className:"btn btn-success",children:"\u2795 Th\xeam Nguy\xean Li\u1ec7u"})]})}),(0,ky.jsx)("div",{className:"card fade-in",children:t.length>0?(0,ky.jsx)("div",{className:"grid grid-3",style:{gap:"1rem"},children:t.map(e=>(0,ky.jsxs)("div",{className:"card",style:{padding:"1rem",backgroundColor:"#f8f9fa",border:"2px solid #e9ecef",transition:"all 0.3s ease"},children:[(0,ky.jsxs)("div",{className:"text-center mb-2",children:[(0,ky.jsx)("div",{className:"font-bold text-lg",style:{color:"#333"},children:e.name}),(0,ky.jsx)("div",{className:"badge badge-primary",children:e.unit})]}),(0,ky.jsxs)("div",{className:"flex gap-1 justify-center",children:[(0,ky.jsx)("button",{onClick:()=>(e=>{s(e),c({name:e.name,unit:e.unit}),a(!0)})(e),className:"btn btn-warning btn-sm",style:{flex:1},children:"S\u1eeda"}),(0,ky.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n x\xf3a nguy\xean li\u1ec7u n\xe0y? H\xe0nh \u0111\u1ed9ng n\xe0y s\u1ebd x\xf3a nguy\xean li\u1ec7u kh\u1ecfi t\u1ea5t c\u1ea3 c\xf4ng th\u1ee9c."))try{await Ey.deleteIngredient(e),n(Ey.getIngredients()),gy.success("\u0110\xe3 x\xf3a nguy\xean li\u1ec7u th\xe0nh c\xf4ng!")}catch(t){gy.error("C\xf3 l\u1ed7i x\u1ea3y ra khi x\xf3a nguy\xean li\u1ec7u!")}})(e.id),className:"btn btn-danger btn-sm",style:{flex:1},children:"X\xf3a"})]})]},e.id))}):(0,ky.jsxs)("div",{className:"text-center",style:{padding:"2rem"},children:[(0,ky.jsx)("div",{style:{fontSize:"3rem",marginBottom:"1rem"},children:"\ud83e\udd64"}),(0,ky.jsx)("p",{className:"text-muted text-lg",children:"Ch\u01b0a c\xf3 nguy\xean li\u1ec7u n\xe0o"}),(0,ky.jsx)("button",{onClick:f,className:"btn btn-primary mt-2",children:"\u2795 Th\xeam Nguy\xean Li\u1ec7u \u0110\u1ea7u Ti\xean"})]})}),(0,ky.jsx)(TR,{isOpen:r,onClose:d,title:i?"\u270f\ufe0f S\u1eeda Nguy\xean Li\u1ec7u":"\u2795 Th\xeam Nguy\xean Li\u1ec7u M\u1edbi",size:"small",children:(0,ky.jsxs)("div",{className:"fade-in",children:[(0,ky.jsxs)("div",{className:"form-group mb-3",children:[(0,ky.jsx)("label",{className:"form-label",children:"T\xean nguy\xean li\u1ec7u"}),(0,ky.jsx)("input",{type:"text",name:"name",value:o.name,onChange:p,className:"form-control",placeholder:"V\xed d\u1ee5: C\xe0 ph\xea, S\u1eefa t\u01b0\u01a1i, \u0110\u01b0\u1eddng..."})]}),(0,ky.jsxs)("div",{className:"form-group mb-3",children:[(0,ky.jsx)("label",{className:"form-label",children:"\u0110\u01a1n v\u1ecb \u0111o"}),(0,ky.jsxs)("select",{name:"unit",value:o.unit,onChange:p,className:"form-control",children:[(0,ky.jsx)("option",{value:"",children:"Ch\u1ecdn \u0111\u01a1n v\u1ecb \u0111o"}),(0,ky.jsx)("option",{value:"g",children:"Gram (g)"}),(0,ky.jsx)("option",{value:"ml",children:"Milliliter (ml)"}),(0,ky.jsx)("option",{value:"qu\u1ea3",children:"Qu\u1ea3"}),(0,ky.jsx)("option",{value:"ly",children:"Ly"}),(0,ky.jsx)("option",{value:"mu\u1ed7ng",children:"Mu\u1ed7ng"}),(0,ky.jsx)("option",{value:"g\xf3i",children:"G\xf3i"}),(0,ky.jsx)("option",{value:"kg",children:"Kilogram (kg)"}),(0,ky.jsx)("option",{value:"l",children:"Liter (l)"}),(0,ky.jsx)("option",{value:"c\xe1i",children:"C\xe1i"}),(0,ky.jsx)("option",{value:"mi\u1ebfng",children:"Mi\u1ebfng"}),(0,ky.jsx)("option",{value:"h\u0169",children:"H\u0169"})]})]}),(0,ky.jsxs)("div",{className:"flex gap-2 justify-center",style:{paddingTop:"0.5rem",borderTop:"1px solid #e5e7eb"},children:[(0,ky.jsx)("button",{onClick:()=>{o.name.trim()&&o.unit.trim()?(i?(Ey.updateIngredient(i.id,o),n(Ey.getIngredients()),gy.success("\u0110\xe3 c\u1eadp nh\u1eadt nguy\xean li\u1ec7u th\xe0nh c\xf4ng!")):(Ey.addIngredient(o),n(Ey.getIngredients()),gy.success("\u0110\xe3 th\xeam nguy\xean li\u1ec7u m\u1edbi th\xe0nh c\xf4ng!")),d()):gy.warning("Vui l\xf2ng \u0111i\u1ec1n \u0111\u1ea7y \u0111\u1ee7 th\xf4ng tin!")},className:"btn btn-success btn-sm",style:{minWidth:"80px"},children:"\ud83d\udcbe L\u01b0u"}),(0,ky.jsx)("button",{onClick:d,className:"btn btn-secondary btn-sm",style:{minWidth:"80px"},children:"\u274c H\u1ee7y"})]})]})})]})};const CR=function(){const e=he(),t=Ay.isAuthenticated(),n="/login"===e.pathname;return(0,ky.jsx)(Cy,{children:(0,ky.jsxs)("div",{className:"App",children:[t&&!n&&(0,ky.jsx)(Ny,{}),(0,ky.jsx)("main",{style:{minHeight:t&&!n?"calc(100vh - 50px)":"100vh"},children:(0,ky.jsxs)(De,{children:[(0,ky.jsx)(Oe,{path:"/login",element:(0,ky.jsx)(Ry,{})}),(0,ky.jsx)(Oe,{path:"/",element:(0,ky.jsx)(Oy,{children:(0,ky.jsx)(Py,{})})}),(0,ky.jsx)(Oe,{path:"/inventory",element:(0,ky.jsx)(Oy,{children:(0,ky.jsx)(wR,{})})}),(0,ky.jsx)(Oe,{path:"/recipes",element:(0,ky.jsx)(Oy,{children:(0,ky.jsx)(_R,{})})}),(0,ky.jsx)(Oe,{path:"/ingredients",element:(0,ky.jsx)(Oy,{children:(0,ky.jsx)(xR,{})})})]})})]})})},IR=e=>{e&&e instanceof Function&&n.e(453).then(n.bind(n,453)).then(t=>{let{getCLS:n,getFID:r,getFCP:a,getLCP:i,getTTFB:s}=t;n(e),r(e),a(e),i(e),s(e)})};t.createRoot(document.getElementById("root")).render((0,ky.jsx)(dt,{children:(0,ky.jsx)(CR,{})})),IR()})()})();
//# sourceMappingURL=main.95e03bc2.js.map