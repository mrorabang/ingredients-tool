<!DOCTYPE html>
<html>
<head>
    <title>Test Data Loading</title>
</head>
<body>
    <h1>Test Data Loading</h1>
    <div id="status">Loading...</div>
    <div id="ingredients"></div>
    <div id="recipes"></div>
    
    <script>
        // Mock dataService for testing
        class MockDataService {
            constructor() {
                this.ingredients = [];
                this.recipes = {};
                this.isInitialized = false;
                this.useMockAPI = true;
            }
            
            async init() {
                if (this.isInitialized) return;
                
                try {
                    console.log('Loading from MockAPI...');
                    const response = await fetch('https://68d4a223214be68f8c69d69b.mockapi.io/ingredients');
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    this.ingredients = await response.json();
                    console.log('Loaded ingredients:', this.ingredients.length);
                    
                    const recipesResponse = await fetch('https://68d4a223214be68f8c69d69b.mockapi.io/recipes');
                    if (recipesResponse.ok) {
                        const mockAPIRecipes = await recipesResponse.json();
                        console.log('Loaded recipes:', mockAPIRecipes.length);
                        // Convert format
                        this.recipes = {};
                        mockAPIRecipes.forEach(recipe => {
                            this.recipes[recipe.itemId] = recipe.ingredients || {};
                        });
                    }
                    
                    this.isInitialized = true;
                    document.getElementById('status').innerHTML = '✅ Data loaded successfully!';
                } catch (error) {
                    console.error('Error loading data:', error);
                    document.getElementById('status').innerHTML = `❌ Error: ${error.message}`;
                }
            }
            
            getIngredients() {
                return this.ingredients;
            }
            
            getAllRecipes() {
                return this.recipes;
            }
        }
        
        async function testLoading() {
            const dataService = new MockDataService();
            await dataService.init();
            
            const ingredients = dataService.getIngredients();
            const recipes = dataService.getAllRecipes();
            
            document.getElementById('ingredients').innerHTML = `
                <h2>Ingredients (${ingredients.length})</h2>
                <ul>
                    ${ingredients.slice(0, 5).map(ing => `<li>${ing.name} (${ing.unit})</li>`).join('')}
                    ${ingredients.length > 5 ? `<li>... and ${ingredients.length - 5} more</li>` : ''}
                </ul>
            `;
            
            document.getElementById('recipes').innerHTML = `
                <h2>Recipes (${Object.keys(recipes).length})</h2>
                <ul>
                    ${Object.keys(recipes).slice(0, 5).map(itemId => `<li>${itemId}: ${Object.keys(recipes[itemId]).length} ingredients</li>`).join('')}
                </ul>
            `;
        }
        
        testLoading();
    </script>
</body>
</html>
